System.register(["./index-legacy-CW2Mof-g.js","./view_file-legacy-ydAzmqEn.js","./zcq-sb-dky-legacy-CXOWGi-E.js"],function(e,t){"use strict";var l,i,r,o,d,a,s,n,m,u,p,h,f,c,b,F,y,R,g,w,V,v,x,k,S,U,D,I,M,C,$;return{setters:[e=>{l=e.b,i=e.r,r=e.o,o=e.c,d=e.d,a=e.e,s=e.w,n=e.F,m=e.v,u=e.f,p=e.q,h=e.j,f=e.i,c=e.t,b=e.E,F=e.M,y=e.P,R=e.Q,g=e.R,w=e.S,V=e.U,v=e.W,x=e.Y,k=e.Z,S=e.$,U=e.a0},e=>{D=e.v},e=>{I=e.Z,M=e.a,C=e.z,$=e.c}],execute:function(){const t={name:"dynamic_form",props:{validateRules:Array,row:Object,tableHeaderList:Array,isDisabled:{type:Boolean,default:!1},labelWidth:{type:String,default:"auto"},footerButtonList:{type:Array,default:[{type:"gradientDarkGreen",name:"刷新"},{type:"gradientBlue",name:"保存"}]}},data:()=>({ruleForm:{},formItems:[],extensions:[y,R,g,v.configure({bubble:!0}),x.configure({bubble:!0,menubar:!1}),k.configure({bubble:!0}),S.configure({bubble:!0}),U.configure({bubble:!0}),History,w,V],originData:{}}),computed:{moreConfig:()=>({maxCount:1,layout:"horizontal"})},created(){this.originData=JSON.parse(JSON.stringify(this.row)),console.log("行数据",this.row),this.formItems=this.tableHeaderList.filter(e=>!("radio"==e.type||"checkbox"==e.type||"expand"==e.type||"seq"==e.type)),console.log("表单字段",this.formItems);let e={};for(const{field:l}of this.formItems)e[l]="";for(var t in this.ruleForm=Object.assign({},e),this.row)this.ruleForm[t]=this.row[t]},methods:{focusMethod(e){if(e.editRender.props.associate&&this.ruleForm[e.editRender.props.associateField]){let t={};t[e.editRender.props.associateField]=this.ruleForm[e.editRender.props.associateField],b.getAssociateOptionsService(e.editRender.props.associateUrl,t).then(t=>{e.editRender.options=t.data})}},uploadMethod({file:e},t){const l=new FormData;return l.append("file",e),l.append("id",this.ruleForm.id),l.append("type",t.editRender.props.type),b.uploadFileService(l).then(e=>e.data)},downloadMethod({option:e}){b.downloadFileGetService({fileId:e.id})},removeMethod({option:e}){e.id&&b.removeFileService({fileId:e.id,id:this.ruleForm.id}).then(()=>{this.$message.success("移除成功")})},previewMethod({option:e}){b.preViewFileService({id:e.id}).then(e=>{let t=F(e,"pdf")+"#toolbar=0";this.$vxeModal.show(D,{url:t},{width:800,title:"文件预览",height:window.innerHeight-20},{})})},selectBtn(e){switch(e.editRender.props.type){case"tdcs":this.selectCs(e);break;case"tdsb":this.selectSb(e)}},selectCs(e){this.$vxeModal.show($,{omsDefaultNode:this.$store.state.omsDefaultNode,d5000DefaultNode:this.$store.state.d5000DefaultNode,showOMS:!1},{width:600,height:188,title:"选择停电厂站类型"},{refreshCZXX:t=>{this.ruleForm[e.field]=t.CZMC,this.ruleForm[e.field+"Id"]=t.CZID,this.ruleForm[e.field+"lx"]=t.tdcslx,this.ruleForm[e.field+"Param"]=t,this.ruleForm[e.field+"Param0"]=t}})},selectSb(e){if(!this.ruleForm.tdcslx)return void this.$message({message:"停电场所类型为空，请先选择停电场所",type:"warning"});if(!this.ruleForm.tdcsParam)return void this.$message({message:"当前为非对象化场所，请重选场所后再选择停电设备",type:"warning"});let t={id:this.ruleForm.id,tdcsParam:this.ruleForm.tdcsParam,bdlx:"rjh-dd"};"D5000"==this.ruleForm.tdcslx?this.$vxeModal.show(I,{paramdata:t,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-D5000"},{refreshSBXX:t=>{this.ruleForm[e.field+"List"]=t,this.ruleForm[e.field+"List0"]=t,this.ruleForm[e.field+"Id"]=t.map(e=>e.sbid).join(","),this.ruleForm[e.field]=t.map(e=>e.sbddmm).join(",")}}):"OMS"==this.ruleForm.tdcslx?this.$vxeModal.show(M,{paramdata:t,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-OMS"},{refreshSBXX:t=>{this.ruleForm[e.field+"List"]=t,this.ruleForm[e.field+"List0"]=t,this.ruleForm[e.field+"Id"]=t.map(e=>e.sbid).join(","),this.ruleForm[e.field]=t.map(e=>e.sbddmm).join(",")}}):"DKY"==this.ruleForm.tdcslx&&this.$vxeModal.show(C,{paramdata:t,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-DKY"},{refreshSBXX:t=>{this.ruleForm[e.field+"List"]=t,this.ruleForm[e.field+"List0"]=t,this.ruleForm[e.field+"Id"]=t.map(e=>e.sbid).join(","),this.ruleForm[e.field]=t.map(e=>e.sbddmm).join(",")}})},btnClick(e){switch(e.name){case"刷新":this.refreshData();break;case"保存":this.doSubmit();break;case"取消":this.$emit("close");break;default:this.$emit("doOperate",{data:this.ruleForm,btn:e})}},refreshData(){this.ruleForm=JSON.parse(JSON.stringify(this.originData))},doSubmit(){console.log(this.ruleForm),this.$refs.ruleForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;this.$emit("doSubmit",this.ruleForm)})}}},L={id:"dynamic_form",class:"page_content"},_={key:11};e("d",l(t,[["render",function(e,t,l,b,F,y){const R=i("el-input"),g=i("el-option"),w=i("el-select"),V=i("el-tree-select"),v=i("el-input-number"),x=i("el-date-picker"),k=i("el-radio"),S=i("el-radio-group"),U=i("vxe-upload"),D=i("el-tiptap"),I=i("el-button"),M=i("el-form-item"),C=i("el-form"),$=i("el-scrollbar");return r(),o("div",L,[d("article",null,[a($,{height:"100%"},{default:s(()=>[a(C,{model:F.ruleForm,rules:l.validateRules,ref:"ruleForm","label-width":l.labelWidth,disabled:l.isDisabled},{default:s(()=>[(r(!0),o(n,null,m(F.formItems,(e,i)=>(r(),u(M,{key:"formItems"+i,label:e.title+"：",prop:e.field,style:p(e.colWidth?{width:e.colWidth}:{width:"100%"})},{default:s(()=>["ElInput"!=e.editRender.name||e.editRender.props.type&&"text"!=e.editRender.props.type?h("",!0):(r(),u(R,{key:0,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:"text",clearable:e.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","clearable"])),"ElInput"==e.editRender.name&&"number"==e.editRender.props.type?(r(),u(R,{key:1,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:"number",clearable:e.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","clearable"])):h("",!0),e.editRender&&"ElInput"==e.editRender.name&&"textarea"==e.editRender.props.type?(r(),u(R,{key:2,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:"textarea",clearable:e.editRender.props.clearable,autosize:{minRows:2,maxRows:6}},null,8,["modelValue","onUpdate:modelValue","clearable"])):h("",!0),"ElSelect"==e.editRender.name?(r(),u(w,{key:3,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,onFocus:t=>y.focusMethod(e),clearable:e.editRender.props.clearable,filterable:e.editRender.props.filterable,multiple:e.editRender.props.multiple},{default:s(()=>[e.editRender.options&&e.editRender.options.length>0?(r(!0),o(n,{key:0},m(e.editRender.options,(t,l)=>(r(),u(g,{key:"formItems"+i+e.field+l,value:t.value,label:t.label},null,8,["value","label"]))),128)):h("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","onFocus","clearable","filterable","multiple"])):h("",!0),"$ElTreeSelect"==e.editRender.name?(r(),u(V,{key:4,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,filterable:e.editRender.props.filterable,"render-after-expand":!1,"check-strictly":"",data:e.editRender.data,clearable:e.editRender.props.clearable,multiple:e.editRender.props.multiple,"collapse-tags":"","collapse-tags-tooltip":"","tag-type":""},null,8,["modelValue","onUpdate:modelValue","filterable","data","clearable","multiple"])):h("",!0),"ElInputNumber"==e.editRender.name?(r(),u(v,{key:5,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,min:e.editRender.props.min,max:e.editRender.props.max,step:e.editRender.props.step,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","min","max","step"])):h("",!0),"ElDatePicker"==e.editRender.name&&["year","month","date","datetime"].includes(e.editRender.props.type)?(r(),u(x,{key:6,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:e.editRender.props.type,"value-format":e.editRender.props.valueFormat,"label-format":e.editRender.props.labelFormat},null,8,["modelValue","onUpdate:modelValue","type","value-format","label-format"])):h("",!0),"$radio"==e.editRender.name?(r(),u(S,{key:7,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t},{default:s(()=>[e.editRender.options&&e.editRender.options.length>0?(r(!0),o(n,{key:0},m(e.editRender.options,(t,l)=>(r(),u(k,{key:"radio"+i+e.field+l,value:t.value},{default:s(()=>[f(c(t.label),1)]),_:2},1032,["value"]))),128)):h("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])):h("",!0),"vxeUpload"==e.editRender.name?(r(),u(U,{key:8,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,disabled:l.isDisabled,multiple:e.editRender.props.multiple,"file-types":e.editRender.props.types,"more-config":y.moreConfig,"show-tip":!1,"show-download-button":"","button-text":"上传","limit-size":e.editRender.props.limitSize,"upload-method":t=>y.uploadMethod(t,e),"download-method":y.downloadMethod,"remove-method":y.removeMethod},null,8,["modelValue","onUpdate:modelValue","disabled","multiple","file-types","more-config","limit-size","upload-method","download-method","remove-method"])):h("",!0),"ElTiptap"==e.editRender.name?(r(),u(D,{key:9,content:F.ruleForm[e.field],"onUpdate:content":t=>F.ruleForm[e.field]=t,extensions:F.extensions},null,8,["content","onUpdate:content","extensions"])):h("",!0),e.editRender&&"$modal"==e.editRender.name?(r(),o(n,{key:10},[a(R,{modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,readonly:"",style:{width:"calc(100% - 78px)","margin-right":"10px"},title:F.ruleForm[e.field]},null,8,["modelValue","onUpdate:modelValue","title"]),a(I,{onClick:t=>y.selectBtn(e),type:"primary",style:{"margin-right":"8px"}},{default:s(()=>[...t[0]||(t[0]=[f("选择",-1)])]),_:1},8,["onClick"])],64)):h("",!0),e.editRender.name?h("",!0):(r(),o("p",_,c(F.ruleForm[e.field]),1))]),_:2},1032,["label","prop","style"]))),128))]),_:1},8,["model","rules","label-width","disabled"])]),_:1})]),d("footer",null,[(r(!0),o(n,null,m(l.footerButtonList,(e,t)=>(r(),u(I,{key:"footerButtonList"+t,type:e.type,onClick:t=>y.btnClick(e)},{default:s(()=>[f(c(e.name),1)]),_:2},1032,["type","onClick"]))),128))])])}],["__scopeId","data-v-b77d7b99"]]))}}});
