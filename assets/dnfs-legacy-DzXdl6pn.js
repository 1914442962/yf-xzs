!function(){function e(e,t,o,i,l,a,n){try{var r=e[a](n),s=r.value}catch(e){return void o(e)}r.done?t(s):Promise.resolve(s).then(i,l)}System.register(["./table_mixin-legacy-D9U6ScmD.js","./index-legacy-BhBZRkTD.js","./view_file-legacy-B8YEJj9G.js","./UploadHttpComponent-legacy-DQP0LTpf.js","./polyfill-legacy-aWkUxw0k.js"],function(t,o){"use strict";var i,l,a,n,r,s,d,c,h,p,u,f,m,g,v,w,y,x,b,C;return{setters:[e=>{i=e.t},e=>{l=e.b,a=e.r,n=e.o,r=e.c,s=e.d,d=e.e,c=e.g,h=e.F,p=e.v,u=e.f,f=e.w,m=e.i,g=e.t,v=e.x,w=e.E,y=e.M,x=e.an},e=>{b=e.v},e=>{C=e.U},null],execute:function(){const o={name:"dnfs",components:{UploadHttpComponent:C},mixins:[i],data:()=>({time:["",""],total:0,searchParams:{type:"dnfs",keyword:""},tableData:[],isAutoWrap:!1}),watch:{},computed:{tableHeaderList:()=>[{type:"checkbox",width:50},{type:"seq",width:60},{field:"fileName",title:"文件名"},{title:"操作",width:"150",slots:{default:"action"}}],gridOptions(){return{height:"auto",keepSource:!0,border:!0,round:!0,stripe:!0,headerAlign:"center",align:"center",loading:!1,rowConfig:{isCurrent:!0,isHover:!0},radioConfig:{highlight:!0},checkboxConfig:{highlight:!0},columnConfig:{resizable:!0},sortConfig:{remote:!0},filterConfig:{remote:!0},showOverflow:this.isAutoWrap,headerCellClassName:"row-class",pagerConfig:this.pagerConfig,proxyConfig:{seq:!0,showResponseMsg:!1,showActionMsg:!1,sort:!0,filter:!0,ajax:{query:({page:e,sorts:t,filters:o})=>this.loadTableApi(e,t,o),delete:({body:e})=>this.doDeleteApi(e.removeRecords),save:({body:e})=>this.doSaveApi(e)}},exportConfig:{filename:"运行方式模版管理表",sheetName:"sheet1",type:"xlsx",mode:"all",modes:["current","selected","all"],message:!1,columns:this.tableHeaderList.filter(e=>"checkbox"!==e.type),exportMethod:this.exportMethod,afterExportMethod:this.afterExportMethod},editConfig:{trigger:"click",mode:"cell",showStatus:!0,showIcon:!0,beforeEditMethod:this.beforeEditMethod},menuConfig:{body:{options:[[{code:"collect",name:"标记重点"}]]}},columns:this.tableHeaderList}},defaultLeftButtons:()=>[{type:"gradientGreen",name:"查询"}],defaultRightButtons:()=>[{type:"gradientBlue",name:"上传文件"}]},mounted(){},methods:{reloadTableData(){this.$refs.xTable.commitProxy("query")},loadTableData(){this.$refs.xTable.commitProxy("reload")},loadTableApi(e,t,o){let i=this.getRealParams(this.searchParams,e,t,o);return new Promise((t,o)=>{w.loadFileService(i).then(o=>{1e5==e.pageSize?(this.total=o.total,t(o.data)):(this.total=o.total,t({result:o.data,page:{total:o.total}}))})})},toggleWrap(){this.isAutoWrap?this.isAutoWrap=!1:this.isAutoWrap="tooltip"},readFileEvent(){var t,o=this;return(t=function*(){const e=[],{files:t}=yield x.readFile({multiple:!0});t.forEach(t=>{e.push({id:o.rowKey++,name:t.name,size:t.size,file:t})}),o.gridOptions.data=e},function(){var o=this,i=arguments;return new Promise(function(l,a){var n=t.apply(o,i);function r(t){e(n,l,a,r,s,"next",t)}function s(t){e(n,l,a,r,s,"throw",t)}r(void 0)})})()},uploadMethod({file:e}){const t=new FormData;t.append("file",e),t.append("id",""),t.append("type","dnfs"),w.uploadFileService(t).then(e=>{this.loadTableData()})},removeMethod(e){w.removeFileService({fileId:e.id}).then(()=>{this.$message.success("移除成功"),this.loadTableData()})},downloadMethod(e){w.downloadFileGetService({fileId:e.id})},previewMethod(e){this.$store.state.isXzs?w.preViewFileGetService({fileId:e.id}):w.preViewFileService({fileId:e.id}).then(e=>{let t=y(e,"pdf")+"#toolbar=0";this.$vxeModal.show(b,{url:t},{width:800,title:"文件预览",height:window.innerHeight-20},{})})}}},k={class:"page_content"},M={class:"header-item"},A={class:"header-item"},P={class:"header-item"};t("default",l(o,[["render",function(e,t,o,i,l,w){const y=a("el-input"),x=a("el-button"),b=a("vxe-upload"),C=a("vxe-button"),S=a("vxe-grid");return n(),r("div",k,[s("header",null,[s("section",null,[s("div",M,[d(y,{placeholder:"请输入文件名称",modelValue:l.searchParams.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>l.searchParams.keyword=e),onKeydown:c(w.loadTableData,["enter"]),title:l.searchParams.keyword,clearable:""},null,8,["modelValue","onKeydown","title"])]),s("div",A,[(n(!0),r(h,null,p(w.defaultLeftButtons,(t,o)=>(n(),u(x,{type:t.type,plain:t.plain,key:o+"defaultLeftButtons",onClick:o=>e.btnClick(t)},{default:f(()=>[m(g(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])]),s("section",null,[s("div",P,[d(x,{type:"gradientBlue",onClick:t[1]||(t[1]=t=>e.$refs.uploadRef.choose())},{default:f(()=>[...t[3]||(t[3]=[m("上传",-1)])]),_:1}),d(b,{ref:"uploadRef",multiple:"","file-types":["doc","docx","xls","xlsx","ppt","pptx","pdf","dwg"],"button-text":"上传文件","show-list":!1,showUploadButton:!1,"upload-method":w.uploadMethod},null,8,["upload-method"])])])]),s("article",null,[d(S,v(w.gridOptions,{ref:"xTable",onMenuClick:t[2]||(t[2]=t=>e.menuClickEvent(t,"年度方式"))}),{action:f(({row:e})=>[d(C,{mode:"text",icon:"vxe-icon-search",status:"primary",onClick:t=>w.previewMethod(e)},null,8,["onClick"]),d(C,{mode:"text",status:"primary",icon:"vxe-icon-download",onClick:t=>w.downloadMethod(e)},null,8,["onClick"]),d(C,{mode:"text",status:"error",icon:"vxe-icon-delete",onClick:t=>w.removeMethod(e)},null,8,["onClick"])]),_:1},16)])])}],["__scopeId","data-v-e7b4fd30"]]))}}})}();
