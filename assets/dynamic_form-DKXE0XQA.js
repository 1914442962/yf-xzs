import{_ as e,r as t,o as l,c as o,b as i,d as r,w as d,F as a,q as s,e as n,p as m,i as u,h as p,t as h,D as f,L as c,P as b,Q as F,R as y,S as R,U as g,W as w,Y as V,Z as v,$ as x,a0 as k}from"./index-CIzN2UtG.js";import{v as S}from"./view_file-CO9OLjy1.js";import{Z as U,a as D,z as I,c as C}from"./zcq-sb-dky-BY8cnSG7.js";const M={name:"dynamic_form",props:{validateRules:Array,row:Object,tableHeaderList:Array,isDisabled:{type:Boolean,default:!1},labelWidth:{type:String,default:"auto"},footerButtonList:{type:Array,default:[{type:"gradientDarkGreen",name:"刷新"},{type:"gradientBlue",name:"保存"}]}},data:()=>({ruleForm:{},formItems:[],extensions:[b,F,y,w.configure({bubble:!0}),V.configure({bubble:!0,menubar:!1}),v.configure({bubble:!0}),x.configure({bubble:!0}),k.configure({bubble:!0}),History,R,g],originData:{}}),computed:{moreConfig:()=>({maxCount:1,layout:"horizontal"})},created(){this.originData=JSON.parse(JSON.stringify(this.row)),console.log("行数据",this.row),this.formItems=this.tableHeaderList.filter(e=>!("radio"==e.type||"checkbox"==e.type||"expand"==e.type||"seq"==e.type)),console.log("表单字段",this.formItems);let e={};for(const{field:l}of this.formItems)e[l]="";for(var t in this.ruleForm=Object.assign({},e),this.row)this.ruleForm[t]=this.row[t]},methods:{focusMethod(e){if(e.editRender.props.associate&&this.ruleForm[e.editRender.props.associateField]){let t={};t[e.editRender.props.associateField]=this.ruleForm[e.editRender.props.associateField],f.getAssociateOptionsService(e.editRender.props.associateUrl,t).then(t=>{e.editRender.options=t.data})}},uploadMethod({file:e},t){const l=new FormData;return l.append("file",e),l.append("id",this.ruleForm.id),l.append("type",t.editRender.props.type),f.uploadFileService(l).then(e=>e.data)},downloadMethod({option:e}){f.downloadFileGetService({fileId:e.id})},removeMethod({option:e}){e.id&&f.removeFileService({fileId:e.id,id:this.ruleForm.id}).then(()=>{this.$message.success("移除成功")})},previewMethod({option:e}){f.preViewFileService({id:e.id}).then(e=>{let t=c(e,"pdf")+"#toolbar=0";this.$vxeModal.show(S,{url:t},{width:800,title:"文件预览",height:window.innerHeight-20},{})})},selectBtn(e){switch(e.editRender.props.type){case"tdcs":this.selectCs(e);break;case"tdsb":this.selectSb(e)}},selectCs(e){this.$vxeModal.show(C,{omsDefaultNode:this.$store.state.omsDefaultNode,d5000DefaultNode:this.$store.state.d5000DefaultNode,showOMS:!1},{width:600,height:188,title:"选择停电厂站类型"},{refreshCZXX:t=>{this.ruleForm[e.field]=t.CZMC,this.ruleForm[e.field+"Id"]=t.CZID,this.ruleForm[e.field+"lx"]=t.tdcslx,this.ruleForm[e.field+"Param"]=t,this.ruleForm[e.field+"Param0"]=t}})},selectSb(e){if(!this.ruleForm.tdcslx)return void this.$message({message:"停电场所类型为空，请先选择停电场所",type:"warning"});if(!this.ruleForm.tdcsParam)return void this.$message({message:"当前为非对象化场所，请重选场所后再选择停电设备",type:"warning"});let t={id:this.ruleForm.id,tdcsParam:this.ruleForm.tdcsParam,bdlx:"rjh-dd"};"D5000"==this.ruleForm.tdcslx?this.$vxeModal.show(U,{paramdata:t,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-D5000"},{refreshSBXX:t=>{this.ruleForm[e.field+"List"]=t,this.ruleForm[e.field+"List0"]=t,this.ruleForm[e.field+"Id"]=t.map(e=>e.sbid).join(","),this.ruleForm[e.field]=t.map(e=>e.sbddmm).join(",")}}):"OMS"==this.ruleForm.tdcslx?this.$vxeModal.show(D,{paramdata:t,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-OMS"},{refreshSBXX:t=>{this.ruleForm[e.field+"List"]=t,this.ruleForm[e.field+"List0"]=t,this.ruleForm[e.field+"Id"]=t.map(e=>e.sbid).join(","),this.ruleForm[e.field]=t.map(e=>e.sbddmm).join(",")}}):"DKY"==this.ruleForm.tdcslx&&this.$vxeModal.show(I,{paramdata:t,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-DKY"},{refreshSBXX:t=>{this.ruleForm[e.field+"List"]=t,this.ruleForm[e.field+"List0"]=t,this.ruleForm[e.field+"Id"]=t.map(e=>e.sbid).join(","),this.ruleForm[e.field]=t.map(e=>e.sbddmm).join(",")}})},btnClick(e){switch(e.name){case"刷新":this.refreshData();break;case"保存":this.doSubmit();break;case"取消":this.$emit("close");break;default:this.$emit("doOperate",{data:this.ruleForm,btn:e})}},refreshData(){this.ruleForm=JSON.parse(JSON.stringify(this.originData))},doSubmit(){console.log(this.ruleForm),this.$refs.ruleForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;this.$emit("doSubmit",this.ruleForm)})}}},$={id:"dynamic_form",class:"page_content"},L={key:11};const _=e(M,[["render",function(e,f,c,b,F,y){const R=t("el-input"),g=t("el-option"),w=t("el-select"),V=t("el-tree-select"),v=t("el-input-number"),x=t("el-date-picker"),k=t("el-radio"),S=t("el-radio-group"),U=t("vxe-upload"),D=t("el-tiptap"),I=t("el-button"),C=t("el-form-item"),M=t("el-form"),_=t("el-scrollbar");return l(),o("div",$,[i("article",null,[r(_,{height:"100%"},{default:d(()=>[r(M,{model:F.ruleForm,rules:c.validateRules,ref:"ruleForm","label-width":c.labelWidth,disabled:c.isDisabled},{default:d(()=>[(l(!0),o(a,null,s(F.formItems,(e,t)=>(l(),n(C,{key:"formItems"+t,label:e.title+"：",prop:e.field,style:m(e.colWidth?{width:e.colWidth}:{width:"100%"})},{default:d(()=>["ElInput"!=e.editRender.name||e.editRender.props.type&&"text"!=e.editRender.props.type?u("",!0):(l(),n(R,{key:0,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:"text",clearable:e.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","clearable"])),"ElInput"==e.editRender.name&&"number"==e.editRender.props.type?(l(),n(R,{key:1,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:"number",clearable:e.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","clearable"])):u("",!0),e.editRender&&"ElInput"==e.editRender.name&&"textarea"==e.editRender.props.type?(l(),n(R,{key:2,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:"textarea",clearable:e.editRender.props.clearable,autosize:{minRows:2,maxRows:6}},null,8,["modelValue","onUpdate:modelValue","clearable"])):u("",!0),"ElSelect"==e.editRender.name?(l(),n(w,{key:3,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,onFocus:t=>y.focusMethod(e),clearable:e.editRender.props.clearable,filterable:e.editRender.props.filterable,multiple:e.editRender.props.multiple},{default:d(()=>[e.editRender.options&&e.editRender.options.length>0?(l(!0),o(a,{key:0},s(e.editRender.options,(o,i)=>(l(),n(g,{key:"formItems"+t+e.field+i,value:o.value,label:o.label},null,8,["value","label"]))),128)):u("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","onFocus","clearable","filterable","multiple"])):u("",!0),"$ElTreeSelect"==e.editRender.name?(l(),n(V,{key:4,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,filterable:e.editRender.props.filterable,"render-after-expand":!1,"check-strictly":"",data:e.editRender.data,clearable:e.editRender.props.clearable,multiple:e.editRender.props.multiple,"collapse-tags":"","collapse-tags-tooltip":"","tag-type":""},null,8,["modelValue","onUpdate:modelValue","filterable","data","clearable","multiple"])):u("",!0),"ElInputNumber"==e.editRender.name?(l(),n(v,{key:5,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,min:e.editRender.props.min,max:e.editRender.props.max,step:e.editRender.props.step,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","min","max","step"])):u("",!0),"ElDatePicker"==e.editRender.name&&["year","month","date","datetime"].includes(e.editRender.props.type)?(l(),n(x,{key:6,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,type:e.editRender.props.type,"value-format":e.editRender.props.valueFormat,"label-format":e.editRender.props.labelFormat},null,8,["modelValue","onUpdate:modelValue","type","value-format","label-format"])):u("",!0),"$radio"==e.editRender.name?(l(),n(S,{key:7,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t},{default:d(()=>[e.editRender.options&&e.editRender.options.length>0?(l(!0),o(a,{key:0},s(e.editRender.options,(o,i)=>(l(),n(k,{key:"radio"+t+e.field+i,value:o.value},{default:d(()=>[p(h(o.label),1)]),_:2},1032,["value"]))),128)):u("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])):u("",!0),"vxeUpload"==e.editRender.name?(l(),n(U,{key:8,modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,disabled:c.isDisabled,multiple:e.editRender.props.multiple,"file-types":e.editRender.props.types,"more-config":y.moreConfig,"show-tip":!1,"show-download-button":"","button-text":"上传","limit-size":e.editRender.props.limitSize,"upload-method":t=>y.uploadMethod(t,e),"download-method":y.downloadMethod,"remove-method":y.removeMethod},null,8,["modelValue","onUpdate:modelValue","disabled","multiple","file-types","more-config","limit-size","upload-method","download-method","remove-method"])):u("",!0),"ElTiptap"==e.editRender.name?(l(),n(D,{key:9,content:F.ruleForm[e.field],"onUpdate:content":t=>F.ruleForm[e.field]=t,extensions:F.extensions},null,8,["content","onUpdate:content","extensions"])):u("",!0),e.editRender&&"$modal"==e.editRender.name?(l(),o(a,{key:10},[r(R,{modelValue:F.ruleForm[e.field],"onUpdate:modelValue":t=>F.ruleForm[e.field]=t,readonly:"",style:{width:"calc(100% - 78px)","margin-right":"10px"},title:F.ruleForm[e.field]},null,8,["modelValue","onUpdate:modelValue","title"]),r(I,{onClick:t=>y.selectBtn(e),type:"primary",style:{"margin-right":"8px"}},{default:d(()=>[...f[0]||(f[0]=[p("选择",-1)])]),_:1},8,["onClick"])],64)):u("",!0),e.editRender.name?u("",!0):(l(),o("p",L,h(F.ruleForm[e.field]),1))]),_:2},1032,["label","prop","style"]))),128))]),_:1},8,["model","rules","label-width","disabled"])]),_:1})]),i("footer",null,[(l(!0),o(a,null,s(c.footerButtonList,(e,t)=>(l(),n(I,{key:"footerButtonList"+t,type:e.type,onClick:t=>y.btnClick(e)},{default:d(()=>[p(h(e.name),1)]),_:2},1032,["type","onClick"]))),128))])])}],["__scopeId","data-v-b77d7b99"]]);export{_ as d};
