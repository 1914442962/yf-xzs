System.register(["./table_mixin-legacy-DIG8w3YV.js","./UploadHttpComponent-legacy-BNj506lX.js","./validateRules-legacy-Co865pER.js","./index-legacy-C9R4tdre.js","./polyfill-legacy-aWkUxw0k.js"],function(e,t){"use strict";var a,s,i,r,o,l,n,d,h,c,u,p,m,g,f,b,y,x,j,v;return{setters:[e=>{a=e.t},e=>{s=e.U},e=>{i=e.v},e=>{r=e.z,o=e.A,l=e._,n=e.r,d=e.o,h=e.c,c=e.b,u=e.F,p=e.q,m=e.e,g=e.w,f=e.h,b=e.t,y=e.d,x=e.v,j=e.D,v=e.y},null],execute:function(){let t=o.base;const w={loadTableDataService:e=>r({url:`${t}/jxjh/queryZjh`,method:"post",data:e,showLoading:!0}),saveTableDataService:e=>r({url:`${t}/jxjh/saveZjh`,method:"post",data:e,showLoading:!0}),doDelTableDataService:e=>r({url:`${t}/jxjh/deleteZjh`,method:"post",data:e,showLoading:!0})},D={class:"page_content"},C={class:"header-item"},T={class:"header-item"},k={class:"header-item"};e("default",l({name:"zjh",mixins:[a],components:{UploadHttpComponent:s},data:()=>({time:["",""],total:0,searchParams:{},tableData:[],isAutoWrap:!1}),watch:{time:{handler(e){e?(this.searchParams.startTime=e[0],this.searchParams.endTime=e[1]):(this.searchParams.startTime="",this.searchParams.endTime="")},immediate:!1}},computed:{tableHeaderList(){return[{type:"checkbox",width:50,fixed:"left"},{type:"seq",width:60,fixed:"left"},{field:"yjsy",title:"预警事由",minWidth:120,headerAlign:"center",align:"left",editRender:{name:"ElInput",props:{type:"textarea",clearable:!0,autosize:!this.isAutoWrap||{maxRows:1},resize:"none"}}},{field:"kssj",title:"开始时间",width:150,sortable:!0,editRender:{name:"ElDatePicker",props:{type:"date",labelFormat:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",clearable:!0}}},{field:"jssj",title:"结束时间",width:150,sortable:!0,editRender:{name:"ElDatePicker",props:{type:"date",labelFormat:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",clearable:!0}}},{field:"bdz",title:"变电站",width:250,editRender:{name:"ElInput",props:{clearable:!0}}}]},editRules:()=>({yjsy:[{required:!0,message:"预警事由不能为空"}],kssj:[{required:!0,message:"开始时间不能为空"},i.date.rule,{validator({cellValue:e,row:t}){if(e&&t.jssj&&v(e).isAfter(t.jssj))return new Error("开始时间必须在结束时间之前")}}],jssj:[{required:!0,message:"结束时间不能为空"},i.date.rule,{validator({cellValue:e,row:t}){if(e&&t.kssj&&v(e).isBefore(t.kssj))return new Error("结束时间必须在开始时间之后")}}],bdz:[{required:!0,message:"变电站不能为空"}]}),gridOptions(){return{height:"auto",keepSource:!0,border:!0,round:!0,stripe:!0,headerAlign:"center",align:"center",loading:!1,rowConfig:{isCurrent:!0,isHover:!0},radioConfig:{highlight:!0},checkboxConfig:{highlight:!0,reserve:!0,showServeStatus:!0,range:!0},columnConfig:{resizable:!0},resizeConfig:{isDblclickAutoWidth:!0},sortConfig:{remote:!0},filterConfig:{remote:!0},showOverflow:this.isAutoWrap,headerCellClassName:"row-class",pagerConfig:this.pagerConfig,proxyConfig:{seq:!0,showResponseMsg:!1,showActionMsg:!1,sort:!0,filter:!0,ajax:{query:({page:e,sorts:t,filters:a})=>this.loadTableApi(e,t,a),queryAll:({sorts:e,filters:t})=>this.loadTableApi({pageSize:1e5,currentPage:1},e,t),delete:({body:e})=>this.doDeleteApi(e.removeRecords),save:({body:e})=>this.doSaveApi(e)}},exportConfig:{filename:"运行方式模版管理表",sheetName:"sheet1",type:"xlsx",mode:"all",modes:["current","selected","all"],message:!1,columns:this.tableHeaderList.filter(e=>"checkbox"!==e.type),exportMethod:this.exportMethod,afterExportMethod:this.afterExportMethod},editConfig:{trigger:"click",mode:"cell",showStatus:!0,showIcon:!0,beforeEditMethod:this.beforeEditMethod},editRules:this.editRules,columns:this.tableHeaderList,menuConfig:{body:{options:[[{code:"collect",name:"标记重点"}]]}}}},defaultLeftButtons:()=>[{type:"gradientGreen",name:"查询"},{type:"gradientDarkGreen",name:"刷新"}],defaultRightButtons:()=>[{type:"gradientBlue",name:"下载导入模版"},{type:"gradientBlue",name:"新增"},{type:"gradientBlue",name:"保存"},{type:"gradientRed",name:"删除"}]},mounted(){},methods:{reloadTableData(){this.$refs.xTable.commitProxy("query")},loadTableData(){this.$refs.xTable.commitProxy("reload")},loadTableApi(e,t,a){let s=this.getRealParams(this.searchParams,e,t,a);return new Promise((t,a)=>{w.loadTableDataService(s).then(a=>{1e5==e.pageSize?(this.total=a.total,t(a.data)):(this.total=a.total,t({result:a.data,page:{total:a.total}}))})})},toggleWrap(){this.isAutoWrap?this.isAutoWrap=!1:this.isAutoWrap="tooltip"},doAdd(){this.$refs.xTable.insertAt({}).then(e=>{this.$refs.xTable.setEditRow(e)})},doSave(){const e=this.getUpdateRecords();e&&e.length>0&&this.$refs.xTable.commitProxy("save")},doSaveApi(e){return new Promise((t,a)=>{let{insertRecords:s,updateRecords:i}=e,r=[...s,...i];w.saveTableDataService({data:r}).then(e=>{this.$message.success(e.data),t()}).catch(()=>{a()})})},doDelete(){const e=this.getCheckboxRecords();e&&e.length>0&&this.$confirm(`确认删除勾选的${e.length}条数据吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$refs.xTable.commitProxy("delete")})},doDeleteApi(e){return new Promise((t,a)=>{let s=e.map(e=>e.id).join(",");w.doDelTableDataService({ids:s}).then(e=>{this.$message.success(e.data),t()}).catch(()=>{a()})})},downloadModule(){j.exportFileService("/jxjh/download-zjh-tpl",{})},beforeEditMethod:({row:e,column:t})=>!0,resetParams(){this.searchParams.keyword="",this.searchParams.sortOrder="",this.searchParams.sortColumn="",this.time=["",""],this.$nextTick(function(){this.loadTableData()})}}},[["render",function(e,t,a,s,i,r){const o=n("el-button"),l=n("upload-http-component"),j=n("vxe-grid");return d(),h("div",D,[c("header",null,[c("section",null,[c("div",C,[(d(!0),h(u,null,p(r.defaultLeftButtons,(t,a)=>(d(),m(o,{type:t.type,plain:t.plain,key:a+"defaultLeftButtons",onClick:a=>e.btnClick(t)},{default:g(()=>[f(b(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])]),c("section",null,[c("div",T,[y(l,{"prop-upload-url":"/jxjh/import-zjh",onLoadTableData:t[0]||(t[0]=e=>r.loadTableData(!0))})]),c("div",k,[(d(!0),h(u,null,p(r.defaultRightButtons,(t,a)=>(d(),m(o,{type:t.type,plain:t.plain,key:a+"defaultRightButtons",onClick:a=>e.btnClick(t)},{default:g(()=>[f(b(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])])]),c("article",null,[y(j,x(r.gridOptions,{ref:"xTable",onMenuClick:t[1]||(t[1]=t=>e.menuClickEvent(t,"设备检修"))}),null,16)])])}],["__scopeId","data-v-1ac37a3a"]]))}}});
