import{aE as t,aF as e,aG as n,aH as o,aI as r,aJ as i,aK as a,aL as s,aM as l,aN as u,aO as c,aP as d,aQ as p,aR as h,aS as f,aT as g,aU as y,aV as v,aW as m,aX as b,aY as _,aZ as x,a_ as E,a$ as w,b0 as S,b1 as O,b2 as C,b3 as T,b4 as M,b5 as N,b6 as A,b7 as P,b8 as D,b9 as k,ba as R,bb as L,bc as I,bd as j,be as B,bf as H,bg as z,bh as F,bi as W,bj as X,bk as U,bl as G,bm as Y,bn as V,bo as K,bp as q,bq as Z,br as $,bs as J,bt as Q,bu as tt,bv as et,bw as nt,bx as ot,by as rt,bz as it,bA as at,bB as st,bC as lt,bD as ut,bE as ct,bF as dt,bG as pt,bH as ht,bI as ft,bJ as gt,bK as yt,bL as vt,bM as mt,bN as bt,bO as _t,bP as xt,bQ as Et,bR as wt,bS as St,bT as Ot,bU as Ct,bV as Tt,bW as Mt,bX as Nt,bY as At,bZ as Pt,b_ as Dt,b$ as kt,c0 as Rt,c1 as Lt,c2 as It,c3 as jt,c4 as Bt,c5 as Ht,c6 as zt,c7 as Ft,c8 as Wt,c9 as Xt,ca as Ut,cb as Gt,cc as Yt,cd as Vt,ce as Kt,cf as qt,cg as Zt,ch as $t,ci as Jt,cj as Qt,ck as te,cl as ee,cm as ne,cn as oe,co as re,cp as ie,cq as ae,cr as se,cs as le,ct as ue,cu as ce,cv as de,cw as pe,cx as he,cy as fe,cz as ge,cA as ye,cB as ve,cC as me}from"./index-CRHEuOwk.js";import{g as be}from"./polyfill-lGe4XDVY.js";function _e(e){return"number"==typeof e?e:t(e)?NaN:+e}function xe(t,n){return function(o,r){var i;if(void 0===o&&void 0===r)return n;if(void 0!==o&&(i=o),void 0!==r){if(void 0===i)return r;"string"==typeof o||"string"==typeof r?(o=e(o),r=e(r)):(o=_e(o),r=_e(r)),i=t(o,r)}return i}}var Ee=xe(function(t,e){return t+e},0);var we=o&&new o,Se=we?function(t,e){return we.set(t,e),t}:r;function Oe(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=i(t.prototype),o=t.apply(n,e);return a(o)?o:n}}var Ce=Math.max;function Te(t,e,n,o){for(var r=-1,i=t.length,a=n.length,s=-1,l=e.length,u=Ce(i-a,0),c=Array(l+u),d=!o;++s<l;)c[s]=e[s];for(;++r<a;)(d||r<i)&&(c[n[r]]=t[r]);for(;u--;)c[s++]=t[r++];return c}var Me=Math.max;function Ne(t,e,n,o){for(var r=-1,i=t.length,a=-1,s=n.length,l=-1,u=e.length,c=Me(i-s,0),d=Array(c+u),p=!o;++r<c;)d[r]=t[r];for(var h=r;++l<u;)d[h+l]=e[l];for(;++a<s;)(p||r<i)&&(d[h+n[a]]=t[r++]);return d}function Ae(){}function Pe(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}Pe.prototype=i(Ae.prototype),Pe.prototype.constructor=Pe;var De=we?function(t){return we.get(t)}:l,ke={},Re=Object.prototype.hasOwnProperty;function Le(t){for(var e=t.name+"",n=ke[e],o=Re.call(ke,e)?n.length:0;o--;){var r=n[o],i=r.func;if(null==i||i==t)return r.name}return e}function Ie(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function je(t){if(t instanceof Pe)return t.clone();var e=new Ie(t.__wrapped__,t.__chain__);return e.__actions__=u(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}Ie.prototype=i(Ae.prototype),Ie.prototype.constructor=Ie;var Be=Object.prototype.hasOwnProperty;function He(t){if(c(t)&&!d(t)&&!(t instanceof Pe)){if(t instanceof Ie)return t;if(Be.call(t,"__wrapped__"))return je(t)}return new Ie(t)}function ze(t){var e=Le(t),n=He[e];if("function"!=typeof n||!(e in Pe.prototype))return!1;if(t===n)return!0;var o=De(n);return!!o&&t===o[0]}He.prototype=Ae.prototype,He.prototype.constructor=He;var Fe=p(Se),We=/\{\n\/\* \[wrapped with (.+)\] \*/,Xe=/,? & /;var Ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var Ge=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function Ye(t,e,n){var o=e+"";return g(t,function(t,e){var n=e.length;if(!n)return t;var o=n-1;return e[o]=(n>1?"& ":"")+e[o],e=e.join(n>2?", ":" "),t.replace(Ue,"{\n/* [wrapped with "+e+"] */\n")}(o,function(t,e){return h(Ge,function(n){var o="_."+n[0];e&n[1]&&!f(t,o)&&t.push(o)}),t.sort()}(function(t){var e=t.match(We);return e?e[1].split(Xe):[]}(o),n)))}function Ve(t,e,n,o,r,i,a,s,l,u){var c=8&e;e|=c?32:64,4&(e&=~(c?64:32))||(e&=-4);var d=[t,e,r,c?i:void 0,c?a:void 0,c?void 0:i,c?void 0:a,s,l,u],p=n.apply(void 0,d);return ze(t)&&Fe(p,d),p.placeholder=o,Ye(p,t,e)}function Ke(t){return t.placeholder}var qe=Math.min;var Ze="__lodash_placeholder__";function $e(t,e){for(var n=-1,o=t.length,r=0,i=[];++n<o;){var a=t[n];a!==e&&a!==Ze||(t[n]=Ze,i[r++]=n)}return i}function Je(t,e,n,o,r,i,a,l,c,d){var p=128&e,h=1&e,f=2&e,g=24&e,v=512&e,m=f?void 0:Oe(t);return function b(){for(var _=arguments.length,x=Array(_),E=_;E--;)x[E]=arguments[E];if(g)var w=Ke(b),S=function(t,e){for(var n=t.length,o=0;n--;)t[n]===e&&++o;return o}(x,w);if(o&&(x=Te(x,o,r,g)),i&&(x=Ne(x,i,a,g)),_-=S,g&&_<d){var O=$e(x,w);return Ve(t,e,Je,b.placeholder,n,x,O,l,c,d-_)}var C=h?n:this,T=f?C[t]:t;return _=x.length,l?x=function(t,e){for(var n=t.length,o=qe(e.length,n),r=u(t);o--;){var i=e[o];t[o]=y(i,n)?r[i]:void 0}return t}(x,l):v&&_>1&&x.reverse(),p&&c<_&&(x.length=c),this&&this!==s&&this instanceof b&&(T=m||Oe(T)),T.apply(C,x)}}var Qe="__lodash_placeholder__",tn=128,en=Math.min;var nn=Math.max;function on(t,e,o,r,i,a,l,u){var c=2&e;if(!c&&"function"!=typeof t)throw new TypeError("Expected a function");var d=r?r.length:0;if(d||(e&=-97,r=i=void 0),l=void 0===l?l:nn(n(l),0),u=void 0===u?u:n(u),d-=i?i.length:0,64&e){var p=r,h=i;r=i=void 0}var f=c?void 0:De(t),g=[t,e,o,r,i,p,h,a,l,u];if(f&&function(t,e){var n=t[1],o=e[1],r=n|o,i=r<131,a=o==tn&&8==n||o==tn&&256==n&&t[7].length<=e[8]||384==o&&e[7].length<=e[8]&&8==n;if(!i&&!a)return t;1&o&&(t[2]=e[2],r|=1&n?0:4);var s=e[3];if(s){var l=t[3];t[3]=l?Te(l,s,e[4]):s,t[4]=l?$e(t[3],Qe):e[4]}(s=e[5])&&(l=t[5],t[5]=l?Ne(l,s,e[6]):s,t[6]=l?$e(t[5],Qe):e[6]),(s=e[7])&&(t[7]=s),o&tn&&(t[8]=null==t[8]?e[8]:en(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r}(g,f),t=g[0],e=g[1],o=g[2],r=g[3],i=g[4],!(u=g[9]=void 0===g[9]?c?0:t.length:nn(g[9]-d,0))&&24&e&&(e&=-25),e&&1!=e)y=8==e||16==e?function(t,e,n){var o=Oe(t);return function r(){for(var i=arguments.length,a=Array(i),l=i,u=Ke(r);l--;)a[l]=arguments[l];var c=i<3&&a[0]!==u&&a[i-1]!==u?[]:$e(a,u);return(i-=c.length)<n?Ve(t,e,Je,r.placeholder,void 0,a,c,void 0,void 0,n-i):v(this&&this!==s&&this instanceof r?o:t,this,a)}}(t,e,u):32!=e&&33!=e||i.length?Je.apply(void 0,g):function(t,e,n,o){var r=1&e,i=Oe(t);return function e(){for(var a=-1,l=arguments.length,u=-1,c=o.length,d=Array(c+l),p=this&&this!==s&&this instanceof e?i:t;++u<c;)d[u]=o[u];for(;l--;)d[u++]=arguments[++a];return v(p,r?n:this,d)}}(t,e,o,r);else var y=function(t,e,n){var o=1&e,r=Oe(t);return function e(){return(this&&this!==s&&this instanceof e?r:t).apply(o?n:this,arguments)}}(t,e,o);return Ye((f?Se:Fe)(y,g),t,e)}function rn(t,e,n){return e=n?void 0:e,on(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}var an=Object.prototype.hasOwnProperty,sn=m(function(t,e){if(b(e)||_(e))x(e,E(e),t);else for(var n in e)an.call(e,n)&&w(t,n,e[n])}),ln=m(function(t,e){x(e,S(e),t)}),un=m(function(t,e,n,o){x(e,S(e),t,o)}),cn=m(function(t,e,n,o){x(e,E(e),t,o)});function dn(t,e){for(var n=-1,o=e.length,r=Array(o),i=null==t;++n<o;)r[n]=i?void 0:O(t,e[n]);return r}var pn=C(dn);function hn(t){if(!c(t))return!1;var e=T(t);return"[object Error]"==e||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!M(t)}var fn=N(function(t,e){try{return v(t,void 0,e)}catch(n){return hn(n)?n:new Error(n)}});function gn(t,e){var o;if("function"!=typeof e)throw new TypeError("Expected a function");return t=n(t),function(){return--t>0&&(o=e.apply(this,arguments)),t<=1&&(e=void 0),o}}var yn=N(function(t,e,n){var o=1;if(n.length){var r=$e(n,Ke(yn));o|=32}return on(t,o,e,n,r)});yn.placeholder={};var vn=C(function(t,e){return h(e,function(e){e=A(e),P(t,e,yn(t[e],t))}),t}),mn=N(function(t,e,n){var o=3;if(n.length){var r=$e(n,Ke(mn));o|=32}return on(e,o,t,n,r)});function bn(t,e,n){var o=t.length;return n=void 0===n?o:n,!e&&n>=o?t:D(t,e,n)}mn.placeholder={};var _n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function xn(t){return _n.test(t)}var En="\\ud800-\\udfff",wn="["+En+"]",Sn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",On="\\ud83c[\\udffb-\\udfff]",Cn="[^"+En+"]",Tn="(?:\\ud83c[\\udde6-\\uddff]){2}",Mn="[\\ud800-\\udbff][\\udc00-\\udfff]",Nn="(?:"+Sn+"|"+On+")"+"?",An="[\\ufe0e\\ufe0f]?",Pn=An+Nn+("(?:\\u200d(?:"+[Cn,Tn,Mn].join("|")+")"+An+Nn+")*"),Dn="(?:"+[Cn+Sn+"?",Sn,Tn,Mn,wn].join("|")+")",kn=RegExp(On+"(?="+On+")|"+Dn+Pn,"g");function Rn(t){return xn(t)?function(t){return t.match(kn)||[]}(t):function(t){return t.split("")}(t)}function Ln(t){return function(e){var n=xn(e=k(e))?Rn(e):void 0,o=n?n[0]:e.charAt(0),r=n?bn(n,1).join(""):e.slice(1);return o[t]()+r}}var In=Ln("toUpperCase");function jn(t){return In(k(t).toLowerCase())}function Bn(t,e,n,o){var r=-1,i=null==t?0:t.length;for(o&&i&&(n=t[++r]);++r<i;)n=e(n,t[r],r,t);return n}function Hn(t){return function(e){return null==t?void 0:t[e]}}var zn=Hn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Fn=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wn=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function Xn(t){return(t=k(t))&&t.replace(Fn,zn).replace(Wn,"")}var Un=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var Gn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Yn="\\ud800-\\udfff",Vn="\\u2700-\\u27bf",Kn="a-z\\xdf-\\xf6\\xf8-\\xff",qn="A-Z\\xc0-\\xd6\\xd8-\\xde",Zn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",$n="["+Zn+"]",Jn="\\d+",Qn="["+Vn+"]",to="["+Kn+"]",eo="[^"+Yn+Zn+Jn+Vn+Kn+qn+"]",no="(?:\\ud83c[\\udde6-\\uddff]){2}",oo="[\\ud800-\\udbff][\\udc00-\\udfff]",ro="["+qn+"]",io="(?:"+to+"|"+eo+")",ao="(?:"+ro+"|"+eo+")",so="(?:['’](?:d|ll|m|re|s|t|ve))?",lo="(?:['’](?:D|LL|M|RE|S|T|VE))?",uo="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",co="[\\ufe0e\\ufe0f]?",po=co+uo+("(?:\\u200d(?:"+["[^"+Yn+"]",no,oo].join("|")+")"+co+uo+")*"),ho="(?:"+[Qn,no,oo].join("|")+")"+po,fo=RegExp([ro+"?"+to+"+"+so+"(?="+[$n,ro,"$"].join("|")+")",ao+"+"+lo+"(?="+[$n,ro+io,"$"].join("|")+")",ro+"?"+io+"+"+so,ro+"+"+lo,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Jn,ho].join("|"),"g");function go(t,e,n){return t=k(t),void 0===(e=n?void 0:e)?function(t){return Gn.test(t)}(t)?function(t){return t.match(fo)||[]}(t):function(t){return t.match(Un)||[]}(t):t.match(e)||[]}var yo=RegExp("['’]","g");function vo(t){return function(e){return Bn(go(Xn(e).replace(yo,"")),t,"")}}var mo=vo(function(t,e,n){return e=e.toLowerCase(),t+(n?jn(e):e)}),bo=s.isFinite,_o=Math.min;function xo(t){var e=Math[t];return function(t,o){if(t=R(t),(o=null==o?0:_o(n(o),292))&&bo(t)){var r=(k(t)+"e").split("e"),i=e(r[0]+"e"+(+r[1]+o));return+((r=(k(i)+"e").split("e"))[0]+"e"+(+r[1]-o))}return e(t)}}var Eo=xo("ceil");function wo(t){var e=He(t);return e.__chain__=!0,e}var So=Math.ceil,Oo=Math.max;function Co(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return j(d(n)?u(n):[n],B(e,1))}function To(t,e,n){var o=n.length;if(null==t)return!o;for(t=Object(t);o--;){var r=n[o],i=e[r],a=t[r];if(void 0===a&&!(r in t)||!i(a))return!1}return!0}function Mo(t,e,n,o){for(var r=-1,i=null==t?0:t.length;++r<i;){var a=t[r];e(o,a,n(a),t)}return o}function No(t,e,n,o){return F(t,function(t,r,i){e(o,t,n(t),i)}),o}function Ao(t,e){return function(n,o){var r=d(n)?Mo:No,i=e?e():{};return r(n,t,z(o),i)}}var Po=Object.prototype.hasOwnProperty,Do=Ao(function(t,e,n){Po.call(t,n)?++t[n]:P(t,n,1)});function ko(t,e,n){var o=on(t,8,void 0,void 0,void 0,void 0,void 0,e=n?void 0:e);return o.placeholder=ko.placeholder,o}ko.placeholder={};function Ro(t,e,n){var o=on(t,16,void 0,void 0,void 0,void 0,void 0,e=n?void 0:e);return o.placeholder=Ro.placeholder,o}Ro.placeholder={};var Lo=Object.prototype,Io=Lo.hasOwnProperty,jo=N(function(t,e){t=Object(t);var n=-1,o=e.length,r=o>2?e[2]:void 0;for(r&&L(e[0],e[1],r)&&(o=1);++n<o;)for(var i=e[n],a=S(i),s=-1,l=a.length;++s<l;){var u=a[s],c=t[u];(void 0===c||X(c,Lo[u])&&!Io.call(t,u))&&(t[u]=i[u])}return t});function Bo(t,e,n,o,r,i){return a(t)&&a(e)&&(i.set(e,t),U(t,e,void 0,Bo,i),i.delete(e)),t}var Ho=m(function(t,e,n,o){U(t,e,n,o)}),zo=N(function(t){return t.push(void 0,Bo),v(Ho,void 0,t)});function Fo(t,e,n){if("function"!=typeof t)throw new TypeError("Expected a function");return setTimeout(function(){t.apply(void 0,n)},e)}var Wo=N(function(t,e){return Fo(t,1,e)}),Xo=N(function(t,e,n){return Fo(t,R(e)||0,n)});function Uo(t,e,n,o){var r=-1,i=f,a=!0,s=t.length,l=[],u=e.length;if(!s)return l;n&&(e=H(e,G(n))),o?(i=V,a=!1):e.length>=200&&(i=K,a=!1,e=new Y(e));t:for(;++r<s;){var c=t[r],d=null==n?c:n(c);if(c=o||0!==c?c:0,a&&d==d){for(var p=u;p--;)if(e[p]===d)continue t;l.push(c)}else i(e,d,o)||l.push(c)}return l}var Go=N(function(t,e){return q(t)?Uo(t,B(e,1,q,!0)):[]}),Yo=N(function(t,e){var n=Z(e);return q(n)&&(n=void 0),q(t)?Uo(t,B(e,1,q,!0),z(n)):[]}),Vo=N(function(t,e){var n=Z(e);return q(n)&&(n=void 0),q(t)?Uo(t,B(e,1,q,!0),void 0,n):[]}),Ko=xe(function(t,e){return t/e},1);function qo(t,e,n,o){for(var r=t.length,i=o?r:-1;(o?i--:++i<r)&&e(t[i],i,t););return n?D(t,o?0:i,o?i+1:r):D(t,o?i+1:0,o?r:i)}function Zo(t){return"function"==typeof t?t:r}function $o(t,e){return(d(t)?h:F)(t,Zo(e))}function Jo(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}var Qo=$(!0);function tr(t,e){return t&&Qo(t,e,E)}var er=J(tr,!0);function nr(t){return function(e){var n,o,r,i=tt(e);return"[object Map]"==i?et(e):"[object Set]"==i?(n=e,o=-1,r=Array(n.size),n.forEach(function(t){r[++o]=[t,t]}),r):function(t,e){return H(e,function(e){return[e,t[e]]})}(e,t(e))}}var or=nr(E),rr=nr(S),ir=Hn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),ar=/[&<>"']/g,sr=RegExp(ar.source);function lr(t){return(t=k(t))&&sr.test(t)?t.replace(ar,ir):t}var ur=/[\\^$.*+?()[\]{}|]/g,cr=RegExp(ur.source);function dr(t,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(!e(t[n],n,t))return!1;return!0}function pr(t,e){var n=!0;return F(t,function(t,o,r){return n=!!e(t,o,r)}),n}function hr(t){return t?Q(n(t),0,4294967295):0}function fr(t,e){var n=[];return F(t,function(t,o,r){e(t,o,r)&&n.push(t)}),n}function gr(t){return function(e,n,o){var r=Object(e);if(!_(e)){var i=z(n);e=E(e),n=function(t){return i(r[t],t,r)}}var a=t(e,n,o);return a>-1?r[i?e[a]:a]:void 0}}var yr=Math.max;function vr(t,e,o){var r=null==t?0:t.length;if(!r)return-1;var i=null==o?0:n(o);return i<0&&(i=yr(r+i,0)),ot(t,z(e),i)}var mr=gr(vr);function br(t,e,n){var o;return n(t,function(t,n,r){if(e(t,n,r))return o=n,!1}),o}var _r=gr(it);var xr=1/0;var Er=xo("floor");function wr(t){return C(function(e){var n=e.length,o=n,r=Ie.prototype.thru;for(t&&e.reverse();o--;){var i=e[o];if("function"!=typeof i)throw new TypeError("Expected a function");if(r&&!a&&"wrapper"==Le(i))var a=new Ie([],!0)}for(o=a?o:n;++o<n;){var s=Le(i=e[o]),l="wrapper"==s?De(i):void 0;a=l&&ze(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?a[Le(l[0])].apply(a,l[3]):1==i.length&&ze(i)?a[s]():a.thru(i)}return function(){var t=arguments,o=t[0];if(a&&1==t.length&&d(o))return a.plant(o).value();for(var r=0,i=n?e[r].apply(this,t):o;++r<n;)i=e[r].call(this,i);return i}})}var Sr=wr(),Or=wr(!0);function Cr(t,e){return nt(e,function(e){return lt(t[e])})}var Tr=Object.prototype.hasOwnProperty,Mr=Ao(function(t,e,n){Tr.call(t,n)?t[n].push(e):P(t,n,[e])});function Nr(t,e){return t>e}function Ar(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=R(e),n=R(n)),t(e,n)}}var Pr=Ar(Nr),Dr=Ar(function(t,e){return t>=e}),kr=Math.max,Rr=Math.min;function Lr(t){return"string"==typeof t||!d(t)&&c(t)&&"[object String]"==T(t)}function Ir(t,e){return H(e,function(e){return t[e]})}function jr(t){return null==t?[]:Ir(t,E(t))}var Br=Math.max;var Hr=Math.max;function zr(t,e,o){var r=null==t?0:t.length;if(!r)return-1;var i=null==o?0:n(o);return i<0&&(i=Hr(r+i,0)),ct(t,e,i)}var Fr=Math.min;function Wr(t,e,n){for(var o=n?V:f,r=t[0].length,i=t.length,a=i,s=Array(i),l=1/0,u=[];a--;){var c=t[a];a&&e&&(c=H(c,G(e))),l=Fr(c.length,l),s[a]=!n&&(e||r>=120&&c.length>=120)?new Y(a&&c):void 0}c=t[0];var d=-1,p=s[0];t:for(;++d<r&&u.length<l;){var h=c[d],g=e?e(h):h;if(h=n||0!==h?h:0,!(p?K(p,g):o(u,g,n))){for(a=i;--a;){var y=s[a];if(!(y?K(y,g):o(t[a],g,n)))continue t}p&&p.push(g),u.push(h)}}return u}function Xr(t){return q(t)?t:[]}var Ur=N(function(t){var e=H(t,Xr);return e.length&&e[0]===t[0]?Wr(e):[]}),Gr=N(function(t){var e=Z(t),n=H(t,Xr);return e===Z(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?Wr(n,z(e)):[]}),Yr=N(function(t){var e=Z(t),n=H(t,Xr);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?Wr(n,void 0,e):[]});function Vr(t,e){return function(n,o){return function(t,e,n,o){return rt(t,function(t,r,i){e(o,n(t),r,i)}),o}(n,t,e(o),{})}}var Kr=Object.prototype.toString,qr=Vr(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Kr.call(e)),t[e]=n},dt(r)),Zr=Object.prototype,$r=Zr.hasOwnProperty,Jr=Zr.toString,Qr=Vr(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Jr.call(e)),$r.call(t,e)?t[e].push(n):t[e]=[n]},z);function ti(t,e,n){e=pt(e,t);var o=null==(t=ht(t,e))?t:t[A(Z(e))];return null==o?void 0:v(o,t,n)}var ei=N(ti),ni=N(function(t,e,n){var o=-1,r="function"==typeof e,i=_(t)?Array(t.length):[];return F(t,function(t){i[++o]=r?v(e,t,n):ti(t,e,n)}),i});var oi=ft&&ft.isArrayBuffer,ri=oi?G(oi):function(t){return c(t)&&"[object ArrayBuffer]"==T(t)};function ii(t){return!0===t||!1===t||c(t)&&"[object Boolean]"==T(t)}var ai=ft&&ft.isDate,si=ai?G(ai):function(t){return c(t)&&"[object Date]"==T(t)};var li=Object.prototype.hasOwnProperty;function ui(t){if(null==t)return!0;if(_(t)&&(d(t)||"string"==typeof t||"function"==typeof t.splice||gt(t)||yt(t)||vt(t)))return!t.length;var e=tt(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(b(t))return!mt(t).length;for(var n in t)if(li.call(t,n))return!1;return!0}var ci=s.isFinite;function di(t){return"number"==typeof t&&t==n(t)}function pi(t){return"number"==typeof t||c(t)&&"[object Number]"==T(t)}var hi=Et?lt:wt;var fi=ft&&ft.isRegExp,gi=fi?G(fi):function(t){return c(t)&&"[object RegExp]"==T(t)},yi=9007199254740991;var vi=Array.prototype.join;var mi=vo(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),bi=Ao(function(t,e,n){P(t,n,e)});var _i=Math.max,xi=Math.min;var Ei=vo(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),wi=Ln("toLowerCase");function Si(t,e){return t<e}var Oi=Ar(Si),Ci=Ar(function(t,e){return t<=e});function Ti(t,e){var n={};return e=z(e),rt(t,function(t,o,r){P(n,e(t,o,r),t)}),n}function Mi(e,n,o){for(var r=-1,i=e.length;++r<i;){var a=e[r],s=n(a);if(null!=s&&(void 0===l?s==s&&!t(s):o(s,l)))var l=s,u=a}return u}function Ni(t,e){for(var n,o=-1,r=t.length;++o<r;){var i=e(t[o]);void 0!==i&&(n=void 0===n?i:n+i)}return n}function Ai(t,e){var n=null==t?0:t.length;return n?Ni(t,e)/n:NaN}var Pi=N(function(t,e){return function(n){return ti(n,t,e)}}),Di=N(function(t,e){return function(n){return ti(t,n,e)}});function ki(t,e,n){var o=E(e),r=Cr(e,o),i=!(a(n)&&"chain"in n&&!n.chain),s=lt(t);return h(r,function(n){var o=e[n];t[n]=o,s&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__);return(n.__actions__=u(this.__actions__)).push({func:o,args:arguments,thisArg:t}),n.__chain__=e,n}return o.apply(t,j([this.value()],arguments))})}),t}var Ri=xe(function(t,e){return t*e},1);function Li(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}var Ii=Mt?Mt.iterator:void 0;function ji(t){if(!t)return[];if(_(t))return Lr(t)?Rn(t):u(t);if(Ii&&t[Ii])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Ii]());var e=tt(t);return("[object Map]"==e?et:"[object Set]"==e?Nt:jr)(t)}function Bi(t,e){var n=t.length;if(n)return y(e+=e<0?n:0,n)?t[e]:void 0}function Hi(t,e){if(null==t)return{};var n=H(At(t),function(t){return[t]});return e=z(e),Pt(t,n,function(t,n){return e(t,n[0])})}function zi(e,n){if(e!==n){var o=void 0!==e,r=null===e,i=e==e,a=t(e),s=void 0!==n,l=null===n,u=n==n,c=t(n);if(!l&&!c&&!a&&e>n||a&&s&&u&&!l&&!c||r&&s&&u||!o&&u||!i)return 1;if(!r&&!a&&!c&&e<n||c&&o&&i&&!r&&!a||l&&o&&i||!s&&i||!u)return-1}return 0}function Fi(t,e,n){e=e.length?H(e,function(t){return d(t)?function(e){return Dt(e,1===t.length?t[0]:t)}:t}):[r];var o=-1;return e=H(e,G(z)),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(kt(t,function(t,n,r){return{criteria:H(e,function(e){return e(t)}),index:++o,value:t}}),function(t,e){return function(t,e,n){for(var o=-1,r=t.criteria,i=e.criteria,a=r.length,s=n.length;++o<a;){var l=zi(r[o],i[o]);if(l)return o>=s?l:l*("desc"==n[o]?-1:1)}return t.index-e.index}(t,e,n)})}function Wi(t){return C(function(e){return e=H(e,G(z)),N(function(n){var o=this;return t(e,function(t){return v(t,o,n)})})})}var Xi=Wi(H),Ui=N,Gi=Math.min,Yi=Ui(function(t,e){var n=(e=1==e.length&&d(e[0])?H(e[0],G(z)):H(B(e,1),G(z))).length;return N(function(o){for(var r=-1,i=Gi(o.length,n);++r<i;)o[r]=e[r].call(this,o[r]);return v(t,this,o)})}),Vi=Wi(dr),Ki=Wi(Rt),qi=Math.floor;function Zi(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=qi(e/2))&&(t+=t)}while(e);return n}var $i=Lt("length"),Ji="\\ud800-\\udfff",Qi="["+Ji+"]",ta="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ea="\\ud83c[\\udffb-\\udfff]",na="[^"+Ji+"]",oa="(?:\\ud83c[\\udde6-\\uddff]){2}",ra="[\\ud800-\\udbff][\\udc00-\\udfff]",ia="(?:"+ta+"|"+ea+")"+"?",aa="[\\ufe0e\\ufe0f]?",sa=aa+ia+("(?:\\u200d(?:"+[na,oa,ra].join("|")+")"+aa+ia+")*"),la="(?:"+[na+ta+"?",ta,oa,ra,Qi].join("|")+")",ua=RegExp(ea+"(?="+ea+")|"+la+sa,"g");function ca(t){return xn(t)?function(t){for(var e=ua.lastIndex=0;ua.test(t);)++e;return e}(t):$i(t)}var da=Math.ceil;function pa(t,n){var o=(n=void 0===n?" ":e(n)).length;if(o<2)return o?Zi(n,t):n;var r=Zi(n,da(t/ca(n)));return xn(n)?bn(Rn(r),0,t).join(""):r.slice(0,t)}var ha=Math.ceil,fa=Math.floor;var ga=/^\s+/,ya=s.parseInt;var va=N(function(t,e){return on(t,32,void 0,e,$e(e,Ke(va)))});va.placeholder={};var ma=N(function(t,e){return on(t,64,void 0,e,$e(e,Ke(ma)))});ma.placeholder={};var ba=Ao(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]});function _a(t,e,n,o){for(var r=n-1,i=t.length;++r<i;)if(o(t[r],e))return r;return-1}var xa=Array.prototype.splice;function Ea(t,e,n,o){var r=o?_a:ct,i=-1,a=e.length,s=t;for(t===e&&(e=u(e)),n&&(s=H(t,G(n)));++i<a;)for(var l=0,c=e[i],d=n?n(c):c;(l=r(s,d,l,o))>-1;)s!==t&&xa.call(s,l,1),xa.call(t,l,1);return t}function wa(t,e){return t&&t.length&&e&&e.length?Ea(t,e):t}var Sa=N(wa);var Oa=Array.prototype.splice;function Ca(t,e){for(var n=t?e.length:0,o=n-1;n--;){var r=e[n];if(n==o||r!==i){var i=r;y(r)?Oa.call(t,r,1):It(t,r)}}return t}var Ta=C(function(t,e){var n=null==t?0:t.length,o=dn(t,e);return Ca(t,H(e,function(t){return y(t,n)?+t:t}).sort(zi)),o}),Ma=Math.floor,Na=Math.random;function Aa(t,e){return t+Ma(Na()*(e-t+1))}var Pa=parseFloat,Da=Math.min,ka=Math.random;var Ra=Math.ceil,La=Math.max;function Ia(t){return function(e,n,o){return o&&"number"!=typeof o&&L(e,n,o)&&(n=o=void 0),e=ut(e),void 0===n?(n=e,e=0):n=ut(n),function(t,e,n,o){for(var r=-1,i=La(Ra((e-t)/(n||1)),0),a=Array(i);i--;)a[o?i:++r]=t,t+=n;return a}(e,n,o=void 0===o?e<n?1:-1:ut(o),t)}}var ja=Ia(),Ba=Ia(!0),Ha=C(function(t,e){return on(t,256,void 0,void 0,void 0,e)});function za(t,e,n,o,r){return r(t,function(t,r,i){n=o?(o=!1,t):e(n,t,r,i)}),n}function Fa(t,e,n){var o=d(t)?Bn:za,r=arguments.length<3;return o(t,z(e),n,r,F)}function Wa(t,e,n,o){var r=null==t?0:t.length;for(o&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}var Xa=Array.prototype.reverse;function Ua(t){return null==t?t:Xa.call(t)}var Ga=xo("round");function Ya(t){var e=t.length;return e?t[Aa(0,e-1)]:void 0}function Va(t){return Ya(jr(t))}function Ka(t,e){var n=-1,o=t.length,r=o-1;for(e=void 0===e?o:e;++n<e;){var i=Aa(n,r),a=t[i];t[i]=t[n],t[n]=a}return t.length=e,t}function qa(t,e){return Ka(u(t),Q(e,0,t.length))}function Za(t,e){var n=jr(t);return Ka(n,Q(e,0,n.length))}function $a(t){return Ka(u(t))}function Ja(t){return Ka(jr(t))}var Qa=vo(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()});function ts(t,e){var n;return F(t,function(t,o,r){return!(n=e(t,o,r))}),!!n}var es=N(function(t,e){if(null==t)return[];var n=e.length;return n>1&&L(t,e[0],e[1])?e=[]:n>2&&L(e[0],e[1],e[2])&&(e=[e[0]]),Fi(t,B(e,1),[])}),ns=Math.floor,os=Math.min;function rs(e,n,o,r){var i=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(n=o(n))!=n,l=null===n,u=t(n),c=void 0===n;i<a;){var d=ns((i+a)/2),p=o(e[d]),h=void 0!==p,f=null===p,g=p==p,y=t(p);if(s)var v=r||g;else v=c?g&&(r||h):l?g&&h&&(r||!f):u?g&&h&&!f&&(r||!y):!f&&!y&&(r?p<=n:p<n);v?i=d+1:a=d}return os(a,4294967294)}function is(e,n,o){var i=0,a=null==e?i:e.length;if("number"==typeof n&&n==n&&a<=2147483647){for(;i<a;){var s=i+a>>>1,l=e[s];null!==l&&!t(l)&&(o?l<=n:l<n)?i=s+1:a=s}return a}return rs(e,n,r,o)}function as(t,e){for(var n=-1,o=t.length,r=0,i=[];++n<o;){var a=t[n],s=e?e(a):a;if(!n||!X(s,l)){var l=s;i[r++]=0===a?0:a}}return i}var ss=Math.max;var ls=vo(function(t,e,n){return t+(n?" ":"")+In(e)});var us=xe(function(t,e){return t-e},0);var cs=Object.prototype,ds=cs.hasOwnProperty;function ps(t,e,n,o){return void 0===t||X(t,cs[n])&&!ds.call(o,n)?e:t}var hs={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function fs(t){return"\\"+hs[t]}var gs=/<%=([\s\S]+?)%>/g,ys={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:gs,variable:"",imports:{_:{escape:lr}}},vs=/\b__p \+= '';/g,ms=/\b(__p \+=) '' \+/g,bs=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_s=/[()=,{}\[\]\/\s]/,xs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Es=/($^)/,ws=/['\n\r\u2028\u2029\\]/g,Ss=Object.prototype.hasOwnProperty;function Os(t,e){return e(t)}var Cs=4294967295,Ts=Math.min;function Ms(t,e){var n=t;return n instanceof Pe&&(n=n.value()),Bn(e,function(t,e){return e.func.apply(e.thisArg,j([t],e.args))},n)}var Ns=9007199254740991;function As(t,e){for(var n=t.length;n--&&ct(e,t[n],0)>-1;);return n}function Ps(t,e){for(var n=-1,o=t.length;++n<o&&ct(e,t[n],0)>-1;);return n}var Ds=/^\s+/;var ks=/\w*$/;var Rs=Hn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Ls=/&(?:amp|lt|gt|quot|#39);/g,Is=RegExp(Ls.source);var js=N(function(t){var e=Z(t);return q(e)&&(e=void 0),Xt(B(t,1,q,!0),z(e))}),Bs=N(function(t){var e=Z(t);return e="function"==typeof e?e:void 0,Xt(B(t,1,q,!0),void 0,e)});function Hs(t,e){return t&&t.length?Xt(t,z(e)):[]}var zs=0;var Fs=Math.max;function Ws(t){if(!t||!t.length)return[];var e=0;return t=nt(t,function(t){if(q(t))return e=Fs(t.length,e),!0}),Bt(e,function(e){return H(t,Lt(e))})}function Xs(t,e){if(!t||!t.length)return[];var n=Ws(t);return null==e?n:H(n,function(t){return v(e,void 0,t)})}function Us(t,e,n,o){return jt(t,e,n(Dt(t,e)),o)}var Gs=vo(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()});var Ys=N(function(t,e){return q(t)?Uo(t,e):[]});var Vs=C(function(t){var e=t.length,n=e?t[0]:0,o=this.__wrapped__,r=function(e){return dn(e,t)};return!(e>1||this.__actions__.length)&&o instanceof Pe&&y(n)?((o=o.slice(n,+n+(e?1:0))).__actions__.push({func:Os,args:[r],thisArg:void 0}),new Ie(o,this.__chain__).thru(function(t){return e&&!t.length&&t.push(void 0),t})):this.thru(r)});function Ks(t,e,n){var o=t.length;if(o<2)return o?Xt(t[0]):[];for(var r=-1,i=Array(o);++r<o;)for(var a=t[r],s=-1;++s<o;)s!=r&&(i[r]=Uo(i[r]||a,t[s],e,n));return Xt(B(i,1),e,n)}var qs=N(function(t){return Ks(nt(t,q))}),Zs=N(function(t){var e=Z(t);return q(e)&&(e=void 0),Ks(nt(t,q),z(e))}),$s=N(function(t){var e=Z(t);return e="function"==typeof e?e:void 0,Ks(nt(t,q),void 0,e)}),Js=N(Ws);function Qs(t,e,n){for(var o=-1,r=t.length,i=e.length,a={};++o<r;){var s=o<i?e[o]:void 0;n(a,t[o],s)}return a}var tl=N(function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,Xs(t,n)});const el={chunk:function(t,e,o){e=(o?L(t,e,o):void 0===e)?1:Oo(n(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,a=0,s=Array(So(r/e));i<r;)s[a++]=D(t,i,i+=e);return s},compact:function(t){for(var e=-1,n=null==t?0:t.length,o=0,r=[];++e<n;){var i=t[e];i&&(r[o++]=i)}return r},concat:Co,difference:Go,differenceBy:Yo,differenceWith:Vo,drop:function(t,e,o){var r=null==t?0:t.length;return r?(e=o||void 0===e?1:n(e),D(t,e<0?0:e,r)):[]},dropRight:function(t,e,o){var r=null==t?0:t.length;return r?(e=o||void 0===e?1:n(e),D(t,0,(e=r-e)<0?0:e)):[]},dropRightWhile:function(t,e){return t&&t.length?qo(t,z(e),!0,!0):[]},dropWhile:function(t,e){return t&&t.length?qo(t,z(e),!0):[]},fill:function(t,e,o,r){var i=null==t?0:t.length;return i?(o&&"number"!=typeof o&&L(t,e,o)&&(o=0,r=i),function(t,e,o,r){var i=t.length;for((o=n(o))<0&&(o=-o>i?0:i+o),(r=void 0===r||r>i?i:n(r))<0&&(r+=i),r=o>r?0:hr(r);o<r;)t[o++]=e;return t}(t,e,o,r)):[]},findIndex:vr,findLastIndex:it,flatten:Ut,flattenDeep:Gt,flattenDepth:function(t,e){return(null==t?0:t.length)?(e=void 0===e?1:n(e),B(t,e)):[]},fromPairs:Yt,head:function(t){return t&&t.length?t[0]:void 0},indexOf:zr,initial:function(t){return(null==t?0:t.length)?D(t,0,-1):[]},intersection:Ur,intersectionBy:Gr,intersectionWith:Yr,join:function(t,e){return null==t?"":vi.call(t,e)},lastIndexOf:function(t,e,o){var r=null==t?0:t.length;if(!r)return-1;var i=r;return void 0!==o&&(i=(i=n(o))<0?_i(r+i,0):xi(i,r-1)),e==e?function(t,e,n){for(var o=n+1;o--;)if(t[o]===e)return o;return o}(t,e,i):ot(t,Ot,i,!0)},nth:function(t,e){return t&&t.length?Bi(t,n(e)):void 0},pull:Sa,pullAll:wa,pullAllBy:function(t,e,n){return t&&t.length&&e&&e.length?Ea(t,e,z(n)):t},pullAllWith:function(t,e,n){return t&&t.length&&e&&e.length?Ea(t,e,void 0,n):t},pullAt:Ta,remove:function(t,e){var n=[];if(!t||!t.length)return n;var o=-1,r=[],i=t.length;for(e=z(e);++o<i;){var a=t[o];e(a,o,t)&&(n.push(a),r.push(o))}return Ca(t,r),n},reverse:Ua,slice:function(t,e,o){var r=null==t?0:t.length;return r?(o&&"number"!=typeof o&&L(t,e,o)?(e=0,o=r):(e=null==e?0:n(e),o=void 0===o?r:n(o)),D(t,e,o)):[]},sortedIndex:function(t,e){return is(t,e)},sortedIndexBy:function(t,e,n){return rs(t,e,z(n))},sortedIndexOf:function(t,e){var n=null==t?0:t.length;if(n){var o=is(t,e);if(o<n&&X(t[o],e))return o}return-1},sortedLastIndex:function(t,e){return is(t,e,!0)},sortedLastIndexBy:function(t,e,n){return rs(t,e,z(n),!0)},sortedLastIndexOf:function(t,e){if(null==t?0:t.length){var n=is(t,e,!0)-1;if(X(t[n],e))return n}return-1},sortedUniq:function(t){return t&&t.length?as(t):[]},sortedUniqBy:function(t,e){return t&&t.length?as(t,z(e)):[]},tail:function(t){var e=null==t?0:t.length;return e?D(t,1,e):[]},take:function(t,e,o){return t&&t.length?(e=o||void 0===e?1:n(e),D(t,0,e<0?0:e)):[]},takeRight:function(t,e,o){var r=null==t?0:t.length;return r?(e=o||void 0===e?1:n(e),D(t,(e=r-e)<0?0:e,r)):[]},takeRightWhile:function(t,e){return t&&t.length?qo(t,z(e),!1,!0):[]},takeWhile:function(t,e){return t&&t.length?qo(t,z(e)):[]},union:Vt,unionBy:js,unionWith:Bs,uniq:function(t){return t&&t.length?Xt(t):[]},uniqBy:Hs,uniqWith:function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Xt(t,void 0,e):[]},unzip:Ws,unzipWith:Xs,without:Ys,xor:qs,xorBy:Zs,xorWith:$s,zip:Js,zipObject:function(t,e){return Qs(t||[],e||[],w)},zipObjectDeep:function(t,e){return Qs(t||[],e||[],jt)},zipWith:tl},nl={countBy:Do,every:function(t,e,n){var o=d(t)?dr:pr;return n&&L(t,e,n)&&(e=void 0),o(t,z(e))},filter:function(t,e){return(d(t)?nt:fr)(t,z(e))},find:mr,findLast:_r,flatMap:Kt,flatMapDeep:function(t,e){return B(at(t,e),xr)},flatMapDepth:function(t,e,o){return o=void 0===o?1:n(o),B(at(t,e),o)},forEach:$o,forEachRight:function(t,e){return(d(t)?Jo:er)(t,Zo(e))},groupBy:Mr,includes:function(t,e,o,r){t=_(t)?t:jr(t),o=o&&!r?n(o):0;var i=t.length;return o<0&&(o=Br(i+o,0)),Lr(t)?o<=i&&t.indexOf(e,o)>-1:!!i&&ct(t,e,o)>-1},invokeMap:ni,keyBy:bi,map:at,orderBy:function(t,e,n,o){return null==t?[]:(d(e)||(e=null==e?[]:[e]),d(n=o?void 0:n)||(n=null==n?[]:[n]),Fi(t,e,n))},partition:ba,reduce:Fa,reduceRight:function(t,e,n){var o=d(t)?Wa:za,r=arguments.length<3;return o(t,z(e),n,r,er)},reject:function(t,e){return(d(t)?nt:fr)(t,Li(z(e)))},sample:function(t){return(d(t)?Ya:Va)(t)},sampleSize:function(t,e,o){return e=(o?L(t,e,o):void 0===e)?1:n(e),(d(t)?qa:Za)(t,e)},shuffle:function(t){return(d(t)?$a:Ja)(t)},size:function(t){if(null==t)return 0;if(_(t))return Lr(t)?ca(t):t.length;var e=tt(t);return"[object Map]"==e||"[object Set]"==e?t.size:mt(t).length},some:function(t,e,n){var o=d(t)?Rt:ts;return n&&L(t,e,n)&&(e=void 0),o(t,z(e))},sortBy:es},ol={now:qt},rl={after:function(t,e){if("function"!=typeof e)throw new TypeError("Expected a function");return t=n(t),function(){if(--t<1)return e.apply(this,arguments)}},ary:rn,before:gn,bind:yn,bindKey:mn,curry:ko,curryRight:Ro,debounce:Zt,defer:Wo,delay:Xo,flip:function(t){return on(t,512)},memoize:$t,once:function(t){return gn(2,t)},overArgs:Yi,partial:va,partialRight:ma,rearg:Ha,rest:function(t,e){if("function"!=typeof t)throw new TypeError("Expected a function");return e=void 0===e?e:n(e),N(t,e)},spread:function(t,e){if("function"!=typeof t)throw new TypeError("Expected a function");return e=null==e?0:ss(n(e),0),N(function(n){var o=n[e],r=bn(n,0,e);return o&&j(r,o),v(t,this,r)})},throttle:Jt,unary:function(t){return rn(t,1)},wrap:function(t,e){return va(Zo(e),t)}},il={castArray:Qt,clone:ee,cloneDeep:ne,cloneDeepWith:function(t,e){return I(t,5,e="function"==typeof e?e:void 0)},cloneWith:function(t,e){return I(t,4,e="function"==typeof e?e:void 0)},conformsTo:function(t,e){return null==e||To(t,e,E(e))},eq:X,gt:Pr,gte:Dr,isArguments:vt,isArrayBuffer:ri,isArrayLike:_,isArrayLikeObject:q,isBoolean:ii,isBuffer:gt,isDate:si,isElement:function(t){return c(t)&&1===t.nodeType&&!M(t)},isEmpty:ui,isEqual:oe,isEqualWith:function(t,e,n){var o=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===o?bt(t,e,void 0,n):!!o},isError:hn,isFinite:function(t){return"number"==typeof t&&ci(t)},isFunction:lt,isInteger:di,isLength:re,isMap:ie,isMatch:function(t,e){return t===e||_t(t,e,xt(e))},isMatchWith:function(t,e,n){return n="function"==typeof n?n:void 0,_t(t,e,xt(e),n)},isNaN:function(t){return pi(t)&&t!=+t},isNative:function(t){if(hi(t))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return St(t)},isNil:ae,isNull:se,isNumber:pi,isObjectLike:c,isPlainObject:M,isRegExp:gi,isSafeInteger:function(t){return di(t)&&t>=-9007199254740991&&t<=yi},isSet:le,isString:Lr,isSymbol:t,isTypedArray:yt,isUndefined:ue,isWeakMap:function(t){return c(t)&&"[object WeakMap]"==tt(t)},isWeakSet:function(t){return c(t)&&"[object WeakSet]"==T(t)},lt:Oi,lte:Ci,toArray:ji,toFinite:ut,toLength:hr,toNumber:R,toPlainObject:te,toSafeInteger:function(t){return t?Q(n(t),-9007199254740991,Ns):0===t?t:0},toString:k},al={add:Ee,ceil:Eo,divide:Ko,floor:Er,max:function(t){return t&&t.length?Mi(t,r,Nr):void 0},maxBy:function(t,e){return t&&t.length?Mi(t,z(e),Nr):void 0},mean:function(t){return Ai(t,r)},meanBy:function(t,e){return Ai(t,z(e))},min:function(t){return t&&t.length?Mi(t,r,Si):void 0},minBy:function(t,e){return t&&t.length?Mi(t,z(e),Si):void 0},multiply:Ri,round:Ga,subtract:us,sum:function(t){return t&&t.length?Ni(t,r):0},sumBy:function(t,e){return t&&t.length?Ni(t,z(e)):0}},sl={clamp:ce,inRange:function(t,e,n){return e=ut(e),void 0===n?(n=e,e=0):n=ut(n),function(t,e,n){return t>=Rr(e,n)&&t<kr(e,n)}(t=R(t),e,n)},random:function(t,e,n){if(n&&"boolean"!=typeof n&&L(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=ut(t),void 0===e?(e=t,t=0):e=ut(e)),t>e){var o=t;t=e,e=o}if(n||t%1||e%1){var r=ka();return Da(t+r*(e-t+Pa("1e-"+((r+"").length-1))),e)}return Aa(t,e)}},ll={assign:sn,assignIn:ln,assignInWith:un,assignWith:cn,at:pn,create:function(t,e){var n=i(t);return null==e?n:W(n,e)},defaults:jo,defaultsDeep:zo,findKey:function(t,e){return br(t,z(e),rt)},findLastKey:function(t,e){return br(t,z(e),tr)},forIn:function(t,e){return null==t?t:st(t,Zo(e),S)},forInRight:function(t,e){return null==t?t:Qo(t,Zo(e),S)},forOwn:function(t,e){return t&&rt(t,Zo(e))},forOwnRight:function(t,e){return t&&tr(t,Zo(e))},functions:function(t){return null==t?[]:Cr(t,E(t))},functionsIn:function(t){return null==t?[]:Cr(t,S(t))},get:O,has:ge,hasIn:ye,invert:qr,invertBy:Qr,invoke:ei,keysIn:S,mapKeys:Ti,mapValues:function(t,e){var n={};return e=z(e),rt(t,function(t,o,r){P(n,o,e(t,o,r))}),n},merge:de,mergeWith:Ho,omit:pe,omitBy:function(t,e){return Hi(t,Li(z(e)))},pick:he,pickBy:Hi,result:function(t,e,n){var o=-1,r=(e=pt(e,t)).length;for(r||(r=1,t=void 0);++o<r;){var i=null==t?void 0:t[A(e[o])];void 0===i&&(o=r,i=n),t=lt(i)?i.call(t):i}return t},set:fe,setWith:function(t,e,n,o){return o="function"==typeof o?o:void 0,null==t?t:jt(t,e,n,o)},toPairs:or,toPairsIn:rr,transform:function(t,e,n){var o=d(t),r=o||gt(t)||yt(t);if(e=z(e),null==n){var s=t&&t.constructor;n=r?o?new s:[]:a(t)&&lt(s)?i(zt(t)):{}}return(r?h:rt)(t,function(t,o,r){return e(n,t,o,r)}),n},unset:function(t,e){return null==t||It(t,e)},update:function(t,e,n){return null==t?t:Us(t,e,Zo(n))},updateWith:function(t,e,n,o){return o="function"==typeof o?o:void 0,null==t?t:Us(t,e,Zo(n),o)},values:jr,valuesIn:function(t){return null==t?[]:Ir(t,S(t))}},ul={at:Vs,chain:wo,commit:function(){return new Ie(this.value(),this.__chain__)},next:function(){void 0===this.__values__&&(this.__values__=ji(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},plant:function(t){for(var e,n=this;n instanceof Ae;){var o=je(n);o.__index__=0,o.__values__=void 0,e?r.__wrapped__=o:e=o;var r=o;n=n.__wrapped__}return r.__wrapped__=t,e},reverse:function(){var t=this.__wrapped__;if(t instanceof Pe){var e=t;return this.__actions__.length&&(e=new Pe(this)),(e=e.reverse()).__actions__.push({func:Os,args:[Ua],thisArg:void 0}),new Ie(e,this.__chain__)}return this.thru(Ua)},tap:function(t,e){return e(t),t},toIterator:function(){return this},value:function(){return Ms(this.__wrapped__,this.__actions__)},wrapperChain:function(){return wo(this)}},cl={camelCase:mo,capitalize:jn,deburr:Xn,endsWith:function(t,o,r){t=k(t),o=e(o);var i=t.length,a=r=void 0===r?i:Q(n(r),0,i);return(r-=o.length)>=0&&t.slice(r,a)==o},escape:lr,escapeRegExp:function(t){return(t=k(t))&&cr.test(t)?t.replace(ur,"\\$&"):t},kebabCase:mi,lowerCase:Ei,lowerFirst:wi,pad:function(t,e,o){t=k(t);var r=(e=n(e))?ca(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return pa(fa(i),o)+t+pa(ha(i),o)},padEnd:function(t,e,o){t=k(t);var r=(e=n(e))?ca(t):0;return e&&r<e?t+pa(e-r,o):t},padStart:function(t,e,o){t=k(t);var r=(e=n(e))?ca(t):0;return e&&r<e?pa(e-r,o)+t:t},parseInt:function(t,e,n){return n||null==e?e=0:e&&(e=+e),ya(k(t).replace(ga,""),e||0)},repeat:function(t,e,o){return e=(o?L(t,e,o):void 0===e)?1:n(e),Zi(k(t),e)},replace:function(){var t=arguments,e=k(t[0]);return t.length<3?e:e.replace(t[1],t[2])},snakeCase:Qa,split:function(t,n,o){return o&&"number"!=typeof o&&L(t,n,o)&&(n=o=void 0),(o=void 0===o?4294967295:o>>>0)?(t=k(t))&&("string"==typeof n||null!=n&&!gi(n))&&!(n=e(n))&&xn(t)?bn(Rn(t),0,o):t.split(n,o):[]},startCase:ls,startsWith:function(t,o,r){return t=k(t),r=null==r?0:Q(n(r),0,t.length),o=e(o),t.slice(r,r+o.length)==o},template:function(t,e,n){var o=ys.imports._.templateSettings||ys;n&&L(t,e,n)&&(e=void 0),t=k(t),e=un({},e,o,ps);var r,i,a=un({},e.imports,o.imports,ps),s=E(a),l=Ir(a,s),u=0,c=e.interpolate||Es,d="__p += '",p=RegExp((e.escape||Es).source+"|"+c.source+"|"+(c===gs?xs:Es).source+"|"+(e.evaluate||Es).source+"|$","g"),h=Ss.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+"\n":"";t.replace(p,function(e,n,o,a,s,l){return o||(o=a),d+=t.slice(u,l).replace(ws,fs),n&&(r=!0,d+="' +\n__e("+n+") +\n'"),s&&(i=!0,d+="';\n"+s+";\n__p += '"),o&&(d+="' +\n((__t = ("+o+")) == null ? '' : __t) +\n'"),u=l+e.length,e}),d+="';\n";var f=Ss.call(e,"variable")&&e.variable;if(f){if(_s.test(f))throw new Error("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(i?d.replace(vs,""):d).replace(ms,"$1").replace(bs,"$1;"),d="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(i?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=fn(function(){return Function(s,h+"return "+d).apply(void 0,l)});if(g.source=d,hn(g))throw g;return g},templateSettings:ys,toLower:function(t){return k(t).toLowerCase()},toUpper:function(t){return k(t).toUpperCase()},trim:function(t,n,o){if((t=k(t))&&(o||void 0===n))return Ft(t);if(!t||!(n=e(n)))return t;var r=Rn(t),i=Rn(n);return bn(r,Ps(r,i),As(r,i)+1).join("")},trimEnd:function(t,n,o){if((t=k(t))&&(o||void 0===n))return t.slice(0,Wt(t)+1);if(!t||!(n=e(n)))return t;var r=Rn(t);return bn(r,0,As(r,Rn(n))+1).join("")},trimStart:function(t,n,o){if((t=k(t))&&(o||void 0===n))return t.replace(Ds,"");if(!t||!(n=e(n)))return t;var r=Rn(t);return bn(r,Ps(r,Rn(n))).join("")},truncate:function(t,o){var r=30,i="...";if(a(o)){var s="separator"in o?o.separator:s;r="length"in o?n(o.length):r,i="omission"in o?e(o.omission):i}var l=(t=k(t)).length;if(xn(t)){var u=Rn(t);l=u.length}if(r>=l)return t;var c=r-ca(i);if(c<1)return i;var d=u?bn(u,0,c).join(""):t.slice(0,c);if(void 0===s)return d+i;if(u&&(c+=d.length-c),gi(s)){if(t.slice(c).search(s)){var p,h=d;for(s.global||(s=RegExp(s.source,k(ks.exec(s))+"g")),s.lastIndex=0;p=s.exec(h);)var f=p.index;d=d.slice(0,void 0===f?c:f)}}else if(t.indexOf(e(s),c)!=c){var g=d.lastIndexOf(s);g>-1&&(d=d.slice(0,g))}return d+i},unescape:function(t){return(t=k(t))&&Is.test(t)?t.replace(Ls,Rs):t},upperCase:Gs,upperFirst:In,words:go},dl={attempt:fn,bindAll:vn,cond:function(t){var e=null==t?0:t.length,n=z;return t=e?H(t,function(t){if("function"!=typeof t[1])throw new TypeError("Expected a function");return[n(t[0]),t[1]]}):[],N(function(n){for(var o=-1;++o<e;){var r=t[o];if(v(r[0],this,n))return v(r[1],this,n)}})},conforms:function(t){return function(t){var e=E(t);return function(n){return To(n,t,e)}}(I(t,1))},constant:dt,defaultTo:function(t,e){return null==t||t!=t?e:t},flow:Sr,flowRight:Or,iteratee:function(t){return z("function"==typeof t?t:I(t,1))},matches:function(t){return Ct(I(t,1))},matchesProperty:function(t,e){return Tt(t,I(e,1))},method:Pi,methodOf:Di,noop:l,nthArg:function(t){return t=n(t),N(function(e){return Bi(e,t)})},over:Xi,overEvery:Vi,overSome:Ki,property:ve,propertyOf:function(t){return function(e){return null==t?void 0:Dt(t,e)}},range:ja,rangeRight:Ba,stubArray:me,stubFalse:wt,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(t,e){if((t=n(t))<1||t>9007199254740991)return[];var o=Cs,r=Ts(t,Cs);e=Zo(e),t-=Cs;for(var i=Bt(r,e);++o<t;)e(o);return i},toPath:function(e){return d(e)?H(e,A):t(e)?[e]:u(Ht(k(e)))},uniqueId:function(t){var e=++zs;return k(t)+e}};var pl=Math.max,hl=Math.min;var fl=Math.min;var gl,yl=4294967295,vl=Array.prototype,ml=Object.prototype.hasOwnProperty,bl=Mt?Mt.iterator:void 0,_l=Math.max,xl=Math.min,El=function(t){return function(e,n,o){if(null==o){var r=a(n),i=r&&E(n),s=i&&i.length&&Cr(n,i);(s?s.length:r)||(o=n,n=e,e=this)}return t(e,n,o)}}(ki);He.after=rl.after,He.ary=rl.ary,He.assign=ll.assign,He.assignIn=ll.assignIn,He.assignInWith=ll.assignInWith,He.assignWith=ll.assignWith,He.at=ll.at,He.before=rl.before,He.bind=rl.bind,He.bindAll=dl.bindAll,He.bindKey=rl.bindKey,He.castArray=il.castArray,He.chain=ul.chain,He.chunk=el.chunk,He.compact=el.compact,He.concat=el.concat,He.cond=dl.cond,He.conforms=dl.conforms,He.constant=dl.constant,He.countBy=nl.countBy,He.create=ll.create,He.curry=rl.curry,He.curryRight=rl.curryRight,He.debounce=rl.debounce,He.defaults=ll.defaults,He.defaultsDeep=ll.defaultsDeep,He.defer=rl.defer,He.delay=rl.delay,He.difference=el.difference,He.differenceBy=el.differenceBy,He.differenceWith=el.differenceWith,He.drop=el.drop,He.dropRight=el.dropRight,He.dropRightWhile=el.dropRightWhile,He.dropWhile=el.dropWhile,He.fill=el.fill,He.filter=nl.filter,He.flatMap=nl.flatMap,He.flatMapDeep=nl.flatMapDeep,He.flatMapDepth=nl.flatMapDepth,He.flatten=el.flatten,He.flattenDeep=el.flattenDeep,He.flattenDepth=el.flattenDepth,He.flip=rl.flip,He.flow=dl.flow,He.flowRight=dl.flowRight,He.fromPairs=el.fromPairs,He.functions=ll.functions,He.functionsIn=ll.functionsIn,He.groupBy=nl.groupBy,He.initial=el.initial,He.intersection=el.intersection,He.intersectionBy=el.intersectionBy,He.intersectionWith=el.intersectionWith,He.invert=ll.invert,He.invertBy=ll.invertBy,He.invokeMap=nl.invokeMap,He.iteratee=dl.iteratee,He.keyBy=nl.keyBy,He.keys=E,He.keysIn=ll.keysIn,He.map=nl.map,He.mapKeys=ll.mapKeys,He.mapValues=ll.mapValues,He.matches=dl.matches,He.matchesProperty=dl.matchesProperty,He.memoize=rl.memoize,He.merge=ll.merge,He.mergeWith=ll.mergeWith,He.method=dl.method,He.methodOf=dl.methodOf,He.mixin=El,He.negate=Li,He.nthArg=dl.nthArg,He.omit=ll.omit,He.omitBy=ll.omitBy,He.once=rl.once,He.orderBy=nl.orderBy,He.over=dl.over,He.overArgs=rl.overArgs,He.overEvery=dl.overEvery,He.overSome=dl.overSome,He.partial=rl.partial,He.partialRight=rl.partialRight,He.partition=nl.partition,He.pick=ll.pick,He.pickBy=ll.pickBy,He.property=dl.property,He.propertyOf=dl.propertyOf,He.pull=el.pull,He.pullAll=el.pullAll,He.pullAllBy=el.pullAllBy,He.pullAllWith=el.pullAllWith,He.pullAt=el.pullAt,He.range=dl.range,He.rangeRight=dl.rangeRight,He.rearg=rl.rearg,He.reject=nl.reject,He.remove=el.remove,He.rest=rl.rest,He.reverse=el.reverse,He.sampleSize=nl.sampleSize,He.set=ll.set,He.setWith=ll.setWith,He.shuffle=nl.shuffle,He.slice=el.slice,He.sortBy=nl.sortBy,He.sortedUniq=el.sortedUniq,He.sortedUniqBy=el.sortedUniqBy,He.split=cl.split,He.spread=rl.spread,He.tail=el.tail,He.take=el.take,He.takeRight=el.takeRight,He.takeRightWhile=el.takeRightWhile,He.takeWhile=el.takeWhile,He.tap=ul.tap,He.throttle=rl.throttle,He.thru=Os,He.toArray=il.toArray,He.toPairs=ll.toPairs,He.toPairsIn=ll.toPairsIn,He.toPath=dl.toPath,He.toPlainObject=il.toPlainObject,He.transform=ll.transform,He.unary=rl.unary,He.union=el.union,He.unionBy=el.unionBy,He.unionWith=el.unionWith,He.uniq=el.uniq,He.uniqBy=el.uniqBy,He.uniqWith=el.uniqWith,He.unset=ll.unset,He.unzip=el.unzip,He.unzipWith=el.unzipWith,He.update=ll.update,He.updateWith=ll.updateWith,He.values=ll.values,He.valuesIn=ll.valuesIn,He.without=el.without,He.words=cl.words,He.wrap=rl.wrap,He.xor=el.xor,He.xorBy=el.xorBy,He.xorWith=el.xorWith,He.zip=el.zip,He.zipObject=el.zipObject,He.zipObjectDeep=el.zipObjectDeep,He.zipWith=el.zipWith,He.entries=ll.toPairs,He.entriesIn=ll.toPairsIn,He.extend=ll.assignIn,He.extendWith=ll.assignInWith,El(He,He),He.add=al.add,He.attempt=dl.attempt,He.camelCase=cl.camelCase,He.capitalize=cl.capitalize,He.ceil=al.ceil,He.clamp=sl.clamp,He.clone=il.clone,He.cloneDeep=il.cloneDeep,He.cloneDeepWith=il.cloneDeepWith,He.cloneWith=il.cloneWith,He.conformsTo=il.conformsTo,He.deburr=cl.deburr,He.defaultTo=dl.defaultTo,He.divide=al.divide,He.endsWith=cl.endsWith,He.eq=il.eq,He.escape=cl.escape,He.escapeRegExp=cl.escapeRegExp,He.every=nl.every,He.find=nl.find,He.findIndex=el.findIndex,He.findKey=ll.findKey,He.findLast=nl.findLast,He.findLastIndex=el.findLastIndex,He.findLastKey=ll.findLastKey,He.floor=al.floor,He.forEach=nl.forEach,He.forEachRight=nl.forEachRight,He.forIn=ll.forIn,He.forInRight=ll.forInRight,He.forOwn=ll.forOwn,He.forOwnRight=ll.forOwnRight,He.get=ll.get,He.gt=il.gt,He.gte=il.gte,He.has=ll.has,He.hasIn=ll.hasIn,He.head=el.head,He.identity=r,He.includes=nl.includes,He.indexOf=el.indexOf,He.inRange=sl.inRange,He.invoke=ll.invoke,He.isArguments=il.isArguments,He.isArray=d,He.isArrayBuffer=il.isArrayBuffer,He.isArrayLike=il.isArrayLike,He.isArrayLikeObject=il.isArrayLikeObject,He.isBoolean=il.isBoolean,He.isBuffer=il.isBuffer,He.isDate=il.isDate,He.isElement=il.isElement,He.isEmpty=il.isEmpty,He.isEqual=il.isEqual,He.isEqualWith=il.isEqualWith,He.isError=il.isError,He.isFinite=il.isFinite,He.isFunction=il.isFunction,He.isInteger=il.isInteger,He.isLength=il.isLength,He.isMap=il.isMap,He.isMatch=il.isMatch,He.isMatchWith=il.isMatchWith,He.isNaN=il.isNaN,He.isNative=il.isNative,He.isNil=il.isNil,He.isNull=il.isNull,He.isNumber=il.isNumber,He.isObject=a,He.isObjectLike=il.isObjectLike,He.isPlainObject=il.isPlainObject,He.isRegExp=il.isRegExp,He.isSafeInteger=il.isSafeInteger,He.isSet=il.isSet,He.isString=il.isString,He.isSymbol=il.isSymbol,He.isTypedArray=il.isTypedArray,He.isUndefined=il.isUndefined,He.isWeakMap=il.isWeakMap,He.isWeakSet=il.isWeakSet,He.join=el.join,He.kebabCase=cl.kebabCase,He.last=Z,He.lastIndexOf=el.lastIndexOf,He.lowerCase=cl.lowerCase,He.lowerFirst=cl.lowerFirst,He.lt=il.lt,He.lte=il.lte,He.max=al.max,He.maxBy=al.maxBy,He.mean=al.mean,He.meanBy=al.meanBy,He.min=al.min,He.minBy=al.minBy,He.stubArray=dl.stubArray,He.stubFalse=dl.stubFalse,He.stubObject=dl.stubObject,He.stubString=dl.stubString,He.stubTrue=dl.stubTrue,He.multiply=al.multiply,He.nth=el.nth,He.noop=dl.noop,He.now=ol.now,He.pad=cl.pad,He.padEnd=cl.padEnd,He.padStart=cl.padStart,He.parseInt=cl.parseInt,He.random=sl.random,He.reduce=nl.reduce,He.reduceRight=nl.reduceRight,He.repeat=cl.repeat,He.replace=cl.replace,He.result=ll.result,He.round=al.round,He.sample=nl.sample,He.size=nl.size,He.snakeCase=cl.snakeCase,He.some=nl.some,He.sortedIndex=el.sortedIndex,He.sortedIndexBy=el.sortedIndexBy,He.sortedIndexOf=el.sortedIndexOf,He.sortedLastIndex=el.sortedLastIndex,He.sortedLastIndexBy=el.sortedLastIndexBy,He.sortedLastIndexOf=el.sortedLastIndexOf,He.startCase=cl.startCase,He.startsWith=cl.startsWith,He.subtract=al.subtract,He.sum=al.sum,He.sumBy=al.sumBy,He.template=cl.template,He.times=dl.times,He.toFinite=il.toFinite,He.toInteger=n,He.toLength=il.toLength,He.toLower=cl.toLower,He.toNumber=il.toNumber,He.toSafeInteger=il.toSafeInteger,He.toString=il.toString,He.toUpper=cl.toUpper,He.trim=cl.trim,He.trimEnd=cl.trimEnd,He.trimStart=cl.trimStart,He.truncate=cl.truncate,He.unescape=cl.unescape,He.uniqueId=dl.uniqueId,He.upperCase=cl.upperCase,He.upperFirst=cl.upperFirst,He.each=nl.forEach,He.eachRight=nl.forEachRight,He.first=el.head,El(He,(gl={},rt(He,function(t,e){ml.call(He.prototype,e)||(gl[e]=t)}),gl),{chain:!1}),He.VERSION="4.17.23",(He.templateSettings=cl.templateSettings).imports._=He,h(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){He[t].placeholder=He}),h(["drop","take"],function(t,e){Pe.prototype[t]=function(o){o=void 0===o?1:_l(n(o),0);var r=this.__filtered__&&!e?new Pe(this):this.clone();return r.__filtered__?r.__takeCount__=xl(o,r.__takeCount__):r.__views__.push({size:xl(o,yl),type:t+(r.__dir__<0?"Right":"")}),r},Pe.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),h(["filter","map","takeWhile"],function(t,e){var n=e+1,o=1==n||3==n;Pe.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:z(t),type:n}),e.__filtered__=e.__filtered__||o,e}}),h(["head","last"],function(t,e){var n="take"+(e?"Right":"");Pe.prototype[t]=function(){return this[n](1).value()[0]}}),h(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");Pe.prototype[t]=function(){return this.__filtered__?new Pe(this):this[n](1)}}),Pe.prototype.compact=function(){return this.filter(r)},Pe.prototype.find=function(t){return this.filter(t).head()},Pe.prototype.findLast=function(t){return this.reverse().find(t)},Pe.prototype.invokeMap=N(function(t,e){return"function"==typeof t?new Pe(this):this.map(function(n){return ti(n,t,e)})}),Pe.prototype.reject=function(t){return this.filter(Li(z(t)))},Pe.prototype.slice=function(t,e){t=n(t);var o=this;return o.__filtered__&&(t>0||e<0)?new Pe(o):(t<0?o=o.takeRight(-t):t&&(o=o.drop(t)),void 0!==e&&(o=(e=n(e))<0?o.dropRight(-e):o.take(e-t)),o)},Pe.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Pe.prototype.toArray=function(){return this.take(yl)},rt(Pe.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),r=He[o?"take"+("last"==e?"Right":""):e],i=o||/^find/.test(e);r&&(He.prototype[e]=function(){var e=this.__wrapped__,a=o?[1]:arguments,s=e instanceof Pe,l=a[0],u=s||d(e),c=function(t){var e=r.apply(He,j([t],a));return o&&p?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var p=this.__chain__,h=!!this.__actions__.length,f=i&&!p,g=s&&!h;if(!i&&u){e=g?e:new Pe(this);var y=t.apply(e,a);return y.__actions__.push({func:Os,args:[c],thisArg:void 0}),new Ie(y,p)}return f&&g?t.apply(this,a):(y=this.thru(c),f?o?y.value()[0]:y.value():y)})}),h(["pop","push","shift","sort","splice","unshift"],function(t){var e=vl[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",o=/^(?:pop|shift)$/.test(t);He.prototype[t]=function(){var t=arguments;if(o&&!this.__chain__){var r=this.value();return e.apply(d(r)?r:[],t)}return this[n](function(n){return e.apply(d(n)?n:[],t)})}}),rt(Pe.prototype,function(t,e){var n=He[e];if(n){var o=n.name+"";ml.call(ke,o)||(ke[o]=[]),ke[o].push({name:e,func:n})}}),ke[Je(void 0,2).name]=[{name:"wrapper",func:void 0}],Pe.prototype.clone=function(){var t=new Pe(this.__wrapped__);return t.__actions__=u(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=u(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=u(this.__views__),t},Pe.prototype.reverse=function(){if(this.__filtered__){var t=new Pe(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Pe.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=d(t),o=e<0,r=n?t.length:0,i=function(t,e,n){for(var o=-1,r=n.length;++o<r;){var i=n[o],a=i.size;switch(i.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=hl(e,t+a);break;case"takeRight":t=pl(t,e-a)}}return{start:t,end:e}}(0,r,this.__views__),a=i.start,s=i.end,l=s-a,u=o?s:a-1,c=this.__iteratees__,p=c.length,h=0,f=fl(l,this.__takeCount__);if(!n||!o&&r==l&&f==l)return Ms(t,this.__actions__);var g=[];t:for(;l--&&h<f;){for(var y=-1,v=t[u+=e];++y<p;){var m=c[y],b=m.iteratee,_=m.type,x=b(v);if(2==_)v=x;else if(!x){if(1==_)continue t;break t}}g[h++]=v}return g},He.prototype.at=ul.at,He.prototype.chain=ul.wrapperChain,He.prototype.commit=ul.commit,He.prototype.next=ul.next,He.prototype.plant=ul.plant,He.prototype.reverse=ul.reverse,He.prototype.toJSON=He.prototype.valueOf=He.prototype.value=ul.value,He.prototype.first=He.prototype.head,bl&&(He.prototype[bl]=ul.toIterator);var wl,Sl,Ol,Cl,Tl,Ml,Nl,Al,Pl,Dl,kl,Rl={},Ll=[],Il=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,jl=Array.isArray;function Bl(t,e){for(var n in e)t[n]=e[n];return t}function Hl(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function zl(t,e,n){var o,r,i,a={};for(i in e)"key"==i?o=e[i]:"ref"==i?r=e[i]:a[i]=e[i];if(arguments.length>2&&(a.children=arguments.length>3?wl.call(arguments,2):n),"function"==typeof t&&null!=t.defaultProps)for(i in t.defaultProps)void 0===a[i]&&(a[i]=t.defaultProps[i]);return Fl(t,a,o,r,null)}function Fl(t,e,n,o,r){var i={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==r?++Ol:r,__i:-1,__u:0};return null==r&&null!=Sl.vnode&&Sl.vnode(i),i}function Wl(t){return t.children}function Xl(t,e){this.props=t,this.context=e}function Ul(t,e){if(null==e)return t.__?Ul(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?Ul(t):null}function Gl(t){if(t.__P&&t.__d){var e=t.__v,n=e.__e,o=[],r=[],i=Bl({},e);i.__v=e.__v+1,Sl.vnode&&Sl.vnode(i),nu(t.__P,i,e,t.__n,t.__P.namespaceURI,32&e.__u?[n]:null,o,null==n?Ul(e):n,!!(32&e.__u),r),i.__v=e.__v,i.__.__k[i.__i]=i,ru(o,i,r),e.__e=e.__=null,i.__e!=n&&Yl(i)}}function Yl(t){if(null!=(t=t.__)&&null!=t.__c)return t.__e=t.__c.base=null,t.__k.some(function(e){if(null!=e&&null!=e.__e)return t.__e=t.__c.base=e.__e}),Yl(t)}function Vl(t){(!t.__d&&(t.__d=!0)&&Cl.push(t)&&!Kl.__r++||Tl!=Sl.debounceRendering)&&((Tl=Sl.debounceRendering)||Ml)(Kl)}function Kl(){for(var t,e=1;Cl.length;)Cl.length>e&&Cl.sort(Nl),t=Cl.shift(),e=Cl.length,Gl(t);Kl.__r=0}function ql(t,e,n,o,r,i,a,s,l,u,c){var d,p,h,f,g,y,v,m=o&&o.__k||Ll,b=e.length;for(l=function(t,e,n,o,r){var i,a,s,l,u,c=n.length,d=c,p=0;for(t.__k=new Array(r),i=0;i<r;i++)null!=(a=e[i])&&"boolean"!=typeof a&&"function"!=typeof a?("string"==typeof a||"number"==typeof a||"bigint"==typeof a||a.constructor==String?a=t.__k[i]=Fl(null,a,null,null,null):jl(a)?a=t.__k[i]=Fl(Wl,{children:a},null,null,null):void 0===a.constructor&&a.__b>0?a=t.__k[i]=Fl(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):t.__k[i]=a,l=i+p,a.__=t,a.__b=t.__b+1,s=null,-1!=(u=a.__i=Jl(a,n,l,d))&&(d--,(s=n[u])&&(s.__u|=2)),null==s||null==s.__v?(-1==u&&(r>c?p--:r<c&&p++),"function"!=typeof a.type&&(a.__u|=4)):u!=l&&(u==l-1?p--:u==l+1?p++:(u>l?p--:p++,a.__u|=4))):t.__k[i]=null;if(d)for(i=0;i<c;i++)null!=(s=n[i])&&!(2&s.__u)&&(s.__e==o&&(o=Ul(s)),su(s,s));return o}(n,e,m,l,b),d=0;d<b;d++)null!=(h=n.__k[d])&&(p=-1!=h.__i&&m[h.__i]||Rl,h.__i=d,y=nu(t,h,p,r,i,a,s,l,u,c),f=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&au(p.ref,null,h),c.push(h.ref,h.__c||f,h)),null==g&&null!=f&&(g=f),(v=!!(4&h.__u))||p.__k===h.__k?l=Zl(h,l,t,v):"function"==typeof h.type&&void 0!==y?l=y:f&&(l=f.nextSibling),h.__u&=-7);return n.__e=g,l}function Zl(t,e,n,o){var r,i;if("function"==typeof t.type){for(r=t.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=t,e=Zl(r[i],e,n,o));return e}t.__e!=e&&(o&&(e&&t.type&&!e.parentNode&&(e=Ul(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do{e=e&&e.nextSibling}while(null!=e&&8==e.nodeType);return e}function $l(t,e){return e=e||[],null==t||"boolean"==typeof t||(jl(t)?t.some(function(t){$l(t,e)}):e.push(t)),e}function Jl(t,e,n,o){var r,i,a,s=t.key,l=t.type,u=e[n],c=null!=u&&!(2&u.__u);if(null===u&&null==s||c&&s==u.key&&l==u.type)return n;if(o>(c?1:0))for(r=n-1,i=n+1;r>=0||i<e.length;)if(null!=(u=e[a=r>=0?r--:i++])&&!(2&u.__u)&&s==u.key&&l==u.type)return a;return-1}function Ql(t,e,n){"-"==e[0]?t.setProperty(e,null==n?"":n):t[e]=null==n?"":"number"!=typeof n||Il.test(e)?n:n+"px"}function tu(t,e,n,o,r){var i,a;t:if("style"==e)if("string"==typeof n)t.style.cssText=n;else{if("string"==typeof o&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||Ql(t.style,e,"");if(n)for(e in n)o&&n[e]==o[e]||Ql(t.style,e,n[e])}else if("o"==e[0]&&"n"==e[1])i=e!=(e=e.replace(Al,"$1")),a=e.toLowerCase(),e=a in t||"onFocusOut"==e||"onFocusIn"==e?a.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?o?n.u=o.u:(n.u=Pl,t.addEventListener(e,i?kl:Dl,i)):t.removeEventListener(e,i?kl:Dl,i);else{if("http://www.w3.org/2000/svg"==r)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=e&&"height"!=e&&"href"!=e&&"list"!=e&&"form"!=e&&"tabIndex"!=e&&"download"!=e&&"rowSpan"!=e&&"colSpan"!=e&&"role"!=e&&"popover"!=e&&e in t)try{t[e]=null==n?"":n;break t}catch(s){}"function"==typeof n||(null==n||!1===n&&"-"!=e[4]?t.removeAttribute(e):t.setAttribute(e,"popover"==e&&1==n?"":n))}}function eu(t){return function(e){if(this.l){var n=this.l[e.type+t];if(null==e.t)e.t=Pl++;else if(e.t<n.u)return;return n(Sl.event?Sl.event(e):e)}}}function nu(t,e,n,o,r,i,a,s,l,u){var c,d,p,h,f,g,y,v,m,b,_,x,E,w,S,O=e.type;if(void 0!==e.constructor)return null;128&n.__u&&(l=!!(32&n.__u),i=[s=e.__e=n.__e]),(c=Sl.__b)&&c(e);t:if("function"==typeof O)try{if(v=e.props,m="prototype"in O&&O.prototype.render,b=(c=O.contextType)&&o[c.__c],_=c?b?b.props.value:c.__:o,n.__c?y=(d=e.__c=n.__c).__=d.__E:(m?e.__c=d=new O(v,_):(e.__c=d=new Xl(v,_),d.constructor=O,d.render=lu),b&&b.sub(d),d.state||(d.state={}),d.__n=o,p=d.__d=!0,d.__h=[],d._sb=[]),m&&null==d.__s&&(d.__s=d.state),m&&null!=O.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=Bl({},d.__s)),Bl(d.__s,O.getDerivedStateFromProps(v,d.__s))),h=d.props,f=d.state,d.__v=e,p)m&&null==O.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),m&&null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(m&&null==O.getDerivedStateFromProps&&v!==h&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(v,_),e.__v==n.__v||!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(v,d.__s,_)){e.__v!=n.__v&&(d.props=v,d.state=d.__s,d.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(t){t&&(t.__=e)}),Ll.push.apply(d.__h,d._sb),d._sb=[],d.__h.length&&a.push(d);break t}null!=d.componentWillUpdate&&d.componentWillUpdate(v,d.__s,_),m&&null!=d.componentDidUpdate&&d.__h.push(function(){d.componentDidUpdate(h,f,g)})}if(d.context=_,d.props=v,d.__P=t,d.__e=!1,x=Sl.__r,E=0,m)d.state=d.__s,d.__d=!1,x&&x(e),c=d.render(d.props,d.state,d.context),Ll.push.apply(d.__h,d._sb),d._sb=[];else do{d.__d=!1,x&&x(e),c=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++E<25);d.state=d.__s,null!=d.getChildContext&&(o=Bl(Bl({},o),d.getChildContext())),m&&!p&&null!=d.getSnapshotBeforeUpdate&&(g=d.getSnapshotBeforeUpdate(h,f)),w=null!=c&&c.type===Wl&&null==c.key?iu(c.props.children):c,s=ql(t,jl(w)?w:[w],e,n,o,r,i,a,s,l,u),d.base=e.__e,e.__u&=-161,d.__h.length&&a.push(d),y&&(d.__E=d.__=null)}catch(C){if(e.__v=null,l||null!=i)if(C.then){for(e.__u|=l?160:128;s&&8==s.nodeType&&s.nextSibling;)s=s.nextSibling;i[i.indexOf(s)]=null,e.__e=s}else{for(S=i.length;S--;)Hl(i[S]);ou(e)}else e.__e=n.__e,e.__k=n.__k,C.then||ou(e);Sl.__e(C,e,n)}else null==i&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):s=e.__e=function(t,e,n,o,r,i,a,s,l){var u,c,d,p,h,f,g,y=n.props||Rl,v=e.props,m=e.type;if("svg"==m?r="http://www.w3.org/2000/svg":"math"==m?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),null!=i)for(u=0;u<i.length;u++)if((h=i[u])&&"setAttribute"in h==!!m&&(m?h.localName==m:3==h.nodeType)){t=h,i[u]=null;break}if(null==t){if(null==m)return document.createTextNode(v);t=document.createElementNS(r,m,v.is&&v),s&&(Sl.__m&&Sl.__m(e,i),s=!1),i=null}if(null==m)y===v||s&&t.data==v||(t.data=v);else{if(i=i&&wl.call(t.childNodes),!s&&null!=i)for(y={},u=0;u<t.attributes.length;u++)y[(h=t.attributes[u]).name]=h.value;for(u in y)h=y[u],"dangerouslySetInnerHTML"==u?d=h:"children"==u||u in v||"value"==u&&"defaultValue"in v||"checked"==u&&"defaultChecked"in v||tu(t,u,null,h,r);for(u in v)h=v[u],"children"==u?p=h:"dangerouslySetInnerHTML"==u?c=h:"value"==u?f=h:"checked"==u?g=h:s&&"function"!=typeof h||y[u]===h||tu(t,u,h,y[u],r);if(c)s||d&&(c.__html==d.__html||c.__html==t.innerHTML)||(t.innerHTML=c.__html),e.__k=[];else if(d&&(t.innerHTML=""),ql("template"==e.type?t.content:t,jl(p)?p:[p],e,n,o,"foreignObject"==m?"http://www.w3.org/1999/xhtml":r,i,a,i?i[0]:n.__k&&Ul(n,0),s,l),null!=i)for(u=i.length;u--;)Hl(i[u]);s||(u="value","progress"==m&&null==f?t.removeAttribute("value"):null!=f&&(f!==t[u]||"progress"==m&&!f||"option"==m&&f!=y[u])&&tu(t,u,f,y[u],r),u="checked",null!=g&&g!=t[u]&&tu(t,u,g,y[u],r))}return t}(n.__e,e,n,o,r,i,a,l,u);return(c=Sl.diffed)&&c(e),128&e.__u?void 0:s}function ou(t){t&&(t.__c&&(t.__c.__e=!0),t.__k&&t.__k.some(ou))}function ru(t,e,n){for(var o=0;o<n.length;o++)au(n[o],n[++o],n[++o]);Sl.__c&&Sl.__c(e,t),t.some(function(e){try{t=e.__h,e.__h=[],t.some(function(t){t.call(e)})}catch(n){Sl.__e(n,e.__v)}})}function iu(t){return"object"!=typeof t||null==t||t.__b>0?t:jl(t)?t.map(iu):Bl({},t)}function au(t,e,n){try{if("function"==typeof t){var o="function"==typeof t.__u;o&&t.__u(),o&&null==e||(t.__u=t(e))}else t.current=e}catch(r){Sl.__e(r,n)}}function su(t,e,n){var o,r;if(Sl.unmount&&Sl.unmount(t),(o=t.ref)&&(o.current&&o.current!=t.__e||au(o,null,e)),null!=(o=t.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(i){Sl.__e(i,e)}o.base=o.__P=null}if(o=t.__k)for(r=0;r<o.length;r++)o[r]&&su(o[r],e,n||"function"!=typeof t.type);n||Hl(t.__e),t.__c=t.__=t.__e=void 0}function lu(t,e,n){return this.constructor(t,n)}wl=Ll.slice,Sl={__e:function(t,e,n,o){for(var r,i,a;e=e.__;)if((r=e.__c)&&!r.__)try{if((i=r.constructor)&&null!=i.getDerivedStateFromError&&(r.setState(i.getDerivedStateFromError(t)),a=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(t,o||{}),a=r.__d),a)return r.__E=r}catch(s){t=s}throw t}},Ol=0,Xl.prototype.setState=function(t,e){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=Bl({},this.state),"function"==typeof t&&(t=t(Bl({},n),this.props)),t&&Bl(n,t),null!=t&&this.__v&&(e&&this._sb.push(e),Vl(this))},Xl.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Vl(this))},Xl.prototype.render=Wl,Cl=[],Ml="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Nl=function(t,e){return t.__v.__b-e.__v.__b},Kl.__r=0,Al=/(PointerCapture)$|Capture$/i,Pl=0,Dl=eu(!1),kl=eu(!0);var uu=[];Object.freeze(uu);var cu={};function du(){return++jc.mobxGuid}function pu(t){throw hu(!1,t),"X"}function hu(t,e){if(!t)throw new Error("[mobx] "+(e||"An invariant failed, however the error is obfuscated because this is a production build."))}function fu(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}Object.freeze(cu);var gu=function(){};function yu(t){return null!==t&&"object"==typeof t}function vu(t){if(null===t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}function mu(t,e,n){Object.defineProperty(t,e,{enumerable:!1,writable:!0,configurable:!0,value:n})}function bu(t,e){var n="isMobX"+t;return e.prototype[n]=!0,function(t){return yu(t)&&!0===t[n]}}function _u(t){return t instanceof Map}function xu(t){return t instanceof Set}function Eu(t){var e=new Set;for(var n in t)e.add(n);return Object.getOwnPropertySymbols(t).forEach(function(n){Object.getOwnPropertyDescriptor(t,n).enumerable&&e.add(n)}),Array.from(e)}function wu(t){return t&&t.toString?t.toString():new String(t).toString()}function Su(t){return null===t?null:"object"==typeof t?""+t:t}var Ou="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,Cu=Symbol("mobx administration"),Tu=function(){function t(t){void 0===t&&(t="Atom@"+du()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=ec.NOT_TRACKING}return t.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},t.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},t.prototype.reportObserved=function(){return Uc(this)},t.prototype.reportChanged=function(){Wc(),function(t){if(t.lowestObserverState===ec.STALE)return;t.lowestObserverState=ec.STALE,t.observers.forEach(function(e){e.dependenciesState===ec.UP_TO_DATE&&(e.isTracing!==oc.NONE&&Gc(e,t),e.onBecomeStale()),e.dependenciesState=ec.STALE})}(this),Xc()},t.prototype.toString=function(){return this.name},t}(),Mu=bu("Atom",Tu);function Nu(t,e,n){void 0===e&&(e=gu),void 0===n&&(n=gu);var o=new Tu(t);return e!==gu&&sd("onBecomeObserved",o,e),n!==gu&&ad(o,n),o}var Au={structural:function(t,e){return ep(t,e)},default:function(t,e){return Object.is(t,e)}},Pu=function(t,e){return(Pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Du=function(){return Du=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Du.apply(this,arguments)};function ku(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function Ru(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}function Lu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ru(arguments[e]));return t}var Iu=Symbol("mobx did run lazy initializers"),ju=Symbol("mobx pending decorators"),Bu={},Hu={};function zu(t){var e,n;if(!0!==t[Iu]){var o=t[ju];if(o){mu(t,Iu,!0);var r=Lu(Object.getOwnPropertySymbols(o),Object.keys(o));try{for(var i=ku(r),a=i.next();!a.done;a=i.next()){var s=o[a.value];s.propertyCreator(t,s.prop,s.descriptor,s.decoratorTarget,s.decoratorArguments)}}catch(l){e={error:l}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}}}function Fu(t,e){return function(){var n,o,r=function(o,r,i,a){if(!0===a)return e(o,r,i,o,n),null;if(!Object.prototype.hasOwnProperty.call(o,ju)){var s=o[ju];mu(o,ju,Du({},s))}return o[ju][r]={prop:r,propertyCreator:e,descriptor:i,decoratorTarget:o,decoratorArguments:n},function(t,e){var n=e?Bu:Hu;return n[t]||(n[t]={configurable:!0,enumerable:e,get:function(){return zu(this),this[t]},set:function(e){zu(this),this[t]=e}})}(r,t)};return(2===(o=arguments).length||3===o.length)&&("string"==typeof o[1]||"symbol"==typeof o[1])||4===o.length&&!0===o[3]?(n=uu,r.apply(null,arguments)):(n=Array.prototype.slice.call(arguments),r)}}function Wu(t,e,n){return fd(t)?t:Array.isArray(t)?Qu.array(t,{name:n}):vu(t)?Qu.object(t,void 0,{name:n}):_u(t)?Qu.map(t,{name:n}):xu(t)?Qu.set(t,{name:n}):t}function Xu(t){return t}function Uu(t){hu(t);var e=Fu(!0,function(e,n,o,r,i){var a=o?o.initializer?o.initializer.call(e):o.value:void 0;Yd(e).addObservableProp(n,a,t)});return e.enhancer=t,e}var Gu={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function Yu(t){return null==t?Gu:"string"==typeof t?{name:t,deep:!0,proxy:!0}:t}Object.freeze(Gu);var Vu=Uu(Wu),Ku=Uu(function(t,e,n){return null==t||$d(t)||jd(t)||Fd(t)||Ud(t)?t:Array.isArray(t)?Qu.array(t,{name:n,deep:!1}):vu(t)?Qu.object(t,void 0,{name:n,deep:!1}):_u(t)?Qu.map(t,{name:n,deep:!1}):xu(t)?Qu.set(t,{name:n,deep:!1}):pu(!1)}),qu=Uu(Xu),Zu=Uu(function(t,e,n){return ep(t,e)?e:t});function $u(t){return t.defaultDecorator?t.defaultDecorator.enhancer:!1===t.deep?Xu:Wu}var Ju={box:function(t,e){arguments.length>2&&tc("box");var n=Yu(e);return new Tc(t,$u(n),n.name,!0,n.equals)},array:function(t,e){arguments.length>2&&tc("array");var n=Yu(e);return function(t,e,n,o){void 0===n&&(n="ObservableArray@"+du());void 0===o&&(o=!1);var r=new kd(n,e,o);i=r.values,a=Cu,s=r,Object.defineProperty(i,a,{enumerable:!1,writable:!1,configurable:!0,value:s});var i,a,s;var l=new Proxy(r.values,Dd);if(r.proxy=l,t&&t.length){var u=Oc(!0);r.spliceWithArray(0,0,t),Cc(u)}return l}(t,$u(n),n.name)},map:function(t,e){arguments.length>2&&tc("map");var n=Yu(e);return new zd(t,$u(n),n.name)},set:function(t,e){arguments.length>2&&tc("set");var n=Yu(e);return new Xd(t,$u(n),n.name)},object:function(t,e,n){"string"==typeof arguments[1]&&tc("object");var o=Yu(n);if(!1===o.proxy)return ld({},t,e,o);var r=ud(o),i=function(t){var e=new Proxy(t,Od);return t[Cu].proxy=e,e}(ld({},void 0,void 0,o));return cd(i,t,e,r),i},ref:qu,shallow:Ku,deep:Vu,struct:Zu},Qu=function(t,e,n){if("string"==typeof arguments[1]||"symbol"==typeof arguments[1])return Vu.apply(null,arguments);if(fd(t))return t;var o=vu(t)?Qu.object(t,e,n):Array.isArray(t)?Qu.array(t,e):_u(t)?Qu.map(t,e):xu(t)?Qu.set(t,e):t;if(o!==t)return o;pu(!1)};function tc(t){pu("Expected one or two arguments to observable."+t+". Did you accidentally try to use observable."+t+" as decorator?")}Object.keys(Ju).forEach(function(t){return Qu[t]=Ju[t]});var ec,nc,oc,rc,ic=Fu(!1,function(t,e,n,o,r){var i=n.get,a=n.set,s=r[0]||{};Yd(t).addComputedProp(t,e,Du({get:i,set:a,context:t},s))}),ac=ic({equals:Au.structural}),sc=function(t,e,n){if("string"==typeof e)return ic.apply(null,arguments);if(null!==t&&"object"==typeof t&&1===arguments.length)return ic.apply(null,arguments);var o="object"==typeof e?e:{};return o.get=t,o.set="function"==typeof e?e:o.set,o.name=o.name||t.name||"",new Nc(o)};sc.struct=ac,(nc=ec||(ec={}))[nc.NOT_TRACKING=-1]="NOT_TRACKING",nc[nc.UP_TO_DATE=0]="UP_TO_DATE",nc[nc.POSSIBLY_STALE=1]="POSSIBLY_STALE",nc[nc.STALE=2]="STALE",(rc=oc||(oc={}))[rc.NONE=0]="NONE",rc[rc.LOG=1]="LOG",rc[rc.BREAK=2]="BREAK";var lc=function(){return function(t){this.cause=t}}();function uc(t){return t instanceof lc}function cc(t){switch(t.dependenciesState){case ec.UP_TO_DATE:return!1;case ec.NOT_TRACKING:case ec.STALE:return!0;case ec.POSSIBLY_STALE:for(var e=vc(!0),n=gc(),o=t.observing,r=o.length,i=0;i<r;i++){var a=o[i];if(Ac(a)){if(jc.disableErrorBoundaries)a.get();else try{a.get()}catch(s){return yc(n),mc(e),!0}if(t.dependenciesState===ec.STALE)return yc(n),mc(e),!0}}return bc(t),yc(n),mc(e),!1}}function dc(t){var e=t.observers.size>0;jc.computationDepth>0&&e&&pu(!1),jc.allowStateChanges||!e&&"strict"!==jc.enforceActions||pu(!1)}function pc(t,e,n){var o=vc(!0);bc(t),t.newObserving=new Array(t.observing.length+100),t.unboundDepsCount=0,t.runId=++jc.runId;var r,i=jc.trackingDerivation;if(jc.trackingDerivation=t,!0===jc.disableErrorBoundaries)r=e.call(n);else try{r=e.call(n)}catch(a){r=new lc(a)}return jc.trackingDerivation=i,function(t){for(var e=t.observing,n=t.observing=t.newObserving,o=ec.UP_TO_DATE,r=0,i=t.unboundDepsCount,a=0;a<i;a++){0===(s=n[a]).diffValue&&(s.diffValue=1,r!==a&&(n[r]=s),r++),s.dependenciesState>o&&(o=s.dependenciesState)}n.length=r,t.newObserving=null,i=e.length;for(;i--;){0===(s=e[i]).diffValue&&zc(s,t),s.diffValue=0}for(;r--;){var s;1===(s=n[r]).diffValue&&(s.diffValue=0,Hc(s,t))}o!==ec.UP_TO_DATE&&(t.dependenciesState=o,t.onBecomeStale())}(t),mc(o),r}function hc(t){var e=t.observing;t.observing=[];for(var n=e.length;n--;)zc(e[n],t);t.dependenciesState=ec.NOT_TRACKING}function fc(t){var e=gc();try{return t()}finally{yc(e)}}function gc(){var t=jc.trackingDerivation;return jc.trackingDerivation=null,t}function yc(t){jc.trackingDerivation=t}function vc(t){var e=jc.allowStateReads;return jc.allowStateReads=t,e}function mc(t){jc.allowStateReads=t}function bc(t){if(t.dependenciesState!==ec.UP_TO_DATE){t.dependenciesState=ec.UP_TO_DATE;for(var e=t.observing,n=e.length;n--;)e[n].lowestObserverState=ec.UP_TO_DATE}}var _c=0,xc=1,Ec=Object.getOwnPropertyDescriptor(function(){},"name");function wc(t,e,n){var o=function(){return Sc(t,e,n||this,arguments)};return o.isMobxAction=!0,o}function Sc(t,e,n,o){var r=function(){var t=!1,e=0,n=gc();Wc();var o=Oc(!0),r=vc(!0),i={prevDerivation:n,prevAllowStateChanges:o,prevAllowStateReads:r,notifySpy:t,startTime:e,actionId:xc++,parentActionId:_c};return _c=i.actionId,i}();try{return e.apply(n,o)}catch(i){throw r.error=i,i}finally{!function(t){_c!==t.actionId&&pu("invalid action stack. did you forget to finish an action?");_c=t.parentActionId,void 0!==t.error&&(jc.suppressReactionErrors=!0);Cc(t.prevAllowStateChanges),mc(t.prevAllowStateReads),Xc(),yc(t.prevDerivation),jc.suppressReactionErrors=!1}(r)}}function Oc(t){var e=jc.allowStateChanges;return jc.allowStateChanges=t,e}function Cc(t){jc.allowStateChanges=t}Ec&&Ec.configurable;var Tc=function(t){function e(e,n,o,r,i){void 0===o&&(o="ObservableValue@"+du()),void 0===i&&(i=Au.default);var a=t.call(this,o)||this;return a.enhancer=n,a.name=o,a.equals=i,a.hasUnreportedChange=!1,a.value=n(e,void 0,o),a}return function(t,e){function n(){this.constructor=t}Pu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},e.prototype.set=function(t){this.value,(t=this.prepareNewValue(t))!==jc.UNCHANGED&&this.setNewValue(t)},e.prototype.prepareNewValue=function(t){if(dc(this),Cd(this)){var e=Md(this,{object:this,type:"update",newValue:t});if(!e)return jc.UNCHANGED;t=e.newValue}return t=this.enhancer(t,this.value,this.name),this.equals(this.value,t)?jc.UNCHANGED:t},e.prototype.setNewValue=function(t){var e=this.value;this.value=t,this.reportChanged(),Nd(this)&&Pd(this,{type:"update",object:this,newValue:t,oldValue:e})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(t){return Td(this,t)},e.prototype.observe=function(t,e){return e&&t({object:this,type:"update",newValue:this.value,oldValue:void 0}),Ad(this,t)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.value+"]"},e.prototype.valueOf=function(){return Su(this.get())},e.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},e}(Tu),Mc=bu("ObservableValue",Tc),Nc=function(){function t(t){this.dependenciesState=ec.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=ec.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+du(),this.value=new lc(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=oc.NONE,hu(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+du(),t.set&&(this.setter=wc(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?Au.structural:Au.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return t.prototype.onBecomeStale=function(){!function(t){if(t.lowestObserverState!==ec.UP_TO_DATE)return;t.lowestObserverState=ec.POSSIBLY_STALE,t.observers.forEach(function(e){e.dependenciesState===ec.UP_TO_DATE&&(e.dependenciesState=ec.POSSIBLY_STALE,e.isTracing!==oc.NONE&&Gc(e,t),e.onBecomeStale())})}(this)},t.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(t){return t()})},t.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(t){return t()})},t.prototype.get=function(){this.isComputing&&pu("Cycle detected in computation "+this.name+": "+this.derivation),0!==jc.inBatch||0!==this.observers.size||this.keepAlive?(Uc(this),cc(this)&&this.trackAndCompute()&&function(t){if(t.lowestObserverState===ec.STALE)return;t.lowestObserverState=ec.STALE,t.observers.forEach(function(e){e.dependenciesState===ec.POSSIBLY_STALE?e.dependenciesState=ec.STALE:e.dependenciesState===ec.UP_TO_DATE&&(t.lowestObserverState=ec.UP_TO_DATE)})}(this)):cc(this)&&(this.warnAboutUntrackedRead(),Wc(),this.value=this.computeValue(!1),Xc());var t=this.value;if(uc(t))throw t.cause;return t},t.prototype.peek=function(){var t=this.computeValue(!1);if(uc(t))throw t.cause;return t},t.prototype.set=function(t){if(this.setter){hu(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else hu(!1,!1)},t.prototype.trackAndCompute=function(){var t=this.value,e=this.dependenciesState===ec.NOT_TRACKING,n=this.computeValue(!0),o=e||uc(t)||uc(n)||!this.equals(t,n);return o&&(this.value=n),o},t.prototype.computeValue=function(t){var e;if(this.isComputing=!0,jc.computationDepth++,t)e=pc(this,this.derivation,this.scope);else if(!0===jc.disableErrorBoundaries)e=this.derivation.call(this.scope);else try{e=this.derivation.call(this.scope)}catch(n){e=new lc(n)}return jc.computationDepth--,this.isComputing=!1,e},t.prototype.suspend=function(){this.keepAlive||(hc(this),this.value=void 0)},t.prototype.observe=function(t,e){var n=this,o=!0,r=void 0;return function(t,e){void 0===e&&(e=cu);var n,o=e&&e.name||t.name||"Autorun@"+du();if(e.scheduler||e.delay){var r=rd(e),i=!1;n=new Vc(o,function(){i||(i=!0,r(function(){i=!1,n.isDisposed||n.track(a)}))},e.onError,e.requiresObservable)}else n=new Vc(o,function(){this.track(a)},e.onError,e.requiresObservable);function a(){t(n)}return n.schedule(),n.getDisposer()}(function(){var i=n.get();if(!o||e){var a=gc();t({type:"update",object:n,newValue:i,oldValue:r}),yc(a)}o=!1,r=i})},t.prototype.warnAboutUntrackedRead=function(){},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},t.prototype.valueOf=function(){return Su(this.get())},t.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},t}(),Ac=bu("ComputedValue",Nc),Pc=function(){return function(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}}(),Dc={};function kc(){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:Dc}var Rc,Lc=!0,Ic=!1,jc=((Rc=kc()).__mobxInstanceCount>0&&!Rc.__mobxGlobals&&(Lc=!1),Rc.__mobxGlobals&&Rc.__mobxGlobals.version!==(new Pc).version&&(Lc=!1),Lc?Rc.__mobxGlobals?(Rc.__mobxInstanceCount+=1,Rc.__mobxGlobals.UNCHANGED||(Rc.__mobxGlobals.UNCHANGED={}),Rc.__mobxGlobals):(Rc.__mobxInstanceCount=1,Rc.__mobxGlobals=new Pc):(setTimeout(function(){Ic||pu("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new Pc));function Bc(){return jc}function Hc(t,e){t.observers.add(e),t.lowestObserverState>e.dependenciesState&&(t.lowestObserverState=e.dependenciesState)}function zc(t,e){t.observers.delete(e),0===t.observers.size&&Fc(t)}function Fc(t){!1===t.isPendingUnobservation&&(t.isPendingUnobservation=!0,jc.pendingUnobservations.push(t))}function Wc(){jc.inBatch++}function Xc(){if(0===--jc.inBatch){Zc();for(var t=jc.pendingUnobservations,e=0;e<t.length;e++){var n=t[e];n.isPendingUnobservation=!1,0===n.observers.size&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBecomeUnobserved()),n instanceof Nc&&n.suspend())}jc.pendingUnobservations=[]}}function Uc(t){var e=jc.trackingDerivation;return null!==e?(e.runId!==t.lastAccessedBy&&(t.lastAccessedBy=e.runId,e.newObserving[e.unboundDepsCount++]=t,t.isBeingObserved||(t.isBeingObserved=!0,t.onBecomeObserved())),!0):(0===t.observers.size&&jc.inBatch>0&&Fc(t),!1)}function Gc(t,e){if(console.log("[mobx.trace] '"+t.name+"' is invalidated due to a change in: '"+e.name+"'"),t.isTracing===oc.BREAK){var n=[];Yc(dd(Jd(t,o)),n,1),new Function("debugger;\n/*\nTracing '"+t.name+"'\n\nYou are entering this break point because derivation '"+t.name+"' is being traced and '"+e.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(t instanceof Nc?t.derivation.toString().replace(/[*]\//g,"/"):"")+"\n\nThe dependencies for this derivation are:\n\n"+n.join("\n")+"\n*/\n    ")()}var o}function Yc(t,e,n){e.length>=1e3?e.push("(and many more)"):(e.push(""+new Array(n).join("\t")+t.name),t.dependencies&&t.dependencies.forEach(function(t){return Yc(t,e,n+1)}))}var Vc=function(){function t(t,e,n,o){void 0===t&&(t="Reaction@"+du()),void 0===o&&(o=!1),this.name=t,this.onInvalidate=e,this.errorHandler=n,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=ec.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+du(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=oc.NONE}return t.prototype.onBecomeStale=function(){this.schedule()},t.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,jc.pendingReactions.push(this),Zc())},t.prototype.isScheduled=function(){return this._isScheduled},t.prototype.runReaction=function(){if(!this.isDisposed){if(Wc(),this._isScheduled=!1,cc(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending}catch(t){this.reportExceptionInDerivation(t)}}Xc()}},t.prototype.track=function(t){if(!this.isDisposed){Wc(),this._isRunning=!0;var e=pc(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&hc(this),uc(e)&&this.reportExceptionInDerivation(e.cause),Xc()}},t.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler)this.errorHandler(t,this);else{if(jc.disableErrorBoundaries)throw t;var n="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";jc.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(n,t),jc.globalReactionErrorHandlers.forEach(function(n){return n(t,e)})}},t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(Wc(),hc(this),Xc()))},t.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t[Cu]=this,t},t.prototype.toString=function(){return"Reaction["+this.name+"]"},t.prototype.trace=function(t){void 0===t&&(t=!1),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=!1;"boolean"==typeof t[t.length-1]&&(n=t.pop());var o=function(t){switch(t.length){case 0:return jc.trackingDerivation;case 1:return Jd(t[0]);case 2:return Jd(t[0],t[1])}}(t);if(!o)return pu(!1);o.isTracing===oc.NONE&&console.log("[mobx.trace] '"+o.name+"' tracing enabled");o.isTracing=n?oc.BREAK:oc.LOG}(this,t)},t}(),Kc=100,qc=function(t){return t()};function Zc(){jc.inBatch>0||jc.isRunningReactions||qc($c)}function $c(){jc.isRunningReactions=!0;for(var t=jc.pendingReactions,e=0;t.length>0;){++e===Kc&&(console.error("Reaction doesn't converge to a stable state after "+Kc+" iterations. Probably there is a cycle in the reactive function: "+t[0]),t.splice(0));for(var n=t.splice(0),o=0,r=n.length;o<r;o++)n[o].runReaction()}jc.isRunningReactions=!1}var Jc=bu("Reaction",Vc);function Qc(){pu(!1)}function td(t){return function(e,n,o){if(o){if(o.value)return{value:wc(t,o.value),enumerable:!1,configurable:!0,writable:!0};var r=o.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return wc(t,r.call(this))}}}return function(t){return function(e,n,o){Object.defineProperty(e,n,{configurable:!0,enumerable:!1,get:function(){},set:function(e){mu(this,n,ed(t,e))}})}}(t).apply(this,arguments)}}var ed=function(t,e,n,o){return 1===arguments.length&&"function"==typeof t?wc(t.name||"<unnamed action>",t):2===arguments.length&&"function"==typeof e?wc(t,e):1===arguments.length&&"string"==typeof t?td(t):!0!==o?td(e).apply(null,arguments):void mu(t,e,wc(t.name||e,n.value,this))};function nd(t,e,n){mu(t,e,wc(e,n.bind(t)))}ed.bound=function(t,e,n,o){return!0===o?(nd(t,e,n.value),null):n?{configurable:!0,enumerable:!1,get:function(){return nd(this,e,n.value||n.initializer.call(this)),this[e]},set:Qc}:{enumerable:!1,configurable:!0,set:function(t){nd(this,e,t)},get:function(){}}};var od=function(t){return t()};function rd(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:od}function id(t,e,n){void 0===n&&(n=cu);var o,r,i,a=n.name||"Reaction@"+du(),s=ed(a,n.onError?(o=n.onError,r=e,function(){try{return r.apply(this,arguments)}catch(t){o.call(this,t)}}):e),l=!n.scheduler&&!n.delay,u=rd(n),c=!0,d=!1,p=n.compareStructural?Au.structural:n.equals||Au.default,h=new Vc(a,function(){c||l?f():d||(d=!0,u(f))},n.onError,n.requiresObservable);function f(){if(d=!1,!h.isDisposed){var e=!1;h.track(function(){var n=t(h);e=c||!p(i,n),i=n}),c&&n.fireImmediately&&s(i,h),c||!0!==e||s(i,h),c&&(c=!1)}}return h.schedule(),h.getDisposer()}function ad(t,e,n){return sd("onBecomeUnobserved",t,e)}function sd(t,e,n,o){var r=Jd(e),i=n,a=t+"Listeners";return r[a]?r[a].add(i):r[a]=new Set([i]),"function"!=typeof r[t]?pu(!1):function(){var t=r[a];t&&(t.delete(i),0===t.size&&delete r[a])}}function ld(t,e,n,o){var r=ud(o=Yu(o));return zu(t),Yd(t,o.name,r.enhancer),e&&cd(t,e,n,r),t}function ud(t){return t.defaultDecorator||(!1===t.deep?qu:Vu)}function cd(t,e,n,o){var r,i;Wc();try{var a=Ou(e);try{for(var s=ku(a),l=s.next();!l.done;l=s.next()){var u=l.value,c=Object.getOwnPropertyDescriptor(e,u);0;var d=(n&&u in n?n[u]:c.get?ic:o)(t,u,c,!0);d&&Object.defineProperty(t,u,d)}}catch(p){r={error:p}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}finally{Xc()}}function dd(t){var e,n,o={name:t.name};return t.observing&&t.observing.length>0&&(o.dependencies=(e=t.observing,n=[],e.forEach(function(t){-1===n.indexOf(t)&&n.push(t)}),n).map(dd)),o}function pd(t,e){if(null==t)return!1;if(void 0!==e){if(!1===$d(t))return!1;if(!t[Cu].values.has(e))return!1;var n=Jd(t,e);return Ac(n)}return Ac(t)}function hd(t,e){return"string"!=typeof e?pu(!1):pd(t,e)}function fd(t){return 1!==arguments.length&&pu(!1),function(t){return null!=t&&($d(t)||!!t[Cu]||Mu(t)||Jc(t)||Ac(t))}(t)}function gd(t){return $d(t)?t[Cu].getKeys():Fd(t)||Ud(t)?Array.from(t.keys()):jd(t)?t.map(function(t,e){return e}):pu(!1)}function yd(t,e,n){if(2!==arguments.length||Ud(t))if($d(t)){var o=t[Cu];o.values.get(e)?o.write(e,n):o.addObservableProp(e,n,o.defaultEnhancer)}else if(Fd(t))t.set(e,n);else if(Ud(t))t.add(e);else{if(!jd(t))return pu(!1);"number"!=typeof e&&(e=parseInt(e,10)),hu(e>=0,"Not a valid index: '"+e+"'"),Wc(),e>=t.length&&(t.length=e+1),t[e]=n,Xc()}else{Wc();var r=e;try{for(var i in r)yd(t,i,r[i])}finally{Xc()}}}function vd(t,e,n,o){return function(t,e,n){return Qd(t).observe(e,n)}(t,e,n)}var md={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function bd(t,e,n,o){return o.detectCycles&&t.set(e,n),n}function _d(t,e,n){if(!e.recurseEverything&&!fd(t))return t;if("object"!=typeof t)return t;if(null===t)return null;if(t instanceof Date)return t;if(Mc(t))return _d(t.get(),e,n);if(fd(t)&&gd(t),!0===e.detectCycles&&null!==t&&n.has(t))return n.get(t);if(jd(t)||Array.isArray(t)){var o=bd(n,t,[],e),r=t.map(function(t){return _d(t,e,n)});o.length=r.length;for(var i=0,a=r.length;i<a;i++)o[i]=r[i];return o}if(Ud(t)||Object.getPrototypeOf(t)===Set.prototype){if(!1===e.exportMapsAsObjects){var s=bd(n,t,new Set,e);return t.forEach(function(t){s.add(_d(t,e,n))}),s}var l=bd(n,t,[],e);return t.forEach(function(t){l.push(_d(t,e,n))}),l}if(Fd(t)||Object.getPrototypeOf(t)===Map.prototype){if(!1===e.exportMapsAsObjects){var u=bd(n,t,new Map,e);return t.forEach(function(t,o){u.set(o,_d(t,e,n))}),u}var c=bd(n,t,{},e);return t.forEach(function(t,o){c[o]=_d(t,e,n)}),c}var d=bd(n,t,{},e);return Eu(t).forEach(function(o){d[o]=_d(t[o],e,n)}),d}function xd(t,e){var n;return"boolean"==typeof e&&(e={detectCycles:e}),e||(e=md),e.detectCycles=void 0===e.detectCycles?!0===e.recurseEverything:!0===e.detectCycles,e.detectCycles&&(n=new Map),_d(t,e,n)}function Ed(t,e){void 0===e&&(e=void 0),Wc();try{return t.apply(e)}finally{Xc()}}function wd(t){return t[Cu]}function Sd(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t}var Od={has:function(t,e){if(e===Cu||"constructor"===e||e===Iu)return!0;var n=wd(t);return Sd(e)?n.has(e):e in t},get:function(t,e){if(e===Cu||"constructor"===e||e===Iu)return t[e];var n=wd(t),o=n.values.get(e);if(o instanceof Tu){var r=o.get();return void 0===r&&n.has(e),r}return Sd(e)&&n.has(e),t[e]},set:function(t,e,n){return!!Sd(e)&&(yd(t,e,n),!0)},deleteProperty:function(t,e){return!!Sd(e)&&(wd(t).remove(e),!0)},ownKeys:function(t){return wd(t).keysAtom.reportObserved(),Reflect.ownKeys(t)},preventExtensions:function(t){return pu("Dynamic observable objects cannot be frozen"),!1}};function Cd(t){return void 0!==t.interceptors&&t.interceptors.length>0}function Td(t,e){var n=t.interceptors||(t.interceptors=[]);return n.push(e),fu(function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)})}function Md(t,e){var n=gc();try{for(var o=Lu(t.interceptors||[]),r=0,i=o.length;r<i&&(hu(!(e=o[r](e))||e.type,"Intercept handlers should return nothing or a change object"),e);r++);return e}finally{yc(n)}}function Nd(t){return void 0!==t.changeListeners&&t.changeListeners.length>0}function Ad(t,e){var n=t.changeListeners||(t.changeListeners=[]);return n.push(e),fu(function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)})}function Pd(t,e){var n=gc(),o=t.changeListeners;if(o){for(var r=0,i=(o=o.slice()).length;r<i;r++)o[r](e);yc(n)}}var Dd={get:function(t,e){return e===Cu?t[Cu]:"length"===e?t[Cu].getArrayLength():"number"==typeof e?Rd.get.call(t,e):"string"!=typeof e||isNaN(e)?Rd.hasOwnProperty(e)?Rd[e]:t[e]:Rd.get.call(t,parseInt(e))},set:function(t,e,n){return"length"===e&&t[Cu].setArrayLength(n),"number"==typeof e&&Rd.set.call(t,e,n),"symbol"==typeof e||isNaN(e)?t[e]=n:Rd.set.call(t,parseInt(e),n),!0},preventExtensions:function(t){return pu("Observable arrays cannot be frozen"),!1}};var kd=function(){function t(t,e,n){this.owned=n,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new Tu(t||"ObservableArray@"+du()),this.enhancer=function(n,o){return e(n,o,t+"[..]")}}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.dehanceValues=function(t){return void 0!==this.dehancer&&t.length>0?t.map(this.dehancer):t},t.prototype.intercept=function(t){return Td(this,t)},t.prototype.observe=function(t,e){return void 0===e&&(e=!1),e&&t({object:this.proxy,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),Ad(this,t)},t.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},t.prototype.setArrayLength=function(t){if("number"!=typeof t||t<0)throw new Error("[mobx.array] Out of range: "+t);var e=this.values.length;if(t!==e)if(t>e){for(var n=new Array(t-e),o=0;o<t-e;o++)n[o]=void 0;this.spliceWithArray(e,0,n)}else this.spliceWithArray(t,e-t)},t.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");this.lastKnownLength+=e},t.prototype.spliceWithArray=function(t,e,n){var o=this;dc(this.atom);var r=this.values.length;if(void 0===t?t=0:t>r?t=r:t<0&&(t=Math.max(0,r+t)),e=1===arguments.length?r-t:null==e?0:Math.max(0,Math.min(e,r-t)),void 0===n&&(n=uu),Cd(this)){var i=Md(this,{object:this.proxy,type:"splice",index:t,removedCount:e,added:n});if(!i)return uu;e=i.removedCount,n=i.added}n=0===n.length?n:n.map(function(t){return o.enhancer(t,void 0)});var a=this.spliceItemsIntoValues(t,e,n);return 0===e&&0===n.length||this.notifyArraySplice(t,n,a),this.dehanceValues(a)},t.prototype.spliceItemsIntoValues=function(t,e,n){var o;if(n.length<1e4)return(o=this.values).splice.apply(o,Lu([t,e],n));var r=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(n,this.values.slice(t+e)),r},t.prototype.notifyArrayChildUpdate=function(t,e,n){var o=!this.owned&&!1,r=Nd(this),i=r||o?{object:this.proxy,type:"update",index:t,newValue:e,oldValue:n}:null;this.atom.reportChanged(),r&&Pd(this,i)},t.prototype.notifyArraySplice=function(t,e,n){var o=!this.owned&&!1,r=Nd(this),i=r||o?{object:this.proxy,type:"splice",index:t,removed:n,added:e,removedCount:n.length,addedCount:e.length}:null;this.atom.reportChanged(),r&&Pd(this,i)},t}(),Rd={intercept:function(t){return this[Cu].intercept(t)},observe:function(t,e){return void 0===e&&(e=!1),this[Cu].observe(t,e)},clear:function(){return this.splice(0)},replace:function(t){var e=this[Cu];return e.spliceWithArray(0,e.values.length,t)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(t,e){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var r=this[Cu];switch(arguments.length){case 0:return[];case 1:return r.spliceWithArray(t);case 2:return r.spliceWithArray(t,e)}return r.spliceWithArray(t,e,n)},spliceWithArray:function(t,e,n){return this[Cu].spliceWithArray(t,e,n)},push:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this[Cu];return n.spliceWithArray(n.values.length,0,t),n.values.length},pop:function(){return this.splice(Math.max(this[Cu].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this[Cu];return n.spliceWithArray(0,0,t),n.values.length},reverse:function(){var t=this.slice();return t.reverse.apply(t,arguments)},sort:function(t){var e=this.slice();return e.sort.apply(e,arguments)},remove:function(t){var e=this[Cu],n=e.dehanceValues(e.values).indexOf(t);return n>-1&&(this.splice(n,1),!0)},get:function(t){var e=this[Cu];if(e){if(t<e.values.length)return e.atom.reportObserved(),e.dehanceValue(e.values[t]);console.warn("[mobx.array] Attempt to read an array index ("+t+") that is out of bounds ("+e.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},set:function(t,e){var n=this[Cu],o=n.values;if(t<o.length){dc(n.atom);var r=o[t];if(Cd(n)){var i=Md(n,{type:"update",object:n.proxy,index:t,newValue:e});if(!i)return;e=i.newValue}(e=n.enhancer(e,r))!==r&&(o[t]=e,n.notifyArrayChildUpdate(t,e,r))}else{if(t!==o.length)throw new Error("[mobx.array] Index out of bounds, "+t+" is larger than "+o.length);n.spliceWithArray(t,0,[e])}}};["concat","flat","includes","indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(t){"function"==typeof Array.prototype[t]&&(Rd[t]=function(){var e=this[Cu];e.atom.reportObserved();var n=e.dehanceValues(e.values);return n[t].apply(n,arguments)})}),["every","filter","find","findIndex","flatMap","forEach","map","some"].forEach(function(t){"function"==typeof Array.prototype[t]&&(Rd[t]=function(e,n){var o=this,r=this[Cu];return r.atom.reportObserved(),r.dehanceValues(r.values)[t](function(t,r){return e.call(n,t,r,o)},n)})}),["reduce","reduceRight"].forEach(function(t){Rd[t]=function(){var e=this,n=this[Cu];n.atom.reportObserved();var o=arguments[0];return arguments[0]=function(t,r,i){return r=n.dehanceValue(r),o(t,r,i,e)},n.values[t].apply(n.values,arguments)}});var Ld,Id=bu("ObservableArrayAdministration",kd);function jd(t){return yu(t)&&Id(t[Cu])}var Bd,Hd={},zd=function(){function t(t,e,n){if(void 0===e&&(e=Wu),void 0===n&&(n="ObservableMap@"+du()),this.enhancer=e,this.name=n,this[Ld]=Hd,this._keysAtom=Nu(this.name+".keys()"),this[Symbol.toStringTag]="Map","function"!=typeof Map)throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return t.prototype._has=function(t){return this._data.has(t)},t.prototype.has=function(t){var e=this;if(!jc.trackingDerivation)return this._has(t);var n=this._hasMap.get(t);if(!n){var o=n=new Tc(this._has(t),Xu,this.name+"."+wu(t)+"?",!1);this._hasMap.set(t,o),ad(o,function(){return e._hasMap.delete(t)})}return n.get()},t.prototype.set=function(t,e){var n=this._has(t);if(Cd(this)){var o=Md(this,{type:n?"update":"add",object:this,newValue:e,name:t});if(!o)return this;e=o.newValue}return n?this._updateValue(t,e):this._addValue(t,e),this},t.prototype.delete=function(t){var e=this;if((dc(this._keysAtom),Cd(this))&&!(o=Md(this,{type:"delete",object:this,name:t})))return!1;if(this._has(t)){var n=Nd(this),o=n?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return Ed(function(){e._keysAtom.reportChanged(),e._updateHasMapEntry(t,!1),e._data.get(t).setNewValue(void 0),e._data.delete(t)}),n&&Pd(this,o),!0}return!1},t.prototype._updateHasMapEntry=function(t,e){var n=this._hasMap.get(t);n&&n.setNewValue(e)},t.prototype._updateValue=function(t,e){var n=this._data.get(t);if((e=n.prepareNewValue(e))!==jc.UNCHANGED){var o=Nd(this),r=o?{type:"update",object:this,oldValue:n.value,name:t,newValue:e}:null;n.setNewValue(e),o&&Pd(this,r)}},t.prototype._addValue=function(t,e){var n=this;dc(this._keysAtom),Ed(function(){var o=new Tc(e,n.enhancer,n.name+"."+wu(t),!1);n._data.set(t,o),e=o.value,n._updateHasMapEntry(t,!0),n._keysAtom.reportChanged()});var o=Nd(this);o&&Pd(this,o?{type:"add",object:this,name:t,newValue:e}:null)},t.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},t.prototype.values=function(){var t=this,e=this.keys();return ip({next:function(){var n=e.next(),o=n.done,r=n.value;return{done:o,value:o?void 0:t.get(r)}}})},t.prototype.entries=function(){var t=this,e=this.keys();return ip({next:function(){var n=e.next(),o=n.done,r=n.value;return{done:o,value:o?void 0:[r,t.get(r)]}}})},t.prototype[(Ld=Cu,Symbol.iterator)]=function(){return this.entries()},t.prototype.forEach=function(t,e){var n,o;try{for(var r=ku(this),i=r.next();!i.done;i=r.next()){var a=Ru(i.value,2),s=a[0],l=a[1];t.call(e,l,s,this)}}catch(u){n={error:u}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}},t.prototype.merge=function(t){var e=this;return Fd(t)&&(t=t.toJS()),Ed(function(){var n=Oc(!0);try{vu(t)?Eu(t).forEach(function(n){return e.set(n,t[n])}):Array.isArray(t)?t.forEach(function(t){var n=Ru(t,2),o=n[0],r=n[1];return e.set(o,r)}):_u(t)?(t.constructor!==Map&&pu("Cannot initialize from classes that inherit from Map: "+t.constructor.name),t.forEach(function(t,n){return e.set(n,t)})):null!=t&&pu("Cannot initialize map from "+t)}finally{Cc(n)}}),this},t.prototype.clear=function(){var t=this;Ed(function(){fc(function(){var e,n;try{for(var o=ku(t.keys()),r=o.next();!r.done;r=o.next()){var i=r.value;t.delete(i)}}catch(a){e={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}})})},t.prototype.replace=function(t){var e=this;return Ed(function(){var n,o,r,i,a=function(t){if(_u(t)||Fd(t))return t;if(Array.isArray(t))return new Map(t);if(vu(t)){var e=new Map;for(var n in t)e.set(n,t[n]);return e}return pu("Cannot convert to map from '"+t+"'")}(t),s=new Map,l=!1;try{for(var u=ku(e._data.keys()),c=u.next();!c.done;c=u.next()){var d=c.value;if(!a.has(d))if(e.delete(d))l=!0;else{var p=e._data.get(d);s.set(d,p)}}}catch(E){n={error:E}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}try{for(var h=ku(a.entries()),f=h.next();!f.done;f=h.next()){var g=Ru(f.value,2),y=(d=g[0],p=g[1],e._data.has(d));if(e.set(d,p),e._data.has(d)){var v=e._data.get(d);s.set(d,v),y||(l=!0)}}}catch(w){r={error:w}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}if(!l)if(e._data.size!==s.size)e._keysAtom.reportChanged();else for(var m=e._data.keys(),b=s.keys(),_=m.next(),x=b.next();!_.done;){if(_.value!==x.value){e._keysAtom.reportChanged();break}_=m.next(),x=b.next()}e._data=s}),this},Object.defineProperty(t.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.toPOJO=function(){var t,e,n={};try{for(var o=ku(this),r=o.next();!r.done;r=o.next()){var i=Ru(r.value,2),a=i[0],s=i[1];n["symbol"==typeof a?a:wu(a)]=s}}catch(l){t={error:l}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},t.prototype.toJS=function(){return new Map(this)},t.prototype.toJSON=function(){return this.toPOJO()},t.prototype.toString=function(){var t=this;return this.name+"[{ "+Array.from(this.keys()).map(function(e){return wu(e)+": "+t.get(e)}).join(", ")+" }]"},t.prototype.observe=function(t,e){return Ad(this,t)},t.prototype.intercept=function(t){return Td(this,t)},t}(),Fd=bu("ObservableMap",zd),Wd={},Xd=function(){function t(t,e,n){if(void 0===e&&(e=Wu),void 0===n&&(n="ObservableSet@"+du()),this.name=n,this[Bd]=Wd,this._data=new Set,this._atom=Nu(this.name),this[Symbol.toStringTag]="Set","function"!=typeof Set)throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(t,o){return e(t,o,n)},t&&this.replace(t)}return t.prototype.dehanceValue=function(t){return void 0!==this.dehancer?this.dehancer(t):t},t.prototype.clear=function(){var t=this;Ed(function(){fc(function(){var e,n;try{for(var o=ku(t._data.values()),r=o.next();!r.done;r=o.next()){var i=r.value;t.delete(i)}}catch(a){e={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}})})},t.prototype.forEach=function(t,e){var n,o;try{for(var r=ku(this),i=r.next();!i.done;i=r.next()){var a=i.value;t.call(e,a,a,this)}}catch(s){n={error:s}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}},Object.defineProperty(t.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),t.prototype.add=function(t){var e=this;if((dc(this._atom),Cd(this))&&!(o=Md(this,{type:"add",object:this,newValue:t})))return this;if(!this.has(t)){Ed(function(){e._data.add(e.enhancer(t,void 0)),e._atom.reportChanged()});var n=Nd(this),o=n?{type:"add",object:this,newValue:t}:null;n&&Pd(this,o)}return this},t.prototype.delete=function(t){var e=this;if(Cd(this)&&!(o=Md(this,{type:"delete",object:this,oldValue:t})))return!1;if(this.has(t)){var n=Nd(this),o=n?{type:"delete",object:this,oldValue:t}:null;return Ed(function(){e._atom.reportChanged(),e._data.delete(t)}),n&&Pd(this,o),!0}return!1},t.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},t.prototype.entries=function(){var t=0,e=Array.from(this.keys()),n=Array.from(this.values());return ip({next:function(){var o=t;return t+=1,o<n.length?{value:[e[o],n[o]],done:!1}:{done:!0}}})},t.prototype.keys=function(){return this.values()},t.prototype.values=function(){this._atom.reportObserved();var t=this,e=0,n=Array.from(this._data.values());return ip({next:function(){return e<n.length?{value:t.dehanceValue(n[e++]),done:!1}:{done:!0}}})},t.prototype.replace=function(t){var e=this;return Ud(t)&&(t=t.toJS()),Ed(function(){var n=Oc(!0);try{Array.isArray(t)||xu(t)?(e.clear(),t.forEach(function(t){return e.add(t)})):null!=t&&pu("Cannot initialize set from "+t)}finally{Cc(n)}}),this},t.prototype.observe=function(t,e){return Ad(this,t)},t.prototype.intercept=function(t){return Td(this,t)},t.prototype.toJS=function(){return new Set(this)},t.prototype.toString=function(){return this.name+"[ "+Array.from(this).join(", ")+" ]"},t.prototype[(Bd=Cu,Symbol.iterator)]=function(){return this.values()},t}(),Ud=bu("ObservableSet",Xd),Gd=function(){function t(t,e,n,o){void 0===e&&(e=new Map),this.target=t,this.values=e,this.name=n,this.defaultEnhancer=o,this.keysAtom=new Tu(n+".keys")}return t.prototype.read=function(t){return this.values.get(t).get()},t.prototype.write=function(t,e){var n=this.target,o=this.values.get(t);if(o instanceof Nc)o.set(e);else{if(Cd(this)){if(!(i=Md(this,{type:"update",object:this.proxy||n,name:t,newValue:e})))return;e=i.newValue}if((e=o.prepareNewValue(e))!==jc.UNCHANGED){var r=Nd(this),i=r?{type:"update",object:this.proxy||n,oldValue:o.value,name:t,newValue:e}:null;o.setNewValue(e),r&&Pd(this,i)}}},t.prototype.has=function(t){var e=this.pendingKeys||(this.pendingKeys=new Map),n=e.get(t);if(n)return n.get();var o=!!this.values.get(t);return n=new Tc(o,Xu,this.name+"."+wu(t)+"?",!1),e.set(t,n),n.get()},t.prototype.addObservableProp=function(t,e,n){void 0===n&&(n=this.defaultEnhancer);var o=this.target;if(Cd(this)){var r=Md(this,{object:this.proxy||o,name:t,type:"add",newValue:e});if(!r)return;e=r.newValue}var i=new Tc(e,n,this.name+"."+wu(t),!1);this.values.set(t,i),e=i.value,Object.defineProperty(o,t,function(t){return Vd[t]||(Vd[t]={configurable:!0,enumerable:!0,get:function(){return this[Cu].read(t)},set:function(e){this[Cu].write(t,e)}})}(t)),this.notifyPropertyAddition(t,e)},t.prototype.addComputedProp=function(t,e,n){var o,r,i,a=this.target;n.name=n.name||this.name+"."+wu(e),this.values.set(e,new Nc(n)),(t===a||(o=t,r=e,!(i=Object.getOwnPropertyDescriptor(o,r))||!1!==i.configurable&&!1!==i.writable))&&Object.defineProperty(t,e,function(t){return Kd[t]||(Kd[t]={configurable:jc.computedConfigurable,enumerable:!1,get:function(){return qd(this).read(t)},set:function(e){qd(this).write(t,e)}})}(e))},t.prototype.remove=function(t){if(this.values.has(t)){var e=this.target;if(Cd(this))if(!(s=Md(this,{object:this.proxy||e,name:t,type:"remove"})))return;try{Wc();var n=Nd(this),o=!1,r=this.values.get(t),i=r&&r.get();if(r&&r.set(void 0),this.keysAtom.reportChanged(),this.values.delete(t),this.pendingKeys){var a=this.pendingKeys.get(t);a&&a.set(!1)}delete this.target[t];var s=n?{type:"remove",object:this.proxy||e,oldValue:i,name:t}:null;o,n&&Pd(this,s)}finally{Xc()}}},t.prototype.illegalAccess=function(t,e){console.warn("Property '"+e+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},t.prototype.observe=function(t,e){return Ad(this,t)},t.prototype.intercept=function(t){return Td(this,t)},t.prototype.notifyPropertyAddition=function(t,e){var n=Nd(this),o=n?{type:"add",object:this.proxy||this.target,name:t,newValue:e}:null;if(n&&Pd(this,o),this.pendingKeys){var r=this.pendingKeys.get(t);r&&r.set(!0)}this.keysAtom.reportChanged()},t.prototype.getKeys=function(){var t,e;this.keysAtom.reportObserved();var n=[];try{for(var o=ku(this.values),r=o.next();!r.done;r=o.next()){var i=Ru(r.value,2),a=i[0];i[1]instanceof Tc&&n.push(a)}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},t}();function Yd(t,e,n){if(void 0===e&&(e=""),void 0===n&&(n=Wu),Object.prototype.hasOwnProperty.call(t,Cu))return t[Cu];vu(t)||(e=(t.constructor.name||"ObservableObject")+"@"+du()),e||(e="ObservableObject@"+du());var o=new Gd(t,new Map,wu(e),n);return mu(t,Cu,o),o}var Vd=Object.create(null),Kd=Object.create(null);function qd(t){var e=t[Cu];return e||(zu(t),t[Cu])}var Zd=bu("ObservableObjectAdministration",Gd);function $d(t){return!!yu(t)&&(zu(t),Zd(t[Cu]))}function Jd(t,e){if("object"==typeof t&&null!==t){if(jd(t))return void 0!==e&&pu(!1),t[Cu].atom;if(Ud(t))return t[Cu];if(Fd(t)){var n=t;return void 0===e?n._keysAtom:((o=n._data.get(e)||n._hasMap.get(e))||pu(!1),o)}var o;if(zu(t),e&&!t[Cu]&&t[e],$d(t))return e?((o=t[Cu].values.get(e))||pu(!1),o):pu(!1);if(Mu(t)||Ac(t)||Jc(t))return t}else if("function"==typeof t&&Jc(t[Cu]))return t[Cu];return pu(!1)}function Qd(t,e){return t||pu("Expecting some object"),void 0!==e?Qd(Jd(t,e)):Mu(t)||Ac(t)||Jc(t)||Fd(t)||Ud(t)?t:(zu(t),t[Cu]?t[Cu]:void pu(!1))}var tp=Object.prototype.toString;function ep(t,e,n){return void 0===n&&(n=-1),np(t,e,n)}function np(t,e,n,o,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;if("function"!==i&&"object"!==i&&"object"!=typeof e)return!1;var a=tp.call(t);if(a!==tp.call(e))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0===+t?1/+t==1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(t)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":n>=0&&n++}t=op(t),e=op(e);var s="[object Array]"===a;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var l=t.constructor,u=e.constructor;if(l!==u&&!("function"==typeof l&&l instanceof l&&"function"==typeof u&&u instanceof u)&&"constructor"in t&&"constructor"in e)return!1}if(0===n)return!1;n<0&&(n=-1),r=r||[];for(var c=(o=o||[]).length;c--;)if(o[c]===t)return r[c]===e;if(o.push(t),r.push(e),s){if((c=t.length)!==e.length)return!1;for(;c--;)if(!np(t[c],e[c],n-1,o,r))return!1}else{var d=Object.keys(t),p=void 0;if(c=d.length,Object.keys(e).length!==c)return!1;for(;c--;)if(!rp(e,p=d[c])||!np(t[p],e[p],n-1,o,r))return!1}return o.pop(),r.pop(),!0}function op(t){return jd(t)?t.slice():_u(t)||Fd(t)||xu(t)||Ud(t)?Array.from(t.entries()):t}function rp(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ip(t){return t[Symbol.iterator]=ap,t}function ap(){return this}if("undefined"==typeof Proxy||"undefined"==typeof Symbol)throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");function sp(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.prefix,o=void 0===n?"":n,r=e.suffix,i=void 0===r?"":r;return o+(t.displayName||t.name||t.constructor&&t.constructor.name||"<component>")+i}"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:function(t){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}},extras:{getDebugName:function(t,e){return(void 0!==e?Jd(t,e):$d(t)||Fd(t)||Ud(t)?Qd(t):Jd(t)).name}},$mobx:Cu});var lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},cp=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),dp=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},pp=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},hp=console;function fp(t,e,n,o,r){var i=function(t){var e=Bc().allowStateChanges;return Bc().allowStateChanges=t,e}(t),a=void 0;try{a=e(n,o,r)}finally{!function(t){Bc().allowStateChanges=t}(i)}return a}function gp(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t[e],r=vp[e],i=o?!0===n?function(){r.apply(this,arguments),o.apply(this,arguments)}:function(){o.apply(this,arguments),r.apply(this,arguments)}:r;t[e]=i}function yp(t,e){if(null==t||null==e||"object"!==(void 0===t?"undefined":lp(t))||"object"!==(void 0===e?"undefined":lp(e)))return t!==e;var n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(var o=void 0,r=n.length-1;o=n[r];r--)if(e[o]!==t[o])return!0;return!1}var vp={componentWillMount:function(){var t=this,e=sp(this),n=!1,o=!1;function r(t){var e=this[t],r=Nu("reactive "+t);Object.defineProperty(this,t,{configurable:!0,enumerable:!0,get:function(){return r.reportObserved(),e},set:function(t){!o&&yp(e,t)?(e=t,n=!0,r.reportChanged(),n=!1):e=t}})}r.call(this,"props"),r.call(this,"state");var i=this.render.bind(this),a=null,s=!1,l=function(t,e,n){s=!1;var o=void 0,r=void 0;if(a.track(function(){try{r=fp(!1,i,t,e,n)}catch(a){o=a}}),o)throw o;return r};this.render=function(){return(a=new Vc(e+".render()",function(){if(!s&&(s=!0,"function"==typeof t.componentWillReact&&t.componentWillReact(),!0!==t.__$mobxIsUnmounted)){var e=!0;try{o=!0,n||Xl.prototype.forceUpdate.call(t),e=!1}finally{o=!1,e&&a.dispose()}}})).reactComponent=t,l.$mobx=a,t.render=l,l(t.props,t.state,t.context)}},componentWillUnmount:function(){this.render.$mobx&&this.render.$mobx.dispose(),this.__$mobxIsUnmounted=!0},componentDidMount:function(){},componentDidUpdate:function(){},shouldComponentUpdate:function(t,e){return this.state!==e||yp(this.props,t)}};function mp(t){var e,n,o;if(arguments.length>1&&hp.warn('Mobx observer: Using observer to inject stores is not supported. Use `@connect(["store1", "store2"]) ComponentClass instead or preferably, use `@inject("store1", "store2") @observer ComponentClass` or `inject("store1", "store2")(observer(componentClass))``'),!0===t.isMobxInjector&&hp.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),!((o=t).prototype&&o.prototype.render||Xl.isPrototypeOf(o)))return mp((n=e=function(){function e(){return up(this,e),pp(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return dp(e,Xl),cp(e,[{key:"render",value:function(){return t.call(this,this.props,this.context)}}]),e}(),e.displayName=sp(t),n));if(!t)throw new Error("Please pass a valid component to 'observer'");return function(t){gp(t,"componentWillMount",!0),gp(t,"componentDidMount"),t.shouldComponentUpdate||(t.shouldComponentUpdate=vp.shouldComponentUpdate)}(t.prototype||t),t.isMobXReactObserver=!0,t}mp(function(t){return t.children[0]()}).displayName="Observer";var bp,_p;"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;bp=function(t,e){var n,o,r,i,a,s,l,u;t.exports=(n={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r=Object.defineProperty,i=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,s=Object.getOwnPropertyDescriptor,l=Object.getPrototypeOf,u=l&&l(Object),function t(e,c,d){if("string"!=typeof c){if(u){var p=l(c);p&&p!==u&&t(e,p,d)}var h=i(c);a&&(h=h.concat(a(c)));for(var f=0;f<h.length;++f){var g=h[f];if(!(n[g]||o[g]||d&&d[g])){var y=s(c,g);try{r(e,g,y)}catch(v){}}}return e}return e})},bp(_p={exports:{}},_p.exports);var xp={children:!0,key:!0,ref:!0},Ep=console;if(function(){function t(){return up(this,t),pp(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}dp(t,Xl),cp(t,[{key:"render",value:function(t){var e=t.children;return e.length>1?zl("div",null," ",e," "):e[0]}},{key:"getChildContext",value:function(){var t={},e=this.context.mobxStores;if(e)for(var n in e)t[n]=e[n];for(var o in this.props)xp[o]||"suppressChangedStoreWarning"===o||(t[o]=this.props[o]);return{mobxStores:t}}},{key:"componentWillReceiveProps",value:function(t){if(Object.keys(t).length!==Object.keys(this.props).length&&Ep.warn("MobX Provider: The set of provided stores has changed. Please avoid changing stores as the change might not propagate to all children"),!t.suppressChangedStoreWarning)for(var e in t)xp[e]||this.props[e]===t[e]||Ep.warn("MobX Provider: Provided store '"+e+"' has changed. Please avoid replacing stores as the change might not propagate to all children")}}])}(),!Xl)throw new Error("mobx-preact requires Preact to be available");var wp,Sp,Op,Cp=[],Tp=Sl,Mp=Tp.__b,Np=Tp.__r,Ap=Tp.diffed,Pp=Tp.__c,Dp=Tp.unmount,kp=Tp.__;function Rp(){for(var t;t=Cp.shift();){var e=t.__H;if(t.__P&&e)try{e.__h.some(jp),e.__h.some(Bp),e.__h=[]}catch(n){e.__h=[],Tp.__e(n,t.__v)}}}Tp.__b=function(t){wp=null,Mp&&Mp(t)},Tp.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),kp&&kp(t,e)},Tp.__r=function(t){Np&&Np(t);var e=(wp=t.__c).__H;e&&(Sp===wp?(e.__h=[],wp.__h=[],e.__.some(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.some(jp),e.__h.some(Bp),e.__h=[])),Sp=wp},Tp.diffed=function(t){Ap&&Ap(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(1!==Cp.push(e)&&Op===Tp.requestAnimationFrame||((Op=Tp.requestAnimationFrame)||Ip)(Rp)),e.__H.__.some(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Sp=wp=null},Tp.__c=function(t,e){e.some(function(t){try{t.__h.some(jp),t.__h=t.__h.filter(function(t){return!t.__||Bp(t)})}catch(n){e.some(function(t){t.__h&&(t.__h=[])}),e=[],Tp.__e(n,t.__v)}}),Pp&&Pp(t,e)},Tp.unmount=function(t){Dp&&Dp(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.some(function(t){try{jp(t)}catch(n){e=n}}),n.__H=void 0,e&&Tp.__e(e,n.__v))};var Lp="function"==typeof requestAnimationFrame;function Ip(t){var e,n=function(){clearTimeout(o),Lp&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,35);Lp&&(e=requestAnimationFrame(n))}function jp(t){var e=wp,n=t.__c;"function"==typeof n&&(t.__c=void 0,n()),wp=e}function Bp(t){var e=wp;t.__c=t.__(),wp=e}function Hp(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var o in e)if("__source"!==o&&t[o]!==e[o])return!0;return!1}function zp(t,e){this.props=t,this.context=e}(zp.prototype=new Xl).isPureReactComponent=!0,zp.prototype.shouldComponentUpdate=function(t,e){return Hp(this.props,t)||Hp(this.state,e)};var Fp=Sl.__b;Sl.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Fp&&Fp(t)};var Wp=Sl.__e;Sl.__e=function(t,e,n,o){if(t.then)for(var r,i=e;i=i.__;)if((r=i.__c)&&r.__c)return null==e.__e&&(e.__e=n.__e,e.__k=n.__k),r.__c(t,e);Wp(t,e,n,o)};var Xp=Sl.unmount;function Up(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(t){"function"==typeof t.__c&&t.__c()}),t.__c.__H=null),null!=(t=function(t,e){for(var n in e)t[n]=e[n];return t}({},t)).__c&&(t.__c.__P===n&&(t.__c.__P=e),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map(function(t){return Up(t,e,n)})),t}function Gp(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(t){return Gp(t,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function Yp(){this.__u=0,this.o=null,this.__b=null}function Vp(t){if(!t.__)return null;var e=t.__.__c;return e&&e.__a&&e.__a(t)}function Kp(){this.i=null,this.l=null}Sl.unmount=function(t){var e=t.__c;e&&(e.__z=!0),e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Xp&&Xp(t)},(Yp.prototype=new Xl).__c=function(t,e){var n=e.__c,o=this;null==o.o&&(o.o=[]),o.o.push(n);var r=Vp(o.__v),i=!1,a=function(){i||o.__z||(i=!0,n.__R=null,r?r(l):l())};n.__R=a;var s=n.__P;n.__P=null;var l=function(){if(! --o.__u){if(o.state.__a){var t=o.state.__a;o.__v.__k[0]=Gp(t,t.__c.__P,t.__c.__O)}var e;for(o.setState({__a:o.__b=null});e=o.o.pop();)e.__P=s,e.forceUpdate()}};o.__u++||32&e.__u||o.setState({__a:o.__b=o.__v.__k[0]}),t.then(a,a)},Yp.prototype.componentWillUnmount=function(){this.o=[]},Yp.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=Up(this.__b,n,o.__O=o.__P)}this.__b=null}var r=e.__a&&zl(Wl,null,t.fallback);return r&&(r.__u&=-33),[zl(Wl,null,e.__a?null:t.children),r]};var qp=function(t,e,n){if(++n[1]===n[0]&&t.l.delete(e),t.props.revealOrder&&("t"!==t.props.revealOrder[0]||!t.l.size))for(n=t.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.i=n=n[2]}};(Kp.prototype=new Xl).__a=function(t){var e=this,n=Vp(e.__v),o=e.l.get(t);return o[0]++,function(r){var i=function(){e.props.revealOrder?(o.push(r),qp(e,t,o)):r()};n?n(i):i()}},Kp.prototype.render=function(t){this.i=null,this.l=new Map;var e=$l(t.children);t.revealOrder&&"b"===t.revealOrder[0]&&e.reverse();for(var n=e.length;n--;)this.l.set(e[n],this.i=[1,0,this.i]);return t.children},Kp.prototype.componentDidUpdate=Kp.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(e,n){qp(t,n,e)})};var Zp="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,$p=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Jp=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Qp=/[A-Z0-9]/g,th="undefined"!=typeof document,eh=function(t){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(t)};function nh(t,e,n){return null==e.__k&&(e.textContent=""),function(t,e){var n,o,r;e==document&&(e=document.documentElement),Sl.__&&Sl.__(t,e),n=e.__k,o=[],r=[],nu(e,t=e.__k=zl(Wl,null,[t]),n||Rl,Rl,e.namespaceURI,n?null:e.firstChild?wl.call(e.childNodes):null,o,n?n.__e:e.firstChild,!1,r),ru(o,t,r)}(t,e),"function"==typeof n&&n(),t?t.__c:null}Xl.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Xl.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var oh=Sl.event;function rh(){}function ih(){return this.cancelBubble}function ah(){return this.defaultPrevented}Sl.event=function(t){return oh&&(t=oh(t)),t.persist=rh,t.isPropagationStopped=ih,t.isDefaultPrevented=ah,t.nativeEvent=t};var sh={enumerable:!1,configurable:!0,get:function(){return this.class}},lh=Sl.vnode;Sl.vnode=function(t){"string"==typeof t.type&&function(t){var e=t.props,n=t.type,o={},r=-1===n.indexOf("-");for(var i in e){var a=e[i];if(!("value"===i&&"defaultValue"in e&&null==a||th&&"children"===i&&"noscript"===n||"class"===i||"className"===i)){var s=i.toLowerCase();"defaultValue"===i&&"value"in e&&null==e.value?i="value":"download"===i&&!0===a?a="":"translate"===s&&"no"===a?a=!1:"o"===s[0]&&"n"===s[1]?"ondoubleclick"===s?i="ondblclick":"onchange"!==s||"input"!==n&&"textarea"!==n||eh(e.type)?"onfocus"===s?i="onfocusin":"onblur"===s?i="onfocusout":Jp.test(i)&&(i=s):s=i="oninput":r&&$p.test(i)?i=i.replace(Qp,"-$&").toLowerCase():null===a&&(a=void 0),"oninput"===s&&o[i=s]&&(i="oninputCapture"),o[i]=a}}"select"==n&&o.multiple&&Array.isArray(o.value)&&(o.value=$l(e.children).forEach(function(t){t.props.selected=-1!=o.value.indexOf(t.props.value)})),"select"==n&&null!=o.defaultValue&&(o.value=$l(e.children).forEach(function(t){t.props.selected=o.multiple?-1!=o.defaultValue.indexOf(t.props.value):o.defaultValue==t.props.value})),e.class&&!e.className?(o.class=e.class,Object.defineProperty(o,"className",sh)):e.className&&(o.class=o.className=e.className),t.props=o}(t),t.$$typeof=Zp,lh&&lh(t)};var uh=Sl.__r;Sl.__r=function(t){uh&&uh(t),t.__c};var ch=Sl.diffed;Sl.diffed=function(t){ch&&ch(t);var e=t.props,n=t.__e;null!=n&&"textarea"===t.type&&"value"in e&&e.value!==n.value&&(n.value=null==e.value?"":e.value)};var dh=0;function ph(t,e,n,o,r,i){e||(e={});var a,s,l=e;if("ref"in l)for(s in l={},e)"ref"==s?a=e[s]:l[s]=e[s];var u={type:t,props:l,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--dh,__i:-1,__u:0,__source:r,__self:i};if("function"==typeof t&&(a=t.defaultProps))for(s in a)void 0===l[s]&&(l[s]=a[s]);return Sl.vnode&&Sl.vnode(u),u}var hh,fh;(fh=hh||(hh={})).get=function(t){var e=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n}(t,[]);if(!t.container)throw new Error("Ensure the container of LogicFlow is specified and valid.");return sn({},fh.defaults,e)},(hh||(hh={})).defaults={background:!1,grid:!1,textEdit:!0,snapline:!0,outline:!1,disabledTools:[]};var gh={node:!1,edge:!1},yh={node:!0,edge:!0};function vh(t){try{return JSON.parse(JSON.stringify(t))}catch(e){return t}}var mh,bh,_h,xh,Eh,wh,Sh,Oh,Ch,Th,Mh,Nh,Ah,Ph,Dh=200;(bh=mh||(mh={}))[bh.DEFAULT=1]="DEFAULT",bh[bh.TEXT_EDIT=2]="TEXT_EDIT",bh[bh.SHOW_MENU=3]="SHOW_MENU",bh[bh.ALLOW_CONNECT=4]="ALLOW_CONNECT",bh[bh.NOT_ALLOW_CONNECT=5]="NOT_ALLOW_CONNECT",(xh=_h||(_h={})).NODE="node",xh.EDGE="edge",xh.GRAPH="graph",(wh=Eh||(Eh={})).NODE="node",wh.CIRCLE_NODE="circle-node",wh.POLYGON_NODE="polygon-node",wh.RECT_NODE="rect-node",wh.TEXT_NODE="text-node",wh.ELLIPSE_NODE="ellipse-node",wh.DIAMOND_NODE="diamond-node",wh.HTML_NODE="html-node",wh.CUSTOM_HTML_NODE="custom-html-node",wh.EDGE="edge",wh.LINE_EDGE="line-edge",wh.POLYLINE_EDGE="polyline-edge",wh.BEZIER_EDGE="bezier-edge",wh.GRAPH="graph",(Oh=Sh||(Sh={})).ELEMENT_CLICK="element:click",Oh.NODE_ADD="node:add",Oh.NODE_DELETE="node:delete",Oh.NODE_CLICK="node:click",Oh.NODE_DBCLICK="node:dbclick",Oh.NODE_GROUP_COPY="node:group-copy-add",Oh.NODE_DND_ADD="node:dnd-add",Oh.NODE_DND_DRAG="node:dnd-drag",Oh.NODE_MOUSEDOWN="node:mousedown",Oh.NODE_DRAGSTART="node:dragstart",Oh.NODE_DRAG="node:drag",Oh.NODE_DROP="node:drop",Oh.NODE_MOUSEUP="node:mouseup",Oh.NODE_MOUSEMOVE="node:mousemove",Oh.NODE_MOUSEENTER="node:mouseenter",Oh.NODE_MOUSELEAVE="node:mouseleave",Oh.NODE_CONTEXTMENU="node:contextmenu",Oh.NODE_ROTATE="node:rotate",Oh.NODE_RESIZE="node:resize",Oh.NODE_FOCUS="node:focus",Oh.NODE_BLUR="node:blur",Oh.NODE_PROPERTIES_CHANGE="node:properties-change",Oh.NODE_PROPERTIES_DELETE="node:properties-delete",Oh.EDGE_ADD="edge:add",Oh.EDGE_DELETE="edge:delete",Oh.EDGE_CLICK="edge:click",Oh.EDGE_DBCLICK="edge:dbclick",Oh.EDGE_FOCUS="edge:focus",Oh.EDGE_BLUR="edge:blur",Oh.EDGE_MOUSEENTER="edge:mouseenter",Oh.EDGE_MOUSELEAVE="edge:mouseleave",Oh.EDGE_CONTEXTMENU="edge:contextmenu",Oh.EDGE_ADJUST="edge:adjust",Oh.EDGE_EXCHANGE_NODE="edge:exchange-node",Oh.ANCHOR_CLICK="anchor:click",Oh.ANCHOR_MOUSEDOWN="anchor:mousedown",Oh.ANCHOR_DRAGSTART="anchor:dragstart",Oh.ANCHOR_DRAG="anchor:drag",Oh.ANCHOR_DROP="anchor:drop",Oh.ANCHOR_DRAGEND="anchor:dragend",Oh.ADJUST_POINT_MOUSEDOWN="adjustPoint:mousedown",Oh.ADJUST_POINT_MOUSEUP="adjustPoint:mouseup",Oh.ADJUST_POINT_MOUSEMOVE="adjustPoint:mousemove",Oh.ADJUST_POINT_DRAGSTART="adjustPoint:dragstart",Oh.ADJUST_POINT_DRAG="adjustPoint:drag",Oh.ADJUST_POINT_DROP="adjustPoint:drop",Oh.ADJUST_POINT_DRAGEND="adjustPoint:dragend",Oh.BLANK_MOUSEDOWN="blank:mousedown",Oh.BLANK_DRAGSTART="blank:dragstart",Oh.BLANK_DRAG="blank:drag",Oh.BLANK_DROP="blank:drop",Oh.BLANK_MOUSEMOVE="blank:mousemove",Oh.BLANK_CANVAS_MOUSEMOVE="blank:canvas-mousemove",Oh.BLANK_MOUSEUP="blank:mouseup",Oh.BLANK_CLICK="blank:click",Oh.BLANK_CONTEXTMENU="blank:contextmenu",Oh.SELECTION_MOUSEDOWN="selection:mousedown",Oh.SELECTION_DRAGSTART="selection:dragstart",Oh.SELECTION_DRAG="selection:drag",Oh.SELECTION_DROP="selection:drop",Oh.SELECTION_MOUSEMOVE="selection:mousemove",Oh.SELECTION_MOUSEUP="selection:mouseup",Oh.SELECTION_CONTEXTMENU="selection:contextmenu",Oh.CONNECTION_NOT_ALLOWED="connection:not-allowed",Oh.TEXT_MOUSEDOWN="text:mousedown",Oh.TEXT_DRAGSTART="text:dragstart",Oh.TEXT_DRAG="text:drag",Oh.TEXT_DROP="text:drop",Oh.TEXT_CLICK="text:click",Oh.TEXT_DBCLICK="text:dbclick",Oh.TEXT_BLUR="text:blur",Oh.TEXT_MOUSEMOVE="text:mousemove",Oh.TEXT_MOUSEUP="text:mouseup",Oh.TEXT_FOCUS="text:focus",Oh.TEXT_ADD="text:add",Oh.TEXT_UPDATE="text:update",Oh.TEXT_CLEAR="text:clear",Oh.LABEL_MOUSEDOWN="label:mousedown",Oh.LABEL_DRAGSTART="label:dragstart",Oh.LABEL_DRAG="label:drag",Oh.LABEL_DROP="label:drop",Oh.LABEL_CLICK="label:click",Oh.LABEL_DBCLICK="label:dbclick",Oh.LABEL_BLUR="label:blur",Oh.LABEL_MOUSEMOVE="label:mousemove",Oh.LABEL_MOUSEUP="label:mouseup",Oh.LABEL_FOCUS="label:focus",Oh.LABEL_ADD="label:add",Oh.LABEL_UPDATE="label:update",Oh.LABEL_CLEAR="label:clear",Oh.LABEL_DELETE="label:delete",Oh.LABEL_SHOULD_ADD="label:should-add",Oh.LABEL_BATCH_ADD="label:batch-add",Oh.LABEL_SHOULD_UPDATE="label:should-update",Oh.LABEL_SHOULD_DELETE="label:should-delete",Oh.LABEL_BATCH_DELETE="label:batch-delete",Oh.LABEL_NOT_ALLOWED_ADD="label:not-allowed-add",Oh.HISTORY_CHANGE="history:change",Oh.GRAPH_TRANSFORM="graph:transform",Oh.GRAPH_RENDERED="graph:rendered",Oh.GRAPH_UPDATED="graph:updated",Oh.EDIT_CONFIG_CHANGED="editConfig:changed",(Th=Ch||(Ch={}))[Th.STATIC=-1]="STATIC",Th[Th.DEFAULT=0]="DEFAULT",Th[Th.INCREASE=1]="INCREASE",Th[Th.EDGE_TOP=2]="EDGE_TOP",(Nh=Mh||(Mh={})).HORIZONTAL="horizontal",Nh.VERTICAL="vertical",(Ph=Ah||(Ah={})).TEXT="text",Ph.LABEL="label";var kh=function(){function t(t){var e=t.onDragStart,n=void 0===e?l:e,o=t.onDragging,r=void 0===o?l:o,i=t.onDragEnd,a=void 0===i?l:i,s=t.eventType,u=void 0===s?"":s,c=t.eventCenter,d=t.step,p=void 0===d?1:d,h=t.isStopPropagation,f=void 0===h||h,g=t.model,y=t.data,v=this;this.isDragging=!1,this.isStartDragging=!1,this.startX=0,this.startY=0,this.sumDeltaX=0,this.sumDeltaY=0,this.handleMouseDown=function(t){var e,n,o=null===window||void 0===window?void 0:window.document;if(0===t.button){v.isStopPropagation&&t.stopPropagation(),v.isStartDragging=!0,v.startX=t.clientX,v.startY=t.clientY,o.addEventListener("mousemove",v.handleMouseMove,!1),o.addEventListener("mouseup",v.handleMouseUp,!1);var r=null===(e=v.model)||void 0===e?void 0:e.getData();null===(n=v.eventCenter)||void 0===n||n.emit(Sh["".concat(v.eventType,"_MOUSEDOWN")],{e:t,data:v.data||r}),v.startTime=(new Date).getTime()}},this.handleMouseMove=function(t){var e,n;if(v.isStopPropagation&&t.stopPropagation(),v.isStartDragging&&(v.sumDeltaX+=t.clientX-v.startX,v.sumDeltaY+=t.clientY-v.startY,v.startX=t.clientX,v.startY=t.clientY,v.step<=1||Math.abs(v.sumDeltaX)>v.step||Math.abs(v.sumDeltaY)>v.step)){var o=v.sumDeltaX%v.step,r=v.sumDeltaY%v.step,i=v.sumDeltaX-o,a=v.sumDeltaY-r;v.sumDeltaX=o,v.sumDeltaY=r;var s=null===(e=v.model)||void 0===e?void 0:e.getData();v.isDragging||(null===(n=v.eventCenter)||void 0===n||n.emit(Sh["".concat(v.eventType,"_DRAGSTART")],{e:t,data:v.data||s}),v.onDragStart({event:t})),v.isDragging=!0,Promise.resolve().then(function(){var e,n;v.onDragging({deltaX:i,deltaY:a,event:t}),null===(e=v.eventCenter)||void 0===e||e.emit(Sh["".concat(v.eventType,"_MOUSEMOVE")],{deltaX:i,deltaY:a,e:t,data:v.data||s}),null===(n=v.eventCenter)||void 0===n||n.emit(Sh["".concat(v.eventType,"_DRAG")],{e:t,data:v.data||s})})}},this.handleMouseUp=function(t){var e=window.document;v.isStartDragging=!1,v.isStopPropagation&&t.stopPropagation(),Promise.resolve().then(function(){var n,o,r;e.removeEventListener("mousemove",v.handleMouseMove,!1),e.removeEventListener("mouseup",v.handleMouseUp,!1);var i=null===(n=v.model)||void 0===n?void 0:n.getData();null===(o=v.eventCenter)||void 0===o||o.emit(Sh["".concat(v.eventType,"_MOUSEUP")],{e:t,data:v.data||i}),v.isDragging&&(v.isDragging=!1,v.onDragEnd({event:t}),null===(r=v.eventCenter)||void 0===r||r.emit(Sh["".concat(v.eventType,"_DROP")],{e:t,data:v.data||i}))})},this.cancelDrag=function(){var t=null===window||void 0===window?void 0:window.document;t.removeEventListener("mousemove",v.handleMouseMove,!1),t.removeEventListener("mouseup",v.handleMouseUp,!1),v.onDragEnd({event:void 0}),v.isDragging=!1},this.destroy=function(){v.isStartDragging&&v.cancelDrag()},this.onDragStart=n,this.onDragging=r,this.onDragEnd=a,this.step=p,this.isStopPropagation=f,this.eventType=u,this.eventCenter=c,this.model=g,this.data=y}return t.prototype.setStep=function(t){this.step=t},t.prototype.setModel=function(t){this.model=t},t}(),Rh=function(t){return t.modelType===Eh.LINE_EDGE?function(t){var e=t.startPoint,n=t.endPoint,o=(e.x+n.x)/2,r=(e.y+n.y)/2,i=Math.abs(e.x-n.x)+10,a=Math.abs(e.y-n.y)+10;return{x:o-i/2,y:r-a/2,x1:o+i/2,y1:r+a/2}}(t):t.modelType===Eh.POLYLINE_EDGE?function(t){var e=t.points,n=sf(e),o=Uh(n,8),r=o.x,i=o.y,a=o.width,s=o.height;return{x:r-a/2,y:i-s/2,x1:r+a/2,y1:i+s/2}}(t):t.modelType===Eh.BEZIER_EDGE?function(t){var e=t.path,n=pf(e),o=Uh(n,8),r=o.x,i=o.y,a=o.width,s=o.height;return{x:r-a/2,y:i-s/2,x1:r+a/2,y1:i+s/2}}(t):void 0},Lh=function(t,e,n){var o=t.x,r=t.y,i=e.x,a=e.y,s=n.x,l=n.y,u=(l-a)/(s-i),c=a-u*i;return(o>=i&&o<=s||o<=i&&o>=s)&&(r>=a&&r<=l||r<=a&&r>=l)&&Math.abs(r-u*o-c)<Number.EPSILON},Ih=function(t){var e=t.start,n=t.end,o=t.offset,r=t.verticalLength,i=t.type,a={leftX:0,leftY:0,rightX:0,rightY:0},s=Math.atan((n.y-e.y)/(n.x-e.x)),l=Math.atan(o/r),u=Math.sqrt(r*r+o*o);return"start"===i?n.x>=e.x?(a.leftX=e.x+u*Math.sin(s+l),a.leftY=e.y-u*Math.cos(s+l),a.rightX=e.x-u*Math.sin(s-l),a.rightY=e.y+u*Math.cos(s-l)):(a.leftX=e.x-u*Math.sin(s+l),a.leftY=e.y+u*Math.cos(s+l),a.rightX=e.x+u*Math.sin(s-l),a.rightY=e.y-u*Math.cos(s-l)):"end"===i&&(n.x>=e.x?(a.leftX=n.x+u*Math.sin(s-l),a.leftY=n.y-u*Math.cos(s-l),a.rightX=n.x-u*Math.sin(s+l),a.rightY=n.y+u*Math.cos(s+l)):(a.leftX=n.x-u*Math.sin(s-l),a.leftY=n.y+u*Math.cos(s-l),a.rightX=n.x+u*Math.sin(s+l),a.rightY=n.y-u*Math.cos(s+l))),a},jh=function(){return jh=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},jh.apply(this,arguments)},Bh=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Hh=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},zh=function(t){var e=[],n={};return t.forEach(function(t){var e="".concat(t.x,"-").concat(t.y);t.id=e,n[e]=t}),Object.keys(n).forEach(function(t){e.push(n[t])}),e},Fh=function(t,e){return 0===t.width&&0===t.height?t:{x:t.x,y:t.y,centerX:t.centerX,centerY:t.centerY,minX:t.minX-e,minY:t.minY-e,maxX:t.maxX+e,maxY:t.maxY+e,height:t.height+2*e,width:t.width+2*e}},Wh=function(t,e,n){var o=function(t,e){var n=Math.abs(t.x-e.centerX),o=Math.abs(t.y-e.centerY);return n/e.width>o/e.height?Mh.HORIZONTAL:Mh.VERTICAL}(n,e);return o===Mh.HORIZONTAL?{x:n.x>t.centerX?t.maxX:t.minX,y:n.y}:{x:n.x,y:n.y>t.centerY?t.maxY:t.minY}},Xh=function(t,e){var n=Math.min(t.minX,e.minX),o=Math.min(t.minY,e.minY),r=Math.max(t.maxX,e.maxX),i=Math.max(t.maxY,e.maxY);return{x:(n+r)/2,y:(o+i)/2,centerX:(n+r)/2,centerY:(o+i)/2,minX:n,minY:o,maxX:r,maxY:i,height:i-o,width:r-n}},Uh=function(t,e){void 0===t&&(t=[]);var n=[],o=[];t.forEach(function(t){n.push(t.x),o.push(t.y)});var r=Math.min.apply(Math,Hh([],Bh(n),!1)),i=Math.max.apply(Math,Hh([],Bh(n),!1)),a=Math.min.apply(Math,Hh([],Bh(o),!1)),s=Math.max.apply(Math,Hh([],Bh(o),!1)),l=i-r,u=s-a;return e&&(l+=e,u+=e),{centerX:(r+i)/2,centerY:(a+s)/2,maxX:i,maxY:s,minX:r,minY:a,x:(r+i)/2,y:(a+s)/2,height:u,width:l}},Gh=function(t){var e=t.minX,n=t.minY,o=t.maxX,r=t.maxY;return[{x:e,y:n},{x:o,y:n},{x:o,y:r},{x:e,y:r}]},Yh=function(t,e){var n=t.x,o=t.y;return n<e.minX||n>e.maxX||o<e.minY||o>e.maxY},Vh=function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},Kh=function(t,e,n,o,r){return Vh(t,e)+Vh(t,n)+function(t,e){var n=0;return e.forEach(function(e){e&&(t.x===e.x&&(n+=-2),t.y===e.y&&(n+=-2))}),n}(t,[e,n,o,r])},qh=function(t,e,n,o,r){r||(r=0),t.unshift(e[o]),n[o]&&n[o]!==o&&r<=100&&qh(t,e,n,n[o],r+1)},Zh=function(t,e,n,o){var r=e.x-t.x,i=e.y-t.y,a=o.x-n.x,s=o.y-n.y,l=(-i*(t.x-n.x)+r*(t.y-n.y))/(-a*i+r*s),u=(a*(t.y-n.y)-s*(t.x-n.x))/(-a*i+r*s);return l>=0&&l<=1&&u>=0&&u<=1},$h=function(t,e,n){if(0===n.width&&0===n.height)return!1;var o=Bh(Gh(n),4),r=o[0],i=o[1],a=o[2],s=o[3];return Zh(t,e,r,i)||Zh(t,e,r,s)||Zh(t,e,i,a)||Zh(t,e,a,s)},Jh=function(t,e,n,o,r,i,a){var s=[],l=[e],u={},c={},d={};e.id&&(c[e.id]=0,d[e.id]=Kh(e,n,e));var p={};t.forEach(function(t){t.id&&(p[t.id]=t)});for(var h=function(){var h,f,g,y,v=1/0;if(l.forEach(function(t){t.id&&d[t.id]<v&&(v=d[t.id],h=t)}),h===n&&n.id){var m=[];return qh(m,p,u,n.id),{value:m}}if(!h)return{value:[e,n]};g=h,(y=(f=l).indexOf(g))>-1&&f.splice(y,1),s.push(h),function(t,e,n,o){var r=[];return t.forEach(function(t){t!==e&&(t.x!==e.x&&t.y!==e.y||$h(t,e,n)||$h(t,e,o)||r.push(t))}),zh(r)}(t,h,o,r).forEach(function(t){var o;if(-1===s.indexOf(t)&&(-1===l.indexOf(t)&&l.push(t),(null==h?void 0:h.id)&&(null==t?void 0:t.id))){var r=(null!==(o=c[h.id])&&void 0!==o?o:0)+Vh(h,t);if(c[t.id]&&r>=c[t.id])return;u[t.id]=h.id,c[t.id]=r,d[t.id]=c[t.id]+Kh(t,n,e,i,a)}})};l.length;){var f=h();if("object"==typeof f)return f.value}return[e,n]},Qh=function(t){return Wf(t)},tf=function(t){for(var e=1;e<t.length-1;){var n=t[e-1],o=t[e],r=t[e+1];n.x===o.x&&o.x===r.x||n.y===o.y&&o.y===r.y?t.splice(e,1):e++}return t},ef=function(t,e,n,o,r){var i,a,s=Qh(n),l=Qh(o),u=Fh(s,r),c=Fh(l,r),d=Wh(u,s,t),p=Wh(c,l,e);if(i=u,a=c,2*Math.abs(i.centerX-a.centerX)<i.width+a.width&&2*Math.abs(i.centerY-a.centerY)<i.height+a.height){var h=lf(t,e,d,p);return Hh(Hh([t,d],Bh(h),!1),[p,e],!1)}var f=Uh([d,p]),g=Xh(u,f),y=Xh(c,f),v=[];v=(v=v.concat(Gh(g))).concat(Gh(y));var m={x:(t.x+e.x)/2,y:(t.y+e.y)/2};[f,g,y].forEach(function(t){v=v.concat(function(t,e){return Hh(Hh([],Bh(function(t,e){return e<t.minX||e>t.maxX?[]:[{x:e,y:t.minY},{x:e,y:t.maxY}]}(t,e.x)),!1),Bh(function(t,e){return e<t.minY||e>t.maxY?[]:[{x:t.minX,y:e},{x:t.maxX,y:e}]}(t,e.y)),!1)}(t,m).filter(function(t){return Yh(t,u)&&Yh(t,c)}))}),[{x:d.x,y:p.y},{x:p.x,y:d.y}].forEach(function(t){Yh(t,u)&&Yh(t,c)&&v.push(t)}),v.unshift(d),v.push(p),v=zh(v);var b=Jh(v,d,p,s,l,t,e);return b.unshift(t),b.push(e),b.length>2&&(b=tf(b)),zh(b)},nf=function(t,e,n){var o=zf(t,n),r=zf(e,n);return o&&r},of=function(t,e,n){var o=zf(t,n),r=zf(e,n);return!(o&&r)&&(o||r)},rf=function(t,e,n){for(var o=void 0,r=Wf(n),i=Gh(r),a=0;a<i.length;a++){Zh(t,e,i[a],i[(a+1)%i.length])&&(o=[i[a],i[(a+1)%i.length]])}if(o)return function(t,e,n,o){var r=(e.y-t.y)*(o.x-n.x)-(t.x-e.x)*(n.y-o.y);if(0===r)return!1;var i=((e.x-t.x)*(o.x-n.x)*(n.y-t.y)+(e.y-t.y)*(o.x-n.x)*t.x-(o.y-n.y)*(e.x-t.x)*n.x)/r,a=-((e.y-t.y)*(o.y-n.y)*(n.x-t.x)+(e.x-t.x)*(o.y-n.y)*t.y-(o.x-n.x)*(e.y-t.y)*n.y)/r;return(i-t.x)*(i-e.x)<=0&&(a-t.y)*(a-e.y)<=0&&(i-n.x)*(i-o.x)<=0&&(a-n.y)*(a-o.y)<=0&&{x:i,y:a}}(t,e,o[0],o[1])},af=function(t,e){var n=void 0;return t.x===e.x?n=Mh.VERTICAL:t.y===e.y&&(n=Mh.HORIZONTAL),n},sf=function(t){var e=t.split(" "),n=[];return e&&e.forEach(function(t){var e=Bh(t.split(","),2),o=e[0],r=e[1];n.push({x:Number(o),y:Number(r)})}),n},lf=function(t,e,n,o){var r=[];if(af(t,n)===af(e,o))t.y===n.y?(r.push({x:n.x,y:(n.y+o.y)/2}),r.push({x:o.x,y:(n.y+o.y)/2})):(r.push({x:(n.x+o.x)/2,y:n.y}),r.push({x:(n.x+o.x)/2,y:o.y}));else{var i={x:n.x,y:o.y},a=Lh(i,t,n),s=Lh(i,e,o);if(a||s)i={x:o.x,y:n.y};else{var l=uf(i,t,n),u=uf(i,e,o);l&&u&&(i={x:o.x,y:n.y})}r.push(i)}return r},uf=function(t,e,n){return t.x===e.x&&t.x===n.x||t.y===e.y&&t.y===n.y},cf=function(t){if(!t)return 0;for(var e=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);t.match(/[A-Z]/)?e+=1.5:e+=o>=1&&o<=126||o>=65376&&o<=65439?1:2}return e},df=function(t){var e=t.start,n=t.end,o=t.sourceNode,r=t.targetNode,i=t.offset,a=Wf(o),s=Wf(r),l=Fh(a,i),u=Fh(s,i);return{sNext:Wh(l,a,e),ePre:Wh(u,s,n)}},pf=function(t){var e=t.replace(/M/g,"").replace(/C/g,",").split(",");return[hf(e[0]),hf(e[1]),hf(e[2]),hf(e[3])]},hf=function(t){var e=Bh(t.replace(/(^\s*)/g,"").split(" "),2);return{x:+e[0],y:+e[1]}},ff=function(t,e){var n=Bh(t,4),o=function(t,e,n,o,r){var i=function(r){if(r<0||r>1)throw new RangeError('The value range of parameter "t" is [0,1]');return{x:t.x*Math.pow(1-r,3)+3*e.x*r*Math.pow(1-r,2)+3*n.x*Math.pow(r,2)*(1-r)+o.x*Math.pow(r,3),y:t.y*Math.pow(1-r,3)+3*e.y*r*Math.pow(1-r,2)+3*n.y*Math.pow(r,2)*(1-r)+o.y*Math.pow(r,3)}},a=0,s=2,l=o.x,u=o.y,c=o;for(;a<r&&s<50;){var d=(c=i(1-s/kg)).x,p=c.y;a=Hf(l,u,d,p),s++}return c}(n[0],n[1],n[2],n[3],e);return[o,t[3]]},gf=function(t,e){for(var n,o=t.x,r=t.y,i=sf(e),a=Number.MAX_SAFE_INTEGER,s=[],l=0;l<i.length;l++)s.push({start:i[l],end:i[(l+1)%i.length]});if(s.forEach(function(t){var e=t.start,i=t.end;if(e.x===i.x){var s={x:e.x,y:r};if(Lh(s,e,i))(l=Math.abs(e.x-o))<a&&(a=l,n=s)}else if(e.y===i.y){var l;s={x:o,y:e.y};if(Lh(s,e,i))(l=Math.abs(e.y-r))<a&&(a=l,n=s)}}),!n){var u=s[0],c=u.start,d=u.end;n={x:c.x+(d.x-c.x)/2,y:c.y+(d.y-c.y)/2}}return n},yf=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))};var vf=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},mf=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};function bf(t,e,n){return n&&e*Math.round(t/e)||t}var _f=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},xf=function(t,e,n){var o=_f(t,2),r=o[0],i=o[1],a=_f(e,2),s=a[0],l=a[1],u=_f(n,2),c=u[0],d=u[1];return r>s&&r<c&&i>l&&i<d},Ef=function(t,e){var n=!1;switch(e.multipleSelectKey){case"meta":n=t.metaKey;break;case"alt":n=t.altKey;break;case"shift":n=t.shiftKey;break;case"ctrl":n=t.ctrlKey;break;default:n=!1}return n},wf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function Sf(t,e){return!!(t instanceof Cf&&e instanceof Cf)}var Of=function(t){function e(n,o,r){var i=t.call(this,3)||this;return i[0]=n,i[1]=o,i[2]=r,i.x=n,i.y=o,i.z=r,Object.setPrototypeOf(i,e.prototype),i}return wf(e,t),e.prototype.add=function(t){if(Sf(this,t))return new Cf(this.x+t.x,this.y+t.y);var e=this.z+t.z;return new Tf((this.x+t.x)/e,(this.y+t.y)/e)},e.prototype.subtract=function(t){if(Sf(this,t))return new Cf(this.x-t.x,this.y-t.y);var e=this.z-t.z;return 0===e?new Cf(this.x-t.x,this.y-t.y):new Tf((this.x-t.x)/e,(this.y-t.y)/e)},e}(Array),Cf=function(t){function e(n,o,r){var i=t.call(this,n,o,null!=r?r:0)||this;return Object.setPrototypeOf(i,e.prototype),i}return wf(e,t),e.prototype.toString=function(){return"Vector"},e.prototype.dot=function(t){var e=this;return t.reduce(function(t,n,o){return t+n*e[o]})},e.prototype.cross=function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},e.prototype.getLength=function(){return Math.hypot(this.x,this.y)},e.prototype.normalize=function(){var t=this.getLength();return new e(this.x/t,this.y/t)},e.prototype.crossZ=function(t){return this.x*t.y-this.y*t.x},e.prototype.angle=function(t){var e=this.crossZ(t),n=Math.acos(this.normalize().dot(t.normalize()));return e>=0?n:-n},e}(Of),Tf=function(t){function e(n,o){var r=t.call(this,n,o,1)||this;return Object.setPrototypeOf(r,e.prototype),r}return wf(e,t),e.prototype.toString=function(){return"Point"},e}(Of),Mf=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Nf=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Af=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},Pf=function(t){function e(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=t.call(this,n.length)||this;return r.fill(new Array(3)),n.forEach(function(t,e){r[e]=t}),r.columns=n[0].length,r.rows=n.length,Object.setPrototypeOf(r,e.prototype),r}return Mf(e,t),e.prototype.getRow=function(t){return this[t]},e.prototype.getColumn=function(t){return Af([],Nf(this.map(function(e){return e[t]})),!1)},e.prototype.transpose=function(){for(var t=[],n=0;n<this.columns;n++)t.push(this.getColumn(n));return new(e.bind.apply(e,Af([void 0],Nf(t),!1)))},e.prototype.cross=function(t){var n=new Array(this.rows).fill("").map(function(){return[]});if(this.columns===t.rows)for(var o=0;o<this.rows;o++)for(var r=this.getRow(o),i=function(e){var i=t.getColumn(e);n[o][e]=r.reduce(function(t,e,n){return t+e*i[n]},0)},a=0;a<t.columns;a++)i(a);return new(e.bind.apply(e,Af([void 0],Nf(n),!1)))},e.prototype.to2D=function(){return this.map(function(t){return[t[0],t[1]]})},e.prototype.toPoints=function(){return this.map(function(t){return new Tf(t[0],t[1])})},e.prototype.toString=function(){var t=Nf(this[0],2),e=t[0],n=t[1],o=Nf(this[1],2),r=o[0],i=o[1],a=Nf(this[2],2),s=a[0],l=a[1];return"matrix(".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(s," ").concat(l,")")},e.prototype.translate=function(t,e){return this.cross(new Rf(t,e))},e.prototype.rotate=function(t){return this.cross(new Df(t))},e.prototype.scale=function(t,e){return this.cross(new kf(t,e))},e}(Array),Df=function(t){function e(n){var o=t.call(this,new Cf(+Math.cos(n).toFixed(2),+Math.sin(n).toFixed(2),0),new Cf(-Math.sin(n).toFixed(2),+Math.cos(n).toFixed(2),0),new Cf(0,0,1))||this;return Object.setPrototypeOf(o,e.prototype),o}return Mf(e,t),e.prototype.inverse=function(){return this.transpose()},e}(Pf),kf=function(t){function e(n,o){var r=t.call(this,new Cf(n,0,0),new Cf(0,o,0),new Cf(0,0,1))||this;return r.sx=n,r.sy=o,Object.setPrototypeOf(r,e.prototype),r}return Mf(e,t),e.prototype.inverse=function(){return new e(1/this.sx,1/this.sy)},e}(Pf),Rf=function(t){function e(n,o){var r=t.call(this,new Cf(1,0,0),new Cf(0,1,0),new Cf(n,o,1))||this;return r.tx=n,r.ty=o,Object.setPrototypeOf(r,e.prototype),r}return Mf(e,t),e.prototype.inverse=function(){return new e(-this.tx,-this.ty)},e}(Pf);!function(t){var e,n,o=t.enforceActions,r=t.computedRequiresReaction,i=t.computedConfigurable,a=t.disableErrorBoundaries,s=t.reactionScheduler,l=t.reactionRequiresObservable,u=t.observableRequiresReaction;if((jc.pendingReactions.length||jc.inBatch||jc.isRunningReactions)&&pu("isolateGlobalState should be called before MobX is running any reactions"),Ic=!0,Lc&&(0===--kc().__mobxInstanceCount&&(kc().__mobxGlobals=void 0),jc=new Pc),void 0!==o){var c=void 0;switch(o){case!0:case"observed":c=!0;break;case!1:case"never":c=!1;break;case"strict":case"always":c="strict";break;default:pu("Invalid value for 'enforceActions': '"+o+"', expected 'never', 'always' or 'observed'")}jc.enforceActions=c,jc.allowStateChanges=!0!==c&&"strict"!==c}void 0!==r&&(jc.computedRequiresReaction=!!r),void 0!==l&&(jc.reactionRequiresObservable=!!l),void 0!==u&&(jc.observableRequiresReaction=!!u,jc.allowStateReads=!jc.observableRequiresReaction),void 0!==i&&(jc.computedConfigurable=!!i),void 0!==a&&(!0===a&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."),jc.disableErrorBoundaries=!!a),s&&(e=s,n=qc,qc=function(t){return e(function(){return n(t)})})}({});var Lf=function(){return Lf=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Lf.apply(this,arguments)},If=function(t){return t.anchors},jf=function(t,e){for(var n,o=e.nodes,r=o.length-1;r>=0;r--){var i=o[r];if(Ff(t,i)){var a=i.getTargetAnchor(t);if(a){var s={node:i,anchorIndex:a.index,anchor:a.anchor};n&&!Bf(i,n.node,e)||(n=s)}}}return n},Bf=function(t,e,n){return t.zIndex>e.zIndex||n.nodesMap[t.id].index>n.nodesMap[e.id].index},Hf=function(t,e,n,o){return Math.hypot(t-n,e-o)},zf=function(t,e,n){void 0===n&&(n=0);var o=!1,r=Wf(e),i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(new Pf([t.x,t.y,1]).translate(-e.x,-e.y).rotate(-e.rotate).translate(e.x,e.y)[0],2),a=i[0],s=i[1];return a>=r.minX-n&&a<=r.maxX+n&&s>=r.minY-n&&s<=r.maxY+n&&(o=!0),o},Ff=function(t,e){return zf(t,e,5)},Wf=function(t){var e=t.x,n=t.y,o=t.width,r=t.height;return{minX:e-o/2,minY:n-r/2,maxX:e+o/2,maxY:n+r/2,x:e,y:n,width:o,height:r,centerX:e,centerY:n}},Xf=function(t,e,n){var o,r=function(t){var e=t,n=e.x,o=e.y,r=e.width,i=e.height,a=e.radius;return[{x:n-r/2+a,y:o-i/2+a,r:a},{x:n+r/2-a,y:o-i/2+a,r:a},{x:n-r/2+a,y:o+i/2-a,r:a},{x:n+r/2-a,y:o+i/2-a,r:a}]}(n),i=Number.MAX_SAFE_INTEGER;return r.forEach(function(e){var n=Hf(t.x,t.y,e.x,e.y);n<i&&(i=n,o=e)}),Uf(t,e,o)},Uf=function(t,e,n){var o,r=n.x,i=n.y,a=n.r;if(e===Mh.HORIZONTAL){var s=r-Math.sqrt(a*a-(t.y-i)*(t.y-i)),l=r+Math.sqrt(a*a-(t.y-i)*(t.y-i));o={x:Math.abs(s-t.x)<Math.abs(l-t.x)?s:l,y:t.y}}else if(e===Mh.VERTICAL){var u=i-Math.sqrt(a*a-(t.x-r)*(t.x-r)),c=i+Math.sqrt(a*a-(t.x-r)*(t.x-r)),d=Math.abs(u-t.y)<Math.abs(c-t.y)?u:c;o={x:t.x,y:d}}return o},Gf=function(t,e){var n=e,o=!1,r=n.x,i=n.y,a=n.width,s=n.height,l=n.radius,u=r-a/2+l,c=r+a/2-l,d=i-s/2+l,p=i+s/2-l;return t.y===i+s/2||t.y===i-s/2?o=t.x>u&&t.x<c:t.x!==r+a/2&&t.x!==r-a/2||(o=t.y>d&&t.y<p),o},Yf=function(t,e,n){var o,r=n,i=r.x,a=r.y,s=r.rx,l=r.ry;if(e===Mh.HORIZONTAL){var u=i-Math.sqrt(s*s-(t.y-a)*(t.y-a)*s*s/(l*l)),c=i+Math.sqrt(s*s-(t.y-a)*(t.y-a)*s*s/(l*l));o={x:Math.abs(u-t.x)<Math.abs(c-t.x)?u:c,y:t.y}}else if(e===Mh.VERTICAL){var d=a-Math.sqrt(l*l-(t.x-i)*(t.x-i)*l*l/(s*s)),p=a+Math.sqrt(l*l-(t.x-i)*(t.x-i)*l*l/(s*s)),h=Math.abs(d-t.y)<Math.abs(p-t.y)?d:p;o={x:t.x,y:h}}return o},Vf=function(t,e,n){for(var o,r=n.pointsPosition,i=Number.MAX_SAFE_INTEGER,a=[],s=0;s<r.length;s++)a.push({start:r[s],end:r[(s+1)%r.length]});return a.forEach(function(n){var r=n.start,a=n.end,s=r,l=a;r.x>a.x&&(s=a,l=r);var u={x:t.x,y:t.y};if(s.x===l.x&&e===Mh.HORIZONTAL&&(u={x:s.x,y:t.y}),s.y===l.y&&e===Mh.VERTICAL&&(u={x:t.x,y:s.y}),s.x!==l.x&&s.y!==l.y){var c=(l.y-s.y)/(l.x-s.x),d=(s.x*l.y-l.x*s.y)/(s.x-l.x);e===Mh.HORIZONTAL?u={x:(t.y-d)/c,y:t.y}:e===Mh.VERTICAL&&(u={x:t.x,y:c*t.x+d})}if(Lh(u,r,a)){var p=Hf(u.x,u.y,t.x,t.y);p<i&&(i=p,o=u)}}),o},Kf=function(t,e,n,o){var r=t.x,i=t.y;return e.x>t.x?r=t.x+n/2:e.x<t.x&&(r=t.x-n/2),e.y>t.y?i=t.y+o/2:e.y<t.y&&(i=t.y-o/2),{x:r,y:i}},qf=function(t){var e=t.rows,n=t.style,o=t.rowsLength,r=t.className,i=document.createElement("div");i.className=r,i.style.fontSize="".concat(n.fontSize),i.style.width="".concat(n.width),i.style.lineHeight="".concat(n.lineHeight),i.style.padding="".concat(n.padding),n.fontFamily&&(i.style.fontFamily="".concat(n.fontFamily)),o>1?e.forEach(function(t){var e=document.createElement("div");e.textContent=t,i.appendChild(e)}):i.textContent=e[0],document.body.appendChild(i);var a=i.clientHeight;return document.body.removeChild(i),a},Zf=function(t){var e=t.rows,n=t.rowsLength,o=t.fontSize,r=0;return e&&e.forEach(function(t){var e=cf(t);r=e>r?e:r}),{width:Math.ceil(r/2)*o+o/4,height:n*(o+2)+o/4}},$f=function(t){return"object"!=typeof t?{isAllPass:!!t,msg:t?"":"不允许连接"}:t};let Jf;const Qf=new Uint8Array(16);function tg(){if(!Jf&&(Jf="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jf(Qf)}const eg=[];for(let Cw=0;Cw<256;++Cw)eg.push((Cw+256).toString(16).slice(1));const ng={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function og(t,e,n){if(ng.randomUUID&&!t)return ng.randomUUID();const o=(t=t||{}).random||(t.rng||tg)();return o[6]=15&o[6]|64,o[8]=63&o[8]|128,function(t,e=0){return eg[t[e+0]]+eg[t[e+1]]+eg[t[e+2]]+eg[t[e+3]]+"-"+eg[t[e+4]]+eg[t[e+5]]+"-"+eg[t[e+6]]+eg[t[e+7]]+"-"+eg[t[e+8]]+eg[t[e+9]]+"-"+eg[t[e+10]]+eg[t[e+11]]+eg[t[e+12]]+eg[t[e+13]]+eg[t[e+14]]+eg[t[e+15]]}(o)}var rg=function(){return og()},ig=new Map,ag=function(t){var e=rg();var n=window.requestAnimationFrame(function n(){if(t(),ig.get(e)){var o=window.requestAnimationFrame(n);ig.set(e,o)}});return ig.set(e,n),e},sg=function(t){var e=ig.get(t);e&&(window.cancelAnimationFrame(e),ig.delete(t))},lg=function(){return lg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},lg.apply(this,arguments)};function ug(t){var e=t.x,n=void 0===e?0:e,o=t.y,r=void 0===o?0:o,i=t.value,a=t.fontSize,s=void 0===a?12:a,l=t.fill,u=void 0===l?"currentColor":l,c=t.overflowMode,d=void 0===c?"default":c,p=t.textWidth,h=void 0===p?void 0:p,f=t.model,g={x:n,y:r,fill:u,fontSize:s,textAnchor:"middle",dominantBaseline:"central"};if($o(or(t),function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),n=e[0],o=e[1];"object"!=typeof o&&(g[n]=o)}),i){var y=String(i).split(/[\r\n]/g),v=y.length;if("default"!==d){var m=f.BaseType,b=f.modelType;if(m===_h.NODE&&b!==Eh.TEXT_NODE||m===_h.EDGE&&h)return function(t){var e=t.x,n=t.y,o=t.value,r=t.model,i=t.textWidth,a=t.fontSize,s=void 0===a?12:a,l=t.lineHeight,u=t.fontFamily,c=void 0===u?"":u,d=t.wrapPadding,p=void 0===d?"0, 0":d,h=t.overflowMode,f=r.width,g=r.height,y=r.textHeight,v=i||f,m=String(o).split(/[\r\n]/g),b=m.length,_=qf({rows:m,style:{fontSize:"".concat(s,"px"),width:"".concat(v,"px"),fontFamily:c,lineHeight:l,padding:p},rowsLength:b,className:"lf-get-text-height"}),x=g>_?g:_;y&&(x=y);var E="ellipsis"===h;E&&(x=s+2);return ph("g",{children:ph("foreignObject",{width:v,height:x,x:e-v/2,y:n-x/2,style:{overflow:"visible",textAlign:"left"},children:ph("div",{className:"lf-node-text-auto-wrap",style:{minHeight:x,width:v,padding:p},children:ph("div",{className:E?"lf-node-text-ellipsis-content":"lf-node-text-auto-wrap-content",title:E?m.join(""):"",style:lg({},t),children:m.map(function(t){return ph("div",{className:"lf-node-text--auto-wrap-inner",children:t})})})})})})}(t)}if(v>1){var _=y.map(function(t,e){return ph("tspan",{className:"lf-text-tspan",x:n,y:r+(e-(v-1)/2)*(s+2),children:t})});return ph("text",lg({},g,{children:_}))}return ph("text",lg({},g,{children:i}))}return null}var cg=function(){return cg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},cg.apply(this,arguments)};function dg(t){var e={x1:10,y1:10,x2:20,y2:20,stroke:"black"};return $o(or(t),function(t){var n=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),o=n[0],r=n[1];("style"===o||"object"!=typeof r)&&(e[o]=r)}),ph("line",cg({},e))}var pg=function(){return pg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},pg.apply(this,arguments)};function hg(t){var e=t.x,n=t.y,o=t.width,r=t.height,i=t.className,a=t.strokeWidth,s=t.radius,l=void 0===s?0:s,u=e-o/2,c=n-r/2,d={};return d["stroke-width"]=a,$o(or(t),function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),n=e[0],o=e[1];"object"!=typeof o&&(d[n]=o)}),d.className=i?"lf-basic-shape ".concat(i):"lf-basic-shape",l&&(d.rx=l,d.ry=l),d.x=u,d.y=c,ph("rect",pg({},d))}var fg=function(){return fg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},fg.apply(this,arguments)};function gg(t){var e={d:""};return $o(or(t),function(t){var n=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),o=n[0],r=n[1];"style"!==o&&"object"==typeof r||(e[o]=r)}),ph("path",fg({},e))}var yg=function(){return yg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},yg.apply(this,arguments)};function vg(t){var e=t.x,n=void 0===e?0:e,o=t.y,r=void 0===o?0:o,i=t.r,a=void 0===i?4:i,s=t.className,l={cx:n,cy:r,r:a,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return $o(or(t),function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),n=e[0],o=e[1];"object"!=typeof o&&(l[n]=o)}),l.className=s?"lf-basic-shape ".concat(s):"lf-basic-shape",ph("circle",yg({},l))}var mg=function(){return mg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},mg.apply(this,arguments)};function bg(t){var e=t.x,n=void 0===e?0:e,o=t.y,r=void 0===o?0:o,i=t.rx,a=void 0===i?4:i,s=t.ry,l=void 0===s?4:s,u=t.className,c={cx:n,cy:r,rx:a,ry:l,fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1};return $o(or(t),function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),n=e[0],o=e[1];"object"!=typeof o&&(c[n]=o)}),c.className=u?"lf-basic-shape ".concat(u):"lf-basic-shape",ph("ellipse",mg({},c))}var _g=function(){return _g=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},_g.apply(this,arguments)};function xg(t){var e=t.points,n=void 0===e?[]:e,o=t.className,r=t.radius,i={fill:"transparent",fillOpacity:1,strokeWidth:1,stroke:"#000",strokeOpacity:1,points:""};if($o(or(t),function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),n=e[0],o=e[1];"object"!=typeof o&&(i[n]=o)}),o?i.classNmae="lf-basic-shape ".concat(o):i.className="lf-basic-shape",r){var a=function(t,e){var n=t.map(function(t){return{x:t[0],y:t[1]}}),o=n.length;if(o<3)return"";for(var r=Math.abs(e),i="",a=0;a<o;a++){var s=n[(a-1+o)%o],l=n[a],u=n[(a+1)%o],c={x:l.x-s.x,y:l.y-s.y},d={x:u.x-l.x,y:u.y-l.y},p=Math.hypot(c.x,c.y),h=Math.hypot(d.x,d.y),f={x:c.x/p,y:c.y/p},g={x:d.x/h,y:d.y/h},y={x:l.x-f.x*r,y:l.y-f.y*r},v={x:l.x+g.x*r,y:l.y+g.y*r};i+=0===a?"M ".concat(y.x," ").concat(y.y," "):"L ".concat(y.x," ").concat(y.y," "),i+="Q ".concat(l.x," ").concat(l.y," ").concat(v.x," ").concat(v.y," ")}return i+"Z"}(n,r);return i.d=a,ph("path",_g({},i))}return i.points=n.map(function(t){return t.join(",")}).join(" "),ph("polygon",_g({},i))}var Eg=function(){return Eg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Eg.apply(this,arguments)};function wg(t){var e=t.className,n={points:"",fill:"none"};return $o(or(t),function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(t,2),o=e[0],r=e[1];("style"===o||"object"!=typeof r)&&(n[o]=r)}),e&&(n.className="".concat(e)),ph("polyline",Eg({},n))}var Sg,Og,Cg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Tg=function(){return Tg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Tg.apply(this,arguments)};(Og=Sg||(Sg={}))[Og.LEFT_TOP=0]="LEFT_TOP",Og[Og.RIGHT_TOP=1]="RIGHT_TOP",Og[Og.RIGHT_BOTTOM=2]="RIGHT_BOTTOM",Og[Og.LEFT_BOTTOM=3]="LEFT_BOTTOM";var Mg=function(t){function e(e){var n=t.call(this)||this;n.isShiftPressed=!1,n.bindKeyboardEvents=function(){document.addEventListener("keydown",n.handleKeyDown),document.addEventListener("keyup",n.handleKeyUp)},n.handleKeyDown=function(t){"Shift"===t.key&&(n.isShiftPressed=!0)},n.handleKeyUp=function(t){"Shift"===t.key&&(n.isShiftPressed=!1)},n.updateEdgePointByAnchors=function(){var t=n.nodeModel,e=t.id,o=t.anchors;$o(n.graphModel.getNodeEdges(e),function(t){if(t.sourceNodeId===e)(n=mr(o,function(e){return e.id===t.sourceAnchorId}))&&t.updateStartPoint({x:n.x,y:n.y});else if(t.targetNodeId===e){var n;(n=mr(o,function(e){return e.id===t.targetAnchorId}))&&t.updateEndPoint({x:n.x,y:n.y})}})},n.triggerResizeEvent=function(t,e,o,r,i,a){n.graphModel.eventCenter.emit(Sh.NODE_RESIZE,{preData:t,data:e,deltaX:o,deltaY:r,index:i,model:a})},n.recalcResizeInfo=function(t,e,n,o,r){void 0===n&&(n=1),void 0===o&&(o=!1),void 0===r&&(r=!1);var i=ne(e),a=i.deltaX,s=i.deltaY,l=i.width,u=i.height,c=i.PCTResizeInfo;if(c){var d=0,p=0;switch(t){case Sg.LEFT_TOP:p=(-1*a-s)/4;break;case Sg.RIGHT_TOP:p=(a-s)/4;break;case Sg.RIGHT_BOTTOM:p=(a+s)/4;break;case Sg.LEFT_BOTTOM:p=(-1*a+s)/4}0!==p&&(d=Math.round(p/c.ResizeBasis.basisHeight*1e5)/1e3),c.ResizePCT.widthPCT=Math.max(Math.min(c.ResizePCT.widthPCT+d,c.ScaleLimit.maxScaleLimit),c.ScaleLimit.minScaleLimit),c.ResizePCT.heightPCT=Math.max(Math.min(c.ResizePCT.heightPCT+d,c.ScaleLimit.maxScaleLimit),c.ScaleLimit.minScaleLimit);var h=Math.round(c.ResizePCT.widthPCT*c.ResizeBasis.basisWidth/100),f=Math.round(c.ResizePCT.heightPCT*c.ResizeBasis.basisHeight/100);switch(t){case Sg.LEFT_TOP:a=l-h,s=u-f;break;case Sg.RIGHT_TOP:a=h-l,s=u-f;break;case Sg.RIGHT_BOTTOM:a=h-l,s=f-u;break;case Sg.LEFT_BOTTOM:a=l-h,s=f-u}return i}switch(t){case Sg.LEFT_TOP:i.width=o?l:l-a*n,i.height=r?u:u-s*n;break;case Sg.RIGHT_TOP:i.width=o?l:l+a*n,i.height=r?u:u-s*n;break;case Sg.RIGHT_BOTTOM:i.width=o?l:l+a*n,i.height=r?u:u+s*n;break;case Sg.LEFT_BOTTOM:i.width=o?l:l-a*n,i.height=r?u:u+s*n}return i},n.resizeNode=function(t){var e=t.deltaX,o=t.deltaY,r=n.index,i=n.props,a=i.model,s=i.graphModel,l=i.x,u=i.y;Dg({x:l,y:u,deltaX:e,deltaY:o,index:r,nodeModel:a,graphModel:s,forceProportional:n.isShiftPressed,cancelCallback:function(){n.dragHandler.cancelDrag()}})},n.onDragStart=function(){n.graphModel.selectNodeById(n.nodeModel.id)},n.onDragging=function(t){var e=t.deltaX,o=t.deltaY,r=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(n.graphModel.transformModel.fixDeltaXY(e,o),2),i=r[0],a=r[1];n.resizeNode({deltaX:i,deltaY:a})},n.onDragEnd=function(){var t=n.nodeModel.x,e=n.nodeModel.y;n.nodeModel.moveTo(t,e),n.updateEdgePointByAnchors()};var o=e.index,r=e.model,i=e.graphModel;return n.index=o,n.nodeModel=r,n.graphModel=i,n.dragHandler=new kh({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:i.gridSize}),n.bindKeyboardEvents(),n}return Cg(e,t),e.prototype.componentWillUnmount=function(){this.dragHandler.destroy(),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("keyup",this.handleKeyUp)},e.prototype.render=function(){var t=this.props,e=t.x,n=t.y,o=t.direction,r=t.model.getResizeControlStyle(),i=r.width,a=r.height,s=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n}(r,["width","height"]);return ph("g",{className:"lf-resize-control lf-resize-control-".concat(o),children:[ph(hg,Tg({className:"lf-resize-control-content",x:e,y:n,width:null!=i?i:7,height:null!=a?a:7},s)),ph(hg,{className:"lf-resize-control-content",x:e,y:n,width:25,height:25,fill:"transparent",stroke:"transparent",onMouseDown:this.dragHandler.handleMouseDown})]})},e}(Xl),Ng=function(t){function e(){return t.call(this)||this}return Cg(e,t),e.prototype.getResizeControl=function(){var t=this.props,e=t.model,n=t.graphModel,o=Wf(e),r=o.minX,i=o.minY,a=o.maxX,s=o.maxY,l=[{index:Sg.LEFT_TOP,direction:"nw",x:r,y:i},{index:Sg.RIGHT_TOP,direction:"ne",x:a,y:i},{index:Sg.RIGHT_BOTTOM,direction:"se",x:a,y:s},{index:Sg.LEFT_BOTTOM,direction:"sw",x:r,y:s}];return at(l,function(t){return ph(Mg,Tg({},t,{model:e,graphModel:n}))})},e.prototype.getResizeOutline=function(){var t=this.props.model,e=t.x,n=t.y,o=t.width,r=t.height,i=t.getResizeOutlineStyle();return ph(hg,Tg({},i,{x:e,y:n,width:o,height:r}))},e.prototype.render=function(){return ph("g",{className:"lf-resize-control-group",children:[this.getResizeOutline(),this.getResizeControl()]})},e}(Xl);function Ag(t,e,n){var o=function(t){return t*Math.PI/180}(n),r=t.x-e.x,i=t.y-e.y;return{x:r*Math.cos(o)-i*Math.sin(o)+e.x,y:r*Math.sin(o)+i*Math.cos(o)+e.y}}function Pg(t,e,n,o,r,i,a,s,l){void 0===s&&(s=!1),void 0===l&&(l=!1);var u=e.deltaX,c=e.deltaY,d=e.width,p=e.height,h=n/Math.PI*180,f={x:i,y:a},g=Ag({x:o,y:r},f,h),y=function(t,e,n,o,r,i,a,s){void 0===r&&(r=!1),void 0===i&&(i=!1);var l,u,c,d,p={x:n.x-(t.x-n.x),y:n.y-(t.y-n.y)},h=(u=e,c=(l=p).x,d=l.y,{x:c+(u.x-c)/2,y:d+(u.y-d)/2}),f=Ag(e,h,-o),g=Ag(p,h,-o);if(r){var y=Math.abs(f.x-g.x)-a;h.x>f.x?h.x=h.x+y/2:h.x=h.x-y/2}if(i){var v=Math.abs(f.y-g.y)-s;h.y>f.y?h.y=h.y+v/2:h.y=h.y-v/2}if(r||i){var m=Ag(g,h,o),b=m.x-p.x,_=m.y-p.y;h.x=h.x-b,h.y=h.y-_,g=Ag(p,h,-o),f={x:h.x-(g.x-h.x),y:h.y-(g.y-h.y)}}var x=Math.abs(f.x-g.x),E=Math.abs(f.y-g.y);return r&&(x=a),i&&(E=s),{width:x,height:E,center:h}}(g,{x:g.x+u,y:g.y+c},f,h,s,l,d,p),v=y.width,m=y.height,b=y.center;return e.width=v*t,e.height=m*t,e.deltaX=2*(b.x-f.x),e.deltaY=2*(b.y-f.y),e}var Dg=function(t){var e=t.x,n=t.y,o=t.deltaX,r=t.deltaY,i=t.index,a=t.nodeModel,s=t.graphModel,l=t.cancelCallback,u=t.forceProportional,c=void 0!==u&&u,d=a.r,p=a.rx,h=a.ry,f=a.width,g=a.height,y=a.PCTResizeInfo,v=a.minWidth,m=a.minHeight,b=a.maxWidth,_=a.maxHeight,x=a.rotate,E=v===b,w=m===_,S=e,O=n,C=function(t,e,n,o,r,i,a,s,l,u,c){void 0===n&&(n=1),void 0===o&&(o=!1),void 0===r&&(r=!1),void 0===i&&(i=0),void 0===c&&(c=!1);var d=ne(e),p=d.deltaX,h=d.deltaY,f=d.width,g=d.height,y=d.PCTResizeInfo;if(y){var v=0,m=0;switch(t){case Sg.LEFT_TOP:m=(-1*p-h)/4;break;case Sg.RIGHT_TOP:m=(p-h)/4;break;case Sg.RIGHT_BOTTOM:m=(p+h)/4;break;case Sg.LEFT_BOTTOM:m=(-1*p+h)/4}0!==m&&(v=Math.round(m/y.ResizeBasis.basisHeight*1e5)/1e3),y.ResizePCT.widthPCT=Math.max(Math.min(y.ResizePCT.widthPCT+v,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit),y.ResizePCT.heightPCT=Math.max(Math.min(y.ResizePCT.heightPCT+v,y.ScaleLimit.maxScaleLimit),y.ScaleLimit.minScaleLimit);var b=Math.round(y.ResizePCT.widthPCT*y.ResizeBasis.basisWidth/100),_=Math.round(y.ResizePCT.heightPCT*y.ResizeBasis.basisHeight/100);switch(t){case Sg.LEFT_TOP:p=f-b,h=g-_;break;case Sg.RIGHT_TOP:p=b-f,h=g-_;break;case Sg.RIGHT_BOTTOM:p=b-f,h=_-g;break;case Sg.LEFT_BOTTOM:p=f-b,h=_-g}return d}if(i%(2*Math.PI)!=0&&void 0!==a&&void 0!==s)return Pg(n,d,i,a,s,l,u,o,r);if(c){var x=f/g,E=0,w=f,S=g;switch(t){case Sg.LEFT_TOP:E=Math.abs(p)>Math.abs(h)?-p:-h,x>=1?S=(w=f+E)/x:w=(S=g+E)*x,d.width=w,d.height=S,d.deltaX=f-w,d.deltaY=g-S;break;case Sg.RIGHT_TOP:E=Math.abs(p)>Math.abs(h)?p:-h,x>=1?S=(w=f+E)/x:w=(S=g-E)*x,d.width=w,d.height=S,d.deltaX=w-f,d.deltaY=g-S;break;case Sg.RIGHT_BOTTOM:E=Math.abs(p)>Math.abs(h)?p:h,x>=1?S=(w=f+E)/x:w=(S=g+E)*x,d.width=w,d.height=S,d.deltaX=w-f,d.deltaY=S-g;break;case Sg.LEFT_BOTTOM:E=Math.abs(p)>Math.abs(h)?-p:h,x>=1?S=(w=f-E)/x:w=(S=g+E)*x,d.width=w,d.height=S,d.deltaX=f-w,d.deltaY=S-g}return d}switch(t){case Sg.LEFT_TOP:d.width=o?f:f-p*n,d.height=r?g:g-h*n;break;case Sg.RIGHT_TOP:d.width=o?f:f+p*n,d.height=r?g:g-h*n;break;case Sg.RIGHT_BOTTOM:d.width=o?f:f+p*n,d.height=r?g:g+h*n;break;case Sg.LEFT_BOTTOM:d.width=o?f:f-p*n,d.height=r?g:g+h*n}return d}(i,{width:d||p||f,height:d||h||g,deltaX:o,deltaY:r,PCTResizeInfo:y},d||p&&h?.5:1,E,w,x,S,O,a.x,a.y,c);if(C.width<v||C.width>b||C.height<m||C.height>_)null==l||l();else{(x%(2*Math.PI)==0||y||void 0===S||void 0===O)&&(C.deltaX=E?0:C.deltaX,C.deltaY=w?0:C.deltaY);var T=a.getData(),M=a.resize(C);T.x===M.x&&T.y===M.y||(function(t,e){var n=t.id,o=t.anchors;$o(e.getNodeEdges(n),function(t){if(t.sourceNodeId===n)(e=mr(o,function(e){return e.id===t.sourceAnchorId}))&&t.updateStartPoint({x:e.x,y:e.y});else if(t.targetNodeId===n){var e;(e=mr(o,function(e){return e.id===t.targetAnchorId}))&&t.updateEndPoint({x:e.x,y:e.y})}})}(a,s),function(t,e,n,o,r,i,a){a.eventCenter.emit(Sh.NODE_RESIZE,{preData:t,data:e,deltaX:n,deltaY:o,index:r,model:i})}(T,M,o,r,i,a,s))}},kg=100,Rg={x:1,y:0};function Lg(t){var e=Math.hypot(t.x,t.y);return{x:t.x/e,y:t.y/e,z:0}}function Ig(t){return function(t,e){var n=function(t,e){return t.x*e.y-t.y*e.x}(t,e),o=Math.acos(function(t,e){var n=[t.x,t.y,t.z];return[e.x,e.y,e.z].reduce(function(t,e,o){return t+e*n[o]})}(Lg(t),Lg(e)));return n>=0?o:-o}(Rg,t)}var jg,Bg={baseNode:{fill:"#fff",stroke:"#000",strokeWidth:2},baseEdge:{stroke:"#000",strokeWidth:2},rect:{},circle:{},diamond:{},ellipse:{},polygon:{},text:{color:"#000",stroke:"none",fontSize:12,background:{fill:"transparent"}},anchor:{stroke:"#000",fill:"#fff",r:4,hover:{r:10,fill:"#949494",fillOpacity:.5,stroke:"#949494"}},anchorLine:{stroke:"#000",strokeWidth:2,strokeDasharray:"3,2"},nodeText:{color:"#000",overflowMode:"default",fontSize:12,lineHeight:1.2},edgeText:{textWidth:100,overflowMode:"default",fontSize:12,background:{fill:"#fff"}},line:{},polyline:{},bezier:{fill:"none",adjustLine:{stroke:"#949494"},adjustAnchor:{r:4,fill:"#949494",fillOpacity:1,stroke:"#949494"}},arrow:{offset:10,verticalLength:5},snapline:{stroke:"#949494",strokeWidth:1},edgeAdjust:{r:4,fill:"#fff",stroke:"#949494",strokeWidth:2},outline:{fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},edgeAnimation:{stroke:"red",strokeDasharray:"10,10",strokeDashoffset:"100%",animationName:"lf_animate_dash",animationDuration:"20s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"normal"},rotateControl:{stroke:"#000",fill:"#fff",strokeWidth:1.5},resizeControl:{width:7,height:7,fill:"#fff",stroke:"#000"},resizeOutline:{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},Hg={colorful:{rect:{fill:"#72CBFF",stroke:"#3ABDF9",radius:8},circle:{fill:"#FFE075",stroke:"#F9CE3A",radius:8},ellipse:{fill:"#FFA8A8",stroke:"#FF6B66",radius:8},text:{fill:"#72CBFF",radius:8},diamond:{fill:"#96F7AF",stroke:"#40EF7E",radius:8},polygon:{fill:"#E0A8FF",stroke:"#C271FF",radius:8},polyline:{radius:8},arrow:{strokeLinecap:"round",strokeLinejoin:"round",offset:10,verticalLength:5},snapline:{strokeLinecap:"round",strokeLinejoin:"round",stroke:"#949494",strokeWidth:1},outline:{radius:8,fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},resizeOutline:{radius:8,fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},dark:{baseNode:{fill:"#23272e",stroke:"#fefeff"},baseEdge:{stroke:"#fefeff"},rect:{radius:8},diamond:{radius:8},polygon:{radius:8},polyline:{radius:8},nodeText:{color:"#fefeff",overflowMode:"default",fontSize:12,lineHeight:1.2},arrow:{strokeLinecap:"round",strokeLinejoin:"round",offset:10,verticalLength:5},snapline:{strokeLinecap:"round",strokeLinejoin:"round",stroke:"#949494",strokeWidth:1},outline:{radius:8,fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},resizeOutline:{radius:8,fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},radius:{rect:{radius:8},diamond:{radius:8},polygon:{radius:8},polyline:{radius:8},arrow:{strokeLinecap:"round",strokeLinejoin:"round",offset:10,verticalLength:5},snapline:{strokeLinecap:"round",strokeLinejoin:"round",stroke:"#949494",strokeWidth:1},outline:{radius:8,fill:"transparent",stroke:"#949494",strokeDasharray:"3,3",hover:{stroke:"#949494"}},resizeOutline:{radius:8,fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},default:Bg},zg={background:"#ffffff"},Fg={colorful:{background:"#fefeff"},dark:{background:"#23272e"},radius:zg,default:zg},Wg={color:"#acacac",thickness:1},Xg={colorful:{color:"#dadada",thickness:1},dark:{color:"#66676a",thickness:1},radius:Wg,default:Wg},Ug=function(t,e){var n=ne(Bg);return e&&(n=de(n,Hg[e])),t&&(n=de(n,t)),n},Gg=Ug,Yg=1e3,Vg=999,Kg=function(){return++Yg},qg=function(){return qg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},qg.apply(this,arguments)},Zg=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},$g=function(){function t(t,e){var n;this.BaseType=_h.EDGE,this.id="",this.type="",this.sourceNodeId="",this.targetNodeId="",this.textMode=Ah.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this.points="",this.pointsList=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.isAnimation=!1,this.isShowAdjustPoint=!1,this.zIndex=0,this.state=mh.DEFAULT,this.modelType=Eh.EDGE,this.customTextPosition=!1,this.style={},this.arrowConfig={markerEnd:"url(#marker-end-".concat(this.id,")"),markerStart:"url(#marker-start-".concat(this.id,")")},this.graphModel=e,this.properties=null!==(n=t.properties)&&void 0!==n?n:{},this.initEdgeData(t),this.setAttributes()}return t.prototype.initEdgeData=function(t){var e=this;if(t.properties||(t.properties={}),!t.id){var n=this.graphModel.idGenerator,o=n&&n(t.type),r=this.createId();t.id=r||o||rg()}this.arrowConfig.markerEnd="url(#marker-end-".concat(t.id,")"),this.arrowConfig.markerStart="url(#marker-start-".concat(t.id,")");var i=this.graphModel.editConfigModel.adjustEdgeStartAndEnd;this.isShowAdjustPoint=i,sn(this,function(t){return he(t,["id","type","sourceNodeId","sourceAnchorId","targetNodeId","targetAnchorId","pointsList","startPoint","endPoint","properties"])}(t));var a=this.graphModel,s=a.overlapMode,l=a.eventCenter;this.updateZIndexByOverlap(s,t.zIndex||Kg()),this.setAnchors(),this.initPoints(),this.formatText(t),l.on("overlap:change",function(t){var n=t.overlapMode;e.updateZIndexByOverlap(n,e.zIndex||Kg())})},t.prototype.setAttributes=function(){},t.prototype.createId=function(){return null},t.prototype.getEdgeStyle=function(){return qg(qg({},this.graphModel.theme.baseEdge),this.style)},t.prototype.getAdjustPointStyle=function(){return qg({},this.graphModel.theme.edgeAdjust)},t.prototype.getTextStyle=function(){var t=this.graphModel.theme.edgeText;return ne(t)},t.prototype.getEdgeAnimationStyle=function(){var t=this.graphModel.theme.edgeAnimation;return ne(t)},t.prototype.getArrowStyle=function(){var t=this.getEdgeStyle(),e=this.getEdgeAnimationStyle(),n=this.graphModel.theme.arrow,o=this.isAnimation?e.stroke:t.stroke;return qg(qg(qg({},t),{fill:o,stroke:o}),n)},t.prototype.getOutlineStyle=function(){var t=this.graphModel.theme.outline;return ne(t)},t.prototype.getTextPosition=function(){return{x:0,y:0}},Object.defineProperty(t.prototype,"sourceNode",{get:function(){var t,e;return null===(e=null===(t=this.graphModel)||void 0===t?void 0:t.nodesMap[this.sourceNodeId])||void 0===e?void 0:e.model},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetNode",{get:function(){var t,e;return null===(e=null===(t=this.graphModel)||void 0===t?void 0:t.nodesMap[this.targetNodeId])||void 0===e?void 0:e.model},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textPosition",{get:function(){return this.getTextPosition()},enumerable:!1,configurable:!0}),t.prototype.getBeginAnchor=function(t,e,n){var o,r,i=If(t);if(n){if(o=mr(i,function(t){return t.id===n}))return o;console.warn("未在节点上找到指定的起点锚点".concat(n,"，已使用默认锚点作为起点"))}return i.forEach(function(t){var n=yf(t,e);(void 0===r||n<r)&&(r=n,o=t)}),o},t.prototype.getEndAnchor=function(t,e){var n,o,r=this,i=If(t);if(e){if(n=mr(i,function(t){return t.id===e}))return n;console.warn("未在节点上找到指定的终点锚点".concat(e,"，已使用默认锚点作为终点"))}return i.forEach(function(t){if(r.startPoint){var e=yf(t,r.startPoint);(void 0===o||e<o)&&(o=e,n=t)}}),n},t.prototype.getProperties=function(){return xd(this.properties)},t.prototype.getData=function(){var t=this.properties;fd(t)&&(t=xd(t));var e={id:this.id,type:this.type,properties:t,sourceNodeId:this.sourceNodeId,targetNodeId:this.targetNodeId,sourceAnchorId:this.sourceAnchorId,targetAnchorId:this.targetAnchorId,startPoint:sn({},this.startPoint),endPoint:sn({},this.endPoint)};[Ch.INCREASE,Ch.STATIC].includes(this.graphModel.overlapMode)&&(e.zIndex=this.zIndex);var n=this.text,o=n.x,r=n.y,i=n.value;return i&&(e.text={x:o,y:r,value:i}),e},t.prototype.getHistoryData=function(){return this.getData()},t.prototype.setProperty=function(t,e){yd(this.properties,t,vh(e)),this.setAttributes()},t.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},t.prototype.setProperties=function(t){this.properties=qg(qg({},xd(this.properties)),vh(t)),this.setAttributes()},t.prototype.changeEdgeId=function(t){var e=this.arrowConfig,n=e.markerEnd,o=e.markerStart;o&&o==="url(#marker-start-".concat(this.id,")")&&(this.arrowConfig.markerStart="url(#marker-start-".concat(t,")")),n&&n==="url(#marker-end-".concat(this.id,")")&&(this.arrowConfig.markerEnd="url(#marker-end-".concat(t,")")),this.id=t},t.prototype.setStyle=function(t,e){var n;this.style=qg(qg({},this.style),((n={})[t]=vh(e),n))},t.prototype.setStyles=function(t){this.style=qg(qg({},this.style),vh(t))},t.prototype.updateStyles=function(t){this.style=qg({},vh(t))},t.prototype.setTextMode=function(t){this.textMode=t},t.prototype.formatText=function(t){var e,n,o,r=this.graphModel.editConfigModel,i=r.edgeTextDraggable,a=r.edgeTextEdit,s=this.textPosition,l=s.x,u=s.y,c=t.text,d={value:"",x:l,y:u,draggable:i,editable:a};c&&("string"==typeof c?d=qg(qg({},d),{value:c}):(d=qg(qg({},d),{x:null!==(e=c.x)&&void 0!==e?e:l,y:null!==(n=c.y)&&void 0!==n?n:u,value:null!==(o=c.value)&&void 0!==o?o:""}),ue(c.draggable)||(d.draggable=c.draggable),ue(c.editable)||(d.editable=c.editable))),this.text=d},t.prototype.resetTextPosition=function(){var t=this.textPosition,e=t.x,n=t.y;this.text.x=e,this.text.y=n},t.prototype.moveText=function(t,e){var n=this.text,o=n.x,r=n.y,i=n.value,a=n.draggable,s=n.editable;this.text={value:i,editable:s,draggable:a,x:o+t,y:r+e}},t.prototype.setText=function(t){t&&sn(this.text,t)},t.prototype.updateText=function(t){this.text=qg(qg({},xd(this.text)),{value:t})},t.prototype.setAnchors=function(){if(!this.sourceAnchorId||!this.startPoint){if(!(t=this.getBeginAnchor(this.sourceNode,this.targetNode,this.sourceAnchorId)))throw new Error("无法获取beginAnchor，请检查anchors相关逻辑，anchors不能为空");this.startPoint||(this.startPoint={x:t.x,y:t.y}),this.sourceAnchorId||(this.sourceAnchorId=t.id)}if(!this.targetAnchorId||!this.endPoint){var t;if(!(t=this.getEndAnchor(this.targetNode,this.targetAnchorId)))throw new Error("无法获取endAnchor，请检查anchors相关逻辑，anchors不能为空");this.endPoint||(this.endPoint={x:t.x,y:t.y}),this.targetAnchorId||(this.targetAnchorId=t.id)}},t.prototype.setSelected=function(t){void 0===t&&(t=!0),this.isSelected=t},t.prototype.setHovered=function(t){void 0===t&&(t=!0),this.isHovered=t},t.prototype.setHitable=function(t){void 0===t&&(t=!0),this.isHitable=t},t.prototype.setHittable=function(t){void 0===t&&(t=!0),this.isHittable=t},t.prototype.openEdgeAnimation=function(){this.isAnimation=!0},t.prototype.closeEdgeAnimation=function(){this.isAnimation=!1},t.prototype.setElementState=function(t,e){this.state=t,this.additionStateData=e},t.prototype.updateStartPoint=function(t){this.startPoint=t},t.prototype.moveStartPoint=function(t,e){this.startPoint&&(this.startPoint.x+=t,this.startPoint.y+=e)},t.prototype.updateEndPoint=function(t){this.endPoint=t},t.prototype.moveEndPoint=function(t,e){this.endPoint&&(this.endPoint.x+=t,this.endPoint.y+=e)},t.prototype.setZIndex=function(t){void 0===t&&(t=0),this.zIndex=t},t.prototype.initPoints=function(){},t.prototype.updateAttributes=function(t){sn(this,t)},t.prototype.getAdjustStart=function(){return this.startPoint},t.prototype.getAdjustEnd=function(){return this.endPoint},t.prototype.updateAfterAdjustStartAndEnd=function(t){var e=t.startPoint,n=t.endPoint;this.updateStartPoint({x:e.x,y:e.y}),this.updateEndPoint({x:n.x,y:n.y})},t.prototype.updateZIndexByOverlap=function(t,e){switch(t){case Ch.DEFAULT:this.zIndex=0;break;case Ch.EDGE_TOP:this.zIndex=1;break;case Ch.INCREASE:this.zIndex=e}},t.BaseType=_h.EDGE,Zg([Qu],t.prototype,"type",void 0),Zg([Qu],t.prototype,"sourceNodeId",void 0),Zg([Qu],t.prototype,"targetNodeId",void 0),Zg([Qu],t.prototype,"startPoint",void 0),Zg([Qu],t.prototype,"endPoint",void 0),Zg([Qu],t.prototype,"textMode",void 0),Zg([Qu],t.prototype,"text",void 0),Zg([Qu],t.prototype,"properties",void 0),Zg([Qu],t.prototype,"points",void 0),Zg([Qu],t.prototype,"pointsList",void 0),Zg([Qu],t.prototype,"isSelected",void 0),Zg([Qu],t.prototype,"isHovered",void 0),Zg([Qu],t.prototype,"isHitable",void 0),Zg([Qu],t.prototype,"isHittable",void 0),Zg([Qu],t.prototype,"draggable",void 0),Zg([Qu],t.prototype,"visible",void 0),Zg([Qu],t.prototype,"isAnimation",void 0),Zg([Qu],t.prototype,"isShowAdjustPoint",void 0),Zg([Qu],t.prototype,"zIndex",void 0),Zg([Qu],t.prototype,"state",void 0),Zg([Qu],t.prototype,"style",void 0),Zg([Qu],t.prototype,"arrowConfig",void 0),Zg([sc],t.prototype,"sourceNode",null),Zg([sc],t.prototype,"targetNode",null),Zg([sc],t.prototype,"textPosition",null),Zg([ed],t.prototype,"setProperty",null),Zg([ed],t.prototype,"deleteProperty",null),Zg([ed],t.prototype,"setProperties",null),Zg([ed],t.prototype,"changeEdgeId",null),Zg([ed],t.prototype,"setStyle",null),Zg([ed],t.prototype,"setStyles",null),Zg([ed],t.prototype,"updateStyles",null),Zg([ed],t.prototype,"setTextMode",null),Zg([ed],t.prototype,"formatText",null),Zg([ed],t.prototype,"resetTextPosition",null),Zg([ed],t.prototype,"moveText",null),Zg([ed],t.prototype,"setText",null),Zg([ed],t.prototype,"updateText",null),Zg([ed],t.prototype,"setAnchors",null),Zg([ed],t.prototype,"setSelected",null),Zg([ed],t.prototype,"setHovered",null),Zg([ed],t.prototype,"setHitable",null),Zg([ed],t.prototype,"setHittable",null),Zg([ed],t.prototype,"openEdgeAnimation",null),Zg([ed],t.prototype,"closeEdgeAnimation",null),Zg([ed],t.prototype,"setElementState",null),Zg([ed],t.prototype,"updateStartPoint",null),Zg([ed],t.prototype,"moveStartPoint",null),Zg([ed],t.prototype,"updateEndPoint",null),Zg([ed],t.prototype,"moveEndPoint",null),Zg([ed],t.prototype,"setZIndex",null),Zg([ed],t.prototype,"initPoints",null),Zg([ed],t.prototype,"updateAttributes",null),Zg([ed],t.prototype,"getAdjustStart",null),Zg([ed],t.prototype,"getAdjustEnd",null),Zg([ed],t.prototype,"updateAfterAdjustStartAndEnd",null),Zg([ed],t.prototype,"updateZIndexByOverlap",null),t}(),Jg=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qg=function(){return Qg=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Qg.apply(this,arguments)},ty=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},ey=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},ny=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.modelType=Eh.BEZIER_EDGE,o.path="",o.initEdgeData(e),o.setAttributes(),o}return Jg(e,t),e.prototype.initEdgeData=function(e){this.offset=O(e,"properties.offset",100),t.prototype.initEdgeData.call(this,e)},e.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.bezier,n=t.prototype.getEdgeStyle.call(this),o=this.properties.style,r=void 0===o?{}:o;return Qg(Qg(Qg({},n),ne(e)),ne(r))},e.prototype.getTextPosition=function(){if(this.pointsList&&this.pointsList.length>0){var t=0,e=0;return this.pointsList.forEach(function(n){var o=n.x,r=n.y;t+=o,e+=r}),{x:t/this.pointsList.length,y:e/this.pointsList.length}}return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},e.prototype.getData=function(){var e=t.prototype.getData.call(this),n=this.pointsList.map(function(t){return{x:t.x,y:t.y}});return Qg(Qg({},e),{pointsList:n})},e.prototype.getControls=function(){var t=this.startPoint,e=this.endPoint;return df({start:t,end:e,sourceNode:this.sourceNode,targetNode:this.targetNode,offset:this.offset})},e.prototype.getPath=function(t){var e=ey(t,4),n=e[0],o=e[1],r=e[2],i=e[3];return"M ".concat(n.x," ").concat(n.y,"\n    C ").concat(o.x," ").concat(o.y,",\n    ").concat(r.x," ").concat(r.y,",\n    ").concat(i.x," ").concat(i.y)},e.prototype.initPoints=function(){this.pointsList.length>0?this.path=this.getPath(this.pointsList):this.updatePoints()},e.prototype.updatePoints=function(){var t=this.getControls(),e=t.sNext,n=t.ePre;this.updatePath(e,n)},e.prototype.updatePath=function(t,e){t=ne(t),e=ne(e);var n={x:this.startPoint.x,y:this.startPoint.y},o={x:this.endPoint.x,y:this.endPoint.y};if(!t||!e){var r=this.getControls();t=r.sNext,e=r.ePre}this.pointsList=[n,t,e,o],this.path=this.getPath(this.pointsList)},e.prototype.updateStartPoint=function(t){this.startPoint=Object.assign({},t),this.updatePoints()},e.prototype.updateEndPoint=function(t){this.endPoint=Object.assign({},t),this.updatePoints()},e.prototype.moveStartPoint=function(t,e){this.startPoint.x+=t,this.startPoint.y+=e;var n=ey(this.pointsList,3),o=n[1],r=n[2];o.x+=t,o.y+=e,this.updatePath(o,r)},e.prototype.moveEndPoint=function(t,e){this.endPoint.x+=t,this.endPoint.y+=e;var n=ey(this.pointsList,3),o=n[1],r=n[2];r.x+=t,r.y+=e,this.updatePath(o,r)},e.prototype.updateAdjustAnchor=function(t,e){var n;"sNext"===e?this.pointsList[1]=t:"ePre"===e&&(this.pointsList[2]=t),this.path=this.getPath(this.pointsList),(null===(n=this.text)||void 0===n?void 0:n.value)&&this.setText(sn({},this.text,this.textPosition))},e.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},e.prototype.getAdjustEnd=function(){var t=this.pointsList;return t[t.length-1]||this.endPoint},e.prototype.updateAfterAdjustStartAndEnd=function(t){var e=t.startPoint,n=t.endPoint,o=t.sourceNode,r=t.targetNode,i=df({start:e,end:n,sourceNode:o,targetNode:r,offset:this.offset}),a=i.sNext,s=i.ePre;this.pointsList=[e,a,s,n],this.initPoints()},ty([Qu],e.prototype,"offset",void 0),ty([Qu],e.prototype,"path",void 0),ty([ed],e.prototype,"initPoints",null),ty([ed],e.prototype,"updatePoints",null),ty([ed],e.prototype,"updateStartPoint",null),ty([ed],e.prototype,"updateEndPoint",null),ty([ed],e.prototype,"moveStartPoint",null),ty([ed],e.prototype,"moveEndPoint",null),ty([ed],e.prototype,"updateAdjustAnchor",null),ty([ed],e.prototype,"getAdjustStart",null),ty([ed],e.prototype,"getAdjustEnd",null),ty([ed],e.prototype,"updateAfterAdjustStartAndEnd",null),e}($g),oy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ry=function(){return ry=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ry.apply(this,arguments)},iy=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},ay=function(t){function e(){var e=t.apply(this,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],iy(arguments),!1))||this;return e.modelType=Eh.LINE_EDGE,e}return oy(e,t),e.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.line,n=t.prototype.getEdgeStyle.call(this),o=this.properties.style,r=void 0===o?{}:o;return ry(ry(ry({},n),ne(e)),ne(r))},e.prototype.initEdgeData=function(e){t.prototype.initEdgeData.call(this,e),this.points=this.getPath([this.startPoint,this.endPoint])},e.prototype.getPath=function(t){var e=iy(t,2),n=e[0],o=e[1];return"".concat(n.x,",").concat(n.y," ").concat(o.x,",").concat(o.y)},e.prototype.getTextPosition=function(){return{x:(this.startPoint.x+this.endPoint.x)/2,y:(this.startPoint.y+this.endPoint.y)/2}},e}($g),sy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ly=function(){return ly=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ly.apply(this,arguments)},uy=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},cy=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},dy=function(t){function e(){var e=t.apply(this,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],cy(arguments),!1))||this;return e.modelType=Eh.POLYLINE_EDGE,e.draggingPointList=[],e}return sy(e,t),e.prototype.initEdgeData=function(e){var n=O(e,"properties.offset");if(this.offset="number"==typeof n?n:this.getDefaultOffset(),e.pointsList){var o=this.orthogonalizePath(e.pointsList);e.pointsList=o,this.pointsList=o}t.prototype.initEdgeData.call(this,e)},e.prototype.setAttributes=function(){var t=this.properties.offset;t&&t!==this.offset&&(this.offset=t,this.updatePoints())},e.prototype.orthogonalizePath=function(t){if(!Array.isArray(t)||t.length<2)return t;var e,n=function(t,e){var n=t[t.length-1];n&&n.x===e.x&&n.y===e.y||t.push({x:e.x,y:e.y})},o=function(t,e){return t.x===e.x||t.y===e.y},r=function(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)},i=[];n(i,t[0]);for(var a=0;a<t.length-1;a++){var s=i[i.length-1],l=t[a+1];if(s&&l)if(o(s,l))n(i,l),e=s.x===l.x?Mh.VERTICAL:Mh.HORIZONTAL;else{var u={x:l.x,y:s.y},c={x:s.x,y:l.y},d=e===Mh.VERTICAL?c:e===Mh.HORIZONTAL||r(s,u)<=r(s,c)?u:c;d.x===s.x&&d.y===s.y||n(i,d),n(i,l);var p=i[i.length-2],h=i[i.length-1];e=p&&h?p.x===h.x?Mh.VERTICAL:Mh.HORIZONTAL:e}}var f=[];for(a=0;a<i.length;a++){var g=i[a-1],y=i[a];l=i[a+1];g&&y&&l&&(g.x===y.x&&y.x===l.x||g.y===y.y&&y.y===l.y)||n(f,y)}return f.length>=2&&(f[0]={x:t[0].x,y:t[0].y},f[f.length-1]={x:t[t.length-1].x,y:t[t.length-1].y}),f.length<2||f.every(function(t,e,n){return 0===e||o(n[e-1],n[e])})?f:[{x:t[0].x,y:t[0].y},{x:t[t.length-1].x,y:t[t.length-1].y}]},e.prototype.getDefaultOffset=function(){var t=this.getArrowStyle();return("number"==typeof t.offset?t.offset:0)+5},e.prototype.getEdgeStyle=function(){var e=this.graphModel.theme.polyline,n=t.prototype.getEdgeStyle.call(this),o=this.properties.style,r=void 0===o?{}:o;return ly(ly(ly({},n),ne(e)),ne(r))},e.prototype.getTextPosition=function(){var t,e=null===(t=this.text)||void 0===t?void 0:t.value;if(this.dbClickPosition&&!e){var n=this.dbClickPosition;return{x:n.x,y:n.y}}var o=sf(this.points),r=cy(function(t){if(1===t.length){var e=Bh(t,1)[0];return[e,e]}for(var n=t[0],o=t[1],r=Hf(n.x,n.y,o.x,o.y),i=1;i<t.length-1;i++){var a=t[i],s=t[i+1],l=Hf(a.x,a.y,s.x,s.y);l>r&&(r=l,n=a,o=s)}return[n,o]}(o),2),i=r[0],a=r[1];return{x:(i.x+a.x)/2,y:(i.y+a.y)/2}},e.prototype.getAfterAnchor=function(t,e,n){var o,r;return n.forEach(function(n){var i;t===Mh.HORIZONTAL?i=Math.abs(e.y-n.y):t===Mh.VERTICAL&&(i=Math.abs(e.x-n.x)),(!r||r>i)&&(r=i,o=n)}),o},e.prototype.getCrossPoint=function(t,e,n){var o;return t===Mh.HORIZONTAL?o={x:n.x,y:e.y}:t===Mh.VERTICAL&&(o={x:e.x,y:n.y}),o},e.prototype.removeCrossPoints=function(t,e,n){var o=n.map(function(t){return t});if(1===t){var r=o[t],i=o[e],a=o[t-1];if(nf(a,r,this.sourceNode)){if(of(r,i,this.sourceNode))(s=rf(r,i,this.sourceNode))&&(o[t]=s,o.splice(t-1,1),t--,e--)}else this.sourceNode.anchors.forEach(function(e){(e.x===a.x&&e.x===r.x||e.y===a.y&&e.y===r.y)&&(Hf(e.x,e.y,r.x,r.y)<Hf(a.x,a.y,r.x,r.y)&&(o[t-1]=e))})}if(e===n.length-2){var s,l=o[t],u=o[e],c=o[e+1];if(nf(u,c,this.targetNode)){if(of(l,u,this.targetNode))(s=rf(l,u,this.targetNode))&&(o[e]=s,o.splice(e+1,1))}else this.targetNode.anchors.forEach(function(t){(t.x===c.x&&t.x===u.x||t.y===c.y&&t.y===u.y)&&(Hf(t.x,t.y,u.x,u.y)<Hf(c.x,c.y,u.x,u.y)&&(o[e+1]=t))})}return o},e.prototype.getDraggingPoints=function(t,e,n,o,r){var i=r.map(function(t){return t}),a=this.getAfterAnchor(t,n,o),s=this.getCrossPoint(t,n,a);return"start"===e?(i.unshift(s),i.unshift(a)):(i.push(s),i.push(a)),i},e.prototype.updateCrossPoints=function(t){var e=t.map(function(t){return t}),n=t[0],o=t[1],r=t[e.length-2],i=t[e.length-1],a=this.sourceNode,s=this.targetNode,l=a.modelType,u=s.modelType,c=af(n,o),d=e[0];switch(l){case Eh.RECT_NODE:if(0!==a.radius)Gf(n,a)||(d=Xf(n,c,a));break;case Eh.CIRCLE_NODE:d=Uf(n,c,a);break;case Eh.ELLIPSE_NODE:d=Yf(n,c,a);break;case Eh.DIAMOND_NODE:case Eh.POLYGON_NODE:d=Vf(n,c,a)}d&&(e[0]=d);var p=af(r,i),h=e[e.length-1];switch(u){case Eh.RECT_NODE:if(0!==s.radius)Gf(i,s)||(h=Xf(i,p,s));break;case Eh.CIRCLE_NODE:h=Uf(i,p,s);break;case Eh.ELLIPSE_NODE:h=Yf(i,p,s);break;case Eh.DIAMOND_NODE:case Eh.POLYGON_NODE:h=Vf(i,p,s)}return h&&(e[e.length-1]=h),e},e.prototype.updatePath=function(t){this.pointsList=this.orthogonalizePath(t),this.points=this.getPath(this.pointsList)},e.prototype.getData=function(){var e=t.prototype.getData.call(this),n=this.pointsList.map(function(t){return{x:t.x,y:t.y}});return Object.assign({},e,{pointsList:n})},e.prototype.getPath=function(t){return t.map(function(t){return"".concat(t.x,",").concat(t.y)}).join(" ")},e.prototype.initPoints=function(){this.pointsList.length>0?this.points=this.getPath(this.pointsList):this.updatePoints()},e.prototype.updatePoints=function(){var t=ef({x:this.startPoint.x,y:this.startPoint.y},{x:this.endPoint.x,y:this.endPoint.y},this.sourceNode,this.targetNode,this.offset||0);this.pointsList=this.orthogonalizePath(t),this.points=this.pointsList.map(function(t){return"".concat(t.x,",").concat(t.y)}).join(" ")},e.prototype.updateStartPoint=function(t){this.startPoint=Object.assign({},t),this.updatePoints()},e.prototype.moveStartPoint=function(t,e){this.startPoint.x+=t,this.startPoint.y+=e,this.updatePoints()},e.prototype.updateEndPoint=function(t){this.endPoint=Object.assign({},t),this.updatePoints()},e.prototype.moveEndPoint=function(t,e){this.endPoint.x+=t,this.endPoint.y+=e,this.updatePoints()},e.prototype.updatePointsList=function(t,e){this.pointsList.forEach(function(n){n.x+=t,n.y+=e});var n=this.pointsList[0];this.startPoint=Object.assign({},n);var o=this.pointsList[this.pointsList.length-1];this.endPoint=Object.assign({},o),this.initPoints()},e.prototype.dragAppendStart=function(){this.draggingPointList=this.pointsList.map(function(t){return t})},e.prototype.dragAppendSimple=function(t,e){var n;this.isDragging=!0;var o=t.start,r=t.end,i=t.startIndex,a=t.endIndex,s=t.direction,l=this.pointsList,u=l;return s===Mh.HORIZONTAL?(l[i]={x:o.x,y:o.y+e.y},l[a]={x:r.x,y:r.y+e.y},u=this.pointsList.map(function(t){return t})):s===Mh.VERTICAL&&(l[i]={x:o.x+e.x,y:o.y},l[a]={x:r.x+e.x,y:r.y},u=this.pointsList.map(function(t){return t})),this.updatePointsAfterDrag(u),this.draggingPointList=u,(null===(n=this.text)||void 0===n?void 0:n.value)&&this.setText(sn({},this.text,this.textPosition)),{start:sn({},l[i]),end:sn({},l[a]),startIndex:i,endIndex:a,direction:s}},e.prototype.dragAppend=function(t,e){var n;this.isDragging=!0;var o=t.start,r=t.end,i=t.startIndex,a=t.endIndex,s=t.direction,l=this.pointsList;if(s===Mh.HORIZONTAL){l[i]={x:o.x,y:o.y+e.y},l[a]={x:r.x,y:r.y+e.y};var u=this.pointsList.map(function(t){return t});if(0!==i&&a!==this.pointsList.length-1&&(u=this.removeCrossPoints(i,a,u)),0===i){var c={x:o.x,y:o.y+e.y};if(!zf(c,this.sourceNode)){var d=this.sourceNode.anchors;u=this.getDraggingPoints(s,"start",c,d,u)}}if(a===this.pointsList.length-1){var p={x:r.x,y:r.y+e.y};if(!zf(p,this.targetNode)){d=this.targetNode.anchors;u=this.getDraggingPoints(s,"end",p,d,u)}}this.updatePointsAfterDrag(u),this.draggingPointList=u}else if(s===Mh.VERTICAL){l[i]={x:o.x+e.x,y:o.y},l[a]={x:r.x+e.x,y:r.y};u=this.pointsList.map(function(t){return t});if(0!==i&&a!==this.pointsList.length-1&&(u=this.removeCrossPoints(i,a,u)),0===i){c={x:o.x+e.x,y:o.y};if(!zf(c,this.sourceNode)){d=this.sourceNode.anchors;u=this.getDraggingPoints(s,"start",c,d,u)}}if(a===this.pointsList.length-1){p={x:r.x+e.x,y:r.y};if(!zf(p,this.targetNode)){d=this.targetNode.anchors;u=this.getDraggingPoints(s,"end",p,d,u)}}this.updatePointsAfterDrag(u),this.draggingPointList=u}return(null===(n=this.text)||void 0===n?void 0:n.value)&&this.setText(sn({},this.text,this.textPosition)),{start:sn({},l[i]),end:sn({},l[a]),startIndex:i,endIndex:a,direction:s}},e.prototype.dragAppendEnd=function(){if(this.draggingPointList){var t=tf(sf(this.points));this.pointsList=t.map(function(t){return t}),this.draggingPointList=[];var e=t[0];this.startPoint=sn({},e);var n=t[t.length-1];this.endPoint=sn({},n)}this.isDragging=!1},e.prototype.updatePointsAfterDrag=function(t){var e=this.updateCrossPoints(t);this.points=e.map(function(t){return"".concat(t.x,",").concat(t.y)}).join(" ")},e.prototype.getAdjustStart=function(){return this.pointsList[0]||this.startPoint},e.prototype.getAdjustEnd=function(){var t=this.pointsList;return t[t.length-1]||this.endPoint},e.prototype.updateAfterAdjustStartAndEnd=function(t){var e=t.startPoint,n=t.endPoint,o=t.sourceNode,r=t.targetNode;this.pointsList=this.orthogonalizePath(ef({x:e.x,y:e.y},{x:n.x,y:n.y},o,r,this.offset||0)),this.initPoints()},uy([Qu],e.prototype,"offset",void 0),uy([Qu],e.prototype,"dbClickPosition",void 0),uy([ed],e.prototype,"initPoints",null),uy([ed],e.prototype,"updatePoints",null),uy([ed],e.prototype,"updateStartPoint",null),uy([ed],e.prototype,"moveStartPoint",null),uy([ed],e.prototype,"updateEndPoint",null),uy([ed],e.prototype,"moveEndPoint",null),uy([ed],e.prototype,"updatePointsList",null),uy([ed],e.prototype,"dragAppendStart",null),uy([ed],e.prototype,"dragAppendSimple",null),uy([ed],e.prototype,"dragAppend",null),uy([ed],e.prototype,"dragAppendEnd",null),uy([ed],e.prototype,"updatePointsAfterDrag",null),uy([ed],e.prototype,"getAdjustStart",null),uy([ed],e.prototype,"getAdjustEnd",null),uy([ed],e.prototype,"updateAfterAdjustStartAndEnd",null),e}($g),py=function(){return py=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},py.apply(this,arguments)},hy=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},fy=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gy=function(){function t(t,e){var n;this.BaseType=_h.NODE,this.id="",this.type="",this.x=0,this.y=0,this.textMode=Ah.TEXT,this.text={value:"",x:0,y:0,draggable:!1,editable:!0},this._width=100,this._height=80,this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.anchorsOffset=[],this.virtual=!1,this.isSelected=!1,this.isHovered=!1,this.isShowAnchor=!1,this.isDragging=!1,this.isHitable=!0,this.isHittable=!0,this.draggable=!0,this.visible=!0,this.rotatable=!0,this.resizable=!0,this.zIndex=1,this.state=mh.DEFAULT,this.autoToFront=!0,this.style={},this._rotate=0,this.modelType=Eh.NODE,this.additionStateData={},this.targetRules=[],this.sourceRules=[],this.moveRules=[],this.resizeRules=[],this.hasSetTargetRules=!1,this.hasSetSourceRules=!1,this.graphModel=e,this.properties=null!==(n=t.properties)&&void 0!==n?n:{},this.initNodeData(t),this.setAttributes()}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t;var e=this.x,n=void 0===e?0:e,o=this.y,r=void 0===o?0:o;this.transform=new Rf(-n,-r).rotate(t).translate(n,r).toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"incoming",{get:function(){return{nodes:this.graphModel.getNodeIncomingNode(this.id),edges:this.graphModel.getNodeIncomingEdge(this.id)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outgoing",{get:function(){return{nodes:this.graphModel.getNodeOutgoingNode(this.id),edges:this.graphModel.getNodeOutgoingEdge(this.id)}},enumerable:!1,configurable:!0}),t.prototype.initNodeData=function(t){var e=this;if(t.properties||(t.properties={}),!t.id){var n=this.graphModel.idGenerator,o=n&&n(t.type),r=this.createId();t.id=r||o||rg()}this.formatText(t),sn(this,function(t){return he(t,["id","type","x","y","text","label","properties","virtual","rotate","resizable","rotatable"])}(t));var i=this.graphModel,a=i.overlapMode,s=i.eventCenter;this.updateZIndexByOverlap(a,t.zIndex||Kg()),s.on("overlap:change",function(t){var n=t.overlapMode;e.updateZIndexByOverlap(n,e.zIndex||Kg())})},t.prototype.setAttributes=function(){},t.prototype.createId=function(){return null},t.prototype.setTextMode=function(t){this.textMode=t},t.prototype.formatText=function(t){var e,n,o,r=this.graphModel.editConfigModel,i=r.nodeTextDraggable,a=r.nodeTextEdit,s=t.x,l=t.y,u=t.text,c={value:"",x:s,y:l,draggable:i,editable:a};u&&("string"==typeof u?c.value=u:(c=py(py({},c),{x:null!==(e=u.x)&&void 0!==e?e:s,y:null!==(n=u.y)&&void 0!==n?n:l,value:null!==(o=u.value)&&void 0!==o?o:""}),ue(u.draggable)||(c.draggable=u.draggable),ue(u.editable)||(c.editable=u.editable))),t.text=c},t.prototype.resize=function(t){var e=t.width,n=t.height,o=t.deltaX,r=t.deltaY;return this.isAllowResizeNode(o,r,e,n)?(this.move(o/2,r/2),this.width=e,this.height=n,this.setProperties({width:e,height:n}),this.getData()):this.getData()},t.prototype.proportionalResize=function(){},t.prototype.getData=function(){var t=this.text,e=t.x,n=t.y,o=t.value,r=this.properties;fd(r)&&(r=xd(r)),ae(r.width)&&(r.width=this.width),ae(r.height)&&(r.height=this.height);var i={id:this.id,type:this.type,x:this.x,y:this.y,properties:r};return this.rotate&&(i.rotate=this.rotate),[Ch.INCREASE,Ch.STATIC].includes(this.graphModel.overlapMode)&&(i.zIndex=this.zIndex),o&&(i.text={x:e,y:n,value:o}),i},t.prototype.getHistoryData=function(){return this.getData()},t.prototype.getProperties=function(){return xd(this.properties)},t.prototype.getOuterGAttributes=function(){return{className:""}},t.prototype.getNodeStyle=function(){return py(py({},this.graphModel.theme.baseNode),this.style)},t.prototype.getTextStyle=function(){var t=this.graphModel.theme.nodeText,e=this.properties.textStyle,n=void 0===e?{}:e;return py(py({},ne(t)),ne(n))},t.prototype.getRotateControlStyle=function(){var t=this.graphModel.theme.rotateControl;return ne(t)},t.prototype.getResizeControlStyle=function(){var t=this.graphModel.theme.resizeControl;return ne(t)},t.prototype.getResizeOutlineStyle=function(){var t=this.graphModel.theme.resizeOutline;return ne(t)},t.prototype.getAnchorStyle=function(t){var e=this.graphModel.theme.anchor;return ne(e)},t.prototype.getAnchorLineStyle=function(t){var e=this.graphModel.theme.anchorLine;return ne(e)},t.prototype.getOutlineStyle=function(){var t=this.graphModel.theme.outline;return ne(t)},t.prototype.isAllowConnectedAsSource=function(t,e,n,o){var r=this.hasSetSourceRules?this.sourceRules:this.getConnectedSourceRules();this.hasSetSourceRules=!0;for(var i=!0,a="",s=0;s<r.length;s++){var l=r[s];if(!l.validate.call(this,this,t,e,n,o)){i=!1,a=l.message;break}}return{isAllPass:i,msg:a}},t.prototype.getConnectedSourceRules=function(){return this.sourceRules},t.prototype.isAllowConnectedAsTarget=function(t,e,n,o){var r=this.hasSetTargetRules?this.targetRules:this.getConnectedTargetRules();this.hasSetTargetRules=!0;for(var i=!0,a="",s=0;s<r.length;s++){var l=r[s];if(!l.validate.call(this,t,this,e,n,o)){i=!1,a=l.message;break}}return{isAllPass:i,msg:a}},t.prototype.isAllowMoveNode=function(t,e){var n,o,r=!0,i=!0,a=this.moveRules.concat(this.graphModel.nodeMoveRules);try{for(var s=fy(a),l=s.next();!l.done;l=s.next()){var u=(0,l.value)(this,t,e);if(!u)return!1;if("object"==typeof u){var c=u;if(!c.x&&!c.y)return!1;r=r&&c.x,i=i&&c.y}}}catch(d){n={error:d}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}return{x:r,y:i}},t.prototype.getConnectedTargetRules=function(){return this.targetRules},t.prototype.getAnchorsByOffset=function(){var t=this,e=t.anchorsOffset,n=t.id,o=t.x,r=t.y;return e&&e.length>0?e.map(function(t,e){return t.length?{id:"".concat(n,"_").concat(e),x:o+t[0],y:r+t[1]}:py(py({},t),{x:o+t.x,y:r+t.y,id:t.id||"".concat(n,"_").concat(e)})}):this.getDefaultAnchor()},t.prototype.getDefaultAnchor=function(){return[]},t.prototype.getTargetAnchor=function(t){return function(t,e){for(var n,o=If(e),r=Number.MAX_SAFE_INTEGER,i=0;i<o.length;i++){var a=Hf(t.x,t.y,o[i].x,o[i].y);a<r&&(r=a,n={index:i,anchor:Lf(Lf({},o[i]),{x:o[i].x,y:o[i].y,id:o[i].id})})}return n}(t,this)},t.prototype.getBounds=function(){return{minX:this.x-this.width/2,minY:this.y-this.height/2,maxX:this.x+this.width/2,maxY:this.y+this.height/2}},Object.defineProperty(t.prototype,"anchors",{get:function(){var t=this.getAnchorsByOffset(),e=this,n=e.x,o=e.y,r=e.rotate;return t.forEach(function(t){var e=t.x,i=t.y,a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(new Pf([e,i,1]).translate(-n,-o).rotate(r).translate(n,o)[0],2),s=a[0],l=a[1];t.x=s,t.y=l}),t},enumerable:!1,configurable:!0}),t.prototype.getAnchorInfo=function(t){if(!ae(t))for(var e=0;e<this.anchors.length;e++){var n=this.anchors[e];if(n.id===t)return n}},t.prototype.addNodeMoveRules=function(t){this.moveRules.includes(t)||this.moveRules.push(t)},t.prototype.isAllowMoveByXORY=function(t,e,n){var o,r;if(n)o=!0,r=!0;else{var i=this.isAllowMoveNode(t,e);"boolean"==typeof i?(o=i,r=i):(o=i.x,r=i.y)}return{isAllowMoveX:o,isAllowMoveY:r}},t.prototype.move=function(t,e,n){void 0===n&&(n=!1);var o=this.isAllowMoveByXORY(t,e,n),r=o.isAllowMoveX,i=o.isAllowMoveY;return r&&(this.x=this.x+t,this.text&&this.moveText(t,0)),i&&(this.y=this.y+e,this.text&&this.moveText(0,e)),(r||i)&&(this.rotate=this._rotate),r||i},t.prototype.getMoveDistance=function(t,e,n){void 0===n&&(n=!1);var o=this.isAllowMoveByXORY(t,e,n),r=o.isAllowMoveX,i=o.isAllowMoveY,a=0,s=0;return r&&t&&(this.x=this.x+t,this.text&&this.moveText(t,0),a=t),i&&e&&(this.y=this.y+e,this.text&&this.moveText(0,e),s=e),this.transform=new Rf(-this.x,-this.y).rotate(this.rotate).translate(this.x,this.y).toString(),[a,s]},t.prototype.moveTo=function(t,e,n){void 0===n&&(n=!1);var o=t-this.x,r=e-this.y;return!(!n&&!this.isAllowMoveNode(o,r))&&(this.text&&this.moveText(o,r),this.x=t,this.y=e,!0)},t.prototype.moveText=function(t,e){var n=this.text,o=n.x,r=n.y,i=n.value,a=n.draggable,s=n.editable;this.text={value:i,editable:s,draggable:a,x:o+t,y:r+e}},t.prototype.updateText=function(t){this.text=py(py({},xd(this.text)),{value:t})},t.prototype.addNodeResizeRules=function(t){this.resizeRules.includes(t)||this.resizeRules.push(t)},t.prototype.isAllowResizeNode=function(t,e,n,o){var r,i,a=this.resizeRules.concat(this.graphModel.nodeResizeRules);try{for(var s=fy(a),l=s.next();!l.done;l=s.next()){if(!(0,l.value)(this,t,e,n,o))return!1}}catch(u){r={error:u}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return!0},t.prototype.setSelected=function(t){void 0===t&&(t=!0),this.isSelected=t},t.prototype.setHovered=function(t){void 0===t&&(t=!0),this.isHovered=t,this.setIsShowAnchor(t)},t.prototype.setIsShowAnchor=function(t){void 0===t&&(t=!0),this.isShowAnchor=t},t.prototype.setRotatable=function(t){void 0===t&&(t=!0),this.rotatable=t},t.prototype.setResizable=function(t){void 0===t&&(t=!0),this.resizable=t},t.prototype.setHitable=function(t){void 0===t&&(t=!0),this.isHitable=t},t.prototype.setHittable=function(t){void 0===t&&(t=!0),this.isHittable=t},t.prototype.setElementState=function(t,e){this.state=t,this.additionStateData=e},t.prototype.updateProperties=function(t,e){var n=xd(this.properties);this.properties=t,this.setAttributes(),this.graphModel.eventCenter.emit(Sh.NODE_PROPERTIES_CHANGE,{id:this.id,keys:e,preProperties:n,properties:t})},t.prototype.setProperty=function(t,e){var n=xd(this.properties),o=ne(n);fe(o,t,vh(e)),this.updateProperties(o,[t])},t.prototype.setProperties=function(t){var e=xd(this.properties),n=py(py({},e),vh(t)),o=[];Ti(t,function(t,n){(ge(e,n)&&e[n]!==t||!ge(e,n))&&o.push(n)}),this.updateProperties(n,o)},t.prototype.deleteProperty=function(t){delete this.properties[t],this.setAttributes()},t.prototype.setStyle=function(t,e){var n;this.style=py(py({},this.style),((n={})[t]=vh(e),n))},t.prototype.setStyles=function(t){this.style=py(py({},this.style),vh(t))},t.prototype.updateStyles=function(t){this.style=py({},vh(t))},t.prototype.setZIndex=function(t){void 0===t&&(t=1),this.zIndex=t},t.prototype.updateAttributes=function(t){sn(this,t)},t.prototype.updateZIndexByOverlap=function(t,e){switch(t){case Ch.DEFAULT:this.zIndex=1;break;case Ch.EDGE_TOP:this.zIndex=0;break;case Ch.INCREASE:this.zIndex=e}},t.BaseType=_h.NODE,hy([Qu],t.prototype,"type",void 0),hy([Qu],t.prototype,"x",void 0),hy([Qu],t.prototype,"y",void 0),hy([Qu],t.prototype,"textMode",void 0),hy([Qu],t.prototype,"text",void 0),hy([Qu],t.prototype,"properties",void 0),hy([Qu],t.prototype,"_width",void 0),hy([Qu],t.prototype,"_height",void 0),hy([Qu],t.prototype,"anchorsOffset",void 0),hy([Qu],t.prototype,"isSelected",void 0),hy([Qu],t.prototype,"isHovered",void 0),hy([Qu],t.prototype,"isShowAnchor",void 0),hy([Qu],t.prototype,"isDragging",void 0),hy([Qu],t.prototype,"isHitable",void 0),hy([Qu],t.prototype,"isHittable",void 0),hy([Qu],t.prototype,"draggable",void 0),hy([Qu],t.prototype,"visible",void 0),hy([Qu],t.prototype,"rotatable",void 0),hy([Qu],t.prototype,"resizable",void 0),hy([Qu],t.prototype,"zIndex",void 0),hy([Qu],t.prototype,"state",void 0),hy([Qu],t.prototype,"autoToFront",void 0),hy([Qu],t.prototype,"style",void 0),hy([Qu],t.prototype,"transform",void 0),hy([Qu],t.prototype,"_rotate",void 0),hy([sc],t.prototype,"incoming",null),hy([sc],t.prototype,"outgoing",null),hy([ed],t.prototype,"setTextMode",null),hy([ed],t.prototype,"addNodeMoveRules",null),hy([ed],t.prototype,"move",null),hy([ed],t.prototype,"getMoveDistance",null),hy([ed],t.prototype,"moveTo",null),hy([ed],t.prototype,"moveText",null),hy([ed],t.prototype,"updateText",null),hy([ed],t.prototype,"addNodeResizeRules",null),hy([ed],t.prototype,"setSelected",null),hy([ed],t.prototype,"setHovered",null),hy([ed],t.prototype,"setIsShowAnchor",null),hy([ed],t.prototype,"setRotatable",null),hy([ed],t.prototype,"setResizable",null),hy([ed],t.prototype,"setHitable",null),hy([ed],t.prototype,"setHittable",null),hy([ed],t.prototype,"setElementState",null),hy([ed],t.prototype,"setProperty",null),hy([ed],t.prototype,"setProperties",null),hy([ed],t.prototype,"deleteProperty",null),hy([ed],t.prototype,"setStyle",null),hy([ed],t.prototype,"setStyles",null),hy([ed],t.prototype,"updateStyles",null),hy([ed],t.prototype,"setZIndex",null),hy([ed],t.prototype,"updateAttributes",null),hy([ed],t.prototype,"updateZIndexByOverlap",null),t}(),yy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),vy=function(){return vy=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},vy.apply(this,arguments)},my=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},by=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.modelType=Eh.CIRCLE_NODE,o.r=50,o.initNodeData(e),o.setAttributes(),o}return yy(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return 2*this.r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 2*this.r},enumerable:!1,configurable:!0}),e.prototype.setAttributes=function(){t.prototype.setAttributes.call(this);var e=this.properties.r;e&&(this.r=e)},e.prototype.getNodeStyle=function(){var e=t.prototype.getNodeStyle.call(this),n=this.graphModel.theme.circle,o=this.properties.style,r=void 0===o?{}:o;return vy(vy(vy({},e),ne(n)),ne(r))},e.prototype.getDefaultAnchor=function(){var t=this,e=t.x,n=t.y,o=t.r;return[{x:e,y:n-o,id:"".concat(this.id,"_0")},{x:e+o,y:n,id:"".concat(this.id,"_1")},{x:e,y:n+o,id:"".concat(this.id,"_2")},{x:e-o,y:n,id:"".concat(this.id,"_3")}]},e.prototype.resize=function(t){var e=t.width,n=t.deltaX,o=t.deltaY;return this.move(n/2,o/2),this.r=e,this.setProperties({r:e}),this.getData()},my([Qu],e.prototype,"r",void 0),my([sc],e.prototype,"width",null),my([sc],e.prototype,"height",null),e}(gy),_y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xy=function(){return xy=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},xy.apply(this,arguments)},Ey=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},wy=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Sy=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.modelType=Eh.DIAMOND_NODE,o.rx=30,o.ry=50,o.initNodeData(e),o.setAttributes(),o}return _y(e,t),e.prototype.setAttributes=function(){t.prototype.setAttributes.call(this);var e=this.properties,n=e.rx,o=e.ry;n&&(this.rx=n),o&&(this.ry=o)},e.prototype.getNodeStyle=function(){var e=t.prototype.getNodeStyle.call(this),n=this.graphModel.theme.diamond,o=this.properties.style,r=void 0===o?{}:o;return xy(xy(xy({},e),ne(n)),ne(r))},Object.defineProperty(e.prototype,"points",{get:function(){var t=this,e=t.x,n=t.y,o=t.rx,r=t.ry;return[[e,n-r],[e+o,n],[e,n+r],[e-o,n]]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pointsPosition",{get:function(){return at(this.points,function(t){var e=wy(t,2);return{x:e[0],y:e[1]}})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){var t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;return $o(this.points,function(n){var o=wy(n,1)[0];o<t&&(t=o),o>e&&(e=o)}),e-t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;return $o(this.points,function(n){var o=wy(n,2)[1];o<t&&(t=o),o>e&&(e=o)}),e-t},enumerable:!1,configurable:!0}),e.prototype.getDefaultAnchor=function(){var t=this;return at(this.points,function(e,n){var o=wy(e,2);return{x:o[0],y:o[1],id:"".concat(t.id,"_").concat(n)}})},e.prototype.resize=function(t){var e=t.width,n=t.height,o=t.deltaX,r=t.deltaY;return this.move(o/2,r/2),this.rx=e,this.ry=n,this.setProperties({rx:e,ry:n}),this.getData()},Ey([Qu],e.prototype,"rx",void 0),Ey([Qu],e.prototype,"ry",void 0),Ey([sc],e.prototype,"points",null),Ey([sc],e.prototype,"pointsPosition",null),Ey([sc],e.prototype,"width",null),Ey([sc],e.prototype,"height",null),e}(gy),Oy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Cy=function(){return Cy=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Cy.apply(this,arguments)},Ty=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},My=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.modelType=Eh.ELLIPSE_NODE,o.rx=30,o.ry=45,o.initNodeData(e),o.setAttributes(),o}return Oy(e,t),e.prototype.setAttributes=function(){t.prototype.setAttributes.call(this);var e=this.properties,n=e.rx,o=e.ry;n&&(this.rx=n),o&&(this.ry=o)},e.prototype.getNodeStyle=function(){var e=t.prototype.getNodeStyle.call(this),n=this.graphModel.theme.ellipse,o=this.properties.style,r=void 0===o?{}:o;return Cy(Cy(Cy({},e),ne(n)),ne(r))},Object.defineProperty(e.prototype,"width",{get:function(){return 2*this.rx},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return 2*this.ry},enumerable:!1,configurable:!0}),e.prototype.getDefaultAnchor=function(){var t=this,e=t.x,n=t.y,o=t.rx,r=t.ry;return[{x:e,y:n-r,id:"".concat(this.id,"_0")},{x:e+o,y:n,id:"".concat(this.id,"_1")},{x:e,y:n+r,id:"".concat(this.id,"_2")},{x:e-o,y:n,id:"".concat(this.id,"_3")}]},e.prototype.resize=function(t){var e=t.width,n=t.height,o=t.deltaX,r=t.deltaY;return this.move(o/2,r/2),this.rx=e,this.ry=n,this.setProperties({rx:e,ry:n}),this.getData()},Ty([Qu],e.prototype,"rx",void 0),Ty([Qu],e.prototype,"ry",void 0),Ty([sc],e.prototype,"width",null),Ty([sc],e.prototype,"height",null),e}(gy),Ny=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ay=function(){return Ay=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ay.apply(this,arguments)},Py=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Dy=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},ky=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.modelType=Eh.POLYGON_NODE,o.points=[[50,0],[100,50],[50,100],[0,50]],o.initNodeData(e),o.setAttributes(),o}return Ny(e,t),e.prototype.setAttributes=function(){t.prototype.setAttributes.call(this);var e=this.properties,n=e.points,o=e.width,r=e.height,i=n||this.points;this.points=function(t,e,n){if(!t)return[];var o=Math.min.apply(Math,mf([],vf(t.map(function(t){return t[0]})),!1)),r=Math.max.apply(Math,mf([],vf(t.map(function(t){return t[0]})),!1)),i=Math.min.apply(Math,mf([],vf(t.map(function(t){return t[1]})),!1)),a=Math.max.apply(Math,mf([],vf(t.map(function(t){return t[1]})),!1)),s=-o,l=-i,u=t.map(function(t){var e=vf(t,2),n=e[0],o=e[1];return[n+s,o+l]}),c=e?e/(r-o):1,d=n?n/(a-i):1,p=Math.min(c,d);return u.map(function(t){var e=vf(t,2),n=e[0],o=e[1];return[n*p,o*p]})}(i,o,r)},e.prototype.getNodeStyle=function(){var e=t.prototype.getNodeStyle.call(this),n=this.graphModel.theme.polygon,o=this.properties.style,r=void 0===o?{}:o;return Ay(Ay(Ay({},e),ne(n)),ne(r))},Object.defineProperty(e.prototype,"pointsPosition",{get:function(){var t=this,e=t.x,n=t.y,o=t.width,r=t.height;return this.points.map(function(t){return{x:t[0]+e-o/2,y:t[1]+n-r/2}})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){var t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(n){var o=Dy(n,1)[0];o<t&&(t=o),o>e&&(e=o)}),e-t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;return this.points.forEach(function(n){var o=Dy(n,2)[1];o<t&&(t=o),o>e&&(e=o)}),e-t},enumerable:!1,configurable:!0}),e.prototype.getDefaultAnchor=function(){var t=this,e=this,n=e.x,o=e.y,r=e.width,i=e.height;return e.points.map(function(e,a){var s=Dy(e,2),l=s[0],u=s[1];return{x:n+l-r/2,y:o+u-i/2,id:"".concat(t.id,"_").concat(a)}})},e.prototype.resize=function(t){var e=this,n=t.width,o=t.height,r=t.deltaX,i=t.deltaY;this.move(r/2,i/2);var a=at(this.points,function(t){var r=Dy(t,2),i=r[0],a=r[1];return[i*n/e.width,a*o/e.height]});return this.points=a,this.properties.points=a,this.getData()},Py([Qu],e.prototype,"points",void 0),Py([sc],e.prototype,"pointsPosition",null),Py([sc],e.prototype,"width",null),Py([sc],e.prototype,"height",null),e}(gy),Ry=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ly=function(){return Ly=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ly.apply(this,arguments)},Iy=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.modelType=Eh.RECT_NODE,o.radius=0,o.initNodeData(e),o.setAttributes(),o}return Ry(e,t),e.prototype.setAttributes=function(){t.prototype.setAttributes.call(this);var e=this.properties,n=e.width,o=e.height,r=e.radius,i=this.getNodeStyle().radius;ae(n)||(this.width=n),ae(o)||(this.height=o),ae(r)||(this.radius=r),ae(i)||(this.radius=i)},e.prototype.getDefaultAnchor=function(){var t=this,e=t.x,n=t.y,o=t.width,r=t.height;return[{x:e,y:n-r/2,id:"".concat(this.id,"_0")},{x:e+o/2,y:n,id:"".concat(this.id,"_1")},{x:e,y:n+r/2,id:"".concat(this.id,"_2")},{x:e-o/2,y:n,id:"".concat(this.id,"_3")}]},e.prototype.getNodeStyle=function(){var e=t.prototype.getNodeStyle.call(this),n=this.graphModel.theme.rect,o=this.properties.style,r=void 0===o?{}:o;return Ly(Ly(Ly({},e),ne(n)),ne(r))},function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);i>3&&a&&Object.defineProperty(e,n,a)}([Qu],e.prototype,"radius",void 0),e}(gy),jy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),By=function(){return By=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},By.apply(this,arguments)},Hy=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},zy=function(t){function e(){var e=t.apply(this,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(arguments),!1))||this;return e.modelType=Eh.TEXT_NODE,e}return jy(e,t),e.prototype.getTextStyle=function(){var e=t.prototype.getTextStyle.call(this),n=this.graphModel.theme.text,o=this.properties.textStyle;return By(By(By({},e),ne(n)),ne(o))},Object.defineProperty(e.prototype,"width",{get:function(){var t=String(this.text.value).split(/[\r\n]/g),e=this.getTextStyle().fontSize;return Zf({rows:t,fontSize:e,rowsLength:t.length}).width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t=String(this.text.value).split(/[\r\n]/g),e=this.getTextStyle().fontSize;return Zf({rows:t,fontSize:e,rowsLength:t.length}).height},enumerable:!1,configurable:!0}),Hy([sc],e.prototype,"width",null),Hy([sc],e.prototype,"height",null),e}(gy),Fy=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Wy=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.modelType=Eh.HTML_NODE,o.setAttributes(),o}return Fy(e,t),e.prototype.setAttributes=function(){t.prototype.setAttributes.call(this);var e=this.properties,n=e.width,o=e.height;n&&(this.width=n),o&&(this.height=o)},e.prototype.getDefaultAnchor=function(){var t=this,e=t.x,n=t.y,o=t.width,r=t.height;return[{x:e,y:n-r/2,id:"".concat(this.id,"_0")},{x:e+o/2,y:n,id:"".concat(this.id,"_1")},{x:e,y:n+r/2,id:"".concat(this.id,"_2")},{x:e-o/2,y:n,id:"".concat(this.id,"_3")}]},e}(gy),Xy=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Uy={stopZoomGraph:!1,stopScrollGraph:!1,stopMoveGraph:!1,adjustEdge:!1,adjustEdgeStartAndEnd:!1,adjustNodePosition:!1,hideAnchors:!0,allowRotate:!1,allowResize:!1,nodeSelectedOutline:!0,textEdit:!1,nodeTextEdit:!1,edgeTextEdit:!1,textDraggable:!1,nodeTextDraggable:!1,edgeTextDraggable:!1},Gy=["isSilentMode","stopZoomGraph","stopScrollGraph","stopMoveGraph","snapGrid","adjustEdge","adjustEdgeMiddle","adjustEdgeStartAndEnd","adjustEdgeStart","adjustEdgeEnd","adjustNodePosition","hideAnchors","allowRotate","allowResize","autoExpand","hoverOutline","nodeSelectedOutline","edgeSelectedOutline","textEdit","nodeTextEdit","edgeTextEdit","textDraggable","nodeTextDraggable","edgeTextDraggable","multipleSelectKey","textMode","nodeTextMode","edgeTextMode","nodeTextMultiple","edgeTextMultiple","nodeTextVertical","edgeTextVertical"],Yy=function(){function t(t){this.isSilentMode=!1,this.stopZoomGraph=!1,this.stopMoveGraph=!1,this.stopScrollGraph=!1,this.snapGrid=!1,this.textMode=Ah.TEXT,this.textEdit=!0,this.textDraggable=!1,this.nodeTextEdit=!0,this.nodeTextDraggable=!1,this.nodeTextMultiple=!1,this.nodeTextVertical=!1,this.nodeTextMode=Ah.TEXT,this.edgeTextMode=Ah.TEXT,this.edgeTextEdit=!0,this.edgeTextDraggable=!1,this.edgeTextMultiple=!1,this.edgeTextVertical=!1,this.hideAnchors=!1,this.allowRotate=!1,this.allowResize=!1,this.hoverOutline=!0,this.nodeSelectedOutline=!0,this.adjustNodePosition=!0,this.autoExpand=!1,this.adjustEdge=!0,this.adjustEdgeMiddle=!1,this.adjustEdgeStartAndEnd=!1,this.adjustEdgeStart=!1,this.adjustEdgeEnd=!1,this.edgeSelectedOutline=!0,this.multipleSelectKey="",sn(this,this.computeConfig(t))}return t.prototype.updateEditConfig=function(t){var e=this.computeConfig(t);sn(this,e)},t.prototype.computeConfig=function(t){var e=t.isSilentMode,n=t.textDraggable,o=t.textMode,r=t.textEdit,i=t.adjustEdgeStartAndEnd,a={};if(!1===e&&sn(a,this.stagedConfig),!0===e&&e!==this.isSilentMode){var s=he(Uy,Gy);this.stagedConfig=he(this,Gy),sn(a,s)}ue(r)||sn(a,{nodeTextEdit:r,edgeTextEdit:r}),ue(n)||sn(a,{nodeTextDraggable:n,edgeTextDraggable:n}),o&&sn(a,{nodeTextMode:o,edgeTextMode:o}),ii(i)&&sn(a,{adjustEdgeStart:i,adjustEdgeEnd:i});var l=he(t,Gy);return sn(a,l)},t.prototype.updateTextMode=function(t){this.textMode=t,this.edgeTextMode=t,this.nodeTextMode=t},t.prototype.getConfig=function(){return he(this,Gy)},Xy([Qu],t.prototype,"isSilentMode",void 0),Xy([Qu],t.prototype,"stopZoomGraph",void 0),Xy([Qu],t.prototype,"stopMoveGraph",void 0),Xy([Qu],t.prototype,"stopScrollGraph",void 0),Xy([Qu],t.prototype,"snapGrid",void 0),Xy([Qu],t.prototype,"textMode",void 0),Xy([Qu],t.prototype,"textEdit",void 0),Xy([Qu],t.prototype,"textDraggable",void 0),Xy([Qu],t.prototype,"nodeTextEdit",void 0),Xy([Qu],t.prototype,"nodeTextDraggable",void 0),Xy([Qu],t.prototype,"nodeTextMultiple",void 0),Xy([Qu],t.prototype,"nodeTextVertical",void 0),Xy([Qu],t.prototype,"nodeTextMode",void 0),Xy([Qu],t.prototype,"edgeTextMode",void 0),Xy([Qu],t.prototype,"edgeTextEdit",void 0),Xy([Qu],t.prototype,"edgeTextDraggable",void 0),Xy([Qu],t.prototype,"edgeTextMultiple",void 0),Xy([Qu],t.prototype,"edgeTextVertical",void 0),Xy([Qu],t.prototype,"hideAnchors",void 0),Xy([Qu],t.prototype,"allowRotate",void 0),Xy([Qu],t.prototype,"allowResize",void 0),Xy([Qu],t.prototype,"hoverOutline",void 0),Xy([Qu],t.prototype,"nodeSelectedOutline",void 0),Xy([Qu],t.prototype,"adjustNodePosition",void 0),Xy([Qu],t.prototype,"autoExpand",void 0),Xy([Qu],t.prototype,"adjustEdge",void 0),Xy([Qu],t.prototype,"adjustEdgeMiddle",void 0),Xy([Qu],t.prototype,"adjustEdgeStartAndEnd",void 0),Xy([Qu],t.prototype,"adjustEdgeStart",void 0),Xy([Qu],t.prototype,"adjustEdgeEnd",void 0),Xy([Qu],t.prototype,"edgeSelectedOutline",void 0),Xy([ed],t.prototype,"updateEditConfig",null),Xy([ed],t.prototype,"updateTextMode",null),t}(),Vy=function(){function t(){this._events={}}return t.prototype.on=function(t,e,n){var o=this;null==t||t.split(",").forEach(function(t){t=t.trim(),o._events[t]||(o._events[t]=[]),o._events[t].push({callback:e,once:!!n})})},t.prototype.once=function(t,e){var n=this;null==t||t.split(",").forEach(function(t){t=t.trim(),n.on(t,e,!0)})},t.prototype.emit=function(t,e){var n=this;null==t||t.split(",").forEach(function(t){var o=n._events[t]||[],r=n._events["*"]||[],i=function(o){for(var r=o.length,i=0;i<r;i++)if(o[i]){var a=o[i],s=a.callback;a.once&&(o.splice(i,1),0===o.length&&delete n._events[t],r--,i--),s.apply(n,[e])}};i(o),i(r)})},t.prototype.off=function(t,e){var n=this;t||(this._events={}),t.split(",").forEach(function(t){if(e){for(var o=n._events[t]||[],r=o.length,i=0;i<r;i++)o[i].callback===e&&(o.splice(i,1),r--,i--);0===o.length&&delete n._events[t]}else delete n._events[t]})},t.prototype.getEvents=function(){return this._events},t.prototype.destroy=function(){this._events={}},t}(),Ky=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qy=function(){return qy=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},qy.apply(this,arguments)},Zy=function(t){function e(e){var n=t.call(this)||this;n.stepScrollX=0,n.stepScrollY=0,n.onDragging=function(t){var e=t.deltaX,o=t.deltaY;n.setState({isDragging:!0});var r=n.props.graphModel,i=r.transformModel;!0!==r.editConfigModel.stopMoveGraph&&i.translate(e,o)},n.onDragEnd=function(){n.setState({isDragging:!1})},n.zoomHandler=function(t){var e=n.props,o=e.graphModel,r=o.editConfigModel,i=o.transformModel,a=o.gridSize,s=e.graphModel,l=t.deltaX,u=t.deltaY,c=r.stopScrollGraph,d=r.stopZoomGraph;if(c||t.ctrlKey||t.metaKey){if(!d){t.preventDefault();var p=s.getPointByClient({x:t.clientX,y:t.clientY}).canvasOverlayPosition,h=p.x,f=p.y;i.zoom(t.deltaY<0,[h,f])}}else{if(t.preventDefault(),n.stepScrollX+=l,n.stepScrollY+=u,Math.abs(n.stepScrollX)>=a){var g=n.stepScrollX%a,y=n.stepScrollX-g;i.translate(-y*i.SCALE_X,0),n.stepScrollX=g}if(Math.abs(n.stepScrollY)>=a){var v=n.stepScrollY%a,m=n.stepScrollY-v;i.translate(0,-m*i.SCALE_Y),n.stepScrollY=v}}},n.clickHandler=function(t){if("canvas-overlay"===t.target.getAttribute("name")){var e=n.props.graphModel;if(e.selectElements.size>0&&e.clearSelectElements(),n.state.isDragging)return;e.eventCenter.emit(Sh.BLANK_CLICK,{e:t})}},n.handleContextMenu=function(t){if("canvas-overlay"===t.target.getAttribute("name")){t.preventDefault();var e=n.props.graphModel,o=e.getPointByClient({x:t.clientX,y:t.clientY});e.eventCenter.emit(Sh.BLANK_CONTEXTMENU,{e:t,position:o})}},n.mouseDownHandler=function(t){var e=n.props.graphModel,o=e.eventCenter,r=e.editConfigModel,i=e.transformModel.SCALE_X,a=e.gridSize,s=r.adjustEdge,l=r.adjustNodePosition,u=r.stopMoveGraph,c=!s&&!l;("canvas-overlay"===t.target.getAttribute("name")||c)&&(!0!==u?(n.stepDrag.setStep(a*i),n.stepDrag.handleMouseDown(t)):o.emit(Sh.BLANK_MOUSEDOWN,{e:t}),n.clickHandler(t))};var o=e.graphModel,r=o.gridSize,i=o.eventCenter;return n.stepDrag=new kh({onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:r,eventType:"BLANK",isStopPropagation:!1,eventCenter:i,model:void 0}),n.state={isDragging:!1},n}return Ky(e,t),e.prototype.render=function(){var t=this.props.graphModel.transformModel.getTransformStyle().transform,e=this.props,n=e.children,o=e.dnd,r=this.state.isDragging;return ph("svg",qy({xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",name:"canvas-overlay",onWheel:this.zoomHandler,onMouseDown:this.mouseDownHandler,onContextMenu:this.handleContextMenu,className:r?"lf-canvas-overlay lf-dragging":"lf-canvas-overlay lf-drag-able"},o.eventMap(),{children:ph("g",{transform:t,children:n})}))},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),$y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Jy=function(){return Jy=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Jy.apply(this,arguments)},Qy=function(t){function e(){var e=t.call(this)||this;return e.onDragging=function(t){var n=t.event,o=e.props,r=o.graphModel,i=o.bezierModel,a=o.type,s=r.getPointByClient({x:n.clientX,y:n.clientY}).canvasOverlayPosition,l=s.x,u=s.y;i.updateAdjustAnchor({x:l,y:u},a),r.eventCenter.emit(Sh.EDGE_ADJUST,{data:i.getData()})},e.onDragEnd=function(){e.props.bezierModel.isDragging=!1},e.dragHandler=new kh({onDragging:e.onDragging,onDragEnd:e.onDragEnd}),e}return $y(e,t),e.prototype.render=function(){var t=this,e=this.props.position,n=e.x,o=e.y,r=this.props.bezierModel.getEdgeStyle().adjustAnchor;return ph(vg,Jy({className:"lf-bezier-adjust-anchor",x:n,y:o},r,{onMouseDown:function(e){t.dragHandler.handleMouseDown(e)}}))},e}(Xl),tv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $y(e,t),e.prototype.getBezierAdjust=function(t,e){var n=t.path,o=t.id,r=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(pf(n),4),i=r[0],a=r[1],s=r[2],l=r[3],u=t.getEdgeStyle().adjustLine,c=[];return c.push(ph(dg,Jy({x1:i.x,y1:i.y,x2:a.x,y2:a.y},u))),c.push(ph(Qy,{position:a,bezierModel:t,graphModel:e,type:"sNext"},"".concat(o,"_ePre"))),c.push(ph(dg,Jy({x1:l.x,y1:l.y,x2:s.x,y2:s.y},u))),c.push(ph(Qy,{position:s,bezierModel:t,graphModel:e,type:"ePre"},"".concat(o,"_sNext"))),c},e.prototype.selectedBezierEdge=function(){for(var t=this.props.graphModel,e=t.edges,n=[],o=0;o<e.length;o++){var r=e[o];r.isSelected&&r.modelType===Eh.BEZIER_EDGE&&r.draggable&&n.push(this.getBezierAdjust(r,t))}return n},e.prototype.render=function(){return ph("g",{className:"lf-bezier-adjust",children:this.selectedBezierEdge()})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),ev=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ev(e,t),e.prototype.render=function(){var t=this.props.background;return ph("div",{className:"lf-background",children:ph("div",{style:a(t)?t:{},className:"lf-background-area"})})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),ov=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),rv=function(t){function e(e){var n=t.call(this,e)||this;return n.id=rg(),n.gridOptions=n.props.graphModel.grid,n}return ov(e,t),e.prototype.renderDot=function(){var t=this.gridOptions,e=t.config,n=t.size,o=void 0===n?1:n,r=t.visible,i=null!=e?e:{},a=i.color,s=i.thickness,l=void 0===s?2:s,u=Math.min(Math.max(2,l),o/4);return ph("g",{fill:a,opacity:r?1:0,children:[ph("circle",{cx:0,cy:0,r:u/2}),ph("circle",{cx:0,cy:o,r:u/2}),ph("circle",{cx:o,cy:0,r:u/2}),ph("circle",{cx:o,cy:o,r:u/2})]})},e.prototype.renderMesh=function(){var t=this.gridOptions,e=t.config,n=t.size,o=void 0===n?1:n,r=t.visible,i=null!=e?e:{},a=i.color,s=i.thickness,l=void 0===s?1:s,u=Math.min(Math.max(1,l),o/2);return ph("path",{d:"M 0 0 H ".concat(o," V ").concat(o," H 0 Z"),stroke:a,strokeWidth:u/2,opacity:r?1:0,fill:"transparent"})},e.prototype.render=function(){var t=this.props.graphModel,e=t.transformModel,n=t.grid;this.gridOptions=n;var o=this.gridOptions,r=o.type,i=o.size,a=void 0===i?1:i,s=[e.SCALE_X,e.SKEW_Y,e.SKEW_X,e.SCALE_Y,e.TRANSLATE_X,e.TRANSLATE_Y].join(","),l="matrix(".concat(s,")");return ph("div",{className:"lf-grid",children:ph("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",children:[ph("defs",{children:ph("pattern",{id:this.id,patternUnits:"userSpaceOnUse",patternTransform:l,x:"0",y:"0",width:a,height:a,children:["dot"===r&&this.renderDot(),"mesh"===r&&this.renderMesh()]})}),ph("rect",{width:"100%",height:"100%",fill:"url(#".concat(this.id,")")})]})})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl);(jg=rv||(rv={})).defaultProps={size:10,visible:!0,type:"dot",config:{color:"#ababab",thickness:1}},jg.getGridOptions=function(t){var e=ne(jg.defaultProps);return sn(e,"number"==typeof t?{size:t}:"boolean"==typeof t?{visible:t}:t)};var iv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),av=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return iv(e,t),e.prototype.render=function(){return ph("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"100%",height:"100%",className:"modification-overlay",children:ph("g",{transform:this.props.graphModel.transformModel.getTransformStyle().transform,children:this.props.children})})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),sv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),lv=function(){return lv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},lv.apply(this,arguments)},uv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return sv(e,t),e.prototype.getNodesOutline=function(){var t=this.props.graphModel,e=t.nodes,n=t.editConfigModel,o=n.hoverOutline,r=n.nodeSelectedOutline,i=[];return e.forEach(function(t){if(t.isHovered||t.isSelected){var e=t.isHovered,n=t.isSelected,a=t.x,s=t.y,l=t.width,u=t.height;if(r&&n||o&&e){var c=t.getOutlineStyle()||{},d={};if(Object.keys(c).forEach(function(t){"hover"!==t&&(d[t]=c[t])}),e){var p=c.hover;d=lv(lv({},d),p)}i.push(ph(hg,lv({transform:t.transform,className:"lf-outline-node",x:a,y:s,width:l+10,height:u+10},d)))}}}),i},e.prototype.getEdgeOutline=function(){for(var t=this.props.graphModel,e=t.edges,n=t.editConfigModel,o=n.edgeSelectedOutline,r=n.hoverOutline,i=[],a=0;a<e.length;a++){var s=e[a];(o&&s.isSelected||r&&s.isHovered)&&(s.modelType===Eh.LINE_EDGE?i.push(this.getLineOutline(s)):s.modelType===Eh.POLYLINE_EDGE?i.push(this.getPolylineOutline(s)):s.modelType===Eh.BEZIER_EDGE&&i.push(this.getBezierOutline(s)))}return i},e.prototype.getLineOutline=function(t){var e=t.startPoint,n=t.endPoint,o=(e.x+n.x)/2,r=(e.y+n.y)/2,i=Math.abs(e.x-n.x)+10,a=Math.abs(e.y-n.y)+10,s=t.getOutlineStyle();return ph(hg,lv({className:"lf-outline-edge",x:o,y:r,width:i,height:a},s))},e.prototype.getPolylineOutline=function(t){var e=t.points,n=sf(e),o=Uh(n,8),r=o.x,i=o.y,a=o.width,s=o.height,l=t.getOutlineStyle();return ph(hg,lv({className:"lf-outline",x:r,y:i,width:a,height:s},l))},e.prototype.getBezierOutline=function(t){var e=t.path,n=pf(e),o=Uh(n,8),r=o.x,i=o.y,a=o.width,s=o.height,l=t.getOutlineStyle();return ph(hg,lv({className:"lf-outline",x:r,y:i,width:a,height:s},l))},e.prototype.render=function(){return ph("g",{className:"lf-outline",children:[this.getNodesOutline(),this.getEdgeOutline()]})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),cv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dv=function(){return dv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},dv.apply(this,arguments)},pv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cv(e,t),e.prototype.render=function(){var t=this.props.snaplineModel,e=null!=t?t:{},n=e.position,o=e.isShowHorizontal,r=e.isShowVertical,i=null==t?void 0:t.getStyle(),a=null!=n?n:{},s=a.x,l=void 0===s?0:s,u=a.y,c=void 0===u?0:u,d=dv(dv({x1:-1e5,y1:c,x2:1e5,y2:c},i),{stroke:o?null==i?void 0:i.stroke:"none"}),p=dv(dv({x1:l,y1:-1e5,x2:l,y2:1e5},i),{stroke:r?null==i?void 0:i.stroke:"none"});return ph("g",{className:"lf-snapline",children:[ph(dg,dv({},d)),ph(dg,dv({},p))]})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),hv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),fv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return hv(e,t),e.prototype.componentDidMount=function(){this.triggerToolRender()},e.prototype.componentDidUpdate=function(){this.triggerToolRender()},e.prototype.getTools=function(){var t=this.props,e=t.tool,n=t.graphModel,o=n.textEditElement,r=e.getTools().map(function(t){return zl(t,{textEditElement:o,graphModel:n,lf:e.instance})});return e.components=r,r},e.prototype.triggerToolRender=function(){var t=this.props,e=t.tool,n=t.graphModel,o=document.querySelector("#ToolOverlay_".concat(n.flowId)),r=e.getInstance();r.components.forEach(function(t){return t(r,o)}),r.components=[]},e.prototype.render=function(){var t=this.props.graphModel;return ph("div",{className:"lf-tool-overlay",id:"ToolOverlay_".concat(t.flowId),children:this.getTools()})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),gv=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},yv=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},vv={false:[-1/0,-1/0,1/0,1/0],true:[-1/0,-1/0,1/0,1/0],vertical:[-1/0,0,1/0,0],horizontal:[0,-1/0,0,1/0]},mv=function(){function t(t,e){this.MINI_SCALE_SIZE=.2,this.MAX_SCALE_SIZE=16,this.SCALE_X=1,this.SKEW_Y=0,this.SKEW_X=0,this.SCALE_Y=1,this.TRANSLATE_X=0,this.TRANSLATE_Y=0,this.ZOOM_SIZE=.04,this.translateLimitMinX=-1/0,this.translateLimitMinY=-1/0,this.translateLimitMaxX=1/0,this.translateLimitMaxY=1/0,this.eventCenter=t;var n=e.stopMoveGraph,o=void 0!==n&&n;this.updateTranslateLimits(o)}return t.prototype.setZoomMiniSize=function(t){this.MINI_SCALE_SIZE=t},t.prototype.setZoomMaxSize=function(t){this.MAX_SCALE_SIZE=t},t.prototype.HtmlPointToCanvasPoint=function(t){var e=yv(t,2),n=e[0],o=e[1];return[(n-this.TRANSLATE_X)/this.SCALE_X,(o-this.TRANSLATE_Y)/this.SCALE_Y]},t.prototype.CanvasPointToHtmlPoint=function(t){var e=yv(t,2),n=e[0],o=e[1];return[n*this.SCALE_X+this.TRANSLATE_X,o*this.SCALE_Y+this.TRANSLATE_Y]},t.prototype.moveCanvasPointByHtml=function(t,e,n){var o=yv(t,2),r=o[0],i=o[1];return[r+e/this.SCALE_X,i+n/this.SCALE_Y]},t.prototype.fixDeltaXY=function(t,e){return[t/this.SCALE_X,e/this.SCALE_Y]},t.prototype.getTransformStyle=function(){var t=[this.SCALE_X,this.SKEW_Y,this.SKEW_X,this.SCALE_Y,this.TRANSLATE_X,this.TRANSLATE_Y].join(",");return{transform:"matrix(".concat(t,")")}},t.prototype.zoom=function(t,e){void 0===t&&(t=!1);var n=this.SCALE_X,o=this.SCALE_Y;return"number"==typeof t?(n=t,o=t):t?(n+=this.ZOOM_SIZE,o+=this.ZOOM_SIZE):(n-=this.ZOOM_SIZE,o-=this.ZOOM_SIZE),n<this.MINI_SCALE_SIZE||n>this.MAX_SCALE_SIZE||(e&&(this.TRANSLATE_X-=(n-this.SCALE_X)*e[0],this.TRANSLATE_Y-=(o-this.SCALE_Y)*e[1]),this.SCALE_X=n,this.SCALE_Y=o,this.emitGraphTransform("zoom")),"".concat(100*this.SCALE_X,"%")},t.prototype.emitGraphTransform=function(t){this.eventCenter.emit(Sh.GRAPH_TRANSFORM,{type:t,transform:{SCALE_X:this.SCALE_X,SKEW_Y:this.SKEW_Y,SKEW_X:this.SKEW_X,SCALE_Y:this.SCALE_Y,TRANSLATE_X:this.TRANSLATE_X,TRANSLATE_Y:this.TRANSLATE_Y}})},t.prototype.resetZoom=function(){this.SCALE_X=1,this.SCALE_Y=1,this.emitGraphTransform("resetZoom")},t.prototype.translate=function(t,e){this.TRANSLATE_X+t<=this.translateLimitMaxX&&this.TRANSLATE_X+t>=this.translateLimitMinX&&(this.TRANSLATE_X+=t),this.TRANSLATE_Y+e<=this.translateLimitMaxY&&this.TRANSLATE_Y+e>=this.translateLimitMinY&&(this.TRANSLATE_Y+=e),this.emitGraphTransform("translate")},t.prototype.focusOn=function(t,e,n,o){var r=yv(this.CanvasPointToHtmlPoint([t,e]),2),i=r[0],a=r[1],s=yv([n/2-i,o/2-a],2),l=s[0],u=s[1];this.TRANSLATE_X+=l,this.TRANSLATE_Y+=u,this.emitGraphTransform("focusOn")},t.prototype.updateTranslateLimits=function(t){var e;e=yv(Array.isArray(t)&&4===t.length?t:vv[t.toString()],4),this.translateLimitMinX=e[0],this.translateLimitMinY=e[1],this.translateLimitMaxX=e[2],this.translateLimitMaxY=e[3]},gv([Qu],t.prototype,"SCALE_X",void 0),gv([Qu],t.prototype,"SKEW_Y",void 0),gv([Qu],t.prototype,"SKEW_X",void 0),gv([Qu],t.prototype,"SCALE_Y",void 0),gv([Qu],t.prototype,"TRANSLATE_X",void 0),gv([Qu],t.prototype,"TRANSLATE_Y",void 0),gv([Qu],t.prototype,"ZOOM_SIZE",void 0),gv([ed],t.prototype,"zoom",null),gv([ed],t.prototype,"resetZoom",null),gv([ed],t.prototype,"translate",null),gv([ed],t.prototype,"focusOn",null),t}(),bv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_v=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},xv=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.parentTransform=n.parentTransform,o}return bv(e,t),e.prototype.setParentTransform=function(t){this.parentTransform=t},e.prototype.getCumulativeScale=function(){var t=this.SCALE_X,n=this.SCALE_Y;if(this.parentTransform)if(this.parentTransform instanceof e){var o=this.parentTransform.getCumulativeScale();t*=o.scaleX,n*=o.scaleY}else t*=this.parentTransform.SCALE_X,n*=this.parentTransform.SCALE_Y;return{scaleX:t,scaleY:n}},e.prototype.getCumulativeTranslate=function(){var t=this.TRANSLATE_X,n=this.TRANSLATE_Y;if(this.parentTransform&&this.parentTransform instanceof e){var o=this.parentTransform.getCumulativeScale();t*=o.scaleX,n*=o.scaleY}return{translateX:t,translateY:n}},e.prototype.HtmlPointToCanvasPoint=function(t){var e=_v(t,2),n=e[0],o=e[1],r=this.getCumulativeScale(),i=r.scaleX,a=r.scaleY,s=this.getCumulativeTranslate();return[(n-s.translateX)/i,(o-s.translateY)/a]},e.prototype.CanvasPointToHtmlPoint=function(t){var e=_v(t,2),n=e[0],o=e[1],r=this.getCumulativeScale(),i=r.scaleX,a=r.scaleY,s=this.getCumulativeTranslate();return[n*i+s.translateX,o*a+s.translateY]},e.prototype.moveCanvasPointByHtml=function(t,e,n){var o=_v(t,2),r=o[0],i=o[1],a=this.getCumulativeScale();return[r+e/a.scaleX,i+n/a.scaleY]},e.prototype.fixDeltaXY=function(t,e){var n=this.getCumulativeScale();return[t/n.scaleX,e/n.scaleY]},e}(mv),Ev=function(){return Ev=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ev.apply(this,arguments)},wv=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Sv=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Ov=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},Cv=function(){function t(t){var e,n,o=this;this.modelMap=new Map,this.nodeModelMap=new Map,this.edgeModelMap=new Map,this.elementsModelMap=new Map,this.nodeMoveRules=[],this.nodeResizeRules=[],this.nodes=[],this.edges=[],this.overlapMode=Ch.DEFAULT,this.gridSize=1,this.partial=!1,this.waitCleanEffects=[];var r,i=t.container,a=t.partial,s=t.background,l=void 0===s?{}:s,u=t.grid,c=t.idGenerator,d=t.edgeGenerator,p=t.animation,h=t.customTrajectory;this.rootEl=i,this.partial=!!a,this.background=l,"object"==typeof u&&t.snapGrid&&(this.gridSize=u.size||1),this.customStyles=t.style||{},this.grid=rv.getGridOptions(null!=u&&u),this.theme=Ug(t.style,t.themeMode),this.theme.grid=ne(this.grid),this.theme.background=ne(this.background),this.edgeType=t.edgeType||"polyline",this.animation=(r=p)&&"boolean"!=typeof r?de(ne(gh),r):ne(!0===r?yh:gh),this.overlapMode=t.overlapMode||Ch.DEFAULT,this.isMiniMap=t.isMiniMap||!1,this.width=null!==(e=t.width)&&void 0!==e?e:this.rootEl.getBoundingClientRect().width,this.isContainerWidth=ae(t.width),this.height=null!==(n=t.height)&&void 0!==n?n:this.rootEl.getBoundingClientRect().height,this.isContainerHeight=ae(t.height);var f,g,y=new ResizeObserver(Zt(function(t){var e,n;try{for(var r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),i=r.next();!i.done;i=r.next()){var a=i.value;if(a.target===o.rootEl){if(!document.body.contains(o.rootEl))return;o.resize(),o.eventCenter.emit("graph:resize",{target:o.rootEl,contentRect:a.contentRect})}}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},16));y.observe(this.rootEl),this.waitCleanEffects.push(function(){y.disconnect()}),this.eventCenter=new Vy,this.editConfigModel=new Yy(t),this.transformModel=new xv(this.eventCenter,t),this.flowId=rg(),this.idGenerator=c,this.edgeGenerator=(f=this,"function"!=typeof(g=d)?function(t,e,n){return Object.assign({type:f.edgeType},n)}:function(t,e,n){var o=g(t,e,n);return o?"string"==typeof o?Object.assign({},n,{type:o}):Object.assign({type:o},n):{type:f.edgeType}}),this.customTrajectory=h}return Object.defineProperty(t.prototype,"nodesMap",{get:function(){return this.nodes.reduce(function(t,e,n){return t[e.id]={index:n,model:e},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"edgesMap",{get:function(){return this.edges.reduce(function(t,e,n){return t[e.id]={index:n,model:e},t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"modelsMap",{get:function(){return Ov(Ov([],Sv(this.nodes),!1),Sv(this.edges),!1).reduce(function(t,e){return t[e.id]=e,t},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sortElements",{get:function(){for(var t,e=(t=Ov(Ov([],Sv(this.nodes),!1),Sv(this.edges),!1),Ov([],Sv(t),!1).sort(function(t,e){return t.zIndex-e.zIndex})),n=[],o=[-200,-200],r=[this.width+Dh,this.height+Dh],i=0;i<e.length;i++){var a=e[i];a.visible&&(!this.partial||a.isSelected||this.isElementInArea(a,o,r,!1,!1))&&n.push(a)}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textEditElement",{get:function(){var t=this.nodes.find(function(t){return t.state===mh.TEXT_EDIT}),e=this.edges.find(function(t){return t.state===mh.TEXT_EDIT});return t||e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectElements",{get:function(){var t=new Map;return this.nodes.forEach(function(e){e.isSelected&&t.set(e.id,e)}),this.edges.forEach(function(e){e.isSelected&&t.set(e.id,e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectNodes",{get:function(){var t=[];return this.nodes.forEach(function(e){e.isSelected&&t.push(e)}),t},enumerable:!1,configurable:!0}),t.prototype.getAreaElement=function(t,e,n,o,r){var i=this;void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===r&&(r=!1);var a=[];return $o(Ov(Ov([],Sv(this.nodes),!1),Sv(this.edges),!1),function(s){var l=i.isElementInArea(s,t,e,n,o);r&&!s.visible||!l||a.push(s)}),a},t.prototype.getModel=function(t){return this.modelMap.get(t)},t.prototype.getNodeModelById=function(t){var e;return this.fakeNode&&t===this.fakeNode.id?this.fakeNode:null===(e=this.nodesMap[t])||void 0===e?void 0:e.model},t.prototype.getPointByClient=function(t){var e=t.x,n=t.y,o=this.rootEl.getBoundingClientRect(),r={x:e-o.left,y:n-o.top},i=Sv(this.transformModel.HtmlPointToCanvasPoint([r.x,r.y]),2);return{domOverlayPosition:r,canvasOverlayPosition:{x:i[0],y:i[1]}}},t.prototype.isElementInArea=function(t,e,n,o,r){var i;if(void 0===o&&(o=!0),void 0===r&&(r=!0),t.BaseType===_h.NODE){for(var a=Wf(t),s=a.minX,l=a.minY,u=a.maxX,c=a.maxY,d=[{x:s,y:l},{x:u,y:l},{x:u,y:c},{x:s,y:c}],p=r,h=0;h<d.length;h++){var f=d[h],g=f.x,y=f.y;if(g=(i=Sv(this.transformModel.CanvasPointToHtmlPoint([g,y]),2))[0],y=i[1],xf([g,y],e,n)!==r){p=!r;break}}return p}if(t.BaseType===_h.EDGE){var v=t.startPoint,m=t.endPoint,b=this.transformModel.CanvasPointToHtmlPoint([v.x,v.y]),_=this.transformModel.CanvasPointToHtmlPoint([m.x,m.y]),x=xf(b,e,n),E=xf(_,e,n);return o?x&&E:x||E}return!1},t.prototype.graphDataToModel=function(t){var e=this;if(t)if(this.elementsModelMap.clear(),this.nodeModelMap.clear(),this.edgeModelMap.clear(),t.nodes?this.nodes=at(t.nodes,function(t){var n=e.getModelAfterSnapToGrid(t);return e.elementsModelMap.set(n.id,n),e.nodeModelMap.set(n.id,n),n}):this.nodes=[],t.edges){var n=this.edgeType;this.edges=at(t.edges,function(t){var o,r=e.getModel(null!==(o=t.type)&&void 0!==o?o:n);if(!r)throw new Error("找不到".concat(t.type,"对应的边。"));var i=new r(t,e);return e.edgeModelMap.set(i.id,i),e.elementsModelMap.set(i.id,i),i})}else this.edges=[];else this.clearData()},t.prototype.modelToGraphData=function(){var t=[];this.edges.forEach(function(e){var n=e.getData();n&&!e.virtual&&t.push(n)});var e=[];return this.nodes.forEach(function(t){var n=t.getData();n&&!t.virtual&&e.push(n)}),{nodes:e,edges:t}},t.prototype.modelToHistoryData=function(){for(var t=!1,e=[],n=0;n<this.nodes.length;n++){var o=this.nodes[n];if(o.isDragging){t=!0;break}e.push(o.getHistoryData())}if(t)return!1;for(var r=!1,i=[],a=0;a<this.edges.length;a++){var s=this.edges[a];if(s.isDragging){r=!0;break}s.virtual||i.push(s.getHistoryData())}return!r&&{nodes:e,edges:i}},t.prototype.getEdgeModelById=function(t){var e;return null===(e=this.edgesMap[t])||void 0===e?void 0:e.model},t.prototype.getElement=function(t){return this.modelsMap[t]},t.prototype.getNodeEdges=function(t){for(var e=[],n=0;n<this.edges.length;n++){var o=this.edges[n],r=o.sourceNodeId===t,i=o.targetNodeId===t;(r||i)&&e.push(o)}return e},t.prototype.getSelectElements=function(t){void 0===t&&(t=!0);var e=this.selectElements,n={nodes:[],edges:[]};return e.forEach(function(o){if(o.BaseType===_h.NODE&&n.nodes.push(o.getData()),o.BaseType===_h.EDGE){var r=o.getData(),i=e.get(r.sourceNodeId)&&e.get(r.targetNodeId);(t||i)&&n.edges.push(r)}}),n},t.prototype.updateAttributes=function(t,e){var n=this.getElement(t);null==n||n.updateAttributes(e)},t.prototype.changeNodeId=function(t,e){return e||(e=rg()),this.nodesMap[e]?(console.warn("当前流程图已存在节点".concat(e,", 修改失败")),""):this.nodesMap[t]?(this.edges.forEach(function(n){n.sourceNodeId===t&&(n.sourceNodeId=e),n.targetNodeId===t&&(n.targetNodeId=e)}),this.nodesMap[t].model.id=e,this.nodesMap[e]=this.nodesMap[t],e):(console.warn("当前流程图找不到节点".concat(t,", 修改失败")),"")},t.prototype.changeEdgeId=function(t,e){return e||(e=rg()),this.edgesMap[e]?(console.warn("当前流程图已存在边: ".concat(e,", 修改失败")),""):this.edgesMap[t]?(this.edges.forEach(function(n){n.id===t&&n.changeEdgeId(e)}),e):(console.warn("当前流程图找不到边: ".concat(e,", 修改失败")),"")},t.prototype.getTextModel=function(t){var e=this.editConfigModel,n=e.textMode,o=e.nodeTextMode,r=e.edgeTextMode;return t.BaseType===_h.NODE?t.textMode||o||n||Ah.TEXT:t.BaseType===_h.EDGE?t.textMode||r||n||Ah.TEXT:void 0},t.prototype.setOverlapMode=function(t){this.overlapMode=t,this.eventCenter.emit("overlap:change",{overlapMode:t})},t.prototype.setTextMode=function(t,e){this.editConfigModel.updateEditConfig({textMode:t})},t.prototype.setFakeNode=function(t){this.fakeNode=t},t.prototype.removeFakeNode=function(){this.fakeNode=null},t.prototype.setModel=function(t,e){return this.modelMap.set(t,e)},t.prototype.toFront=function(t){var e,n,o,r=(null===(e=this.nodesMap[t])||void 0===e?void 0:e.model)||(null===(n=this.edgesMap[t])||void 0===n?void 0:n.model);if(r){if(this.overlapMode===Ch.STATIC)return;if(this.overlapMode===Ch.INCREASE)return void this.setElementZIndex(t,"top");null===(o=this.topElement)||void 0===o||o.setZIndex(),r.setZIndex(9999),this.topElement=r}},t.prototype.setElementZIndex=function(t,e){var n,o,r=(null===(n=this.nodesMap[t])||void 0===n?void 0:n.model)||(null===(o=this.edgesMap[t])||void 0===o?void 0:o.model);if(r){var i=void 0;"number"==typeof e?i=e:("top"===e&&(i=Kg()),"bottom"===e&&(i=--Vg)),r.setZIndex(i)}},t.prototype.deleteNode=function(t){var e=this.nodesMap[t].model,n=e.getData();this.deleteEdgeBySource(t),this.deleteEdgeByTarget(t),this.nodes.splice(this.nodesMap[t].index,1),this.eventCenter.emit(Sh.NODE_DELETE,{data:n,model:e})},t.prototype.addNode=function(t,e,n){void 0===e&&(e=Sh.NODE_ADD);var o=vh(t),r=o.id;r&&this.nodesMap[r]&&delete o.id;var i=this.getModelAfterSnapToGrid(o);this.nodes.push(i);var a={data:i.getData()};return n&&(a.e=n),this.eventCenter.emit(e,a),i},t.prototype.getModelAfterSnapToGrid=function(t){var e=this.getModel(t.type),n=this.editConfigModel.snapGrid;if(!e)throw new Error("找不到".concat(t.type,"对应的节点，请确认是否已注册此类型节点。"));var o=t.x,r=t.y;o&&r&&(t.x=bf(o,this.gridSize,n),t.y=bf(r,this.gridSize,n),"object"==typeof t.text&&null!==t.text&&(t.text.x+=t.x-o,t.text.y+=t.y-r));var i=new e(t,this);return this.nodeModelMap.set(i.id,i),this.elementsModelMap.set(i.id,i),i},t.prototype.cloneNode=function(t){var e=this.getNodeModelById(t),n=null==e?void 0:e.getData();if(n){n.x+=30,n.y+=30,n.id="","object"==typeof n.text&&null!==n.text&&(n.text.x+=30,n.text.y+=30);var o=this.addNode(n);return o.setSelected(!0),null==e||e.setSelected(!1),o.getData()}},t.prototype.moveNode=function(t,e,n,o){var r;void 0===o&&(o=!1);var i=this.nodesMap[t];if(i){var a=i.model;e=(r=Sv(a.getMoveDistance(e,n,o),2))[0],n=r[1],this.moveEdge(t,e,n)}else console.warn("不存在id为".concat(t,"的节点"))},t.prototype.moveNode2Coordinate=function(t,e,n,o){void 0===o&&(o=!1);var r=this.nodesMap[t];if(r){var i=r.model,a=e-i.x,s=n-i.y;this.moveNode(t,a,s,o)}else console.warn("不存在id为".concat(t,"的节点"))},t.prototype.editText=function(t){this.setElementStateById(t,mh.TEXT_EDIT)},t.prototype.addEdge=function(t){var e=vh(t),n=e.type;n||(n=this.edgeType),e.id&&this.edgesMap[e.id]&&(delete e.id,delete e.sourceAnchorId,delete e.targetAnchorId);var o=this.getModel(n);if(!o)throw new Error("找不到".concat(n,"对应的边，请确认是否已注册此类型边。"));var r=new o(Ev(Ev({},e),{type:n}),this);this.edgeModelMap.set(r.id,r),this.elementsModelMap.set(r.id,r);var i=r.getData();return this.edges.push(r),this.eventCenter.emit(Sh.EDGE_ADD,{data:i}),r},t.prototype.moveEdge=function(t,e,n){for(var o=0;o<this.edges.length;o++){var r=this.edges[o],i=r.textPosition,a=i.x,s=i.y,l=this.edges[o].sourceNodeId===t,u=this.edges[o].targetNodeId===t;l&&r.moveStartPoint(e,n),u&&r.moveEndPoint(e,n),(l||u)&&this.handleEdgeTextMove(r,a,s)}},t.prototype.handleEdgeTextMove=function(t,e,n){var o;if(t.customTextPosition)t.resetTextPosition();else{if(t.modelType===Eh.POLYLINE_EDGE&&(null===(o=t.text)||void 0===o?void 0:o.value)){var r=t.text,i=gf(r,t.points);t.moveText(i.x-r.x,i.y-r.y)}var a=t.textPosition,s=a.x,l=a.y;t.moveText(s-e,l-n)}},t.prototype.deleteEdgeBySourceAndTarget=function(t,e){for(var n=0;n<this.edges.length;n++)if(this.edges[n].sourceNodeId===t&&this.edges[n].targetNodeId===e){var o=this.edges[n].getData();this.edges.splice(n,1),n--,this.eventCenter.emit(Sh.EDGE_DELETE,{data:o})}},t.prototype.deleteEdgeById=function(t){if(this.edgesMap[t]){var e=this.edgesMap[t].index,n=this.edgesMap[t].model.getData();this.edges.splice(e,1),this.eventCenter.emit(Sh.EDGE_DELETE,{data:n})}},t.prototype.deleteEdgeBySource=function(t){for(var e=0;e<this.edges.length;e++)if(this.edges[e].sourceNodeId===t){var n=this.edges[e].getData();this.edges.splice(e,1),e--,this.eventCenter.emit(Sh.EDGE_DELETE,{data:n})}},t.prototype.deleteEdgeByTarget=function(t){for(var e=0;e<this.edges.length;e++)if(this.edges[e].targetNodeId===t){var n=this.edges[e].getData();this.edges.splice(e,1),e--,this.eventCenter.emit(Sh.EDGE_DELETE,{data:n})}},t.prototype.setElementStateById=function(t,e,n){this.nodes.forEach(function(o){o.id===t?o.setElementState(e,n):o.setElementState(mh.DEFAULT)}),this.edges.forEach(function(o){o.id===t?o.setElementState(e,n):o.setElementState(mh.DEFAULT)})},t.prototype.updateText=function(t,e){var n=mr(Ov(Ov([],Sv(this.nodes),!1),Sv(this.edges),!1),function(e){return e.id===t});null==n||n.updateText(e)},t.prototype.selectNodeById=function(t,e){var n;void 0===e&&(e=!1),e||this.clearSelectElements();var o=null===(n=this.nodesMap[t])||void 0===n?void 0:n.model;null==o||o.setSelected(!0)},t.prototype.selectEdgeById=function(t,e){var n;void 0===e&&(e=!1),e||this.clearSelectElements();var o=null===(n=this.edgesMap[t])||void 0===n?void 0:n.model;null==o||o.setSelected(!0)},t.prototype.selectElementById=function(t,e){void 0===e&&(e=!1),e||this.clearSelectElements();var n=this.getElement(t);null==n||n.setSelected(!0)},t.prototype.deselectElementById=function(t){var e=this.getElement(t);e&&e.setSelected(!1)},t.prototype.clearSelectElements=function(){var t;this.selectElements.forEach(function(t){null==t||t.setSelected(!1)}),this.selectElements.clear(),[Ch.DEFAULT,Ch.EDGE_TOP].includes(this.overlapMode)&&(null===(t=this.topElement)||void 0===t||t.setZIndex())},t.prototype.moveNodes=function(t,e,n,o){var r,i,a,s=this;void 0===o&&(o=!1);for(var l=t.reduce(function(t,r){var i,a=null===(i=s.nodesMap[r])||void 0===i?void 0:i.model;return a&&(t[r]=a.getMoveDistance(e,n,o)),t},{}),u=0;u<this.edges.length;u++){var c=this.edges[u],d=c.textPosition,p=d.x,h=d.y,f=l[c.sourceNodeId],g=l[c.targetNodeId],y=void 0,v=void 0;f&&g&&c.modelType===Eh.POLYLINE_EDGE?(y=(r=Sv(f,2))[0],v=r[1],c.updatePointsList(y,v)):(f&&(y=(i=Sv(f,2))[0],v=i[1],c.moveStartPoint(y,v)),g&&(y=(a=Sv(g,2))[0],v=a[1],c.moveEndPoint(y,v))),(f||g)&&this.handleEdgeTextMove(c,p,h)}},t.prototype.addNodeMoveRules=function(t){this.nodeMoveRules.includes(t)||this.nodeMoveRules.push(t)},t.prototype.addNodeResizeRules=function(t){this.nodeResizeRules.includes(t)||this.nodeResizeRules.push(t)},t.prototype.setDefaultEdgeType=function(t){this.edgeType=t},t.prototype.changeNodeType=function(t,e){var n=this.getNodeModelById(t);if(n){var o=n.getData();o.type=e;var r=this.getModel(e);if(!r)throw new Error("找不到".concat(e,"对应的节点，请确认是否已注册此类型节点。"));var i=new r(o,this);this.nodes.splice(this.nodesMap[t].index,1,i),this.getNodeEdges(t).forEach(function(e){if(e.sourceNodeId===t){var n=Kf(i,e.startPoint,i.width,i.height);e.updateStartPoint(n)}if(e.targetNodeId===t){n=Kf(i,e.endPoint,i.width,i.height);e.updateEndPoint(n)}})}else console.warn("找不到id为".concat(t,"的节点"))},t.prototype.changeEdgeType=function(t,e){var n=this.getEdgeModelById(t);if(n){if(n.type!==e){var o=n.getData();o.type=e;var r=this.getModel(e);if(!r)throw new Error("找不到".concat(e,"对应的节点，请确认是否已注册此类型节点。"));delete o.pointsList;var i=new r(o,this);this.edges.splice(this.edgesMap[t].index,1,i)}}else console.warn("找不到id为".concat(t,"的边"))},t.prototype.getNodeIncomingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.targetNodeId===t&&e.push(n)}),e},t.prototype.getNodeOutgoingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.sourceNodeId===t&&e.push(n)}),e},t.prototype.getAnchorIncomingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.targetAnchorId===t&&e.push(n)}),e},t.prototype.getAnchorOutgoingEdge=function(t){var e=[];return this.edges.forEach(function(n){n.sourceAnchorId===t&&e.push(n)}),e},t.prototype.getNodeIncomingNode=function(t){var e=this,n=[];return this.edges.forEach(function(o){var r;o.targetNodeId===t&&n.push(null===(r=e.nodesMap[o.sourceNodeId])||void 0===r?void 0:r.model)}),n},t.prototype.getNodeOutgoingNode=function(t){var e=this,n=[];return this.edges.forEach(function(o){o.sourceNodeId===t&&n.push(e.nodesMap[o.targetNodeId].model)}),n},t.prototype.setTheme=function(t,e){var n;if(e&&(Fg[e]&&this.updateBackgroundOptions(Ev(Ev({},"object"==typeof this.background?this.background:{}),Fg[e])),Xg[e]&&this.updateGridOptions(rv.getGridOptions(Ev(Ev({},this.grid),Xg[e])))),t.background&&this.updateBackgroundOptions(t.background),t.grid){var o=rv.getGridOptions(null!==(n=t.grid)&&void 0!==n&&n);this.updateGridOptions(o)}this.theme=Gg(Ev(Ev({},this.customStyles),t),e),this.customStyles=Ev(Ev({},this.customStyles),t)},t.prototype.getTheme=function(){var t=this.background,e=this.grid;return Ev(Ev({},ne(this.theme)),{background:t,grid:e})},t.prototype.updateGridOptions=function(t){de(this.grid,t)},t.prototype.updateGridSize=function(t){this.gridSize=t},t.prototype.updateBackgroundOptions=function(t){ii(t)||ii(this.background)?this.background=t:this.background=Ev(Ev({},this.background),t)},t.prototype.resize=function(t,e){if(this.rootEl&&document.body.contains(this.rootEl)){var n=null!==this.rootEl.offsetParent;if(n)try{this.width=null!=t?t:this.rootEl.getBoundingClientRect().width,this.isContainerWidth=ae(t),this.height=null!=e?e:this.rootEl.getBoundingClientRect().height,this.isContainerHeight=ae(e),!n||this.width&&this.height||console.warn("渲染画布的时候无法获取画布宽高，请确认在container已挂载到DOM。@see https://github.com/didi/LogicFlow/issues/675")}catch(o){console.warn("获取画布宽高时发生错误:",o)}}},t.prototype.clearData=function(){this.nodes=[],this.edges=[],this.edgeModelMap.clear(),this.nodeModelMap.clear(),this.elementsModelMap.clear()},t.prototype.getVirtualRectSize=function(){var t=this.nodes,e=[],n=[];t.forEach(function(t){var o=t.x,r=t.y,i=t.width,a=t.height,s=t.getNodeStyle().strokeWidth,l=void 0===s?0:s,u=o+i/2+l,c=o-i/2-l,d=r+a/2+l,p=r-a/2-l;e=e.concat([u,c].filter(function(t){return!Number.isNaN(t)})),n=n.concat([d,p].filter(function(t){return!Number.isNaN(t)}))});var o=Math.min.apply(Math,Ov([],Sv(e),!1)),r=Math.max.apply(Math,Ov([],Sv(e),!1)),i=Math.min.apply(Math,Ov([],Sv(n),!1)),a=r-o||0,s=Math.max.apply(Math,Ov([],Sv(n),!1))-i||0;return{width:a,height:s,x:o+a/2,y:i+s/2}},t.prototype.translateCenter=function(){var t=this,e=t.nodes,n=t.width,o=t.height,r=t.rootEl,i=t.transformModel;if(e.length){var a=n||r.clientWidth,s=o||r.clientHeight,l=this.getVirtualRectSize(),u=l.x,c=l.y;i.focusOn(u,c,a,s)}},t.prototype.fitView=function(t,e){void 0===t&&(t=20),void 0===e&&(e=20);var n=this,o=n.nodes,r=n.width,i=n.height,a=n.rootEl,s=n.transformModel;if(o.length){var l=r||a.clientWidth,u=i||a.clientHeight,c=this.getVirtualRectSize(),d=c.width,p=c.height,h=c.x,f=c.y,g=(d+e)/l,y=(p+t)/u,v=1/Math.max(g,y),m=[l/2,u/2];s.zoom(v,m),s.focusOn(h,f,l,u)}},t.prototype.openEdgeAnimation=function(t){var e=this.getEdgeModelById(t);null==e||e.openEdgeAnimation()},t.prototype.closeEdgeAnimation=function(t){var e=this.getEdgeModelById(t);null==e||e.closeEdgeAnimation()},t.prototype.getPartial=function(){return this.partial},t.prototype.setPartial=function(t){this.partial=t},t.prototype.destroy=function(){try{this.waitCleanEffects.forEach(function(t){t()})}catch(t){console.warn("error on destroy GraphModel",t)}this.waitCleanEffects.length=0,this.eventCenter.destroy()},wv([Qu],t.prototype,"width",void 0),wv([Qu],t.prototype,"height",void 0),wv([Qu],t.prototype,"theme",void 0),wv([Qu],t.prototype,"grid",void 0),wv([Qu],t.prototype,"edgeType",void 0),wv([Qu],t.prototype,"nodes",void 0),wv([Qu],t.prototype,"edges",void 0),wv([Qu],t.prototype,"fakeNode",void 0),wv([Qu],t.prototype,"overlapMode",void 0),wv([Qu],t.prototype,"background",void 0),wv([Qu],t.prototype,"gridSize",void 0),wv([Qu],t.prototype,"transformModel",void 0),wv([Qu],t.prototype,"editConfigModel",void 0),wv([Qu],t.prototype,"partial",void 0),wv([sc],t.prototype,"nodesMap",null),wv([sc],t.prototype,"edgesMap",null),wv([sc],t.prototype,"modelsMap",null),wv([sc],t.prototype,"sortElements",null),wv([sc],t.prototype,"textEditElement",null),wv([sc],t.prototype,"selectElements",null),wv([sc],t.prototype,"selectNodes",null),wv([ed],t.prototype,"setOverlapMode",null),wv([ed],t.prototype,"setTextMode",null),wv([ed],t.prototype,"setFakeNode",null),wv([ed],t.prototype,"removeFakeNode",null),wv([ed],t.prototype,"setModel",null),wv([ed],t.prototype,"toFront",null),wv([ed],t.prototype,"setElementZIndex",null),wv([ed],t.prototype,"deleteNode",null),wv([ed],t.prototype,"addNode",null),wv([ed],t.prototype,"cloneNode",null),wv([ed],t.prototype,"moveNode",null),wv([ed],t.prototype,"moveNode2Coordinate",null),wv([ed],t.prototype,"editText",null),wv([ed],t.prototype,"addEdge",null),wv([ed],t.prototype,"moveEdge",null),wv([ed],t.prototype,"deleteEdgeBySourceAndTarget",null),wv([ed],t.prototype,"deleteEdgeById",null),wv([ed],t.prototype,"deleteEdgeBySource",null),wv([ed],t.prototype,"deleteEdgeByTarget",null),wv([ed],t.prototype,"setElementStateById",null),wv([ed],t.prototype,"updateText",null),wv([ed],t.prototype,"selectNodeById",null),wv([ed],t.prototype,"selectEdgeById",null),wv([ed],t.prototype,"selectElementById",null),wv([ed],t.prototype,"deselectElementById",null),wv([ed],t.prototype,"clearSelectElements",null),wv([ed],t.prototype,"moveNodes",null),wv([ed],t.prototype,"setDefaultEdgeType",null),wv([ed],t.prototype,"changeNodeType",null),wv([ed],t.prototype,"changeEdgeType",null),wv([ed],t.prototype,"getNodeIncomingEdge",null),wv([ed],t.prototype,"getNodeOutgoingEdge",null),wv([ed],t.prototype,"getAnchorIncomingEdge",null),wv([ed],t.prototype,"getAnchorOutgoingEdge",null),wv([ed],t.prototype,"getNodeIncomingNode",null),wv([ed],t.prototype,"getNodeOutgoingNode",null),wv([ed],t.prototype,"setTheme",null),wv([ed],t.prototype,"getTheme",null),wv([ed],t.prototype,"resize",null),wv([ed],t.prototype,"clearData",null),wv([ed],t.prototype,"translateCenter",null),wv([ed],t.prototype,"fitView",null),wv([ed],t.prototype,"openEdgeAnimation",null),wv([ed],t.prototype,"closeEdgeAnimation",null),wv([ed],t.prototype,"setPartial",null),t}(),Tv=function(){return Tv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Tv.apply(this,arguments)},Mv=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Nv=function(){function t(t,e){void 0===e&&(e=1),this.isShowHorizontal=!1,this.isShowVertical=!1,this.position={x:0,y:0},this.graphModel=t,this.epsilon=e}return t.prototype.getStyle=function(){return Tv({},this.graphModel.theme.snapline)},t.prototype.getCenterSnapLine=function(t,e){for(var n=t.x,o=t.y,r=!1,i=!1,a=0;a<e.length;a++){var s=e[a];if(s.id!==t.id&&(Av(n,s.x,this.epsilon)&&(r=!0),Av(o,s.y,this.epsilon)&&(i=!0),r&&i))break}return{isShowVertical:r,isShowHorizontal:i,position:{x:n,y:o}}},t.prototype.getHorizontalSnapline=function(t,e){var n,o=!1,r=0,i=t.id;if(i){var a=this.graphModel.fakeNode;if(a&&a.id===i)n=Wf(a);else{var s=this.graphModel.getNodeModelById(i);s&&(n=Wf(s))}}for(var l=0;l<e.length;l++){var u=e[l];if(u.id!==t.id){var c=Wf(u);if(Av(c.minY,null==n?void 0:n.minY,this.epsilon)||Av(c.maxY,null==n?void 0:n.minY,this.epsilon)){o=!0,r=n.minY;break}if(Av(c.minY,null==n?void 0:n.maxY,this.epsilon)||Av(c.maxY,null==n?void 0:n.maxY,this.epsilon)){o=!0,r=n.maxY;break}}}return{isShowHorizontal:o,isShowVertical:this.isShowVertical,position:Tv(Tv({},this.position),{y:r})}},t.prototype.getVerticalSnapline=function(t,e){var n,o=!1,r=0,i=t.id;if(i){var a=this.graphModel.fakeNode;if(a&&a.id===i)n=Wf(a);else{var s=this.graphModel.getNodeModelById(i);s&&(n=Wf(s))}}for(var l=0;l<e.length;l++){var u=e[l];if(u.id!==t.id){var c=Wf(u);if(Av(c.minX,null==n?void 0:n.minX,this.epsilon)){o=!0,r=n.minX;break}if(Av(c.minX,null==n?void 0:n.minX,this.epsilon)||Av(c.maxX,null==n?void 0:n.minX,this.epsilon)){o=!0,r=n.minX;break}if(Av(c.minX,null==n?void 0:n.maxX,this.epsilon)||Av(c.maxX,null==n?void 0:n.maxX,this.epsilon)){o=!0,r=n.maxX;break}}}return{isShowHorizontal:this.isShowHorizontal,isShowVertical:o,position:Tv(Tv({},this.position),{x:r})}},t.prototype.getSnapLinePosition=function(t,e){var n=this.getCenterSnapLine(t,e),o=n.isShowHorizontal,r=n.isShowVertical;if(!o){var i=this.getHorizontalSnapline(t,e);i.isShowHorizontal&&(n.isShowHorizontal=i.isShowHorizontal,n.position.y=i.position.y)}if(!r){var a=this.getVerticalSnapline(t,e);a.isShowVertical&&(n.isShowVertical=a.isShowVertical,n.position.x=a.position.x)}return n},t.prototype.setSnaplineInfo=function(t){var e=t.isShowHorizontal,n=t.isShowVertical,o=t.position;this.position=o,this.isShowHorizontal=e,this.isShowVertical=n},t.prototype.clearSnapline=function(){this.position={x:0,y:0},this.isShowHorizontal=!1,this.isShowVertical=!1},t.prototype.setNodeSnapLine=function(t){var e=this.graphModel.nodes,n=this.getSnapLinePosition(t,e);this.setSnaplineInfo(n)},Mv([Qu],t.prototype,"isShowHorizontal",void 0),Mv([Qu],t.prototype,"isShowVertical",void 0),Mv([Qu],t.prototype,"position",void 0),Mv([ed],t.prototype,"clearSnapline",null),Mv([ed],t.prototype,"setNodeSnapLine",null),t}();function Av(t,e,n){return Math.abs(t-e)<=n}var Pv,Dv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),kv=function(t){function e(){var e=t.apply(this,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(arguments),!1))||this;return e.handleResize=function(){var t=e.props,n=t.graphModel,o=t.options,r=n.width,i=n.height,a=r,s=i,l=!1;n.isContainerWidth&&(a=void 0,l=!0),n.isContainerHeight&&(s=void 0,l=!0),l&&n.resize(a,s),o.width=r,o.height=i},e.throttleResize=Jt(e.handleResize,200),e}return Dv(e,t),e.prototype.componentDidMount=function(){window.addEventListener("resize",this.throttleResize)},e.prototype.componentDidUpdate=function(){var t=this.props.graphModel.modelToGraphData();this.props.graphModel.eventCenter.emit(Sh.GRAPH_UPDATED,{data:t})},e.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.throttleResize)},e.prototype.getComponent=function(t,e,n){void 0===n&&(n="canvas-overlay");var o=(0,this.props.getView)(t.type);return o?ph(o,{model:t,graphModel:e,overlay:n},t.id):null},e.prototype.render=function(){var t=this,e=this.props,n=e.graphModel,o=e.tool,r=e.options,i=e.dnd,a=e.snaplineModel,s={};r.width&&(s.width="".concat(n.width,"px")),r.height&&(s.height="".concat(n.height,"px"));var l=n.fakeNode,u=n.editConfigModel,c=n.background,d=u.adjustEdge;return ph("div",{className:"lf-graph","flow-id":n.flowId,style:s,children:[ph(Zy,{graphModel:n,dnd:i,children:[ph("g",{className:"lf-base",children:at(n.sortElements,function(e){return t.getComponent(e,n)})}),l?this.getComponent(l,n):""]}),ph(av,{graphModel:n,children:[ph(uv,{graphModel:n}),d?ph(tv,{graphModel:n}):"",!1!==r.snapline?ph(pv,{snaplineModel:a}):""]}),ph(fv,{graphModel:n,tool:o}),c&&ph(nv,{background:c}),ph(rv,{graphModel:n})]})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),Rv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Lv=function(){return Lv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Lv.apply(this,arguments)},Iv=function(t){function e(){var e=t.call(this)||this;return e.onDragStart=function(t){var n=t.event,o=e.props,r=o.anchorData,i=o.nodeModel,a=o.graphModel;a.selectNodeById(i.id),i.autoToFront&&a.toFront(i.id),a.eventCenter.emit(Sh.ANCHOR_DRAGSTART,{data:r,e:n,nodeModel:i}),e.setState({startX:r.x,startY:r.y,endX:r.x,endY:r.y})},e.onDragging=function(t){var n=t.event,o=e.props,r=o.graphModel,i=o.nodeModel,a=o.anchorData,s=r.transformModel,l=r.eventCenter,u=r.width,c=r.height,d=r.editConfigModel,p=d.autoExpand,h=d.stopMoveGraph;if(n){var f=n.clientX,g=n.clientY,y=r.getPointByClient({x:f,y:g}),v=y.domOverlayPosition,m=v.x,b=v.y,_=y.canvasOverlayPosition,x=_.x,E=_.y;e.t&&sg(e.t);var w=[];m<10?w=[10,0]:m+10>u?w=[-10,0]:b<10?w=[0,10]:b+10>c&&(w=[0,-10]),e.setState({endX:x,endY:E,dragging:!0}),e.moveAnchorEnd(x,E),w.length>0&&!h&&p&&(e.t=ag(function(){var t=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(w,2),n=t[0],o=t[1];s.translate(n,o);var r=e.state,i=r.endX,a=r.endY;e.setState({endX:i-n,endY:a-o}),e.moveAnchorEnd(i-n,a-o)})),l.emit(Sh.ANCHOR_DRAG,{data:a,e:n,nodeModel:i})}},e.onDragEnd=function(t){var n=t.event;e.t&&sg(e.t);var o=e.checkEnd(n);e.setState({startX:0,startY:0,endX:0,endY:0,dragging:!1}),e.sourceRuleResults.clear(),e.targetRuleResults.clear();var r=e.props,i=r.graphModel,a=r.nodeModel,s=r.anchorData;i.eventCenter.emit(Sh.ANCHOR_DRAGEND,{data:s,e:n,nodeModel:a,edgeModel:null!=o?o:void 0})},e.checkEnd=function(t){var n,o=e.props,r=o.graphModel,i=o.nodeModel,a=o.anchorData,s=a.x,l=a.y,u=a.id,c=e.state,d=c.endX,p=c.endY,h=c.dragging,f=jf({x:d,y:p},r);if(e.preTargetNode&&e.preTargetNode.state!==mh.DEFAULT&&e.preTargetNode.setElementState(mh.DEFAULT),h&&f&&f.node){var g=f.node,y=f.anchor.id,v="".concat(i.id,"_").concat(g.id,"_").concat(y,"_").concat(u),m=e.sourceRuleResults.get(v)||{},b=m.isAllPass,_=m.msg,x=e.targetRuleResults.get(v)||{},E=x.isAllPass,w=x.msg;if(b&&E){g.setElementState(mh.DEFAULT);var S=r.getNodeModelById(f.node.id),O=null===(n=r.edgeGenerator)||void 0===n?void 0:n.call(r,i.getData(),null==S?void 0:S.getData()),C=r.addEdge(Lv(Lv({},O),{sourceNodeId:i.id,sourceAnchorId:u,startPoint:{x:s,y:l},targetNodeId:f.node.id,targetAnchorId:f.anchor.id,endPoint:{x:f.anchor.x,y:f.anchor.y}})),T=e.props.anchorData;return r.eventCenter.emit(Sh.ANCHOR_DROP,{data:T,e:t,nodeModel:i,edgeModel:C}),C}var M=g.getData();return r.eventCenter.emit(Sh.CONNECTION_NOT_ALLOWED,{data:M,msg:w||_||"不允许添加连线"}),null}},e.sourceRuleResults=new Map,e.targetRuleResults=new Map,e.state={startX:0,startY:0,endX:0,endY:0,dragging:!1},e.dragHandler=new kh({onDragStart:e.onDragStart,onDragging:e.onDragging,onDragEnd:e.onDragEnd}),e}return Rv(e,t),e.prototype.getAnchorShape=function(){var t=this.props,e=t.anchorData,n=t.style,o=t.node.getAnchorShape(e);if(o)return o;var r=e.x,i=e.y,a=Lv(Lv({},n),null==n?void 0:n.hover);return ph("g",{children:[ph(vg,Lv({className:"lf-node-anchor-hover"},a,{x:r,y:i})),ph(vg,Lv({className:"lf-node-anchor"},n,{x:r,y:i}))]})},Object.defineProperty(e.prototype,"customTrajectory",{get:function(){return this.props.graphModel.customTrajectory},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relateEdges",{get:function(){var t=this.props,e=t.graphModel,n=e.getAnchorIncomingEdge,o=e.getAnchorOutgoingEdge,r=t.anchorData.id;return{incomingEdgeList:n(r),outgoingEdgeList:o(r)}},enumerable:!1,configurable:!0}),e.prototype.moveAnchorEnd=function(t,e){var n,o,r=this.props,i=r.graphModel,a=r.nodeModel,s=r.anchorData,l=jf({x:t,y:e},i);if(l){var u=l.node,c=l.anchor.id;if(this.preTargetNode&&this.preTargetNode!==l.node&&this.preTargetNode.setElementState(mh.DEFAULT),s.id===c)return;this.preTargetNode=u;var d="".concat(a.id,"_").concat(u.id,"_").concat(c,"_").concat(s.id);if(!this.targetRuleResults.has(d)){var p=l.anchor,h=a.isAllowConnectedAsSource(u,s,p),f=u.isAllowConnectedAsTarget(a,s,p);this.sourceRuleResults.set(d,$f(h)),this.targetRuleResults.set(d,$f(f))}var g=(null!==(n=this.sourceRuleResults.get(d))&&void 0!==n?n:{}).isAllPass,y=(null!==(o=this.targetRuleResults.get(d))&&void 0!==o?o:{}).isAllPass;g&&y?u.setElementState(mh.ALLOW_CONNECT):u.setElementState(mh.NOT_ALLOW_CONNECT)}else this.preTargetNode&&this.preTargetNode.state!==mh.DEFAULT&&this.preTargetNode.setElementState(mh.DEFAULT)},e.prototype.isShowLine=function(){var t=this.state,e=t.startX,n=t.startY,o=t.endX,r=t.endY;return Hf(e,n,o,r)>10},e.prototype.render=function(){var t=this,e=this.state,n=e.startX,o=e.startY,r=e.endX,i=e.endY,a=this.props,s=a.anchorData,l=a.edgeStyle,u=a.nodeModel,c=a.graphModel,d=s.edgeAddable;return ph("g",{className:"lf-anchor",children:[ph("g",{onClick:function(t){t.stopPropagation(),c.eventCenter.emit(Sh.ANCHOR_CLICK,{data:s,e:t,nodeModel:u})},onMouseDown:function(e){c.eventCenter.emit(Sh.ANCHOR_MOUSEDOWN,{data:s,e:e,nodeModel:u}),!1!==d&&t.dragHandler.handleMouseDown(e)},children:this.getAnchorShape()}),this.isShowLine()&&(this.customTrajectory?this.customTrajectory(Lv({sourcePoint:{x:n,y:o},targetPoint:{x:r,y:i}},l)):ph(dg,Lv({x1:n,y1:o,x2:r,y2:i},l,{"pointer-events":"none"})))]})},e}(Xl),jv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bv=function(){return Bv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Bv.apply(this,arguments)},Hv=function(t){function e(e){var n=t.call(this,e)||this;return n.style={},n.onDragging=function(t){var e,o=t.event,r=n.props,i=r.graphModel,a=r.nodeModel,s=r.eventCenter,l=i.selectNodes,u=a.x,c=a.y,d=o.clientX,p=o.clientY,h=i.getPointByClient({x:d,y:p}).canvasOverlayPosition,f=h.x,g=h.y,y=new Cf(f-u,g-c),v=(null===(e=n.normal)||void 0===e?void 0:e.angle(y))-n.defaultAngle,m=new Rf(-u,-c).rotate(v).translate(u,c).toString();a.transform=m,a.rotate=v;var b=at(l,function(t){return t.id});-1===b.indexOf(a.id)&&(b=[a.id]);var _=Fa(b,function(t,e){var n=i.getNodeModelById(e);return t[e]=null==n?void 0:n.getMoveDistance(0,0,!1),t},{});b.forEach(function(t){i.getNodeEdges(t).forEach(function(t){if(_[t.sourceNodeId]){var e=i.getNodeModelById(t.sourceNodeId).anchors.find(function(e){return e.id===t.sourceAnchorId});t.updateStartPoint(e)}if(_[t.targetNodeId]){e=i.getNodeModelById(t.targetNodeId).anchors.find(function(e){return e.id===t.targetAnchorId});t.updateEndPoint(e)}})}),s.emit(Sh.NODE_ROTATE,{e:o,model:a,data:a.getData()})},n.style=e.style,n.stepperDrag=new kh({onDragging:n.onDragging}),n}return jv(e,t),e.prototype.render=function(){var t=this,e=this.props.nodeModel,n=e.x,o=e.y,r=n+e.width/2+20,i=o-e.height/2-20;return this.normal=new Cf(1,0),this.defaultAngle=this.normal.angle(new Cf(r-n,i-o)),e.defaultAngle=this.defaultAngle,ph("g",{className:"lf-rotate-control",children:ph("g",{onMouseDown:function(e){t.stepperDrag.handleMouseDown(e)},children:ph(vg,Bv({},this.style,{cx:r,cy:i}))})})},e}(Xl),zv={exports:{}};var Fv=(Pv||(Pv=1,function(t){!function(){var e={}.hasOwnProperty;function n(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];n&&(t=r(t,o(n)))}return t}function o(t){if("string"==typeof t||"number"==typeof t)return t;if("object"!=typeof t)return"";if(Array.isArray(t))return n.apply(null,t);if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]"))return t.toString();var o="";for(var i in t)e.call(t,i)&&t[i]&&(o=r(o,i));return o}function r(t,e){return e?t?t+" "+e:t+e:t}t.exports?(n.default=n,t.exports=n):window.classNames=n}()}(zv)),zv.exports);const Wv=be(Fv);var Xv,Uv,Gv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Yv=function(){return Yv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Yv.apply(this,arguments)},Vv=function(t){function e(e){var n=t.call(this)||this;n.mouseDownHandler=function(t){var e=n.props,o=e.draggable,r=e.model,i=e.graphModel.editConfigModel.nodeTextDraggable;(null!=o?o:i)&&(t.stopPropagation(),n.stepperDrag.model=r,n.stepperDrag.handleMouseDown(t))},n.onDragging=function(t){var e=t.deltaX,o=t.deltaY,r=n.props,i=r.model,a=r.graphModel.transformModel;if(e||o){var s=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(a.fixDeltaXY(e,o),2),l=s[0],u=s[1];i.moveText(l,u)}},n.dbClickHandler=function(){var t=n.props,e=t.editable,o=t.graphModel.eventCenter,r=t.model;e&&r.setElementState(mh.TEXT_EDIT),o.emit(Sh.TEXT_DBCLICK,{data:r.text,model:r})};var o=e.draggable;return n.stepperDrag=new kh({onDragging:n.onDragging,step:1,eventType:"TEXT",isStopPropagation:o}),n}return Gv(e,t),e.prototype.getShape=function(){var t=this.props,e=t.model,n=t.graphModel.editConfigModel,o=e.text,r=o.value,i=o.x,a=o.y,s=o.editable,l=o.draggable,u={x:i,y:a,className:"",value:r},c=e.getTextStyle(),d=n.nodeTextDraggable||l;return ph(ug,Yv({},u,c,{className:Wv({"lf-element-text":s,"lf-text-draggable":!s&&d,"lf-text-disabled":!s&&!d}),model:e}))},e.prototype.render=function(){if(this.props.model.text)return ph("g",{onMouseDown:this.mouseDownHandler,onDblClick:this.dbClickHandler,children:this.getShape()})},e}(Xl),Kv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),qv=function(){return qv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},qv.apply(this,arguments)},Zv=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},$v=function(t){function e(e){var n=t.call(this,e)||this;return n.setHoverOn=function(){n.setState({isHovered:!0})},n.setHoverOff=function(){n.setState({isHovered:!1})},n.state={isHovered:!1},n}return Kv(e,t),e.prototype.getBackground=function(){var t=this.state.isHovered,e=this.props.model,n=e.text,o=e.getTextStyle(),r=o.background||{};if(t&&o.hover&&o.hover.background&&(r=qv(qv({},r),o.hover.background)),(null==n?void 0:n.value)&&"transparent"!==(null==r?void 0:r.fill)){var i=o.fontSize,a=o.textWidth,s=o.lineHeight,l=o.overflowMode,u=r.wrapPadding,c=null==n?void 0:n.value.split(/[\r\n]/g),d=c.length,p=n.x,h=n.y,f={};if("autoWrap"===l&&a){var g=qf({rows:c,style:{fontSize:"".concat(i,"px"),width:"".concat(a,"px"),lineHeight:s,padding:u},rowsLength:d,className:"lf-get-text-height"});f=qv(qv({},r),{x:p,y:h,width:a,height:g})}else{var y=function(t){var e=t.rows,n=t.rowsLength,o=t.fontSize,r=0;return $o(e,function(t){var e=cf(t);r=e>r?e:r}),{width:Math.ceil(r/2)*o+o/4,height:n*(o+2)+o/4}}({rows:c,rowsLength:d,fontSize:i}),v=y.width,m=y.height;if("ellipsis"===l&&(v=a,m=i+2),"string"==typeof r.wrapPadding){var b=r.wrapPadding.split(",").filter(function(t){return t.trim()}).map(function(t){return parseFloat(t.trim())});if(b.length>0&&b.length<=4){if(1===b.length){var _=Zv(b,1)[0];b=[_,_,_,_]}else if(2===b.length){var x=Zv(b,2),E=x[0];b=[E,w=x[1],E,w]}else if(3===b.length){var w,S=Zv(b,3);b=[S[0],w=S[1],S[2],w]}var O=Zv(b,4),C=O[0],T=O[1],M=O[2],N=O[3];v+=T+N,m+=C+M,p+=(T-N)/2,h+=(M-C)/2}}f=qv(qv({},r),{x:p-1,y:h-1,width:v,height:m})}return ph(hg,qv({},f))}return null},e.prototype.getShape=function(){var t=this.props.model,e=t.text,n=e.x,o=e.y,r=e.value;if(!r)return null;var i=t.getTextStyle(),a=qv({x:n,y:o,value:r,model:t,className:"lf-element-text"},i);return ph("g",{className:"lf-line-text",onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,children:[this.getBackground(),ph(ug,qv({},a))]})},e}(Vv),Jv=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qv=function(){return Qv=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Qv.apply(this,arguments)},tm=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},em=function(t){function e(e){var n=t.call(this)||this;n.onDragStart=function(t){var e=t.event,o=n.props,r=o.model,i=o.graphModel;if(e){var a=i.getPointByClient({x:e.clientX,y:e.clientY}).canvasOverlayPosition,s=a.x,l=a.y;n.moveOffset={dx:r.x-s,dy:r.y-l}}},n.onDragging=function(t){var e,o,r,i,a=t.event,s=n.props,l=s.model,u=s.graphModel,c=u.editConfigModel,d=c.stopMoveGraph,p=c.autoExpand,h=c.snapGrid,f=u.transformModel,g=u.selectNodes,y=u.width,v=u.height,m=u.gridSize;l.isDragging=!0;var b=a,_=b.clientX,x=b.clientY,E=n.mouseDownPosition,w=E.x,S=E.y;(_-w>m||x-S>m)&&(l.isDragging=!0);var O=u.getPointByClient({x:_,y:x}).canvasOverlayPosition,C=O.x,T=O.y,M=tm(f.CanvasPointToHtmlPoint([C,T]),2),N=M[0],A=M[1];if(C+=null!==(o=null===(e=n.moveOffset)||void 0===e?void 0:e.dx)&&void 0!==o?o:0,T+=null!==(i=null===(r=n.moveOffset)||void 0===r?void 0:r.dy)&&void 0!==i?i:0,C=bf(C,m,h),T=bf(T,m,h),y&&v){if(!p||d||!(N<0||A<0||N>y||A>v)){var P=tm(f.CanvasPointToHtmlPoint([C-l.width/2,T-l.height/2]),2),D=P[0],k=P[1],R=tm(f.CanvasPointToHtmlPoint([C+l.width/2,T+l.height/2]),2),L=R[0],I=R[1],j=Math.max(m,20),B=[];D<0?B=[j,0]:L>u.width?B=[-j,0]:k<0?B=[0,j]:I>u.height&&(B=[0,-j]),n.t&&sg(n.t);var H=g.map(function(t){return t.id});-1===H.indexOf(l.id)&&(H=[l.id]),B.length>0&&!d&&p?n.t=ag(function(){var t=tm(B,2),e=t[0],n=t[1];f.translate(null!=e?e:0,null!=n?n:0);var o=-(null!=e?e:0)/f.SCALE_X,r=-(null!=n?n:0)/f.SCALE_X;u.moveNodes(H,o,r)}):u.moveNodes(H,C-l.x,T-l.y)}}else u.moveNode2Coordinate(l.id,C,T)},n.onDragEnd=function(){n.t&&sg(n.t),n.props.model.isDragging=!1},n.onMouseOut=function(t){null!==O(window,"navigator.userAgent","").match(/MSIE|Trident/)&&n.setHoverOff(t)},n.handleMouseUp=function(){var t=n.props.model;n.mouseUpDrag=t.isDragging},n.handleClick=function(t){var e=!1===n.mouseUpDrag,o=(new Date).getTime();if(n.startTime){var r=o-n.startTime,i=n.props,a=i.model,s=i.graphModel;if(e||!(r>300)){e||(n.onDragEnd(),n.handleMouseUp());var l={data:a.getData(),e:t,position:s.getPointByClient({x:t.clientX,y:t.clientY}),isSelected:!1,isMultiple:!1},u=2===t.button,c=2===t.detail;if(!u){var d=s.editConfigModel,p=Ef(t,d);if(l.isMultiple=p,a.isSelected&&!c&&p?(l.isSelected=!1,a.setSelected(!1)):(s.selectNodeById(a.id,p),l.isSelected=!0,d.isSilentMode||n.toFront()),c)d.nodeTextEdit&&a.text.editable&&d.textMode===Ah.TEXT&&(a.setSelected(!1),s.setElementStateById(a.id,mh.TEXT_EDIT)),s.eventCenter.emit(Sh.NODE_DBCLICK,l);else{s.eventCenter.emit(Sh.ELEMENT_CLICK,l),s.eventCenter.emit(Sh.NODE_CLICK,l);var h=t.currentTarget,f=!ae(window)&&lt(window.requestAnimationFrame)?window.requestAnimationFrame.bind(window):function(t){return setTimeout(t,0)};f(function(){h.focus()})}}}}},n.handleContextMenu=function(t){t.preventDefault();var e=n.props,o=e.model,r=e.graphModel,i=r.editConfigModel,a=o.getData(),s=r.getPointByClient({x:t.clientX,y:t.clientY});r.setElementStateById(o.id,mh.SHOW_MENU,s.domOverlayPosition),o.isSelected||r.selectNodeById(o.id),r.eventCenter.emit(Sh.NODE_CONTEXTMENU,{data:a,e:t,position:s}),i.isSilentMode||n.toFront()},n.handleMouseDown=function(t){var e=n.props,o=e.model,r=e.graphModel;n.mouseDownPosition={x:t.clientX,y:t.clientY},n.startTime=(new Date).getTime(),r.editConfigModel.adjustNodePosition&&o.draggable&&n.stepDrag&&n.stepDrag.handleMouseDown(t)},n.handleFocus=function(){var t=n.props,e=t.model;t.graphModel.eventCenter.emit(Sh.NODE_FOCUS,{data:e.getData()})},n.handleBlur=function(){if(n.props){var t=n.props,e=t.model;t.graphModel.eventCenter.emit(Sh.NODE_BLUR,{data:e.getData()})}},n.setHoverOn=function(t){var e=n.props,o=e.model,r=e.graphModel;if(!o.isHovered){var i=o.getData();o.setHovered(!0),r.eventCenter.emit(Sh.NODE_MOUSEENTER,{data:i,e:t})}},n.setHoverOff=function(t){var e=n.props,o=e.model,r=e.graphModel,i=o.getData();o.isHovered&&(o.setHovered(!1),r.eventCenter.emit(Sh.NODE_MOUSELEAVE,{data:i,e:t}))};var o=e.graphModel,r=o.gridSize,i=o.eventCenter,a=e.model;return n.stepDrag=new kh({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:r,eventType:"NODE",isStopPropagation:!1,eventCenter:i,model:a}),n.modelDisposer=id(function(){return n.props},function(t){t&&t.model&&n.stepDrag.setModel(t.model)}),n}return Jv(e,t),e.prototype.componentWillUnmount=function(){this.modelDisposer&&this.modelDisposer(),this.render.$mobx&&this.render.$mobx.dispose()},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getAnchorShape=function(t){return null},e.prototype.getAnchors=function(){var t=this,e=this.props,n=e.model,o=e.graphModel,r=n.isSelected,i=n.isHitable,a=n.isDragging,s=n.isShowAnchor;return i&&(r||s)&&!a?at(n.anchors,function(e,r){var i=n.getAnchorLineStyle(e),a=n.getAnchorStyle(e);return ph(Iv,{anchorData:e,node:t,style:a,edgeStyle:i,anchorIndex:r,nodeModel:n,graphModel:o,setHoverOff:t.setHoverOff})}):[]},e.prototype.getRotateControl=function(){var t=this.props,e=t.model,n=t.graphModel,o=n.editConfigModel,r=o.isSilentMode,i=o.allowRotate,a=e.isSelected,s=e.isHitable,l=e.rotatable,u=e.isHovered,c=i&&l,d=e.getRotateControlStyle();if(!r&&s&&(a||u)&&c)return ph(Hv,{graphModel:n,nodeModel:e,eventCenter:n.eventCenter,style:d})},e.prototype.getResizeControl=function(){var t=this.props,e=t.model,n=t.graphModel,o=n.editConfigModel,r=o.isSilentMode,i=o.allowResize,a=e.isSelected,s=e.isHitable,l=e.resizable,u=e.isHovered,c=i&&l,d=e.getResizeControlStyle();return!r&&s&&(a||u)&&c?ph(Ng,{style:d,model:e,graphModel:n}):null},e.prototype.getText=function(){var t,e=this.props,n=e.model,o=e.graphModel,r=o.editConfigModel;if(r.nodeTextMode!==Ah.TEXT)return null;if(n.state===mh.TEXT_EDIT)return null;if(n.text){var i=!1;return r.nodeTextDraggable&&n.text.draggable&&(i=!0),ph(Vv,{editable:r.nodeTextEdit&&(null===(t=n.text.editable)||void 0===t||t),model:n,graphModel:o,draggable:i})}return null},e.prototype.getStateClassName=function(){var t=this.props.model,e=t.state,n=t.isDragging,o=t.isSelected,r="lf-node";switch(e){case mh.ALLOW_CONNECT:r+=" lf-node-allow";break;case mh.NOT_ALLOW_CONNECT:r+=" lf-node-not-allow";break;default:r+=" lf-node-default"}return n&&(r+=" lf-dragging"),o&&(r+=" lf-node-selected"),r},e.prototype.toFront=function(){var t=this.props,e=t.model,n=t.graphModel;e.autoToFront&&n.toFront(e.id)},e.prototype.render=function(){var t,e=this.props,n=e.model,o=e.graphModel,r=o.editConfigModel,i=r.hideAnchors,a=r.adjustNodePosition,s=r.allowRotate,l=r.allowResize,u=o.gridSize,c=o.transformModel.SCALE_X,d=n.isHitable,p=n.draggable,h=n.transform,f=n.getOuterGAttributes(),g=f.className,y=void 0===g?"":g,v=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n}(f,["className"]),m=ph("g",{className:"lf-node-content",children:[ph("g",{transform:h,children:[this.getShape(),this.getText(),s&&this.getRotateControl(),l&&this.getResizeControl()]}),!i&&this.getAnchors()]});return d?(a&&p&&this.stepDrag.setStep(u*c),t=ph("g",Qv({className:"".concat(this.getStateClassName()," ").concat(y),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,onMouseOut:this.onMouseOut,onContextMenu:this.handleContextMenu,onFocus:this.handleFocus,onBlur:this.handleBlur},v,{children:m}))):t=ph("g",Qv({className:"".concat(this.getStateClassName()," ").concat(y)},v,{children:m})),t},e.isObserved=!1,e}(Xl),nm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),om=function(){return om=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},om.apply(this,arguments)},rm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return nm(e,t),e.prototype.getShape=function(){var t=this.props.model,e=t.getNodeStyle();return ph(hg,om({},e,{x:t.x,y:t.y,width:t.width,height:t.height,radius:t.radius}))},e}(em),im=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),am=function(){return am=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},am.apply(this,arguments)},sm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return im(e,t),e.prototype.getShape=function(){var t=this.props.model,e=t.x,n=t.y,o=t.r,r=t.getNodeStyle();return ph(vg,am({},r,{x:e,y:n,r:o}))},e}(em),lm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),um=function(){return um=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},um.apply(this,arguments)},cm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return lm(e,t),e.prototype.getShape=function(){var t=this.props.model,e=t,n=e.x,o=e.y,r=e.width,i=e.height,a=e.points,s=t.getNodeStyle(),l={transform:"matrix(1 0 0 1 ".concat(n-r/2," ").concat(o-i/2,")")};return ph("g",um({},l,{children:ph(xg,um({},s,{points:a,x:n,y:o}))}))},e}(em),dm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),pm=function(){return pm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},pm.apply(this,arguments)},hm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return dm(e,t),e.prototype.getShape=function(){var t=this.props.model,e=t.getNodeStyle();return ph("g",{children:ph(xg,pm({},e,{points:t.points,x:t.x,y:t.y}))})},e}(em),fm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),gm=function(){return gm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},gm.apply(this,arguments)},ym=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return fm(e,t),e.prototype.getShape=function(){var t=this.props.model,e=t.getNodeStyle();return ph(bg,gm({},e,{x:t.x,y:t.y,rx:t.rx,ry:t.ry}))},e}(em),vm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),mm=function(){return mm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},mm.apply(this,arguments)},bm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return vm(e,t),e.prototype.getBackground=function(){var t=this.props.model,e=t.getTextStyle(),n=t.width,o=t.height,r=t.x,i=t.y,a=mm(mm({},e.background),{x:r,y:i,width:n,height:o});return ph(hg,mm({},a))},e.prototype.getResizeControl=function(){return null},e.prototype.getShape=function(){return ph("g",{children:this.getBackground()})},e}(em),_m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),xm=function(){return xm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},xm.apply(this,arguments)},Em=function(t){function e(){var e=t.apply(this,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(arguments),!1))||this;return e.ref={current:null},e}return _m(e,t),Object.defineProperty(e.prototype,"rootEl",{get:function(){return this.ref.current},enumerable:!1,configurable:!0}),e.prototype.setHtml=function(t){t.appendChild(document.createElement("div"))},e.prototype.confirmUpdate=function(t){this.setHtml(t)},e.prototype.shouldUpdate=function(){return(!this.preProperties||this.preProperties!==this.currentProperties)&&(this.preProperties=this.currentProperties,!0)},e.prototype.componentDidMount=function(){this.shouldUpdate()&&this.rootEl&&this.setHtml(this.rootEl)},e.prototype.componentDidUpdate=function(){this.shouldUpdate()&&this.rootEl&&this.confirmUpdate(this.rootEl)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this.rootEl.innerHTML=""},e.prototype.getShape=function(){var t=this.props.model,e=t.x,n=t.y,o=t.height,r=t.width,i=t.getNodeStyle();return this.currentProperties=JSON.stringify(t.properties),ph("foreignObject",xm({},i,{x:e-r/2,y:n-o/2,width:r,height:o,ref:this.ref}))},e}(em),wm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Sm=function(){return Sm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Sm.apply(this,arguments)};(Uv=Xv||(Xv={})).SOURCE="SOURCE",Uv.TARGET="TARGET";var Om=function(t){function e(e){var n=t.call(this)||this;n.handleMouseDown=function(t){n.stepDrag&&n.stepDrag.handleMouseDown(t)},n.onDragStart=function(){var t=n.props,e=t.x,o=t.y,r=t.edgeModel,i=r.startPoint,a=r.endPoint,s=r.pointsList;n.oldEdge={startPoint:i,endPoint:a,pointsList:s},n.setState({endX:e,endY:o,dragging:!0})},n.onDragging=function(t){var e=t.deltaX,o=t.deltaY,r=n.state,i=r.endX,a=r.endY,s=n.props,l=s.graphModel,u=s.type,c=l.transformModel,d=l.editConfigModel,p=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(c.moveCanvasPointByHtml([i,a],e,o),2),h=p[0],f=p[1];n.setState({endX:h,endY:f,dragging:!0});var g=n.props.edgeModel,y=jf({x:i,y:a},l);if(y&&y.node&&n.isAllowAdjust(y).pass){var v=g.startPoint,m=g.endPoint,b=g.sourceNode,_=g.targetNode,x=u===Xv.SOURCE?{startPoint:{x:y.anchor.x,y:y.anchor.y},endPoint:{x:m.x,y:m.y},sourceNode:y.node,targetNode:_}:{startPoint:{x:v.x,y:v.y},endPoint:{x:y.anchor.x,y:y.anchor.y},sourceNode:b,targetNode:y.node};g.updateAfterAdjustStartAndEnd(x)}else u===Xv.SOURCE?g.updateStartPoint({x:h,y:f}):g.updateEndPoint({x:h,y:f});g.text.value&&d.adjustEdge&&g.setText(Object.assign({},g.text,g.textPosition))},n.onDragEnd=function(t){var e,o,r,i=t.event;try{n.setState({dragging:!1});var a=n.props,s=a.graphModel,l=a.edgeModel,u=a.type,c=n.state,d=c.endX,p=c.endY,h=c.dragging,f=jf({x:d,y:p},s);if(!h)return;var g=!1,y=void 0;if(f&&f.node){var v=n.isAllowAdjust(f),m=v.pass,b=v.msg,_=v.newTargetNode;if(m){var x=l.getData(),E=x.text,w=x.sourceAnchorId,S=void 0===w?"":w,O=x.targetAnchorId,C=void 0===O?"":O,T=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n}(x,["text","sourceAnchorId","targetAnchorId"]);if(y=Sm(Sm({sourceAnchorId:S,targetAnchorId:C},T),{text:(null==E?void 0:E.value)||""}),u===Xv.SOURCE){var M=s.getNodeModelById(f.node.id),N=s.getNodeModelById(l.targetNodeId),A=null===(e=s.edgeGenerator)||void 0===e?void 0:e.call(s,null==M?void 0:M.getData(),null==N?void 0:N.getData(),y);y=Sm(Sm({},A),{sourceNodeId:f.node.id,sourceAnchorId:f.anchor.id,startPoint:{x:f.anchor.x,y:f.anchor.y},targetNodeId:l.targetNodeId,endPoint:Sm({},l.endPoint)}),l.sourceNodeId===f.node.id&&l.sourceAnchorId===f.anchor.id&&(g=!0)}else if(u===Xv.TARGET){M=s.getNodeModelById(l.sourceNodeId),N=s.getNodeModelById(f.node.id),A=null===(o=s.edgeGenerator)||void 0===o?void 0:o.call(s,null==M?void 0:M.getData(),null==N?void 0:N.getData(),y);y=Sm(Sm({},A),{sourceNodeId:l.sourceNodeId,startPoint:Sm({},l.startPoint),targetNodeId:f.node.id,targetAnchorId:f.anchor.id,endPoint:{x:f.anchor.x,y:f.anchor.y}}),l.targetNodeId===f.node.id&&l.targetAnchorId===f.anchor.id&&(g=!0)}}else{g=!0;var P=_.getData();s.eventCenter.emit(Sh.CONNECTION_NOT_ALLOWED,{data:P,msg:b})}}else g=!0;if(g)n.recoveryEdge();else{var D=l.getData();s.deleteEdgeById(l.id);var k=s.addEdge(Sm({},y));s.eventCenter.emit(Sh.EDGE_EXCHANGE_NODE,{data:{newEdge:k.getData(),oldEdge:D}})}null===(r=n.preTargetNode)||void 0===r||r.setElementState(mh.DEFAULT)}finally{(s=n.props.graphModel).eventCenter.emit(Sh.ADJUST_POINT_DRAGEND,{e:i,data:n.stepDragData})}},n.recoveryEdge=function(){var t=n.props.edgeModel,e=n.oldEdge,o=e.startPoint,r=e.endPoint,i=e.pointsList;t.updateStartPoint(o),t.updateEndPoint(r),t.modelType!==Eh.LINE_EDGE&&(t.pointsList=null!=i?i:[],t.initPoints())},n.getAdjustPointStyle=function(){return n.props.graphModel.theme.edgeAdjust},n.state={dragging:!1,endX:0,endY:0},n.targetRuleResults=new Map,n.sourceRuleResults=new Map;var o=e.type,r=e.edgeModel,i=e.graphModel.eventCenter;return n.stepDragData={type:o,edgeData:r.getData()},n.stepDrag=new kh({onDragStart:n.onDragStart,onDragging:n.onDragging,onDragEnd:n.onDragEnd,eventType:"ADJUST_POINT",isStopPropagation:!1,eventCenter:i,data:n.stepDragData}),n}return wm(e,t),e.prototype.isAllowAdjust=function(t){var e,n,o,r,i=this.props,a=i.edgeModel,s=a.id,l=a.sourceNode,u=a.targetNode,c=a.sourceAnchorId,d=a.targetAnchorId,p=i.type;if(p===Xv.SOURCE?(e=t.node,n=u,o=t.anchor,r=u.getAnchorInfo(d)):(e=l,n=t.node,r=t.anchor,o=l.getAnchorInfo(c)),this.preTargetNode&&this.preTargetNode!==t.node&&this.preTargetNode.setElementState(mh.DEFAULT),this.preTargetNode=t.node,r.id===o.id)return{pass:!1,msg:"",newTargetNode:n};var h="".concat(e.id,"_").concat(n.id,"_").concat(o.id,"_").concat(r.id);if(!this.targetRuleResults.has(h)){var f=e.isAllowConnectedAsSource(n,o,r,s),g=n.isAllowConnectedAsTarget(e,o,r,s);this.sourceRuleResults.set(h,$f(f)),this.targetRuleResults.set(h,$f(g))}var y=this.sourceRuleResults.get(h),v=y.isAllPass,m=y.msg,b=this.targetRuleResults.get(h),_=b.isAllPass,x=b.msg,E=v&&_?mh.ALLOW_CONNECT:mh.NOT_ALLOW_CONNECT;return p===Xv.SOURCE?e.setElementState(E):n.setElementState(E),{pass:v&&_,msg:x||m,newTargetNode:n}},e.prototype.render=function(){var t=this.props,e=t.x,n=t.y,o=t.getAdjustPointShape,r=t.edgeModel,i=this.state.dragging;return ph("g",{pointerEvents:i?"none":"",onMouseDown:this.handleMouseDown,children:i?"":o(e,n,r)})},e}(Xl),Cm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Tm=function(){return Tm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Tm.apply(this,arguments)};!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Cm(e,t),e.prototype.getArrowAttributes=function(){var t=this.props,e=t.arrowInfo,n=t.style,o=e.start,r=e.end,i={start:o,end:r,offset:n.offset,verticalLength:n.verticalLength,type:"end"},a=Ih(i),s=a.leftX,l=a.leftY,u=a.rightX,c=a.rightY;return Tm({d:"M".concat(s," ").concat(l," L").concat(r.x," ").concat(r.y," L").concat(u," ").concat(c," z")},n)},e.prototype.getShape=function(){var t=this.getArrowAttributes(),e=t.d,n=t.strokeWidth,o=t.stroke;return ph(gg,{d:e,fill:t.fill,strokeWidth:n,stroke:o})},e.prototype.render=function(){return ph("g",{className:"lf-arrow",children:this.getShape()})}}(Xl);var Mm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Nm=function(){return Nm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Nm.apply(this,arguments)},Am=function(t){function e(){var e=t.call(this)||this;return e.textRef={current:null},e.handleHover=function(t,n){var o=e.props,r=o.model,i=o.graphModel.eventCenter;r.setHovered(t);var a=t?Sh.EDGE_MOUSEENTER:Sh.EDGE_MOUSELEAVE,s=r.getData();i.emit(a,{data:s,e:n})},e.setHoverOn=function(t){e.props.model.isHovered||(e.textRef&&e.textRef.current&&e.textRef.current.setHoverOn(),e.handleHover(!0,t))},e.setHoverOff=function(t){e.props.model.isHovered&&(e.textRef&&e.textRef.current&&e.textRef.current.setHoverOff(),e.handleHover(!1,t))},e.handleContextMenu=function(t){t.preventDefault(),e.contextMenuTime=(new Date).getTime(),e.clickTimer&&clearTimeout(e.clickTimer);var n=e.props,o=n.model,r=n.graphModel,i=r.editConfigModel,a=r.getPointByClient({x:t.clientX,y:t.clientY});r.setElementStateById(o.id,mh.SHOW_MENU,a.domOverlayPosition),i.isSilentMode||e.toFront(),o.isSelected||r.selectEdgeById(o.id);var s=null==o?void 0:o.getData();r.eventCenter.emit(Sh.EDGE_CONTEXTMENU,{data:s,e:t,position:a})},e.handleMouseDown=function(t){t.stopPropagation(),e.startTime=(new Date).getTime()},e.handleMouseUp=function(){var t=e.props.model;e.mouseUpDrag=t.isDragging},e.handleClick=function(t){if(e.startTime&&!(e.mouseUpDrag||2===t.button)){var n=2===t.detail,o=e.props,r=o.model,i=o.graphModel,a=null==r?void 0:r.getData(),s=i.getPointByClient({x:t.clientX,y:t.clientY});if(n){var l=i.editConfigModel,u=i.textEditElement,c=r.id,d=r.text,p=r.modelType;if(u&&u.id===c&&i.setElementStateById(c,mh.DEFAULT),l.edgeTextEdit&&d.editable&&(r.setSelected(!1),i.setElementStateById(c,mh.TEXT_EDIT)),p===Eh.POLYLINE_EDGE){var h=r,f=i.getPointByClient({x:t.x,y:t.y}).canvasOverlayPosition,g=f.x,y=f.y;h.dbClickPosition=gf({x:g,y:y},h.points)}i.eventCenter.emit(Sh.EDGE_DBCLICK,{data:a,e:t,position:s})}else{i.eventCenter.emit(Sh.ELEMENT_CLICK,{data:a,e:t,position:s}),i.eventCenter.emit(Sh.EDGE_CLICK,{data:a,e:t,position:s});var v=t.currentTarget,m=!ae(window)&&lt(window.requestAnimationFrame)?window.requestAnimationFrame.bind(window):function(t){return setTimeout(t,0)};m(function(){v.focus()})}var b=i.editConfigModel;i.selectEdgeById(r.id,Ef(t,b)),b.isSilentMode||e.toFront()}},e.handleFocus=function(){var t=e.props,n=t.model;t.graphModel.eventCenter.emit(Sh.EDGE_FOCUS,{data:n.getData()})},e.handleBlur=function(){var t=e.props,n=t.model;t.graphModel.eventCenter.emit(Sh.EDGE_BLUR,{data:n.getData()})},e}return Mm(e,t),e.prototype.getShape=function(){return ph("g",{children:this.getEdge()})},e.prototype.getTextStyle=function(){},e.prototype.getText=function(){var t,e=this.props,n=e.model,o=e.graphModel,r=o.editConfigModel;if(r.edgeTextMode!==Ah.TEXT)return null;if(n.state===mh.TEXT_EDIT)return null;if(n.text){var i=!1;return r.edgeTextDraggable&&n.text.draggable&&(i=!0),ph($v,{ref:this.textRef,editable:r.edgeTextEdit&&(null===(t=n.text.editable)||void 0===t||t),model:n,graphModel:o,draggable:i})}return null},e.prototype.getArrowInfo=function(){var t=this.props.model,e=t.startPoint,n=t.endPoint,o=t.isSelected;return{start:e,end:n,hover:this.state.hover,isSelected:o}},e.prototype.getLastTwoPoints=function(){var t=this.props.model;return[t.startPoint,t.endPoint]},e.prototype.getArrowStyle=function(){return console.error("getArrowStyle is deprecated in 1.2.0, please use model.getArrowStyle"),null},e.prototype.getArrow=function(){var t=this.props.model,e=t.id,n=t.getArrowStyle(),o=n.refY,r=void 0===o?0:o,i=n.refX,a=void 0===i?2:i,s=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(this.getLastTwoPoints(),2),l=s[0],u=s[1],c="auto";if(l&&u){var d=u.x-l.x,p=u.y-l.y;if(0!==d||0!==p){var h=Ig({x:d,y:p})*(180/Math.PI);Number.isFinite(h)&&!Number.isNaN(h)&&(c=h)}}return ph("g",{children:ph("defs",{children:[ph("marker",{id:"marker-start-".concat(e),refX:-a,refY:r,overflow:"visible",orient:"auto",markerUnits:"userSpaceOnUse",children:this.getStartArrow()}),ph("marker",{id:"marker-end-".concat(e),refX:a,refY:r,overflow:"visible",orient:c,markerUnits:"userSpaceOnUse",children:this.getEndArrow()})]})})},e.prototype.getArrowPath=function(t,e){var n=e.stroke,o=e.fill,r=void 0===o?n:o,i=e.strokeWidth,a=e.offset,s=void 0===a?10:a,l=e.verticalLength,u=e.strokeLinecap,c=e.strokeLinejoin,d=e.transform,p="";switch(t){case"solid":p="M".concat(-s/4,",0 L").concat(3*s/4,",").concat(l," L").concat(3*s/4,",-").concat(l," Z");break;case"hollow":p="M".concat(-s/4,",0 L").concat(3*s/4,",").concat(l," L").concat(-s/4,",0 L").concat(3*s/4,",-").concat(l," L").concat(-s/4,",0 Z");break;case"diamond":p="M".concat(-s/2,",0 L0,").concat(l," L").concat(s/2,",0 L0,-").concat(l," L").concat(-s/2,",0 Z");break;case"circle":p="M".concat(-s/2,",0 A").concat(s/4,",").concat(s/4," 0 1,0 ").concat(s/2,",0 A").concat(s/4,",").concat(s/4," 0 1,0 ").concat(-s/2,",0 Z");break;default:p=""}return ph("path",{d:p,stroke:n,fill:r,strokeWidth:i,strokeLinecap:u,strokeLinejoin:c,transform:d})},e.prototype.getStartArrow=function(){var t=this.props.model.getArrowStyle(),e=t.stroke,n=t.strokeWidth,o=t.offset,r=t.verticalLength,i=t.startArrowType,a=void 0===i?"none":i,s=t.strokeLinecap,l=t.strokeLinejoin;return this.getArrowPath(a,{stroke:e,strokeWidth:n,offset:o,verticalLength:r,strokeLinecap:s,strokeLinejoin:l})},e.prototype.getEndArrow=function(){var t=this.props.model.getArrowStyle(),e=t.stroke,n=t.strokeWidth,o=t.offset,r=t.verticalLength,i=t.endArrowType,a=void 0===i?"solid":i,s=t.strokeLinecap,l=t.strokeLinejoin;return this.getArrowPath(a,{stroke:e,strokeWidth:n,offset:o,verticalLength:r,strokeLinecap:s,strokeLinejoin:l,transform:"rotate(180)"})},e.prototype.getAdjustPointShape=function(t,e,n){var o=n.getAdjustPointStyle();return ph(vg,Nm({className:"lf-edge-adjust-point"},o,{x:t,y:e}))},e.prototype.getAdjustPoints=function(){var t=this.props,e=t.model,n=t.graphModel,o=n.editConfigModel,r=o.adjustEdgeStartAndEnd,i=o.adjustEdgeStart,a=o.adjustEdgeEnd,s=e.getAdjustStart(),l=e.getAdjustEnd();return ph("g",{children:[r&&i&&ph(Om,Nm({type:Xv.SOURCE},s,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:e,graphModel:n})),r&&a&&ph(Om,Nm({type:Xv.TARGET},l,{getAdjustPointShape:this.getAdjustPointShape,edgeModel:e,graphModel:n}))]})},e.prototype.getAnimation=function(){console.error("getAnimation is deprecated in 1.2.0, please use model.getEdgeAnimationStyle")},e.prototype.getAppendWidth=function(){return ph("g",{})},e.prototype.getAppend=function(){return ph("g",{className:"lf-edge-append",children:this.getAppendWidth()})},e.prototype.getEdge=function(){return null},e.prototype.toFront=function(){var t=this.props,e=t.graphModel,n=t.model;e.toFront(n.id)},e.prototype.render=function(){var t=this.props.model,e=t.isSelected,n=t.isHitable,o=t.isShowAdjustPoint;return ph("g",{children:[ph("g",{className:["lf-edge",!n&&"pointer-none",e&&"lf-edge-selected"].filter(Boolean).join(" "),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onMouseOver:this.setHoverOn,onMouseEnter:this.setHoverOn,onMouseLeave:this.setHoverOff,onFocus:this.handleFocus,onBlur:this.handleBlur,children:[this.getShape(),this.getAppend(),this.getText(),this.getArrow()]}),o&&e?this.getAdjustPoints():""]})},e.isObserved=!1,e}(Xl),Pm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Dm=function(){return Dm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Dm.apply(this,arguments)},km=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pm(e,t),e.prototype.getEdge=function(){var t=this.props.model,e=t.getEdgeStyle(),n=t,o=n.path,r=n.isAnimation,i=n.arrowConfig,a=t.getEdgeAnimationStyle(),s=a.strokeDasharray,l=a.stroke,u=a.strokeDashoffset,c=a.animationName,d=a.animationDuration,p=a.animationIterationCount,h=a.animationTimingFunction,f=a.animationDirection;return ph(gg,Dm({d:o},e,i,r?{strokeDasharray:s,stroke:l,style:{strokeDashoffset:u,animationName:c,animationDuration:d,animationIterationCount:p,animationTimingFunction:h,animationDirection:f}}:{}))},e.prototype.getAppendWidth=function(){return ph(gg,{d:this.props.model.path,strokeWidth:10,stroke:"transparent",fill:"none"})},e.prototype.getArrowInfo=function(){var t=this.props.model,e=this.state.hover,n=t.isSelected,o=t.getArrowStyle().offset,r=t.pointsList.map(function(t){return{x:t.x,y:t.y}}),i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(ff(r,o),2);return{start:i[0],end:i[1],hover:e,isSelected:n}},e.prototype.getLastTwoPoints=function(){var t=this.props.model,e=t.getArrowStyle().offset,n=t.pointsList.map(function(t){return{x:t.x,y:t.y}});return ff(n,e)},e}(Am),Rm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Lm=function(){return Lm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Lm.apply(this,arguments)},Im=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Rm(e,t),e.prototype.getEdge=function(){var t=this.props.model,e=t.startPoint,n=t.endPoint,o=t.isAnimation,r=t.arrowConfig,i=t.getEdgeStyle(),a=t.getEdgeAnimationStyle(),s=a.strokeDasharray,l=a.stroke,u=a.strokeDashoffset,c=a.animationName,d=a.animationDuration,p=a.animationIterationCount,h=a.animationTimingFunction,f=a.animationDirection;return ph(dg,Lm({},i,{x1:e.x,y1:e.y,x2:n.x,y2:n.y},r,o?{strokeDasharray:s,stroke:l,style:{strokeDashoffset:u,animationName:c,animationDuration:d,animationIterationCount:p,animationTimingFunction:h,animationDirection:f}}:{}))},e.prototype.getAppendWidth=function(){var t=this.props.model,e=function(t){var e,n=t.start,o=t.end;if(n.x===o.x&&n.y===o.y)e="";else{var r={start:n,end:o,offset:10,verticalLength:5},i=Ih(jh(jh({},r),{type:"start"})),a=Ih(jh(jh({},r),{type:"end"}));e="M".concat(i.leftX," ").concat(i.leftY,"\n    L").concat(i.rightX," ").concat(i.rightY,"\n    L").concat(a.rightX," ").concat(a.rightY,"\n    L").concat(a.leftX," ").concat(a.leftY," z")}return{d:e,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}}({start:t.startPoint,end:t.endPoint}),n=e.d,o=e.strokeWidth,r=e.fill,i=e.strokeDasharray;return ph(gg,{d:n,fill:r,strokeWidth:o,stroke:e.stroke,strokeDasharray:i})},e}(Am),jm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Bm=function(){return Bm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Bm.apply(this,arguments)},Hm=function(t){function e(){var e=t.call(this)||this;return e.onDragStart=function(){var t=e.props.model;t.dragAppendStart(),e.isShowAdjustPointTemp=t.isShowAdjustPoint,t.isShowAdjustPoint=!1},e.onDragging=function(t){var n=t.deltaX,o=t.deltaY,r=e.props,i=r.model,a=r.graphModel;e.isDragging=!0;var s=a.transformModel,l=a.editConfigModel,u=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(s.fixDeltaXY(n,o),2),c=u[0],d=u[1],p=i,h=l.adjustEdgeMiddle;e.appendInfo=h?p.dragAppendSimple(e.appendInfo,{x:c,y:d}):p.dragAppend(e.appendInfo,{x:c,y:d})},e.onDragEnd=function(){var t,n=e.props,o=n.model,r=n.graphModel.eventCenter,i=o;i.dragAppendEnd(),e.isDragging=!1,i.isShowAdjustPoint=null!==(t=e.isShowAdjustPointTemp)&&void 0!==t&&t,e.appendInfo=void 0,r.emit(Sh.EDGE_ADJUST,{data:i.getData()})},e.beforeDragStart=function(t,n){n.draggable&&e.drag.handleMouseDown(t),e.appendInfo=n},e.drag=new kh({onDragStart:e.onDragStart,onDragging:e.onDragging,onDragEnd:e.onDragEnd,isStopPropagation:!1}),e}return jm(e,t),e.prototype.getEdge=function(){var t=this.props.model,e=t.points,n=t.isAnimation,o=t.arrowConfig,r=t.getEdgeStyle(),i=t.getEdgeAnimationStyle(),a=i.strokeDasharray,s=i.stroke,l=i.strokeDashoffset,u=i.animationName,c=i.animationDuration,d=i.animationIterationCount,p=i.animationTimingFunction,h=i.animationDirection;return ph(wg,Bm({points:e},r,o,n?{strokeDasharray:a,stroke:s,style:{strokeDashoffset:l,animationName:u,animationDuration:c,animationIterationCount:d,animationTimingFunction:p,animationDirection:h}}:{}))},e.prototype.getArrowInfo=function(){var t=this.props.model,e=t.points,n=t.isSelected,o=this.state.hover,r=sf(e),i=r[0],a=r[0];return r.length>=2&&(i=r[r.length-2],a=r[r.length-1]),{start:i,end:a,hover:o,isSelected:n}},e.prototype.getLastTwoPoints=function(){var t=this.props.model.points,e=sf(t),n=e[0],o=e[0];return e.length>=2&&(n=e[e.length-2],o=e[e.length-1]),[n,o]},e.prototype.getAppendAttributes=function(t){var e,n=t.start,o=t.end;if(n.x===o.x&&n.y===o.y)e="";else{var r={start:n,end:o,offset:10,verticalLength:5},i=Ih(Bm(Bm({},r),{type:"start"})),a=Ih(Bm(Bm({},r),{type:"end"}));e="M".concat(i.leftX," ").concat(i.leftY,"\n      L").concat(i.rightX," ").concat(i.rightY,"\n      L").concat(a.rightX," ").concat(a.rightY,"\n      L").concat(a.leftX," ").concat(a.leftY," z")}return{d:e,fill:"transparent",stroke:"transparent",strokeWidth:1,strokeDasharray:"4, 4"}},e.prototype.getAppendShape=function(t){var e=this.getAppendAttributes(t),n=e.d,o=e.strokeWidth,r=e.fill,i=e.strokeDasharray;return ph(gg,{d:n,fill:r,strokeWidth:o,stroke:e.stroke,strokeDasharray:i})},e.prototype.getAppendWidth=function(){for(var t=this,e=this.props,n=e.model,o=e.graphModel,r=n.pointsList,i=n.draggable,a=[],s=r.length,l=function(e){var n="lf-polyline-append",l={start:{x:r[e].x,y:r[e].y},end:{x:r[e+1].x,y:r[e+1].y},startIndex:e,endIndex:e+1,direction:Mh.HORIZONTAL,draggable:!0},c=ph("g",{className:n,children:u.getAppendShape(l)}),d=o.editConfigModel,p=d.adjustEdge,h=d.adjustEdgeMiddle;if(p&&i){var f=l.startIndex,g=l.endIndex,y=h&&(0===f||g===s-1);l.draggable=!y,l.start.x===l.end.x?(l.draggable&&(n+="-ew-resize"),l.direction=Mh.VERTICAL):l.start.y===l.end.y&&(l.draggable&&(n+="-ns-resize"),l.direction=Mh.HORIZONTAL),c=ph("g",{className:u.isDragging?"lf-dragging":"lf-drag-able",onMouseDown:function(e){return t.beforeDragStart(e,l)},children:ph("g",{className:n,children:u.getAppendShape(l)})})}a.push(c)},u=this,c=0;c<s-1;c++)l(c);return ph("g",{children:a})},e}(Am),zm=function(){return zm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},zm.apply(this,arguments)},Fm=function(){function t(t){var e=this;this.nodeConfig=null,this.fakeNode=null,this.stopDrag=function(){e.nodeConfig=null,window.document.removeEventListener("mouseup",e.stopDrag)},this.dragEnter=function(t){e.nodeConfig&&!e.fakeNode&&(e.fakeNode=e.lf.createFakeNode(zm(zm({},e.nodeConfig),e.clientToLocalPoint({x:t.clientX,y:t.clientY}))))},this.onDragOver=function(t){if(e.lf.graphModel.eventCenter.emit(Sh.BLANK_CANVAS_MOUSEMOVE,{e:t}),t.preventDefault(),e.fakeNode){var n=e.clientToLocalPoint({x:t.clientX,y:t.clientY}),o=n.x,r=n.y;e.fakeNode.moveTo(o,r);var i=e.fakeNode.getData();e.lf.setNodeSnapLine(i),e.lf.graphModel.eventCenter.emit(Sh.NODE_DND_DRAG,{data:i,e:t})}return!1},this.onDragLeave=function(){e.fakeNode&&(e.lf.removeNodeSnapLine(),e.lf.graphModel.removeFakeNode(),e.fakeNode=null)},this.onDrop=function(t){e.lf.graphModel&&t&&e.nodeConfig&&(e.lf.addNode(zm(zm({},e.nodeConfig),e.clientToLocalPoint({x:t.clientX,y:t.clientY})),Sh.NODE_DND_ADD,t),t.preventDefault(),t.stopPropagation(),e.nodeConfig=null,e.lf.removeNodeSnapLine(),e.lf.graphModel.removeFakeNode(),e.fakeNode=null)};var n=t.lf;this.lf=n}return t.prototype.clientToLocalPoint=function(t){var e=t.x,n=t.y,o=O(this.lf.options,["grid","size"]),r=this.lf.graphModel.getPointByClient({x:e,y:n}).canvasOverlayPosition,i=r.x,a=r.y,s=this.lf.graphModel.editConfigModel.snapGrid;return{x:bf(i,o,s),y:bf(a,o,s)}},t.prototype.startDrag=function(t){var e=this.lf.graphModel.editConfigModel;(null==e?void 0:e.isSilentMode)||(this.nodeConfig=t,window.document.addEventListener("mouseup",this.stopDrag))},t.prototype.eventMap=function(){return{onMouseEnter:this.dragEnter,onMouseOver:this.dragEnter,onMouseMove:this.onDragOver,onMouseLeave:this.onDragLeave,onMouseUp:this.onDrop}},t}();var Wm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Xm=function(){return Xm=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Xm.apply(this,arguments)},Um=function(t){function e(e){var n=t.call(this,e)||this;return n.ref={current:null},n.__prevText={type:"",text:"",id:""},n.keyupHandler=function(t){var e=n.props.graphModel.textEditElement;"Enter"===t.key&&t.altKey&&(null==e||e.setElementState(mh.DEFAULT))},n.inputHandler=function(t){var e=t.target.innerText,o=n.props.graphModel.textEditElement;o&&(n.__prevText={type:o.type,text:e.replace(/(\r\n)+$|(\n)+$/,""),id:o.id})},n.keydownHandler=function(t){t.stopPropagation()},n.state={style:{left:0,top:0}},n}return Wm(e,t),e.getDerivedStateFromProps=function(t){var e,n,o=t.textEditElement,r=t.graphModel,i=r.transformModel,a=r.theme,s=a.inputText;if(o){if(!(null===(e=o.text)||void 0===e?void 0:e.value)&&o.BaseType===_h.EDGE){var l=o.text,u=o.textPosition,c=u.x,d=u.y;l.x=c,l.y=d,o.setText(l)}var p={resize:"auto",whiteSpace:"normal",wordBreak:"break-all"};if(o.BaseType===_h.EDGE){var h=a.edgeText,f=h.overflowMode,g=h.lineHeight,y=h.wrapPadding;(m=h.textWidth)&&"autoWrap"===f&&(n=Xm(Xm({},p),{width:m,minWidth:m,lineHeight:g,padding:y}))}else if(o.BaseType===_h.NODE){var v=a.nodeText,m=(f=v.overflowMode,g=v.lineHeight,y=v.wrapPadding,v.textWidth),b=o.width,_=o.modelType,x=o.textWidth||m||b;(_!==Eh.TEXT_NODE&&"autoWrap"===f||_===Eh.TEXT_NODE&&m)&&(n=Xm(Xm({},p),{width:x,minWidth:x,lineHeight:g,padding:y}))}var E=o.text,w=E.x,S=E.y,O=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(i.CanvasPointToHtmlPoint([w,S]),2),C=O[0],T=O[1];return{style:Xm(Xm({left:C,top:T},n),s)}}return null},e.prototype.componentDidUpdate=function(){var t=this.props.graphModel;if(this.ref.current&&(this.ref.current.focus(),this.placeCaretAtEnd(this.ref.current)),""!==this.__prevText.id){var e=this.__prevText,n=e.text,o=e.id;t.updateText(o,n),t.eventCenter.emit(Sh.TEXT_UPDATE,{data:Xm({},this.__prevText)}),this.__prevText.id="",this.__prevText.text="",this.__prevText.type=""}},e.prototype.placeCaretAtEnd=function(t){if(void 0!==window.getSelection&&void 0!==document.createRange){var e=document.createRange();e.selectNodeContents(t),e.collapse(!1);var n=window.getSelection();null==n||n.removeAllRanges(),null==n||n.addRange(e)}},e.prototype.render=function(){var t,e=this.props.graphModel.textEditElement,n=this.state.style;return e?ph("div",{contentEditable:!0,className:"lf-text-input",style:n,ref:this.ref,onKeyUp:this.keyupHandler,onKeyDown:this.keydownHandler,onKeyPress:this.keydownHandler,onInput:this.inputHandler,children:null===(t=e.text)||void 0===t?void 0:t.value},e.id):null},e.toolName="text-edit-tool",e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),Gm=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ym=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Vm=function(t){function e(e){var n=t.call(this,e)||this;n.handleMouseDown=function(t){var e=n.props,o=e.graphModel.gridSize,r=e.lf.getTransform().SCALE_X;n.stepDrag.setStep(o*r),n.stepDrag.handleMouseDown(t)},n.handleWheelEvent=function(t){var e,o;t.preventDefault();var r=t.deltaX,i=t.deltaY,a=t.clientX,s=t.clientY,l=t.ctrlKey,u=new WheelEvent("wheel",{deltaX:r,deltaY:i,clientX:a,clientY:s,ctrlKey:l});null===(o=null===(e=n.props.lf.container)||void 0===e?void 0:e.querySelector('.lf-canvas-overlay[name="canvas-overlay"]'))||void 0===o||o.dispatchEvent(u)},n.onDragging=function(t){var e=t.deltaX,o=t.deltaY,r=n.props,i=r.graphModel,a=r.lf.getTransform(),s=a.SCALE_X,l=a.SCALE_Y,u=i.getSelectElements(!0);i.moveNodes(u.nodes.map(function(t){return t.id}),e/s,o/l)},n.handleContextMenu=function(t){t.preventDefault();var e=n.props,o=e.graphModel,r=e.graphModel,i=r.eventCenter,a=r.selectElements,s=o.getPointByClient({x:t.clientX,y:t.clientY}),l={nodes:[],edges:[]},u=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],Ym(a.values()),!1);u.forEach(function(t){t.BaseType===_h.NODE&&l.nodes.push(t.getData()),t.BaseType===_h.EDGE&&l.edges.push(t.getData())}),i.emit(Sh.SELECTION_CONTEXTMENU,{data:l,e:t,position:s})};var o=e.graphModel,r=o.gridSize,i=o.eventCenter;return n.stepDrag=new kh({onDragging:n.onDragging,step:r,eventType:"SELECTION",eventCenter:i}),n}return Gm(e,t),e.prototype.render=function(){var t,e,n=this.props.graphModel,o=n.selectElements,r=n.transformModel,i=this.props.lf.getTransform(),a=i.SCALE_X,s=i.SCALE_Y;if(!(o.size<=1)){var l=Number.MAX_SAFE_INTEGER,u=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;return o.forEach(function(t){var e;t.BaseType===_h.NODE&&(e=function(t){var e=t.x,n=t.y,o=t.width,r=t.height;return{x:e-o/2,y:n-r/2,x1:e+o/2,y1:n+r/2}}(t)),t.BaseType===_h.EDGE&&(e=Rh(t)),void 0!==e&&(l=Math.min(l,e.x),u=Math.min(u,e.y),c=Math.max(c,e.x1),d=Math.max(d,e.y1))}),t=Ym(r.CanvasPointToHtmlPoint([l,u]),2),l=t[0],u=t[1],e=Ym(r.CanvasPointToHtmlPoint([c,d]),2),c=e[0],d=e[1],ph("div",{className:"lf-multiple-select",style:{left:"".concat(l-20*a/2,"px"),top:"".concat(u-20*s/2,"px"),width:"".concat(c-l+20*a,"px"),height:"".concat(d-u+20*s,"px"),"border-width":"".concat(2*a,"px")},onMouseDown:this.handleMouseDown,onContextMenu:this.handleContextMenu,onWheel:this.handleWheelEvent})}},e.toolName="multiple-select-tool",e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),Km=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},qm=[Um,Vm],Zm=function(){function t(t){var e=this;this.toolMap=new Map,this.disabledToolMap=new Map,this.instance=t,$o(qm,function(t){e.isDisabled(t.toolName)||e.registerTool(t.toolName,t)});var n=t.graphModel;n.eventCenter.on("".concat(Sh.GRAPH_TRANSFORM,",").concat(Sh.NODE_CLICK,",").concat(Sh.BLANK_CLICK," "),function(){var t,e=n.textEditElement,o=n.editConfigModel,r=o.edgeTextEdit,i=o.nodeTextEdit;(r||i)&&e&&(null===(t=n.textEditElement)||void 0===t||t.setElementState(mh.DEFAULT))})}return t.prototype.isDisabled=function(t){var e;return-1!==(null===(e=this.instance.options.disabledTools)||void 0===e?void 0:e.indexOf(t))},t.prototype.registerTool=function(t,e){this.toolMap.set(t,e)},t.prototype.disableTool=function(t){var e=this.toolMap.get(t);if(e)return this.disabledToolMap.set(t,e),this.toolMap.delete(t),!0;throw new Error("禁用失败，不存在名为 ".concat(e," 的工具"))},t.prototype.enableTool=function(t){var e=this.disabledToolMap.get(t);if(e)return this.toolMap.set(t,e),this.disabledToolMap.delete(t),!0;throw new Error("不存在名为 ".concat(e," 的工具"))},t.prototype.getTools=function(){return Array.from(this.toolMap.values())},t.prototype.getInstance=function(){return this.instance},t.prototype.destroy=function(){this.toolMap.clear(),this.disabledToolMap.clear()},Km([Qu],t.prototype,"toolMap",void 0),Km([ed],t.prototype,"disableTool",null),Km([ed],t.prototype,"enableTool",null),t}();function $m(t,e){void 0===e&&(e="Illegal state"),t||function(t){throw new Error("[mobx-utils] "+t)}(e)}var Jm,Qm=function(t){return t&&t!==Object.prototype&&Object.getOwnPropertyNames(t).concat(Qm(Object.getPrototypeOf(t))||[])},tb=function(t){return function(t){var e=Qm(t);return e.filter(function(t,n){return e.indexOf(t)===n})}(t).filter(function(t){return"constructor"!==t&&!~t.indexOf("__")})},eb="pending",nb="fulfilled",ob="rejected";function rb(t){switch(this.state){case eb:return t.pending&&t.pending(this.value);case ob:return t.rejected&&t.rejected(this.value);case nb:return t.fulfilled?t.fulfilled(this.value):this.value}}function ib(t,e){if($m(arguments.length<=2,"fromPromise expects up to two arguments"),$m("function"==typeof t||"object"==typeof t&&t&&"function"==typeof t.then,"Please pass a promise or function to fromPromise"),!0===t.isPromiseBasedObservable)return t;"function"==typeof t&&(t=new Promise(t));var n=t;t.then(ed("observableFromPromise-resolve",function(t){n.value=t,n.state=nb}),ed("observableFromPromise-reject",function(t){n.value=t,n.state=ob})),n.isPromiseBasedObservable=!0,n.case=rb;var o=e&&e.state===nb?e.value:void 0;return ld(n,{value:o,state:eb},{},{deep:!1}),n}(Jm=ib||(ib={})).reject=ed("fromPromise.reject",function(t){var e=Jm(Promise.reject(t));return e.state=ob,e.value=t,e}),Jm.resolve=ed("fromPromise.resolve",function(t){void 0===t&&(t=void 0);var e=Jm(Promise.resolve(t));return e.state=nb,e.value=t,e});var ab=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};!function(){function t(t,e){var n=this;!function(t,e){"string"==typeof t||t.name,Sc(0,"function"==typeof t?t:e,this,void 0)}(function(){n.current=e,n.subscription=t.subscribe(n)})}t.prototype.dispose=function(){this.subscription&&this.subscription.unsubscribe()},t.prototype.next=function(t){this.current=t},t.prototype.complete=function(){this.dispose()},t.prototype.error=function(t){this.current=t,this.dispose()},ab([Qu.ref],t.prototype,"current",void 0),ab([ed.bound],t.prototype,"next",null),ab([ed.bound],t.prototype,"complete",null),ab([ed.bound],t.prototype,"error",null)}();var sb=function(){return sb=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},sb.apply(this,arguments)},lb=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},ub=["model","reset","submit","isDirty","isPropertyDirty","resetProperty"];function cb(t){if(!t)return"ROOT";for(var e=[];t.parent;)e.push(t.path),t=t.parent;return e.reverse().join("/")}function db(t){return $d(t)||jd(t)||Fd(t)}function pb(t,e){var n=new WeakMap;function o(o){var a=n.get(o.object);!function(t,e){switch(t.type){case"add":r(t.newValue,e,t.name);break;case"update":i(t.oldValue),r(t.newValue,e,t.name||""+t.index);break;case"remove":case"delete":i(t.oldValue);break;case"splice":t.removed.map(i),t.added.forEach(function(n,o){return r(n,e,""+(t.index+o))});for(var o=t.index+t.addedCount;o<t.object.length;o++)if(db(t.object[o])){var a=n.get(t.object[o]);a&&(a.path=""+o)}}}(o,a),e(o,cb(a),t)}function r(t,e,i){if(db(t)){var a=n.get(t);if(a){if(a.parent!==e||a.path!==i)throw new Error("The same observable object cannot appear twice in the same tree, trying to assign it to '"+cb(e)+"/"+i+"', but it already exists at '"+cb(a.parent)+"/"+a.path+"'")}else{var s={parent:e,path:i,dispose:vd(t,o)};n.set(t,s),(l=t,$d(l)?gd(l).map(function(t){return[t,l[t]]}):Fd(l)?gd(l).map(function(t){return[t,l.get(t)]}):Ud(l)?Array.from(l.entries()):jd(l)?l.map(function(t,e){return[e,t]}):pu(!1)).forEach(function(t){var e=t[0];return r(t[1],s,e)})}}var l}function i(t){if(db(t)){var e=n.get(t);if(!e)return;n.delete(t),e.dispose(),(o=t,$d(o)?gd(o).map(function(t){return o[t]}):Fd(o)?gd(o).map(function(t){return o.get(t)}):Ud(o)?Array.from(o.values()):jd(o)?o.slice():pu(!1)).forEach(i)}var o}return r(t,void 0,""),function(){i(t)}}!function(){function t(t){var e=this;this.model=t,this.localValues=Qu.map({}),this.localComputedValues=Qu.map({}),this.isPropertyDirty=function(t){return e.localValues.has(t)},$m($d(t),"createViewModel expects an observable object"),tb(t).forEach(function(n){if(n!==Cu&&"__mobxDidRunLazyInitializers"!==n){if($m(-1===ub.indexOf(n),"The propertyname "+n+" is reserved and cannot be used with viewModels"),hd(t,n)){var o=Qd(t,n).derivation;e.localComputedValues.set(n,sc(o.bind(e)))}var r=Object.getOwnPropertyDescriptor(t,n),i=r?{enumerable:r.enumerable}:{};Object.defineProperty(e,n,sb(sb({},i),{configurable:!0,get:function(){return hd(t,n)?e.localComputedValues.get(n).get():e.isPropertyDirty(n)?e.localValues.get(n):e.model[n]},set:ed(function(t){t!==e.model[n]?e.localValues.set(n,t):e.localValues.delete(n)})}))}})}Object.defineProperty(t.prototype,"isDirty",{get:function(){return this.localValues.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"changedValues",{get:function(){return this.localValues.toJS()},enumerable:!1,configurable:!0}),t.prototype.submit=function(){var t=this;gd(this.localValues).forEach(function(e){var n=t.localValues.get(e),o=t.model[e];jd(o)?o.replace(n):Fd(o)?(o.clear(),o.merge(n)):function(t){return arguments.length>1?pu(!1):pd(t)}(n)||(t.model[e]=n)}),this.localValues.clear()},t.prototype.reset=function(){this.localValues.clear()},t.prototype.resetProperty=function(t){this.localValues.delete(t)},lb([sc],t.prototype,"isDirty",null),lb([sc],t.prototype,"changedValues",null),lb([ed.bound],t.prototype,"submit",null),lb([ed.bound],t.prototype,"reset",null),lb([ed.bound],t.prototype,"resetProperty",null)}();var hb=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){function e(e,n,o){var r=void 0===o?{}:o,i=r.name,a=void 0===i?"ogm"+(1e3*Math.random()|0):i,s=r.keyToName,l=void 0===s?function(t){return""+t}:s,u=t.call(this)||this;u._keyToName=l,u._groupBy=n,u._ogmInfoKey=Symbol("ogmInfo"+a),u._base=e;for(var c=0;c<e.length;c++)u._addItem(e[c]);return u._disposeBaseObserver=vd(u._base,function(t){if("splice"===t.type)Ed(function(){for(var e=0,n=t.removed;e<n.length;e++){var o=n[e];u._removeItem(o)}for(var r=0,i=t.added;r<i.length;r++){var a=i[r];u._addItem(a)}});else{if("update"!==t.type)throw new Error("illegal state");Ed(function(){u._removeItem(t.oldValue),u._addItem(t.newValue)})}}),u}hb(e,t),e.prototype.clear=function(){throw new Error("not supported")},e.prototype.delete=function(t){throw new Error("not supported")},e.prototype.set=function(t,e){throw new Error("not supported")},e.prototype.dispose=function(){this._disposeBaseObserver();for(var t=0;t<this._base.length;t++){var e=this._base[t];e[this._ogmInfoKey].reaction(),delete e[this._ogmInfoKey]}},e.prototype._getGroupArr=function(e){var n=t.prototype.get.call(this,e);return void 0===n&&(n=Qu([],{name:"GroupArray["+this._keyToName(e)+"]",deep:!1}),t.prototype.set.call(this,e,n)),n},e.prototype._removeFromGroupArr=function(e,n){var o=t.prototype.get.call(this,e);1===o.length?t.prototype.delete.call(this,e):(n===o.length-1||(o[n]=o[o.length-1],o[n][this._ogmInfoKey].groupArrIndex=n),o.length--)},e.prototype._addItem=function(t){var e=this,n=this._groupBy(t),o=this._getGroupArr(n),r={groupByValue:n,groupArrIndex:o.length,reaction:id(function(){return e._groupBy(t)},function(n,o){var r=t[e._ogmInfoKey];e._removeFromGroupArr(r.groupByValue,r.groupArrIndex);var i=e._getGroupArr(n),a=i.length;i.push(t),r.groupByValue=n,r.groupArrIndex=a})};Object.defineProperty(t,this._ogmInfoKey,{configurable:!0,enumerable:!1,value:r}),o.push(t)},e.prototype._removeItem=function(t){var e=t[this._ogmInfoKey];this._removeFromGroupArr(e.groupByValue,e.groupArrIndex),e.reaction(),delete t[this._ogmInfoKey]}}(zd),Promise.resolve(),"undefined"!=typeof queueMicrotask||"undefined"!=typeof process&&process.nextTick;var fb,gb=function(){return gb=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},gb.apply(this,arguments)},yb=function(){function t(t){this.undos=[],this.redos=[],this.callbacks=[],this.stopWatch=null,this.curData=null,this.maxSize=50,this.waitTime=100,this.eventCenter=t}return t.prototype.add=function(t){oe(Z(this.undos),t)||(this.undos.push(t),oe(this.curData,t)||(this.redos=[]),this.eventCenter.emit(Sh.HISTORY_CHANGE,{data:{undos:this.undos,redos:this.redos,undoAble:this.undoAble(),redoAble:this.redoAble()}}),this.undos.length>this.maxSize&&this.undos.shift())},t.prototype.undoAble=function(){return this.undos.length>1},t.prototype.undo=function(){if(this.undoAble()){var t=this.undos.pop();this.redos.push(t);var e=this.undos.pop();return this.curData=ne(e),e}},t.prototype.redoAble=function(){return this.redos.length>0},t.prototype.redo=function(){if(this.redoAble()){var t=this.redos.pop();return this.curData=ne(t),t}},t.prototype.watch=function(t){var e=this;this.stopWatch&&this.stopWatch(),this.undos.push(t.modelToGraphData()),this.stopWatch=pb(t,Zt(function(){var n=t.modelToHistoryData();n&&e.add(gb({},n))},this.waitTime))},t.prototype.destroy=function(){this.undos=[],this.redos=[],this.curData=null,this.stopWatch&&this.stopWatch()},t}(),vb={exports:{}};var mb=(fb||(fb=1,function(t){!function(e,n){if(e){for(var o,r={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},i={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},a={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},l=1;l<20;++l)r[111+l]="f"+l;for(l=0;l<=9;++l)r[l+96]=l.toString();y.prototype.bind=function(t,e,n){var o=this;return t=t instanceof Array?t:[t],o._bindMultiple.call(o,t,e,n),o},y.prototype.unbind=function(t,e){return this.bind.call(this,t,function(){},e)},y.prototype.trigger=function(t,e){var n=this;return n._directMap[t+":"+e]&&n._directMap[t+":"+e]({},t),n},y.prototype.reset=function(){var t=this;return t._callbacks={},t._directMap={},t},y.prototype.stopCallback=function(t,e){if((" "+e.className+" ").indexOf(" mousetrap ")>-1)return!1;if(g(e,this.target))return!1;if("composedPath"in t&&"function"==typeof t.composedPath){var n=t.composedPath()[0];n!==t.target&&(e=n)}return"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},y.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},y.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);o=null},y.init=function(){var t=y(n);for(var e in t)"_"!==e.charAt(0)&&(y[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},y.init(),e.Mousetrap=y,t.exports&&(t.exports=y)}function u(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function c(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return r[t.which]?r[t.which]:i[t.which]?i[t.which]:String.fromCharCode(t.which).toLowerCase()}function d(t,e){return t.sort().join(",")===e.sort().join(",")}function p(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function h(t,e,n){return n||(n=function(){if(!o)for(var t in o={},r)t>95&&t<112||r.hasOwnProperty(t)&&(o[r[t]]=t);return o}()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function f(t,e){var n,o,r,i=[];for(n=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),r=0;r<n.length;++r)o=n[r],s[o]&&(o=s[o]),e&&"keypress"!=e&&a[o]&&(o=a[o],i.push("shift")),p(o)&&i.push(o);return{key:o,modifiers:i,action:e=h(o,i,e)}}function g(t,e){return null!==t&&t!==n&&(t===e||g(t.parentNode,e))}function y(t){var e=this;if(t=t||n,!(e instanceof y))return new y(t);e.target=t,e._callbacks={},e._directMap={};var o,r={},i=!1,a=!1,s=!1;function l(t){t=t||{};var e,n=!1;for(e in r)t[e]?n=!0:r[e]=0;n||(s=!1)}function h(t,n,o,i,a,s){var l,u,c=[],h=o.type;if(!e._callbacks[t])return[];for("keyup"==h&&p(t)&&(n=[t]),l=0;l<e._callbacks[t].length;++l)if(u=e._callbacks[t][l],(i||!u.seq||r[u.seq]==u.level)&&h==u.action&&("keypress"==h&&!o.metaKey&&!o.ctrlKey||d(n,u.modifiers))){var f=!i&&u.combo==a,g=i&&u.seq==i&&u.level==s;(f||g)&&e._callbacks[t].splice(l,1),c.push(u)}return c}function g(t,n,o,r){e.stopCallback(n,n.target||n.srcElement,o,r)||!1===t(n,o)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(n),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(n))}function v(t){"number"!=typeof t.which&&(t.which=t.keyCode);var n=c(t);n&&("keyup"!=t.type||i!==n?e.handleKey(n,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):i=!1)}function m(t,e,n,a){function u(e){return function(){s=e,++r[t],clearTimeout(o),o=setTimeout(l,1e3)}}function d(e){g(n,e,t),"keyup"!==a&&(i=c(e)),setTimeout(l,10)}r[t]=0;for(var p=0;p<e.length;++p){var h=p+1===e.length?d:u(a||f(e[p+1]).action);b(e[p],h,a,t,p)}}function b(t,n,o,r,i){e._directMap[t+":"+o]=n;var a,s=(t=t.replace(/\s+/g," ")).split(" ");s.length>1?m(t,s,n,o):(a=f(t,o),e._callbacks[a.key]=e._callbacks[a.key]||[],h(a.key,a.modifiers,{type:a.action},r,t,i),e._callbacks[a.key][r?"unshift":"push"]({callback:n,modifiers:a.modifiers,action:a.action,seq:r,level:i,combo:t}))}e._handleKey=function(t,e,n){var o,r=h(t,e,n),i={},u=0,c=!1;for(o=0;o<r.length;++o)r[o].seq&&(u=Math.max(u,r[o].level));for(o=0;o<r.length;++o)if(r[o].seq){if(r[o].level!=u)continue;c=!0,i[r[o].seq]=1,g(r[o].callback,n,r[o].combo,r[o].seq)}else c||g(r[o].callback,n,r[o].combo);var d="keypress"==n.type&&a;n.type!=s||p(t)||d||l(i),a=c&&"keydown"==n.type},e._bindMultiple=function(t,e,n){for(var o=0;o<t.length;++o)b(t[o],e,n)},u(t,"keypress",v),u(t,"keydown",v),u(t,"keyup",v)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)}(vb)),vb.exports);const bb=be(mb);var _b=null;function xb(t,e){var n,o;return t.x+=e,t.y+=e,ui(t.text)||(t.text.x+=e,t.text.y+=e),ui(null===(n=t.properties)||void 0===n?void 0:n._label)||null===(o=t.properties)||void 0===o||o._label.forEach(function(t){t.x+=e,t.y+=e}),t}function Eb(t,e){return t.startPoint&&(t.startPoint.x+=e,t.startPoint.y+=e),t.endPoint&&(t.endPoint.x+=e,t.endPoint.y+=e),t.pointsList&&t.pointsList.length>0&&t.pointsList.forEach(function(t){t.x+=e,t.y+=e}),ui(t.text)||(t.text.x+=e,t.text.y+=e),t}var wb=40,Sb=40;var Ob,Cb=function(){function t(t){t.keyboard||(t.keyboard={enabled:!1}),this.options=t;var e=t.lf;this.target=e.container,this.mousetrap=new bb(this.target),t.keyboard.enabled&&!e.options.isSilentMode&&this.enable(!0)}return t.prototype.initShortcuts=function(){var t,e=this,n=(null!==(t=this.options.keyboard)&&void 0!==t?t:{}).shortcuts;if(n)if(d(n))n.forEach(function(t){var n=t.keys,o=t.callback,r=t.action;return e.on(n,o,r)});else{var o=n.keys,r=n.callback,i=n.action;this.on(o,r,i)}},t.prototype.on=function(t,e,n){this.mousetrap.bind(this.getKeys(t),e,n)},Object.defineProperty(t.prototype,"disabled",{get:function(){var t,e;return!0!==(null===(e=null===(t=this.options)||void 0===t?void 0:t.keyboard)||void 0===e?void 0:e.enabled)},enumerable:!1,configurable:!0}),t.prototype.off=function(t,e){this.mousetrap.unbind(this.getKeys(t),e)},t.prototype.enable=function(t){(this.disabled||t)&&(this.options.keyboard&&(this.options.keyboard.enabled=!0),this.target instanceof HTMLElement&&(this.target.setAttribute("tabindex","-1"),this.target.style.outline="none"))},t.prototype.disable=function(){this.disabled||(this.options.keyboard&&(this.options.keyboard.enabled=!1),this.target instanceof HTMLElement&&this.target.removeAttribute("tabindex"))},t.prototype.destroy=function(){this.mousetrap.reset()},t.prototype.getKeys=function(t){var e=this;return(Array.isArray(t)?t:[t]).map(function(t){return e.formatKey(t)})},t.prototype.formatKey=function(t){return t.toLowerCase().replace(/\s/g,"").replace("delete","del").replace("cmd","command")},t}(),Tb=function(){return Tb=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Tb.apply(this,arguments)},Mb=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Nb=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},Ab=Symbol("plugin registered by Logicflow.use"),Pb=function(){function t(t){var e,n=this;this.viewMap=new Map,this.components=[],this.extension={},this.setView=function(t,e){return n.viewMap.set(t,e)},this.getView=function(t){return n.viewMap.get(t)};var o=hh.get(t),r=o.container,i=o.width,a=o.height;this.options=o,this.container=this.initContainer(r,i,a),this.graphModel=new Cv(Tb(Tb({},o),{container:this.container})),this.plugins=null!==(e=o.plugins)&&void 0!==e?e:[];var s,l,u,c,d=this.graphModel.eventCenter;this.tool=new Zm(this),this.dnd=new Fm({lf:this}),this.history=new yb(d),this.keyboard=new Cb({lf:this,keyboard:o.keyboard}),!1!==o.snapline&&(this.snaplineModel=new Nv(this.graphModel,o.snaplineEpsilon),function(t,e){t.on("node:mousemove",function(t){var n=t.data;e.setNodeSnapLine(n)}),t.on("node:mouseup",function(){e.clearSnapline()})}(d,this.snaplineModel)),o.isSilentMode||(s=this,l=this.graphModel,u=s.keyboard,c=u.options.keyboard,u.on(["cmd + c","ctrl + c"],function(){if(Sb=wb,!(null==c?void 0:c.enabled))return!0;if(l.textEditElement)return!0;var t=s.options.guards,e=l.getSelectElements(!1);return t&&t.beforeClone&&!t.beforeClone(e)||0===e.nodes.length&&0===e.edges.length?(_b=null,!0):((_b=e).nodes.forEach(function(t){return xb(t,wb)}),_b.edges.forEach(function(t){return Eb(t,wb)}),!1)}),u.on(["cmd + v","ctrl + v"],function(){if(!(null==c?void 0:c.enabled))return!0;if(l.textEditElement)return!0;if(_b&&(_b.nodes||_b.edges)){s.clearSelectElements();var t=s.addElements(_b,Sb);if(!t)return!0;t.nodes.forEach(function(t){return s.selectElementById(t.id,!0)}),t.edges.forEach(function(t){return s.selectElementById(t.id,!0)}),_b.nodes.forEach(function(t){return xb(t,wb)}),_b.edges.forEach(function(t){return Eb(t,wb)}),Sb+=wb}return!1}),u.on(["cmd + z","ctrl + z"],function(){return!(null==c?void 0:c.enabled)||!!l.textEditElement||(s.undo(),!1)}),u.on(["cmd + y","ctrl + y"],function(){return!(null==c?void 0:c.enabled)||!!l.textEditElement||(s.redo(),!1)}),u.on(["backspace"],function(){if(!(null==c?void 0:c.enabled))return!0;if(l.textEditElement)return!0;var t=l.getSelectElements(!0);return s.clearSelectElements(),t.edges.forEach(function(t){return t.id&&s.deleteEdge(t.id)}),t.nodes.forEach(function(t){return t.id&&s.deleteNode(t.id)}),!1}),this.keyboard.initShortcuts()),this.defaultRegister(),this.installPlugins(o.disabledPlugins)}return t.prototype.initContainer=function(t,e,n){var o=document.createElement("div");return o.style.position="relative",o.style.width=e?"".concat(e,"px"):"100%",o.style.height=n?"".concat(n,"px"):"100%",t.innerHTML="",t.appendChild(o),o},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return t.toStringTag},enumerable:!1,configurable:!0}),t.prototype.register=function(t,e,n){if(void 0===n&&(n=!0),"string"==typeof t){var o={BaseEdge:Am,BaseEdgeModel:$g,BaseNode:em,BaseNodeModel:gy,RectNode:rm,RectNodeModel:Iy,CircleNode:sm,CircleNodeModel:by,PolygonNode:cm,PolygonNodeModel:ky,TextNode:bm,TextNodeModel:zy,LineEdge:Im,LineEdgeModel:ay,DiamondNode:hm,DiamondNodeModel:Sy,PolylineEdge:Hm,PolylineEdgeModel:dy,BezierEdge:km,BezierEdgeModel:ny,EllipseNode:ym,EllipseNodeModel:My,HtmlNode:Em,HtmlNodeModel:Wy,h:zl,type:t};if(this.viewMap.forEach(function(t){var e=t.extendKey;e&&(o[e]=t)}),this.graphModel.modelMap.forEach(function(t){var e=t.extendKey;e&&(o[e]=t)}),e){var r=e(o),i=r.view,a=r.model,s=i;n&&!s.isObserved&&(s.isObserved=!0,s=Db(s)),this.setView(t,s),this.graphModel.setModel(t,a)}}else this.registerElement(t)},t.prototype.registerElement=function(t){var e=t.view;!1===t.isObserverView||e.isObserved||(e.isObserved=!0,e=Db(e)),this.setView(t.type,e),this.graphModel.setModel(t.type,t.model)},t.prototype.batchRegister=function(t){var e=this;void 0===t&&(t=[]),$o(t,function(t){e.registerElement(t)})},t.prototype.defaultRegister=function(){var t=[{type:"rect",view:rm,model:Iy},{type:"circle",view:sm,model:by},{type:"polygon",view:cm,model:ky},{type:"text",view:bm,model:zy},{type:"ellipse",view:ym,model:My},{type:"diamond",view:hm,model:Sy},{type:"html",view:Em,model:Wy},{type:"line",view:Im,model:ay},{type:"polyline",view:Hm,model:dy},{type:"bezier",view:km,model:ny}];this.batchRegister(t)},t.prototype.addNode=function(t,e,n){return void 0===e&&(e=Sh.NODE_ADD),this.graphModel.addNode(t,e,n)},t.prototype.deleteNode=function(t){var e=this.graphModel.getNodeModelById(t);if(!e)return!1;var n=e.getData(),o=this.options.guards,r=!(null==o?void 0:o.beforeDelete)||o.beforeDelete(n);return r&&this.graphModel.deleteNode(t),r},t.prototype.cloneNode=function(t){var e=this.graphModel.getNodeModelById(t),n=null==e?void 0:e.getData();if(n){var o=this.options.guards;if(!(null==o?void 0:o.beforeClone)||o.beforeClone(n))return this.graphModel.cloneNode(t)}},t.prototype.changeNodeId=function(t,e){return this.graphModel.changeNodeId(t,e)},t.prototype.changeNodeType=function(t,e){this.graphModel.changeNodeType(t,e)},t.prototype.getNodeModelById=function(t){return this.graphModel.getNodeModelById(t)},t.prototype.getNodeDataById=function(t){var e=this.getNodeModelById(t);return null==e?void 0:e.getData()},t.prototype.getNodeIncomingEdge=function(t){return this.graphModel.getNodeIncomingEdge(t)},t.prototype.getNodeOutgoingEdge=function(t){return this.graphModel.getNodeOutgoingEdge(t)},t.prototype.getNodeIncomingNode=function(t){return this.graphModel.getNodeIncomingNode(t)},t.prototype.getNodeOutgoingNode=function(t){return this.graphModel.getNodeOutgoingNode(t)},t.prototype.createFakeNode=function(t){var e=this.graphModel.modelMap.get(t.type);if(!e)return console.warn("不存在为".concat(t.type,"类型的节点")),null;var n=new e(Tb(Tb({},t),{virtual:!0}),this.graphModel);return this.graphModel.setFakeNode(n),n},t.prototype.removeFakeNode=function(){this.graphModel.removeFakeNode()},t.prototype.setNodeSnapLine=function(t){var e;null===(e=this.snaplineModel)||void 0===e||e.setNodeSnapLine(t)},t.prototype.removeNodeSnapLine=function(){var t;null===(t=this.snaplineModel)||void 0===t||t.clearSnapline()},t.prototype.setDefaultEdgeType=function(t){this.graphModel.setDefaultEdgeType(t)},t.prototype.addEdge=function(t){return this.graphModel.addEdge(t)},t.prototype.getEdgeDataById=function(t){var e=this.getEdgeModelById(t);return null==e?void 0:e.getData()},t.prototype.getEdgeModelById=function(t){return this.graphModel.getEdgeModelById(t)},t.prototype.getEdgeModels=function(t){var e=t.sourceNodeId,n=t.targetNodeId,o=[],r=this.graphModel.edges;return e&&n?$o(r,function(t){t.sourceNodeId===e&&t.targetNodeId===n&&o.push(t)}):e?$o(r,function(t){t.sourceNodeId===e&&o.push(t)}):n&&$o(r,function(t){t.targetNodeId===n&&o.push(t)}),o},t.prototype.changeEdgeId=function(t,e){return this.graphModel.changeEdgeId(t,e)},t.prototype.changeEdgeType=function(t,e){this.graphModel.changeEdgeType(t,e)},t.prototype.deleteEdge=function(t){var e=this.graphModel.getEdgeModelById(t);if(!e)return!1;var n=e.getData(),o=this.options.guards,r=!(null==o?void 0:o.beforeDelete)||o.beforeDelete(n);return r&&this.graphModel.deleteEdgeById(t),r},t.prototype.deleteEdgeByNodeId=function(t){var e=t.sourceNodeId,n=t.targetNodeId;e&&n?this.graphModel.deleteEdgeBySourceAndTarget(e,n):e?this.graphModel.deleteEdgeBySource(e):n&&this.graphModel.deleteEdgeByTarget(n)},t.prototype.getNodeEdges=function(t){return this.graphModel.getNodeEdges(t)},t.prototype.addElements=function(t,e){var n=this,o=t.nodes,r=t.edges;void 0===e&&(e=40),console.log("distance",e);var i={},a={nodes:[],edges:[]};return $o(o,function(t){var e=t.id,o=n.addNode(t);e&&(i[e]=o.id),a.nodes.push(o)}),$o(r,function(t){var e=t.sourceNodeId,o=t.targetNodeId;i[e]&&(e=i[e]),i[o]&&(o=i[o]);var r=n.graphModel.addEdge(Tb(Tb({},t),{sourceNodeId:e,targetNodeId:o}));a.edges.push(r)}),a},t.prototype.selectElementById=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!0),this.graphModel.selectElementById(t,e),!e&&n&&this.graphModel.toFront(t)},t.prototype.deselectElementById=function(t){this.graphModel.deselectElementById(t)},t.prototype.getSelectElements=function(t){return void 0===t&&(t=!0),this.graphModel.getSelectElements(t)},t.prototype.clearSelectElements=function(){this.graphModel.clearSelectElements()},t.prototype.getModelById=function(t){return this.graphModel.getElement(t)},t.prototype.getDataById=function(t){var e;return null===(e=this.graphModel.getElement(t))||void 0===e?void 0:e.getData()},t.prototype.deleteElement=function(t){var e,n,o,r=this.getModelById(t);return!!r&&(null!==(o=null===(n=((e={})[_h.NODE]=this.deleteNode,e[_h.EDGE]=this.deleteEdge,e)[r.BaseType])||void 0===n?void 0:n.call(this,t))&&void 0!==o&&o)},t.prototype.setElementZIndex=function(t,e){return this.graphModel.setElementZIndex(t,e)},t.prototype.getAreaElement=function(t,e,n,o,r){return void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===r&&(r=!1),this.graphModel.getAreaElement(t,e,n,o,r).map(function(t){return t.getData()})},t.prototype.setProperties=function(t,e){var n;null===(n=this.graphModel.getElement(t))||void 0===n||n.setProperties(vh(e))},t.prototype.getProperties=function(t){var e;return null===(e=this.graphModel.getElement(t))||void 0===e?void 0:e.getProperties()},t.prototype.deleteProperty=function(t,e){var n;null===(n=this.graphModel.getElement(t))||void 0===n||n.deleteProperty(e)},t.prototype.updateAttributes=function(t,e){this.graphModel.updateAttributes(t,e)},t.prototype.editText=function(t){this.graphModel.editText(t)},t.prototype.updateText=function(t,e){this.graphModel.updateText(t,e)},t.prototype.updateEditConfig=function(t){var e=this.graphModel,n=e.editConfigModel,o=e.transformModel,r=n.snapGrid;if(n.updateEditConfig(t),void 0!==(null==t?void 0:t.stopMoveGraph)&&o.updateTranslateLimits(t.stopMoveGraph),(null==t?void 0:t.isSilentMode)?this.keyboard.disable():this.keyboard.enable(!0),!ae(null==t?void 0:t.snapGrid)&&t.snapGrid!==r){var i=this.graphModel.grid.size,a=void 0===i?1:i;this.graphModel.updateGridSize(t.snapGrid?a:1)}this.emit(Sh.EDIT_CONFIG_CHANGED,{data:n.getConfig()})},t.prototype.getEditConfig=function(){return this.graphModel.editConfigModel.getConfig()},t.prototype.setTheme=function(t,e){this.graphModel.setTheme(t,e)},t.prototype.getTheme=function(){return this.graphModel.getTheme()},t.prototype.focusByElement=function(t){var e=void 0,n=this.getNodeModelById(t);if(n){var o=n.getData();e={x:o.x,y:o.y}}var r=this.getEdgeModelById(t);if(r){var i=r.textPosition;e={x:i.x,y:i.y}}e&&this.focusByCoordinate(e)},t.prototype.focusByCoordinate=function(t){var e=this.graphModel,n=e.transformModel,o=e.width,r=e.height,i=t.x,a=t.y;n.focusOn(i,a,o,r)},t.prototype.focusOn=function(t){if("string"==typeof t)this.focusByElement(t);else if("x"in t&&"y"in t)this.focusByCoordinate(t);else{var e=t.id,n=t.coordinate;e&&this.focusByElement(e),n&&this.focusByCoordinate(n)}},t.prototype.resize=function(t,e){this.graphModel.resize(t,e),this.options.width=this.graphModel.width,this.options.height=this.graphModel.height},t.prototype.toFront=function(t){this.graphModel.toFront(t)},t.prototype.getPointByClient=function(t,e){return"object"==typeof t?this.graphModel.getPointByClient(t):"number"==typeof e?this.graphModel.getPointByClient({x:t,y:e}):void 0},t.prototype.getGraphData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.getGraphRawData();return this.adapterOut?this.adapterOut.apply(this,Nb([n],Mb(t),!1)):n},t.prototype.getGraphRawData=function(){return this.graphModel.modelToGraphData()},t.prototype.clearData=function(){this.graphModel.clearData(),this.render({})},t.prototype.setOverlapMode=function(t){this.graphModel.setOverlapMode(t)},t.prototype.renderRawData=function(t){this.graphModel.graphDataToModel(vh(t)),!1!==this.options.history&&this.history.watch(this.graphModel),nh(ph(kv,{getView:this.getView,tool:this.tool,options:this.options,dnd:this.dnd,snaplineModel:this.snaplineModel,graphModel:this.graphModel}),this.container),this.emit(Sh.GRAPH_RENDERED,{data:this.graphModel.modelToGraphData(),graphModel:this.graphModel})},t.prototype.render=function(t){var e=ne(t);this.adapterIn&&(e=this.adapterIn(e)),this.renderRawData(e)},t.prototype.undo=function(){if(this.history.undoAble()){var t=vh(this.history.undo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},t.prototype.redo=function(){if(this.history.redoAble()){var t=vh(this.history.redo());this.clearSelectElements(),this.graphModel.graphDataToModel(t)}},t.prototype.zoom=function(t,e){return this.graphModel.transformModel.zoom(t,e)},t.prototype.resetZoom=function(){this.graphModel.transformModel.resetZoom()},t.prototype.setZoomMiniSize=function(t){this.graphModel.transformModel.setZoomMiniSize(t)},t.prototype.setZoomMaxSize=function(t){this.graphModel.transformModel.setZoomMaxSize(t)},t.prototype.getTransform=function(){var t=this.graphModel.transformModel;return{SCALE_X:t.SCALE_X,SCALE_Y:t.SCALE_Y,TRANSLATE_X:t.TRANSLATE_X,TRANSLATE_Y:t.TRANSLATE_Y}},t.prototype.translate=function(t,e){this.graphModel.transformModel.translate(t,e)},t.prototype.resetTranslate=function(){var t=this.graphModel.transformModel,e=t.TRANSLATE_X,n=t.TRANSLATE_Y;this.translate(-e,-n)},t.prototype.translateCenter=function(){this.graphModel.translateCenter()},t.prototype.fitView=function(t,e){void 0===e&&(e=t),this.graphModel.fitView(t,e)},t.prototype.openEdgeAnimation=function(t){this.graphModel.openEdgeAnimation(t)},t.prototype.closeEdgeAnimation=function(t){this.graphModel.closeEdgeAnimation(t)},t.prototype.on=function(t,e){this.graphModel.eventCenter.on(t,e)},t.prototype.off=function(t,e){this.graphModel.eventCenter.off(t,e)},t.prototype.once=function(t,e){this.graphModel.eventCenter.once(t,e)},t.prototype.emit=function(t,e){this.graphModel.eventCenter.emit(t,e)},t.use=function(t,e){var n,o=t.pluginName;if(!o)throw new Error("请给插件指定 pluginName!");this.extensions.set(o,((n={})[Ab]=Ab,n.extension=t,n.props=e,n))},t.addThemeMode=function(t,e){!function(t,e){Hg[t]?console.warn("theme mode ".concat(t," already exists")):(Hg[t]=e,Fg[t]=e.background||zg,Xg[t]=e.grid||Wg)}(t,e)},t.removeThemeMode=function(t){!function(t){delete Hg[t],delete Fg[t],delete Xg[t]}(t)},t.clearThemeMode=function(){var t;sn(Hg,t={colorful:{},dark:{},radius:{},default:{}}),sn(Fg,t),sn(Xg,t)},t.prototype.installPlugins=function(e){var n=this;void 0===e&&(e=[]);var o=Array.from(t.extensions,function(t){return Mb(t,2)[1]});$o(Nb(Nb([],Mb(this.plugins),!1),Mb(o),!1),function(t){var o,r;Ab in t?(o=t.extension,r=t.props):o=t;var i=null==o?void 0:o.pluginName;-1===zr(e,i)&&n.installPlugin(o,r)})},t.prototype.installPlugin=function(e,n){var o,r;if("pluginName"in e&&"install"in e){var i=e.pluginName,a=e.install,s=e.render;i&&(a&&a.call(e,this,t),s&&this.components.push(s.bind(e)),this.extension[i]=e)}else{var l=e,u=l.pluginName,c=new l({lf:this,LogicFlow:t,props:n,options:null!==(r=null===(o=this.options.pluginsOptions)||void 0===o?void 0:o[u])&&void 0!==r?r:{}});c.render&&this.components.push(c.render.bind(c)),this.extension[u]=c}},t.prototype.destroy=function(){var t;for(var e in this.clearData(),nh(null,this.container),this.keyboard.destroy(),this.graphModel.destroy(),this.tool.destroy(),this.history.destroy(),this.extension){var n=this.extension[e];"destroy"in n&&(null===(t=n.destroy)||void 0===t||t.call(n))}},t.extensions=new Map,t}();function Db(t){return mp(t)}(Ob=Pb||(Pb={})).toStringTag="LF.".concat(Ob.name);var kb=40,Rb=40,Lb=40,Ib=40,jb=40,Bb=40,Hb=100,zb=80,Fb=100,Wb=80,Xb=function(){function t(){globalThis._ids=this,this._ids=new Set}return t.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},t.prototype.next=function(){for(var t=this.generateId();this._ids.has(t);)t=this.generateId();return this._ids.add(t),t},t}(),Ub=(null===globalThis||void 0===globalThis?void 0:globalThis._ids)||new Xb;function Gb(){return Ub.next()}var Yb=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){function e(e,n){return e.id||(e.id="Event_".concat(Gb())),e.text||(e.text=""),e.text&&"string"==typeof e.text&&(e.text={value:e.text,x:e.x,y:e.y+40}),t.call(this,e,n)||this}Yb(e,t),e.prototype.setAttributes=function(){this.r=18},e.prototype.getConnectedTargetRules=function(){var e=t.prototype.getConnectedTargetRules.call(this);return e.push({message:"起始节点不能作为边的终点",validate:function(){return!1}}),e},e.extendKey="StartEventModel"}(by),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Yb(e,t),e.extendKey="StartEventNode"}(sm);var Vb=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kb=function(){return Kb=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Kb.apply(this,arguments)};!function(t){function e(e,n){return e.id||(e.id="Event_".concat(Gb())),e.text||(e.text=""),e.text&&"string"==typeof e.text&&(e.text={value:e.text,x:e.x,y:e.y+40}),t.call(this,e,n)||this}Vb(e,t),e.prototype.setAttributes=function(){this.r=18},e.prototype.getConnectedSourceRules=function(){var e=t.prototype.getConnectedSourceRules.call(this);return e.push({message:"结束节点不能作为边的起点",validate:function(){return!1}}),e},e.extendKey="EndEventModel"}(by),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Vb(e,t),e.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},e.prototype.getShape=function(){var e=this.props.model,n=e.getNodeStyle(),o=e,r=o.x,i=o.y,a=o.r;return zl("g",{},t.prototype.getShape.call(this),zl("circle",Kb(Kb({},n),{cx:r,cy:i,r:a-5})))},e.extendKey="EndEventView"}(sm);var qb=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){function e(e,n){return e.id||(e.id="Flow_".concat(Gb())),t.call(this,e,n)||this}qb(e,t),e.extendKey="SequenceFlowModel"}(dy),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}qb(e,t),e.extendKey="SequenceFlowEdge"}(Hm);var Zb=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$b=function(){return $b=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},$b.apply(this,arguments)};!function(t){function e(e,n){var o=this;return e.id||(e.id="Gateway_".concat(Gb())),e.text||(e.text=""),e.text&&"string"==typeof e.text&&(e.text={value:e.text,x:e.x,y:e.y+40}),(o=t.call(this,e,n)||this).points=[[25,0],[50,25],[25,50],[0,25]],o}Zb(e,t),e.extendKey="ExclusiveGatewayModel"}(ky),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Zb(e,t),e.prototype.getShape=function(){var t=this.props.model,e=t,n=e.x,o=e.y,r=e.width,i=e.height,a=e.points,s=t.getNodeStyle();return zl("g",{transform:"matrix(1 0 0 1 ".concat(n-r/2," ").concat(o-i/2,")")},zl("polygon",$b($b({},s),{x:n,y:o,points:a})),zl("path",$b({d:"m 16,15 7.42857142857143,9.714285714285715 -7.42857142857143,9.714285714285715 3.428571428571429,0 5.714285714285715,-7.464228571428572 5.714285714285715,7.464228571428572 3.428571428571429,0 -7.42857142857143,-9.714285714285715 7.42857142857143,-9.714285714285715 -3.428571428571429,0 -5.714285714285715,7.464228571428572 -5.714285714285715,-7.464228571428572 -3.428571428571429,0 z"},s)))},e.extendKey="ExclusiveGatewayNode"}(cm);var Jb=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Qb=function(){return Qb=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Qb.apply(this,arguments)};!function(t){function e(e,n){return e.id||(e.id="Activity_".concat(Gb())),t.call(this,e,n)||this}Jb(e,t),e.extendKey="ServiceTaskModel"}(Iy),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Jb(e,t),e.prototype.getLabelShape=function(){var t=this.props.model,e=t.x,n=t.y;return zl("svg",{x:e-t.width/2+5,y:n-t.height/2+5,width:30,height:30,viewBox:"0 0 1274 1024"},zl("path",{fill:t.getNodeStyle().stroke,d:"M882.527918 434.149934c-2.234901-5.303796-7.311523-8.853645-13.059434-9.138124l-61.390185-3.009544c-6.635117-20.973684-15.521508-41.175795-26.513864-60.282968l42.051745-47.743374c4.308119-4.889357 4.955872-12.004405 1.602498-17.59268-46.384423-77.30362-103.969956-101.422947-106.400309-102.410438-5.332449-2.170432-11.432377-1.090844-15.693424 2.77009L654.674467 240.664222c-17.004279-8.654101-35.092239-15.756869-53.995775-21.210068l-3.26537-66.490344c-0.280386-5.747911-3.833305-10.824533-9.134031-13.059434-1.683339-0.709151-30.193673-12.391215-76.866668-12.051477-46.672996-0.339738-75.18333 11.342326-76.866668 12.051477-5.300726 2.234901-8.853645 7.311523-9.134031 13.059434l-3.26537 66.490344c-18.903535 5.453199-36.991496 12.555967-53.995775 21.210068l-48.450479-43.922349c-4.261047-3.860934-10.360975-4.940522-15.693424-2.77009-2.430352 0.98749-60.015885 25.106818-106.400309 102.410438-3.353374 5.588275-2.705622 12.703323 1.602498 17.59268l42.051745 47.743374c-10.992355 19.107173-19.878746 39.309284-26.513864 60.282968l-61.390185 3.009544c-5.747911 0.284479-10.824533 3.834328-13.059434 9.138124-1.01512 2.415003-24.687262 60.190871-2.822278 147.651828 1.583055 6.324032 7.072069 10.893094 13.57518 11.308557 5.892197 0.37146 11.751648 0.523933 17.419741 0.667196 14.498202 0.372483 28.193109 0.723477 40.908712 4.63353 4.212952 1.294482 6.435573 8.270361 9.349949 18.763342 1.287319 4.640694 2.617617 9.43693 4.484128 14.010085 1.794879 4.393054 3.75758 8.570189 5.66093 12.607132 1.302669 2.765997 2.529613 5.380544 3.689019 8.018627 2.986007 6.803963 2.682086 9.773598 2.578732 10.349719-3.061732 3.672646-6.391571 7.238868-9.91379 11.015891-1.810229 1.943258-3.680832 3.949962-5.523807 5.980201l-22.560832 24.8909c-3.865028 4.261047-4.940522 10.365068-2.774183 15.693424 0.991584 2.426259 25.102724 60.011792 102.414531 106.400309 5.588275 3.353374 12.703323 2.701528 17.591657-1.603521l23.476691-20.682042c2.346441-2.061962 4.64888-4.336772 6.875594-6.534833 9.05319-8.93858 14.018272-12.95608 17.73185-11.576663 3.305279 1.222851 6.907317 3.166109 10.720156 5.228071 3.325745 1.794879 6.764054 3.650133 10.465352 5.288446 6.016017 2.662643 12.120039 4.688789 18.019399 6.65149 6.827499 2.266623 13.279445 4.409426 18.819624 7.275707 1.518586 0.782829 1.926886 0.994654 2.358721 7.830339 0.726547 11.496845 1.25048 23.276123 1.753947 34.672684 0.264013 5.900384 0.528026 11.803837 0.815575 17.700127 0.284479 5.743818 3.833305 10.82044 9.138124 13.05534 1.654686 0.698918 29.371958 12.063757 74.869175 12.063757 0.328481 0 3.65832 0 3.986801 0 45.497217 0 73.214489-11.364839 74.869175-12.063757 5.304819-2.234901 8.853645-7.311523 9.138124-13.05534 0.287549-5.89629 0.551562-11.799744 0.815575-17.700127 0.503467-11.396561 1.027399-23.175839 1.753947-34.672684 0.431835-6.835685 0.840134-7.04751 2.358721-7.830339 5.54018-2.866281 11.992125-5.009084 18.819624-7.275707 5.89936-1.962701 12.003382-3.988848 18.019399-6.65149 3.701299-1.638313 7.139607-3.493567 10.465352-5.288446 3.812839-2.061962 7.414877-4.00522 10.720156-5.228071 3.713578-1.379417 8.67866 2.638083 17.73185 11.576663 2.226714 2.198062 4.529153 4.472871 6.875594 6.534833l23.476691 20.682042c4.888334 4.305049 12.003382 4.956895 17.591657 1.603521 77.311807-46.388517 101.422947-103.97405 102.414531-106.400309 2.166339-5.328355 1.090844-11.432377-2.774183-15.693424l-22.560832-24.8909c-1.842974-2.030239-3.713578-4.036943-5.523807-5.980201-3.52222-3.777023-6.852058-7.343245-9.91379-11.015891-0.103354-0.576121-0.407276-3.545756 2.578732-10.349719 1.159406-2.638083 2.38635-5.252631 3.689019-8.018627 1.90335-4.036943 3.866051-8.214079 5.66093-12.607132 1.866511-4.573155 3.196809-9.369392 4.484128-14.010085 2.914376-10.492982 5.136997-17.46886 9.349949-18.763342 12.715603-3.910053 26.41051-4.261047 40.908712-4.63353 5.668093-0.143263 11.527544-0.295735 17.419741-0.667196 6.503111-0.415462 11.992125-4.984524 13.57518-11.308557C907.21518 494.340805 883.543038 436.564937 882.527918 434.149934zM643.49894 643.761929c-35.280528 35.280528-82.191954 54.711066-132.086317 54.711066s-96.806813-19.430538-132.086317-54.711066c-35.280528-35.279504-54.711066-82.191954-54.711066-132.086317 0-49.894364 19.430538-96.80272 54.711066-132.082224 35.283598-35.284621 82.191954-54.711066 132.086317-54.711066s96.80579 19.426445 132.086317 54.711066c35.279504 35.279504 54.711066 82.187861 54.711066 132.082224C698.210006 561.569976 678.782537 608.482425 643.49894 643.761929z"}))},e.prototype.getShape=function(){var t=this.props.model,e=t.x,n=t.y,o=t.width,r=t.height,i=t.radius,a=t.getNodeStyle();return zl("g",{},[zl("rect",Qb({x:e-o/2,y:n-r/2,rx:i,ry:i,width:o,height:r},a)),this.getLabelShape()])},e.extendKey="ServiceTaskNode"}(rm);var t_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),e_=function(){return e_=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},e_.apply(this,arguments)};!function(t){function e(e,n){return e.id||(e.id="Activity_".concat(Gb())),t.call(this,e,n)||this}t_(e,t),e.extendKey="UserTaskModel"}(Iy),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}t_(e,t),e.prototype.getLabelShape=function(){var t=this.props.model,e=t.x,n=t.y;return zl("svg",{x:e-t.width/2+5,y:n-t.height/2+5,width:25,height:25,viewBox:"0 0 1274 1024"},zl("path",{fill:t.getNodeStyle().stroke,d:"M655.807326 287.35973m-223.989415 0a218.879 218.879 0 1 0 447.978829 0 218.879 218.879 0 1 0-447.978829 0ZM1039.955839 895.482975c-0.490184-212.177424-172.287821-384.030443-384.148513-384.030443-211.862739 0-383.660376 171.85302-384.15056 384.030443L1039.955839 895.482975z"}))},e.prototype.getShape=function(){var t=this.props.model,e=t.x,n=t.y,o=t.width,r=t.height,i=t.radius,a=t.getNodeStyle();return zl("g",{},[zl("rect",e_(e_({},a),{x:e-o/2,y:n-r/2,rx:i,ry:i,width:o,height:r})),this.getLabelShape()])},e.extendKey="UserTaskNode"}(rm);var n_=function(){function t(){globalThis._ids=this,this._ids=new Set}return t.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},t.prototype.next=function(){for(var t=this.generateId();this._ids.has(t);)t=this.generateId();return this._ids.add(t),t},t}(),o_=(null===globalThis||void 0===globalThis?void 0:globalThis._ids)||new n_;function r_(){return o_.next()}function i_(t){return Object.prototype.toString.call(t)}function a_(t){var e=t;return"[object Object]"===i_(t)?(e={},Object.keys(t).forEach(function(n){var o=n;"-"===n.charAt(0)&&(o=n.substring(1)),e[o]=a_(t[n])})):Array.isArray(t)&&(e=[],t.forEach(function(t,n){e[n]=a_(t)})),e}function s_(t){return null==t?"":t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}var l_="\t\n";function u_(t,e,n){var o=function(t){return"  ".repeat(t)}(n);if(0!==t&&!1!==t&&!t)return l_+o+"<".concat(e," />");var r="";if("#text"===e)return l_+o+s_(String(t));if("#cdata-section"===e)return l_+o+"<![CDATA["+t+"]]>";if("#comment"===e)return l_+o+"\x3c!--"+t+"--\x3e";if("-"==="".concat(e).charAt(0))return" "+e.substring(1)+'="'+function(t){var e=t;try{"string"!=typeof e&&(e=JSON.parse(t))}catch(n){e=JSON.stringify(a_(t)).replace(/"/g,"'")}return s_(String(e))}(t)+'"';if(Array.isArray(t))t.forEach(function(t){r+=u_(t,e,n+1)});else if("[object Object]"===i_(t)){var i=Object.keys(t),a="",s="";r+=(0===n?"":l_+o)+"<"+e,i.forEach(function(e){"-"===e.charAt(0)?a+=u_(t[e],e,n+1):s+=u_(t[e],e,n+1)}),r+=a+(""!==s?">".concat(s).concat(l_+o,"</").concat(e,">"):" />")}else r+=l_+o+"<".concat(e,">").concat(s_(String(t)),"</").concat(e,">");return r}var c_=function(){};(c_.ObjTree=function(){return this}).VERSION="0.23",c_.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n',c_.ObjTree.prototype.attr_prefix="-",c_.ObjTree.prototype.parseXML=function(t){var e;if(window.DOMParser){var n=new DOMParser,o=n.parseFromString(t,"application/xml");if(!o)return;e=o.documentElement}else window.ActiveXObject&&((n=new ActiveXObject("Microsoft.XMLDOM")).async=!1,n.loadXML(t),e=n.documentElement);if(e)return this.parseDOM(e)},c_.ObjTree.prototype.parseHTTP=function(t,e,n){var o,r={};for(var i in e)r[i]=e[i];if(r.method||(void 0===r.postBody&&void 0===r.postbody&&void 0===r.parameters?r.method="get":r.method="post"),n){r.asynchronous=!0;var a=this,s=n,l=r.onComplete;r.onComplete=function(t){var e;t&&t.responseXML&&t.responseXML.documentElement&&(e=a.parseDOM(t.responseXML.documentElement)),s(e,t),l&&l(t)}}else r.asynchronous=!1;if("undefined"!=typeof HTTP&&HTTP.Request)r.uri=t,(u=new HTTP.Request(r))&&(o=u.transport);else if("undefined"!=typeof Ajax&&Ajax.Request){var u;(u=new Ajax.Request(t,r))&&(o=u.transport)}return n?o:o&&o.responseXML&&o.responseXML.documentElement?this.parseDOM(o.responseXML.documentElement):void 0},c_.ObjTree.prototype.parseDOM=function(t){if(t){if(this.__force_array={},this.force_array)for(var e=0;e<this.force_array.length;e++)this.__force_array[this.force_array[e]]=1;var n=this.parseElement(t);if(this.__force_array[t.nodeName]&&(n=[n]),11!=t.nodeType){var o={};o[t.nodeName]=n,n=o}return n}},c_.ObjTree.prototype.parseElement=function(t){if(7!=t.nodeType){if(3==t.nodeType||4==t.nodeType||8==t.nodeType){if(null==t.nodeValue.match(/[^\x00-\x20]/))return;return t.nodeValue}var e=null,n={};if(t.attributes&&t.attributes.length){e={};for(var o=0;o<t.attributes.length;o++){if("string"==typeof(s=t.attributes[o].nodeName)){var r=t.attributes[o].nodeValue;try{r=JSON.parse(t.attributes[o].nodeValue.replace(/'/g,'"'))}catch(l){r=t.attributes[o].nodeValue}r&&(void 0===n[s=this.attr_prefix+s]&&(n[s]=0),n[s]++,this.addNode(e,s,n[s],r))}}}if(t.childNodes&&t.childNodes.length){var i=!0;e&&(i=!1);for(o=0;o<t.childNodes.length&&i;o++){var a=t.childNodes[o].nodeType;3!=a&&4!=a&&8!=a&&(i=!1)}if(i){e||(e="");for(o=0;o<t.childNodes.length;o++)e+=t.childNodes[o].nodeValue}else{e||(e={});for(o=0;o<t.childNodes.length;o++){var s;if("string"==typeof(s=t.childNodes[o].nodeName))(r=this.parseElement(t.childNodes[o]))&&(void 0===n[s]&&(n[s]=0),n[s]++,this.addNode(e,s,n[s],r))}}}else null===e&&(e={});return e}},c_.ObjTree.prototype.addNode=function(t,e,n,o){this.__force_array[e]?(1==n&&(t[e]=[]),t[e][t[e].length]=o):1==n?t[e]=o:2==n?t[e]=[t[e],o]:t[e][t[e].length]=o},c_.ObjTree.prototype.writeXML=function(t){var e=this.hash_to_xml(null,t);return this.xmlDecl+e},c_.ObjTree.prototype.hash_to_xml=function(t,e){var n=[],o=[];for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];r.charAt(0)!=this.attr_prefix?void 0===i||null==i?n[n.length]="<"+r+" />":"object"==typeof i&&i.constructor==Array?n[n.length]=this.array_to_xml(r,i):n[n.length]="object"==typeof i?this.hash_to_xml(r,i):this.scalar_to_xml(r,i):o[o.length]=" "+r.substring(1)+'="'+this.xml_escape(i)+'"'}var a=o.join(""),s=n.join("");return void 0===t||null==t||(s=n.length>0?s.match(/\n/)?"<"+t+a+">\n"+s+"</"+t+">\n":"<"+t+a+">"+s+"</"+t+">\n":"<"+t+a+" />\n"),s},c_.ObjTree.prototype.array_to_xml=function(t,e){for(var n=[],o=0;o<e.length;o++){var r=e[o];void 0===r||null==r?n[n.length]="<"+t+" />":"object"==typeof r&&r.constructor==Array?n[n.length]=this.array_to_xml(t,r):n[n.length]="object"==typeof r?this.hash_to_xml(t,r):this.scalar_to_xml(t,r)}return n.join("")},c_.ObjTree.prototype.scalar_to_xml=function(t,e){return"#text"==t?this.xml_escape(e):"<"+t+">"+this.xml_escape(e)+"</"+t+">\n"},c_.ObjTree.prototype.xml_escape=s_;var d_,p_,h_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),f_=function(){return f_=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},f_.apply(this,arguments)},g_=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a};(p_=d_||(d_={})).START="bpmn:startEvent",p_.END="bpmn:endEvent",p_.GATEWAY="bpmn:exclusiveGateway",p_.USER="bpmn:userTask",p_.SYSTEM="bpmn:serviceTask",p_.FLOW="bpmn:sequenceFlow";var y_=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef"],v_=["properties","startPoint","endPoint","pointsList"],m_=function(t){return String(t||"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&apos;/g,"'")};function b_(t){var e=t?v_.concat(t):v_;return function(t){return function t(n){var o={};return"string"==typeof n?n:Array.isArray(n)?n.map(function(e){return t(e)}):(Object.entries(n).forEach(function(n){var r=g_(n,2),i=r[0],a=r[1];"object"!=typeof a?0===i.indexOf("-")||["#text","#cdata-section","#comment"].includes(i)?o[i]=a:o["-".concat(i)]=a:e.includes(i)?o["-".concat(i)]=t(a):o[i]=t(a)}),o)}(t)}}function __(t){var e={};return Object.entries(t).forEach(function(t){var n=g_(t,2),o=n[0],r=n[1];0===o.indexOf("-")?e[o.substring(1)]=a_(r):"string"==typeof r?e[o]=r:"[object Object]"===Object.prototype.toString.call(r)?e[o]=__(r):Array.isArray(r)?e[o]=r.map(function(t){return __(t)}):e[o]=r}),e}function x_(t){var e=[],n=[],o=t["bpmn:definitions"];if(o){var r=o["bpmn:process"],i=o["bpmndi:BPMNDiagram"],a=null==i?void 0:i["bpmndi:BPMNPlane"];if(!r||!a)return{nodes:e,edges:n};Object.keys(r).forEach(function(t){if(0===t.indexOf("bpmn:")){var o=r[t];if(t===d_.FLOW){var i=a["bpmndi:BPMNEdge"],s=(Array.isArray(i),i);n=function(t,e){var n=[];if(Array.isArray(t))t.forEach(function(t){var o;o=Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n.push(w_(o,t))});else{var o=void 0;o=Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n.push(w_(o,t))}return n}(o,s)}else{var l=a["bpmndi:BPMNShape"],u=(Array.isArray(l),l);e=e.concat(function(t,e,n){var o=[];if(Array.isArray(t))t.forEach(function(t){var r=E_(Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n,t);o.push(r)});else{var r=E_(Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n,t);o.push(r)}return o}(o,u,t))}}})}return{nodes:e,edges:n}}function E_(t,e,n){var o,r,i=Number(t["dc:Bounds"]["-x"]),a=Number(t["dc:Bounds"]["-y"]),s=m_(n["-name"]),l=S_.shapeConfigMap.get(e);if(l&&(i+=l.width/2,a+=l.height/2),Object.entries(n).forEach(function(t){var e=g_(t,2),n=e[0],r=e[1];-1===y_.indexOf(n)&&(o||(o={}),o[n]=r)}),o&&(o=__(o)),s&&(r={x:i,y:a,value:s},t["bpmndi:BPMNLabel"]&&t["bpmndi:BPMNLabel"]["dc:Bounds"])){var u=t["bpmndi:BPMNLabel"]["dc:Bounds"];r.x=Number(u["-x"])+Number(u["-width"])/2,r.y=Number(u["-y"])+Number(u["-height"])/2}var c={id:t["-bpmnElement"],type:e,x:i,y:a,properties:o};return r&&(c.text=r),c}function w_(t,e){var n,o,r=e["-name"]?m_("".concat(e["-name"])):"";if(r){var i=void 0;t["bpmndi:BPMNLabel"]&&t["bpmndi:BPMNLabel"]["dc:Bounds"]&&(i=t["bpmndi:BPMNLabel"]["dc:Bounds"]);var a=0;if(r.split("\n").forEach(function(t){a<t.length&&(a=t.length)}),i)n={value:r,x:Number(i["-x"])+10*a/2,y:Number(i["-y"])+7};else{var s=t["di:waypoint"]||[],l=s[0],u=s[s.length-1]||l;n={value:r,x:(Number((null==l?void 0:l["-x"])||0)+Number((null==u?void 0:u["-x"])||0))/2,y:(Number((null==l?void 0:l["-y"])||0)+Number((null==u?void 0:u["-y"])||0))/2}}}Object.entries(e).forEach(function(t){var e=g_(t,2),n=e[0],r=e[1];-1===y_.indexOf(n)&&(o||(o={}),o[n]=r)}),o&&(o=__(o));var c={id:e["-id"],type:d_.FLOW,pointsList:t["di:waypoint"].map(function(t){return{x:Number(t["-x"]),y:Number(t["-y"])}}),sourceNodeId:e["-sourceRef"],targetNodeId:e["-targetRef"],properties:o};return n&&(c.text=n),c}var S_=function(){function t(t){var e=t.lf,n=this;this.adapterOut=function(t,e){var o=f_({},n.processAttributes);!function(t,e,n){var o=new Map;e.nodes.forEach(function(e){var r,i={"-id":e.id};if((null===(r=e.text)||void 0===r?void 0:r.value)&&(i["-name"]=e.text.value),e.properties){var a=b_(n)(e.properties);Object.assign(i,a)}o.set(e.id,i),t[e.type]?Array.isArray(t[e.type])?t[e.type].push(i):t[e.type]=[t[e.type],i]:t[e.type]=i});var r=e.edges.map(function(t){var e,r,i=o.get(t.targetNodeId);i["bpmn:incoming"]?Array.isArray(i["bpmn:incoming"])?i["bpmn:incoming"].push(t.id):i["bpmn:incoming"]=[i["bpmn:incoming"],t.id]:i["bpmn:incoming"]=t.id;var a={"-id":t.id,"-sourceRef":t.sourceNodeId,"-targetRef":t.targetNodeId};if((null===(e=t.text)||void 0===e?void 0:e.value)&&(a["-name"]=null===(r=t.text)||void 0===r?void 0:r.value),t.properties){var s=b_(n)(t.properties);Object.assign(a,s)}return a});e.edges.forEach(function(t){var e=o.get(t.sourceNodeId);e["bpmn:outgoing"]?Array.isArray(e["bpmn:outgoing"])?e["bpmn:outgoing"].push(t.id):e["bpmn:outgoing"]=[e["bpmn:outgoing"],t.id]:e["bpmn:outgoing"]=t.id}),t[d_.FLOW]=r}(o,t,e);var r={"-id":"BPMNPlane_1","-bpmnElement":o["-id"]};!function(t,e){t["bpmndi:BPMNEdge"]=e.edges.map(function(t){var e,n=t.id,o=t.pointsList.map(function(t){return{"-x":t.x,"-y":t.y}}),r={"-id":"".concat(n,"_di"),"-bpmnElement":n,"di:waypoint":o};return(null===(e=t.text)||void 0===e?void 0:e.value)&&(r["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":t.text.x-10*t.text.value.length/2,"-y":t.text.y-7,"-width":10*t.text.value.length,"-height":14}}),r}),t["bpmndi:BPMNShape"]=e.nodes.map(function(t){var e,n=t.id,o=100,r=80,i=t.x,a=t.y,s=S_.shapeConfigMap.get(t.type);s&&(o=s.width,r=s.height),i-=o/2,a-=r/2;var l={"-id":"".concat(n,"_di"),"-bpmnElement":n,"dc:Bounds":{"-x":i,"-y":a,"-width":o,"-height":r}};return(null===(e=t.text)||void 0===e?void 0:e.value)&&(l["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":t.text.x-10*t.text.value.length/2,"-y":t.text.y-7,"-width":10*t.text.value.length,"-height":14}}),l})}(r,t);var i=n.definitionAttributes;return i["bpmn:process"]=o,i["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":r},{"bpmn:definitions":i}},this.adapterIn=function(t){if(t)return x_(t)},e.adapterIn=function(t){return n.adapterIn(t)},e.adapterOut=function(t,e){return n.adapterOut(t,e)},this.processAttributes={"-isExecutable":"true","-id":"Process_".concat(r_())},this.definitionAttributes={"-id":"Definitions_".concat(r_()),"-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.0"}}return t.prototype.setCustomShape=function(e,n){t.shapeConfigMap.set(e,n)},t.pluginName="bpmn-adapter",t.shapeConfigMap=new Map,t}();S_.shapeConfigMap.set(d_.START,{width:kb,height:Rb}),S_.shapeConfigMap.set(d_.END,{width:Lb,height:Ib}),S_.shapeConfigMap.set(d_.GATEWAY,{width:jb,height:Bb}),S_.shapeConfigMap.set(d_.SYSTEM,{width:Hb,height:zb}),S_.shapeConfigMap.set(d_.USER,{width:Fb,height:Wb}),function(t){function e(e){var n=t.call(this,e)||this;n.adapterXmlIn=function(t){var e,o="string"==typeof t?n.sanitizeNameAttributes(t):t,r=(e=o,(new c_.ObjTree).parseXML(e));return n.adapterIn(r)},n.adapterXmlOut=function(t,e){return function(t){var e="";for(var n in t)e+=u_(t[n],n,0);return e}(n.adapterOut(t,e))};var o=e.lf;return o.adapterIn=n.adapterXmlIn,o.adapterOut=n.adapterXmlOut,n}h_(e,t),e.prototype.sanitizeNameAttributes=function(t){return t.replace(/name="([^"]*)"/g,function(t,e){var n=e.replace(/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return'name="'.concat(n,'"')})},e.pluginName="bpmnXmlAdapter"}(S_);var O_=function(){function t(){globalThis._ids=this,this._ids=new Set}return t.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},t.prototype.next=function(){for(var t=this.generateId();this._ids.has(t);)t=this.generateId();return this._ids.add(t),t},t}(),C_=(null===globalThis||void 0===globalThis?void 0:globalThis._ids)||new O_;zl("circle",{cx:18,cy:18,r:11,style:"stroke-linecap: round;stroke-linejoin: round;stroke: rgb(34, 36, 42);stroke-width: 2px;fill: white"}),zl("path",{d:"M 18,18 l 2.25,-7.5 m -2.25,7.5 l 5.25,1.5",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(0,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(30,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(60,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(90,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(120,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(150,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(180,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(210,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(240,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(270,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(300,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(330,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),zl("circle",{cx:18,cy:18,r:10,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 4px; fill: rgb(34, 36, 42);"}),zl("circle",{cx:25,cy:25,r:13,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2.5px; fill: white;"});var T_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),M_=function(){return M_=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},M_.apply(this,arguments)},N_=kh,A_=function(t){function e(e){var n=t.call(this)||this;return n.updatePosition=function(t){var e=t.deltaX,o=t.deltaY,r=n.nodeModel,i=r.x,a=r.y;n.nodeModel.x=i+e/2,n.nodeModel.y=a+o/2,n.nodeModel.moveText(e/2,o/2)},n.getResize=function(t){var e=t.index,n=t.deltaX,o=t.deltaY,r=t.width,i=t.height,a=t.PCTResizeInfo,s=t.pct,l=void 0===s?1:s,u=t.freezeWidth,c=void 0!==u&&u,d=t.freezeHeight,p=void 0!==d&&d,h={width:r,height:i,deltaX:n,deltaY:o};if(a){var f=0,g=0;switch(e){case 0:g=(-1*n-o)/4;break;case 1:g=(n-o)/4;break;case 2:g=(n+o)/4;break;case 3:g=(-1*n+o)/4}0!==g&&(f=Math.round(g/a.ResizeBasis.basisHeight*1e5)/1e3),a.ResizePCT.widthPCT=Math.max(Math.min(a.ResizePCT.widthPCT+f,a.ScaleLimit.maxScaleLimit),a.ScaleLimit.minScaleLimit),a.ResizePCT.heightPCT=Math.max(Math.min(a.ResizePCT.heightPCT+f,a.ScaleLimit.maxScaleLimit),a.ScaleLimit.minScaleLimit);var y=Math.round(a.ResizePCT.widthPCT*a.ResizeBasis.basisWidth/100),v=Math.round(a.ResizePCT.heightPCT*a.ResizeBasis.basisHeight/100);switch(e){case 0:n=r-y,o=i-v;break;case 1:n=y-r,o=i-v;break;case 2:n=y-r,o=v-i;break;case 3:n=r-y,o=v-i}return h.width=y,h.height=v,h.deltaX=n/l,h.deltaY=o/l,h}switch(e){case 0:h.width=c?r:r-n*l,h.height=p?i:i-o*l;break;case 1:h.width=c?r:r+n*l,h.height=p?i:i-o*l;break;case 2:h.width=c?r:r+n*l,h.height=p?i:i+o*l;break;case 3:h.width=c?r:r-n*l,h.height=p?i:i+o*l}return h},n.updateEdgePointByAnchors=function(){var t=n.nodeModel,e=t.id,o=t.anchors,r=n.getNodeEdges(e);r.sourceEdges.forEach(function(t){var e=o.find(function(e){return e.id===t.sourceAnchorId});e&&t.updateStartPoint({x:e.x,y:e.y})}),r.targetEdges.forEach(function(t){var e=o.find(function(e){return e.id===t.targetAnchorId});e&&t.updateEndPoint({x:e.x,y:e.y})})},n.updateRect=function(t){var e=t.deltaX,o=t.deltaY,r=n.nodeModel,i=r.x,a=r.y,s=r.width,l=r.height,u=r.radius,c=r.PCTResizeInfo,d=n.nodeModel,p=d.minWidth,h=d.minHeight,f=d.maxWidth,g=d.maxHeight,y=n.index,v=p===f,m=h===g,b=n.getResize({index:y,deltaX:e,deltaY:o,width:s,height:l,PCTResizeInfo:c,pct:1,freezeWidth:v,freezeHeight:m});if(b.width<p||b.width>f||b.height<h||b.height>g)n.dragHandler.cancelDrag();else{n.updatePosition({deltaX:v?0:b.deltaX,deltaY:m?0:b.deltaY}),n.nodeModel.width=b.width,n.nodeModel.height=b.height,n.nodeModel.setProperties({nodeSize:{width:b.width,height:b.height}});var _={x:i,y:a,width:s,height:l,radius:u},x={x:n.nodeModel.x,y:n.nodeModel.y,width:n.nodeModel.width,height:n.nodeModel.height,radius:u};n.updateEdgePointByAnchors(),n.eventEmit({deltaX:e,deltaY:o,beforeNode:_,afterNode:x})}},n.updateEllipse=function(t){var e=t.deltaX,o=t.deltaY,r=n.nodeModel,i=r.rx,a=r.ry,s=r.x,l=r.y,u=r.PCTResizeInfo,c=n.index,d=n.nodeModel,p=d.minWidth,h=d.minHeight,f=d.maxWidth,g=d.maxHeight,y=p===f,v=h===g,m=i,b=a,_=n.getResize({index:c,deltaX:e,deltaY:o,width:m,height:b,PCTResizeInfo:u,pct:.5,freezeWidth:y,freezeHeight:v});if(_.width<p/2||_.width>f/2||_.height<h/2||_.height>g/2)n.dragHandler.cancelDrag();else{n.updatePosition({deltaX:y?0:_.deltaX,deltaY:v?0:_.deltaY}),n.nodeModel.rx=_.width,n.nodeModel.ry=_.height,n.nodeModel.setProperties({nodeSize:{rx:_.width,ry:_.height}});var x={x:s,y:l},E={rx:_.width,ry:_.height,x:n.nodeModel.x,y:n.nodeModel.y};n.updateEdgePointByAnchors(),n.eventEmit({deltaX:e,deltaY:o,beforeNode:M_(M_({},x),{rx:i,ry:a}),afterNode:E})}},n.updateDiamond=function(t){var e=t.deltaX,o=t.deltaY,r=n.nodeModel,i=r.rx,a=r.ry,s=r.x,l=r.y,u=r.PCTResizeInfo,c=n.index,d=n.nodeModel,p=d.minWidth,h=d.minHeight,f=d.maxWidth,g=d.maxHeight,y=p===f,v=h===g,m=i,b=a,_=n.getResize({index:c,deltaX:e,deltaY:o,width:m,height:b,PCTResizeInfo:u,pct:.5,freezeWidth:y,freezeHeight:v});if(_.width<p/2||_.width>f/2||_.height<h/2||_.height>g/2)n.dragHandler.cancelDrag();else{n.updatePosition({deltaX:y?0:_.deltaX,deltaY:v?0:_.deltaY}),n.nodeModel.rx=_.width,n.nodeModel.ry=_.height,n.nodeModel.setProperties({nodeSize:{rx:_.width,ry:_.height}});var x={x:s,y:l,rx:i,ry:a},E={rx:_.width,ry:_.height,x:n.nodeModel.x,y:n.nodeModel.y};n.updateEdgePointByAnchors(),n.eventEmit({deltaX:e,deltaY:o,beforeNode:x,afterNode:E})}},n.eventEmit=function(t){var e=t.deltaX,o=t.deltaY,r=t.beforeNode,i=t.afterNode,a=n.nodeModel,s=a.id,l=a.modelType,u=a.type,c=M_({id:s,modelType:l,type:u},r),d=M_({id:s,modelType:l,type:u},i);n.graphModel.eventCenter.emit("node:resize",{preData:c,data:d,deltaX:e,deltaY:o,index:n.index,model:n.nodeModel})},n.onDragging=function(t){var e,o=t.deltaX,r=t.deltaY,i=n.graphModel.transformModel,a=n.nodeModel.modelType;o=(e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(i.fixDeltaXY(o,r),2))[0],r=e[1],a===Eh.RECT_NODE||a===Eh.HTML_NODE?n.updateRect({deltaX:o,deltaY:r}):a===Eh.ELLIPSE_NODE?n.updateEllipse({deltaX:o,deltaY:r}):a===Eh.DIAMOND_NODE&&n.updateDiamond({deltaX:o,deltaY:r})},n.onDragEnd=function(){var t=n.graphModel.gridSize,e=void 0===t?1:t,o=e*Math.round(n.nodeModel.x/e),r=e*Math.round(n.nodeModel.y/e);n.nodeModel.moveTo(o,r),n.updateEdgePointByAnchors()},n.index=e.index,n.nodeModel=e.model,n.graphModel=e.graphModel,n.dragHandler=new N_({onDragging:n.onDragging,onDragEnd:n.onDragEnd,step:1}),n}return T_(e,t),e.prototype.getNodeEdges=function(t){for(var e=this.graphModel.edges,n=[],o=[],r=0;r<e.length;r++){var i=e[r];i.sourceNodeId===t?n.push(i):e[r].targetNodeId===t&&o.push(i)}return{sourceEdges:n,targetEdges:o}},e.prototype.render=function(){var t=this.props,e=t.x,n=t.y,o=t.index,r=t.model.getControlPointStyle();return ph("g",{className:"lf-resize-control-".concat(o),children:ph(hg,M_({className:"lf-node-control",x:e,y:n},r,{onMouseDown:this.dragHandler.handleMouseDown}))})},e}(Xl),P_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),D_=function(){return D_=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},D_.apply(this,arguments)},k_=function(t){function e(){var e=t.call(this)||this;return e.state={},e}return P_(e,t),e.prototype.getResizeControl=function(){var t=this.props,e=t.model,n=t.graphModel,o=e.x,r=e.y,i=e.width,a=e.height,s={minX:o-i/2,minY:r-a/2,maxX:o+i/2,maxY:r+a/2},l=s.minX,u=s.minY,c=s.maxX,d=s.maxY;return[{x:l,y:u},{x:c,y:u},{x:c,y:d},{x:l,y:d}].map(function(t,o){return ph(A_,D_({index:o},t,{model:e,graphModel:n}))})},e.prototype.getGroupSolid=function(){var t=this.props.model,e=t.x,n=t.y,o=t.width,r=t.height,i=t.getResizeOutlineStyle();return ph(hg,D_({},i,{x:e,y:n,width:o,height:r}))},e.prototype.render=function(){return ph("g",{className:"lf-resize-control",children:[this.getGroupSolid(),this.getResizeControl()]})},e}(Xl),R_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){function e(e,n){var o=t.call(this,e,n)||this,r=e.properties.nodeSize;return r&&(o.rx=r.rx,o.ry=r.ry),o}R_(e,t),e.prototype.initNodeData=function(e){t.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},e.prototype.getOutlineStyle=function(){var e=t.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},e.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},e.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},e.prototype.enableProportionResize=function(t){if(void 0===t&&(t=!0),t){var e={basisWidth:this.rx,basisHeight:this.ry},n={maxScaleLimit:Math.min(this.maxWidth/(2*this.rx)*100,this.maxHeight/(2*this.ry)*100),minScaleLimit:Math.max(this.minWidth/(2*this.rx)*100,this.minHeight/(2*this.ry)*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:e,ScaleLimit:n}}else delete this.PCTResizeInfo}}(My),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}R_(e,t),e.prototype.getControlGroup=function(){var t=this.props,e=t.model,n=t.graphModel;return ph(k_,{model:e,graphModel:n})},e.prototype.getResizeShape=function(){return t.prototype.getShape.call(this)},e.prototype.getShape=function(){var t=this.props,e=t.model,n=t.graphModel.editConfigModel.isSilentMode;return ph("g",{children:[this.getResizeShape(),e.isSelected&&!n?this.getControlGroup():""]})}}(ym);var L_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),I_=function(){return I_=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},I_.apply(this,arguments)};!function(t){function e(e,n){var o=t.call(this,e,n)||this,r=e.properties.nodeSize;return r&&(o.rx=r.rx,o.ry=r.ry),o}L_(e,t),e.prototype.initNodeData=function(e){t.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.gridSize=1},e.prototype.getOutlineStyle=function(){var e=t.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},e.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},e.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},e.prototype.enableProportionResize=function(t){if(void 0===t&&(t=!0),t){var e={basisWidth:this.rx,basisHeight:this.ry},n={maxScaleLimit:Math.min(this.maxWidth/(2*this.rx)*100,this.maxHeight/(2*this.ry)*100),minScaleLimit:Math.max(this.minWidth/(2*this.rx)*100,this.minHeight/(2*this.ry)*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:e,ScaleLimit:n}}else delete this.PCTResizeInfo}}(Sy),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}L_(e,t),e.prototype.getControlGroup=function(){var t=this.props,e=t.model,n=t.graphModel;return ph(k_,{model:e,graphModel:n})},e.prototype.getResizeShape=function(){var t=this.props.model,e=t.points,n=t.getNodeStyle();return ph("g",{children:ph(xg,I_({},n,{points:e}))})},e.prototype.getShape=function(){var t=this.props,e=t.model.isSelected,n=t.graphModel.editConfigModel.isSilentMode;return ph("g",{children:[this.getResizeShape(),e&&!n?this.getControlGroup():""]})}}(hm);var j_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){function e(e,n){var o=t.call(this,e,n)||this,r=e.properties.nodeSize;return r&&(o.width=r.width,o.height=r.height),o}j_(e,t),e.prototype.initNodeData=function(e){t.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},e.prototype.getOutlineStyle=function(){var e=t.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},e.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},e.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},e.prototype.enableProportionResize=function(t){if(void 0===t&&(t=!0),t){var e={basisWidth:this.width,basisHeight:this.height},n={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:e,ScaleLimit:n}}else delete this.PCTResizeInfo}}(Wy),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}j_(e,t),e.prototype.getControlGroup=function(){var t=this.props,e=t.model,n=t.graphModel;return ph(k_,{model:e,graphModel:n})},e.prototype.getResizeShape=function(){return t.prototype.getShape.call(this)},e.prototype.getShape=function(){var t=this.props,e=t.model.isSelected,n=t.graphModel.editConfigModel.isSilentMode;return ph("g",{children:[this.getResizeShape(),e&&!n?this.getControlGroup():""]})}}(Em);var B_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),H_=function(t){function e(e,n){var o=t.call(this,e,n)||this,r=e.properties.nodeSize;return r&&(o.width=r.width,o.height=r.height),o}return B_(e,t),e.prototype.initNodeData=function(e){t.prototype.initNodeData.call(this,e),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},e.prototype.getOutlineStyle=function(){var e=t.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(e.stroke="none",e.hover&&(e.hover.stroke="none")),e},e.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},e.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},e.prototype.enableProportionResize=function(t){if(void 0===t&&(t=!0),t){var e={basisWidth:this.width,basisHeight:this.height},n={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:e,ScaleLimit:n}}else delete this.PCTResizeInfo},e}(Iy),z_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B_(e,t),e.prototype.getControlGroup=function(){var t=this.props,e=t.model,n=t.graphModel;return ph(k_,{model:e,graphModel:n})},e.prototype.getResizeShape=function(){return t.prototype.getShape.call(this)},e.prototype.getShape=function(){var t=this.props,e=t.model.isSelected,n=t.graphModel.editConfigModel.isSilentMode;return ph("g",{children:[this.getResizeShape(),e&&!n?this.getControlGroup():""]})},e}(rm),F_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),W_=function(){return W_=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},W_.apply(this,arguments)},X_=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},U_=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};!function(t){function e(){var e=t.apply(this,U_([],X_(arguments),!1))||this;return e.isGroup=!0,e.isFolded=!1,e.unfoldedWidth=500,e.unfoldedHeight=300,e.childrenLastFoldStatus={},e}F_(e,t),e.prototype.initNodeData=function(e){var n=this;t.prototype.initNodeData.call(this,e);var o=[];d(e.children)&&(o=e.children),this.children=new Set(o),this.width=500,this.height=300,this.foldedWidth=80,this.foldedHeight=60,this.zIndex=-1e4,this.radius=0,this.text.editable=!1,this.text.draggable=!1,this.isRestrict=!1,this.resizable=!1,this.autoToFront=!1,this.foldable=!1,void 0===this.properties.isFolded&&(this.properties.isFolded=!1),this.isFolded=!!this.properties.isFolded,setTimeout(function(){n.isFolded&&n.foldGroup(n.isFolded)})},e.prototype.getResizeOutlineStyle=function(){var e=t.prototype.getResizeOutlineStyle.call(this);return e.stroke="none",e},e.prototype.foldGroup=function(t){var e=this;if(t!==this.isFolded){this.setProperty("isFolded",t),this.isFolded=t,t?(this.x=this.x-this.width/2+this.foldedWidth/2,this.y=this.y-this.height/2+this.foldedHeight/2,this.unfoldedWidth=this.width,this.unfoldedHeight=this.height,this.width=this.foldedWidth,this.height=this.foldedHeight):(this.width=this.unfoldedWidth,this.height=this.unfoldedHeight,this.x=this.x+this.width/2-this.foldedWidth/2,this.y=this.y+this.height/2-this.foldedHeight/2);var n=U_(U_([],X_(this.incoming.edges),!1),X_(this.outgoing.edges),!1);this.children.forEach(function(o){var r=e.graphModel.getElement(o);if(r){var i=r.isFolded;if(r.isGroup&&!r.isFolded&&r.foldGroup(t),r.isGroup&&!t){var a=e.childrenLastFoldStatus[o];void 0!==a&&a!==r.isFolded&&r.foldGroup(a)}e.childrenLastFoldStatus[o]=!!i,r.visible=!t;var s=r.incoming.edges,l=r.outgoing.edges;n=U_(U_(U_([],X_(n),!1),X_(s),!1),X_(l),!1)}}),this.foldEdge(t,n)}},e.prototype.getAnchorStyle=function(e){var n=t.prototype.getAnchorStyle.call(this,e);return n.stroke="transparent",n.fill="transparent",n.hover.fill="transparent",n.hover.stroke="transparent",n},e.prototype.foldEdge=function(t,e){var n=this;e.forEach(function(e,o){var r=e.id,i=e.sourceNodeId,a=e.targetNodeId,s=e.startPoint,l=e.endPoint,u=e.type,c=e.text,d=e.getProperties(),p={id:"".concat(r,"__").concat(o),sourceNodeId:i,targetNodeId:a,startPoint:s,endPoint:l,type:u,properties:d,text:null==c?void 0:c.value};e.virtual&&n.graphModel.deleteEdgeById(e.id);var h=n.graphModel.group.getNodeGroup(a);h||(h=n.graphModel.getNodeModelById(a));var f=n.graphModel.group.getNodeGroup(i);f||(f=n.graphModel.getNodeModelById(i)),t&&!1!==e.visible&&(n.children.has(i)||n.id===i?(p.startPoint=void 0,p.sourceNodeId=n.id):(p.endPoint=void 0,p.targetNodeId=n.id),h.id===n.id&&f.id===n.id||n.createVirtualEdge(p),e.visible=!1),t||!1!==e.visible||(h&&h.isGroup&&h.isFolded?(p.targetNodeId=h.id,p.endPoint=void 0,n.createVirtualEdge(p)):f&&f.isGroup&&f.isFolded?(p.sourceNodeId=f.id,p.startPoint=void 0,n.createVirtualEdge(p)):e.visible=!0)})},e.prototype.createVirtualEdge=function(t){t.pointsList=void 0;var e=this.graphModel.addEdge(t);e.virtual=!0,e.text.editable=!1,e.isFoldedEdge=!0},e.prototype.isInRange=function(t){var e=t.minX,n=t.minY,o=t.maxX,r=t.maxY;return e>=this.x-this.width/2&&o<=this.x+this.width/2&&n>=this.y-this.height/2&&r<=this.y+this.height/2},e.prototype.isAllowMoveTo=function(t){var e=t.minX,n=t.minY,o=t.maxX,r=t.maxY;return{x:e>=this.x-this.width/2&&o<=this.x+this.width/2,y:n>=this.y-this.height/2&&r<=this.y+this.height/2}},e.prototype.setAllowAppendChild=function(t){this.setProperty("groupAddable",t)},e.prototype.addChild=function(t){this.children.add(t),this.graphModel.eventCenter.emit("group:add-node",{data:this.getData()})},e.prototype.removeChild=function(t){this.children.delete(t),this.graphModel.eventCenter.emit("group:remove-node",{data:this.getData()})},e.prototype.getAddableOutlineStyle=function(){return{stroke:"#FEB663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},e.prototype.getData=function(){var e=this,n=t.prototype.getData.call(this);n.children=[],this.children.forEach(function(t){var o=e.graphModel.getNodeModelById(t);o&&!o.virtual&&n.children.push(t)});var o=n.properties;return null==o||delete o.groupAddable,null==o||delete o.isFolded,n},e.prototype.getHistoryData=function(){var e=t.prototype.getData.call(this);e.children=U_([],X_(this.children),!1),e.isGroup=!0;var n=e.properties;return null==n||delete n.groupAddable,(null==n?void 0:n.isFolded)&&(e.x=e.x+this.unfoldedWidth/2-this.foldedWidth/2,e.y=e.y+this.unfoldedHeight/2-this.foldedHeight/2),e},e.prototype.isAllowAppendIn=function(t){return console.info("_nodeData",t),!0},e.prototype.toBack=function(){this.zIndex--}}(H_),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}F_(e,t),e.prototype.getControlGroup=function(){var e=this.props.model,n=e.resizable,o=e.properties;return n&&!o.isFolded?t.prototype.getControlGroup.call(this):null},e.prototype.getAddableShape=function(){var t=this.props.model,e=t.width,n=t.height,o=t.x,r=t.y,i=t.radius,a=t.properties,s=t.getAddableOutlineStyle;if(!a.groupAddable)return null;var l=this.props.model.getNodeStyle().strokeWidth,u=void 0===l?0:l,c=s(),d=e+u+8,p=n+u+8;return zl("rect",W_(W_({},c),{width:d,height:p,x:o-d/2,y:r-p/2,rx:i,ry:i}))},e.prototype.getFoldIcon=function(){var t=this.props.model,e=t.x-t.width/2+5,n=t.y-t.height/2+5;if(!t.foldable)return null;var o=zl("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:t.properties.isFolded?"M ".concat(e+3,",").concat(n+6," ").concat(e+11,",").concat(n+6," M").concat(e+7,",").concat(n+2," ").concat(e+7,",").concat(n+10):"M ".concat(e+3,",").concat(n+6," ").concat(e+11,",").concat(n+6," ")});return zl("g",{},[zl("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#F4F5F6",stroke:"#CECECE",cursor:"pointer",x:t.x-t.width/2+5,y:t.y-t.height/2+5,onClick:function(){t.foldGroup(!t.properties.isFolded)}}),o])},e.prototype.getResizeShape=function(){return zl("g",{},[this.getAddableShape(),t.prototype.getResizeShape.call(this),this.getFoldIcon()])}}(z_);var G_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Y_=function(){return Y_=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Y_.apply(this,arguments)};(function(t){function e(e,n){e.id||(e.id="Flow_".concat(C_.next()));var o=Y_(Y_(Y_({},{}),e.properties),{isDefaultFlow:!1});return e.properties=o,t.call(this,e,n)||this}G_(e,t),e.extendKey="SequenceFlowModel"})(dy),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}G_(e,t),e.prototype.getStartArrow=function(){return zl("path",this.props.model.properties.isDefaultFlow?{refX:15,stroke:"#000000",strokeWidth:2,d:"M 20 5 10 -5 z"}:{d:""})},e.extendKey="SequenceFlowEdge"}(Hm);var V_=40,K_=40,q_=40,Z_=40,$_=100,J_=80,Q_=100,tx=80,ex=100,nx=80,ox=100,rx=80,ix=100,ax=80,sx=100,lx=80,ux=100,cx=80,dx=100,px=80,hx=function(){};(hx.ObjTree=function(){return this}).VERSION="0.23",hx.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n',hx.ObjTree.prototype.attr_prefix="-",hx.ObjTree.prototype.parseXML=function(t){var e;if(window.DOMParser){var n=new DOMParser,o=n.parseFromString(t,"application/xml");if(!o)return;e=o.documentElement}else window.ActiveXObject&&((n=new ActiveXObject("Microsoft.XMLDOM")).async=!1,n.loadXML(t),e=n.documentElement);if(e)return this.parseDOM(e)},hx.ObjTree.prototype.parseHTTP=function(t,e,n){var o,r={};for(var i in e)r[i]=e[i];if(r.method||(void 0===r.postBody&&void 0===r.postbody&&void 0===r.parameters?r.method="get":r.method="post"),n){r.asynchronous=!0;var a=this,s=n,l=r.onComplete;r.onComplete=function(t){var e;t&&t.responseXML&&t.responseXML.documentElement&&(e=a.parseDOM(t.responseXML.documentElement)),s(e,t),l&&l(t)}}else r.asynchronous=!1;if("undefined"!=typeof HTTP&&HTTP.Request)r.uri=t,(u=new HTTP.Request(r))&&(o=u.transport);else if("undefined"!=typeof Ajax&&Ajax.Request){var u;(u=new Ajax.Request(t,r))&&(o=u.transport)}return n?o:o&&o.responseXML&&o.responseXML.documentElement?this.parseDOM(o.responseXML.documentElement):void 0},hx.ObjTree.prototype.parseDOM=function(t){if(t){if(this.__force_array={},this.force_array)for(var e=0;e<this.force_array.length;e++)this.__force_array[this.force_array[e]]=1;var n=this.parseElement(t);if(this.__force_array[t.nodeName]&&(n=[n]),11!==t.nodeType){var o={};o[t.nodeName]=n,n=o}return n}},hx.ObjTree.prototype.parseElement=function(t){if(7!==t.nodeType){if(3===t.nodeType||4===t.nodeType||8===t.nodeType){if(null==t.nodeValue.match(/[^\x00-\x20]/))return;return t.nodeValue}var e=null,n={};if(t.attributes&&t.attributes.length){e={};for(var o=0;o<t.attributes.length;o++){if("string"==typeof(s=t.attributes[o].nodeName)){var r=t.attributes[o].nodeValue;try{r=JSON.parse(t.attributes[o].nodeValue.replace(/'/g,'"'))}catch(l){r=t.attributes[o].nodeValue}null!=r&&(void 0===n[s=this.attr_prefix+s]&&(n[s]=0),n[s]++,this.addNode(e,s,n[s],r))}}}if(t.childNodes&&t.childNodes.length){var i=!0;e&&(i=!1);for(o=0;o<t.childNodes.length&&i;o++){var a=t.childNodes[o].nodeType;3!==a&&4!==a&&8!==a&&(i=!1)}if(i){e||(e="");for(o=0;o<t.childNodes.length;o++)e+=t.childNodes[o].nodeValue}else{e||(e={});for(o=0;o<t.childNodes.length;o++){var s;if("string"==typeof(s=t.childNodes[o].nodeName))(r=this.parseElement(t.childNodes[o]))&&(void 0===n[s]&&(n[s]=0),n[s]++,this.addNode(e,s,n[s],r))}}}else null===e&&(e={});return e}},hx.ObjTree.prototype.addNode=function(t,e,n,o){this.__force_array[e]?(1===n&&(t[e]=[]),t[e][t[e].length]=o):1===n?t[e]=o:2===n?t[e]=[t[e],o]:t[e][t[e].length]=o},hx.ObjTree.prototype.writeXML=function(t){var e=this.hash_to_xml(null,t);return this.xmlDecl+e},hx.ObjTree.prototype.hash_to_xml=function(t,e){var n=[],o=[];for(var r in e)if(ge(e,r)){var i=e[r];r.charAt(0)!==this.attr_prefix?void 0===i||null==i?n[n.length]="<".concat(r," />"):"object"==typeof i&&i.constructor===Array?n[n.length]=this.array_to_xml(r,i):n[n.length]="object"==typeof i?this.hash_to_xml(r,i):this.scalar_to_xml(r,i):o[o.length]=" ".concat(r.substring(1),'="').concat(this.xml_escape(i),'"')}var a=o.join(""),s=n.join("");return void 0===t||null==t||(s=n.length>0?s.match(/\n/)?"<".concat(t).concat(a,">\n").concat(s,"</").concat(t,">\n"):"<".concat(t).concat(a,">").concat(s,"</").concat(t,">\n"):"<".concat(t).concat(a," />\n")),s},hx.ObjTree.prototype.array_to_xml=function(t,e){for(var n=[],o=0;o<e.length;o++){var r=e[o];void 0===r||null==r?n[n.length]="<".concat(t," />"):"object"==typeof r&&r.constructor===Array?n[n.length]=this.array_to_xml(t,r):n[n.length]="object"==typeof r?this.hash_to_xml(t,r):this.scalar_to_xml(t,r)}return n.join("")},hx.ObjTree.prototype.scalar_to_xml=function(t,e){return"#text"===t?this.xml_escape(e):"<".concat(t,">").concat(this.xml_escape(e),"</").concat(t,">\n")},hx.ObjTree.prototype.xml_escape=function(t){return t.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"')};function fx(t){return Object.prototype.toString.call(t)}function gx(t){return"  ".repeat(t)}function yx(t){return"[object Object]"===fx(t)?Object.keys(t).reduce(function(e,n){var o=n;return"-"===n.charAt(0)&&(o=n.substring(1)),e[o]=yx(t[n]),e},{}):Array.isArray(t)?t.map(function(t){return yx(t)}):t}function vx(t,e,n){var o="",r="\t\n"+gx(n);if("-json"===e)return"";if("#text"===e)return r+t;if("#cdata-section"===e)return"".concat(r,"<![CDATA[").concat(t,"]]>");if("#comment"===e)return"".concat(r,"\x3c!--").concat(t,"--\x3e");if("-"==="".concat(e).charAt(0))return" ".concat(e.substring(1),'="').concat(function(t){var e=t;try{"string"!=typeof e&&(e=JSON.parse(t))}catch(n){e=JSON.stringify(yx(t)).replace(/"/g,"'")}return e}(t),'"');if(Array.isArray(t))o+=t.map(function(t){return vx(t,e,n+1)}).join("");else if("[object Object]"===fx(t)){var i=Object.keys(t),a="",s=t["-json"]?"\t\n"+gx(n+1)+t["-json"]:"";o+="".concat(0===n?"":r,"<").concat(e),i.forEach(function(e){"-"===e.charAt(0)?a+=vx(t[e],e,n+1):s+=vx(t[e],e,n+1)}),o+=a+(""!==s?">".concat(s).concat(r,"</").concat(e,">"):" />")}else o+="".concat(r,"<").concat(e,">").concat(t.toString(),"</").concat(e,">");return o}var mx,bx=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_x=function(){return _x=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},_x.apply(this,arguments)},xx=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]])}return n},Ex=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wx=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Sx=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};!function(t){t.START="bpmn:startEvent",t.END="bpmn:endEvent",t.INTERMEDIATE_CATCH="bpmn:intermediateCatchEvent",t.INTERMEDIATE_THROW="bpmn:intermediateThrowEvent",t.BOUNDARY="bpmn:boundaryEvent",t.PARALLEL_GATEWAY="bpmn:parallelGateway",t.INCLUSIVE_GATEWAY="bpmn:inclusiveGateway",t.EXCLUSIVE_GATEWAY="bpmn:exclusiveGateway",t.USER="bpmn:userTask",t.SYSTEM="bpmn:serviceTask",t.FLOW="bpmn:sequenceFlow",t.SUBPROCESS="bpmn:subProcess"}(mx||(mx={}));var Ox=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef","-children"],Cx=["properties","startPoint","endPoint","pointsList"],Tx=[],Mx=["properties.panels","properties.nodeSize","properties.definitionId","properties.timerValue","properties.timerType","properties.definitionType","properties.parent","properties.isBoundaryEventTouchingTask"],Nx=function(t,e){return Object.keys(e||{}).forEach(function(n){if(t[n]){var o=e[n],r=o.in,i=o.out;r&&(t[n].in=r),i&&(t[n].out=i)}else t[n]=e[n]}),t},Ax={"bpmn:startEvent":{out:function(t){var e,n,o=t.properties;return(null===(n=null===(e=Ax[o.definitionType])||void 0===e?void 0:e.out)||void 0===n?void 0:n.call(e,t))||{}}},"bpmn:intermediateCatchEvent":{out:function(t){var e,n,o=t.properties;return(null===(n=null===(e=Ax[o.definitionType])||void 0===e?void 0:e.out)||void 0===n?void 0:n.call(e,t))||{}}},"bpmn:intermediateThrowEvent":{out:function(t){var e,n,o=t.properties;return(null===(n=null===(e=Ax[o.definitionType])||void 0===e?void 0:e.out)||void 0===n?void 0:n.call(e,t))||{}}},"bpmn:boundaryEvent":{out:function(t){var e,n,o=t.properties;return(null===(n=null===(e=Ax[o.definitionType])||void 0===e?void 0:e.out)||void 0===n?void 0:n.call(e,t))||{}}},"bpmn:sequenceFlow":{out:function(t){var e=t.properties,n=e.expressionType,o=e.condition;return o?"cdata"===n?{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression"><![CDATA[${'.concat(o,"}]]></bpmn:conditionExpression>")}:{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression">'.concat(o,"</bpmn:conditionExpression>")}:{json:""}}},"bpmn:timerEventDefinition":{out:function(t){var e=t.properties,n=e.timerType,o=e.timerValue,r=e.definitionId;return{json:'<bpmn:timerEventDefinition id="'.concat(r,'"').concat(n&&o?">".concat("<bpmn:".concat(n,' xsi:type="bpmn:tFormalExpression">').concat(o,"</bpmn:").concat(n,">"),"</bpmn:timerEventDefinition>"):"/>")}},in:function(t,e){var n,o,r,i=t,a=e["-id"],s="",l="";try{for(var u=Ex(Object.keys(e)),c=u.next();!c.done;c=u.next()){var d=c.value;d.includes("bpmn:")&&(s=wx(d.split(":"),2)[1],l=null===(r=e[d])||void 0===r?void 0:r["#text"])}}catch(p){n={error:p}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return{"-definitionId":a,"-definitionType":i,"-timerType":s,"-timerValue":l}}},"bpmn:conditionExpression":{in:function(t,e){var n,o="",r="";return e["#cdata-section"]?(r="cdata",o=(null===(n=/^\$\{(.*)\}$/g.exec(e["#cdata-section"]))||void 0===n?void 0:n[1])||""):e["#text"]&&(r="normal",o=e["#text"]),{"-condition":o,"-expressionType":r}}}};function Px(t){var e,n,o={};try{for(var r=Ex(Object.entries(t)),i=r.next();!i.done;i=r.next()){var a=wx(i.value,2),s=a[0],l=a[1];0===s.indexOf("-")?o[s.substring(1)]=yx(l):"string"==typeof l?o[s]=l:"[object Object]"===Object.prototype.toString.call(l)?o[s]=Px(l):Array.isArray(l)?o[s]=l.map(function(t){return Px(t)}):o[s]=l}}catch(u){e={error:u}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return o}function Dx(t,e,n){var o,r=new Map,i=function(t){var e=null!=t?t:{},n=e.retainedAttrsFields,o=e.excludeFields,r=e.transformer,i=new Set(Sx(Sx([],wx(Cx),!1),wx(n||[]),!1)),a={in:new Set(Sx(Sx([],wx(Tx),!1),wx((null==o?void 0:o.in)||[]),!1)),out:new Set(Sx(Sx([],wx(Mx),!1),wx((null==o?void 0:o.out)||[]),!1))};return Ax=Nx(Ax,r),function(t){var e=t.nodes,n=t.edges;return function t(o,r){var s,l;if(1!==(null==o?void 0:o.flag)){var u;if((u=Ax[o.type])&&u.out){var c=u.out(o),d=Object.keys(c);d.length>0&&d.forEach(function(t){o[t]=c[t]})}(null==o?void 0:o.children)&&(o.children=o.children.map(function(t){return e.find(function(e){return e.id===t})||n.find(function(e){return e.id===t})||{}}));var p={};if("string"==typeof o)return o;if(Array.isArray(o))return o.map(function(e){return t(e,"")}).filter(function(t){return null!=t});try{for(var h=Ex(Object.entries(o)),f=h.next();!f.done;f=h.next()){var g=wx(f.value,2),y=g[0],v=g[1];if(1===(null==v?void 0:v.flag))return;var m=[r,y].filter(function(t){return t}).join(".");a.out.has(m)||("object"!=typeof v?0===y.indexOf("-")||["#text","#cdata-section","#comment"].includes(y)?p[y]=v:p["-".concat(y)]=v:i.has(m)?p["-".concat(y)]=t(v,m):p[y]=t(v,m))}}catch(b){s={error:b}}finally{try{f&&!f.done&&(l=h.return)&&l.call(h)}finally{if(s)throw s.error}}return p}}(t,"")}}(n)(e);i.nodes.forEach(function(e){var n=e["-id"],o=e["-type"],i=e.text,a=e.children,s=xx(e,["-id","-type","text","children"]),l={"-id":n};(null==i?void 0:i["-value"])&&(l["-name"]=i["-value"]),s["-json"]&&(l["-json"]=s["-json"]),s["-properties"]&&Object.assign(l,s["-properties"]),a&&(l.children=a),t[o]||(t[o]=[]),t[o].push(l),r.set(n,l)});var a=i.edges.map(function(t){var e=t["-id"],n=t["-sourceNodeId"],o=t["-targetNodeId"],i=t.text,a=xx(t,["-id","-sourceNodeId","-targetNodeId","text"]),s=r.get(o);s["bpmn:incoming"]||(s["bpmn:incoming"]=[]),s["bpmn:incoming"].push(e);var l={"-id":e,"-sourceRef":n,"-targetRef":o};return(null==i?void 0:i["-value"])&&(l["-name"]=i["-value"]),a["-json"]&&(l["-json"]=a["-json"]),a["-properties"]&&Object.assign(l,a["-properties"]),l});return e.edges.forEach(function(t){var e=t.sourceNodeId,n=t.id,o=r.get(e);o["bpmn:outgoing"]||(o["bpmn:outgoing"]=[]),o["bpmn:outgoing"].push(n)}),null===(o=t["bpmn:subProcess"])||void 0===o||o.forEach(function(e){var n={"bpmn:incoming":new Set,"bpmn:outgoing":new Set},o=[];e.children.forEach(function(o){var i,a=r.get(o["-id"]);["bpmn:incoming","bpmn:outgoing"].forEach(function(t){a[t]&&a[t].forEach(function(e){n[t].add(e)})});var s=null===(i=t[o["-type"]])||void 0===i?void 0:i.findIndex(function(t){return t["-id"]===o["-id"]});s>=0&&t[o["-type"]].splice(s,1),r.delete(o["-id"]),e[o["-type"]]||(e[o["-type"]]=[]),e[o["-type"]].push(a)});var i=n["bpmn:incoming"];n["bpmn:outgoing"].forEach(function(t){i.has(t)&&o.push(t)});for(var s,l=function(t){var n=a.findIndex(function(e){return e["-id"]===o[t]});n>=0?(e["bpmn:sequenceFlow"]||(e["bpmn:sequenceFlow"]=[]),e["bpmn:sequenceFlow"].push(a[n]),a.splice(n,1)):t++,s=t},u=0;u<o.length;)l(u),u=s;delete e.children}),t[mx.FLOW]=a,t}var kx=["bpmn:incoming","bpmn:outgoing"];function Rx(t,e){var n=[],o=[],r=new Map,i=null!=e?e:{},a=i.transformer,s=i.excludeFields,l={in:new Set(Sx(Sx([],wx(Tx),!1),wx((null==s?void 0:s.in)||[]),!1)),out:new Set(Sx(Sx([],wx(Mx),!1),wx((null==s?void 0:s.out)||[]),!1))};Ax=Nx(Ax,a);var u,c,d=t["bpmn:definitions"];if(d){var p=d["bpmn:process"];u=p,c=[function(t){function e(t){t["-children"]||(t["-children"]=[]),Object.keys(t).forEach(function(e){var n;0!==e.indexOf("bpmn:")||kx.includes(e)||(p[e]||(p[e]=[]),!Array.isArray(p[e])&&(p[e]=[p[e]]),Array.isArray(t[e])?(n=p[e]).push.apply(n,Sx([],wx(t[e]),!1)):p[e].push(t[e]),Array.isArray(t[e])?t[e].forEach(function(n){!e.includes("Flow")&&t["-children"].push(n["-id"])}):!e.includes("Flow")&&t["-children"].push(t[e]["-id"]),delete t[e])})}if("bpmn:subProcess"===t){var n=p[t];Array.isArray(n)?n.forEach(function(n){"bpmn:subProcess"===t&&e(n)}):e(n)}},function(t){function e(t){var n;r.set(t["-id"],t),Array.isArray(t)?t.forEach(function(t){e(t)}):"object"==typeof t&&(n=t,Object.keys(n).forEach(function(t){var o,r;if(t.includes("bpmn:")){var i={};Ax[t]&&Ax[t].in?(i=null===(r=(o=Ax[t]).in)||void 0===r?void 0:r.call(o,t,He.cloneDeep(n[t])),delete n[t]):e(n[t]);var a=void 0;(a=Reflect.ownKeys(i)).length>0&&a.forEach(function(t){Reflect.set(n,t,i[t])})}}))}e(p[t])},function(t){if(0===t.indexOf("bpmn:")){var e=p[t];if("bpmn:sequenceFlow"===t){var i=d["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];o=function(t,e){var n=[];if(Array.isArray(t))t.forEach(function(t){var o;o=Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n.push(Ix(o,t))});else{var o=void 0;o=Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n.push(Ix(o,t))}return n}(e,i)}else{var a=d["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];if("bpmn:boundaryEvent"===t){var s=p[t],l=function(t){var e=t["-attachedToRef"],n=r.get(e);n["-boundaryEvents"]||(n["-boundaryEvents"]=[]),n["-boundaryEvents"].push(t["-id"])};Array.isArray(s)?s.forEach(function(t){l(t)}):l(s)}n=n.concat(function(t,e,n){var o=[];if(Array.isArray(t))t.forEach(function(t){var r=Lx(Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n,t);o.push(r)});else{var r=Lx(Array.isArray(e)?e.find(function(e){return e["-bpmnElement"]===t["-id"]}):e,n,t);o.push(r)}return o}(e,a,t))}}}],c.forEach(function(t){try{Object.keys(u).forEach(function(e){try{t(e)}catch(n){console.error(n)}})}catch(e){console.error(e)}})}var h=function(t,e,n){Object.keys(t).forEach(function(o){var r=n?"".concat(n,".").concat(o):o;e.has(r)?delete t[o]:"object"==typeof t[o]&&h(t[o],e,r)})};return n.forEach(function(t){var n,o;if(null===(n=null==e?void 0:e.mapping)||void 0===n?void 0:n.in){var r=null===(o=null==e?void 0:e.mapping)||void 0===o?void 0:o.in,i=t.type;r[i]&&(t.type=r[i])}h(t,l.in,"")}),o.forEach(function(t){var n,o;if(null===(n=null==e?void 0:e.mapping)||void 0===n?void 0:n.in){var r=null===(o=null==e?void 0:e.mapping)||void 0===o?void 0:o.in,i=t.type;r[i]&&(t.type=r[i])}h(t,l.in,"")}),{nodes:n,edges:o}}function Lx(t,e,n){var o=Number(t["dc:Bounds"]["-x"]),r=Number(t["dc:Bounds"]["-y"]),i=n["-children"],a=n["-name"],s=jx.shapeConfigMap.get(e);s&&(o+=s.width/2,r+=s.height/2);var l,u={};if(Object.entries(n).forEach(function(t){var e=wx(t,2),n=e[0],o=e[1];Ox.includes(n)||(u[n]=o)}),u=Px(u),a&&(l={x:o,y:r,value:a},t["bpmndi:BPMNLabel"]&&t["bpmndi:BPMNLabel"]["dc:Bounds"])){var c=t["bpmndi:BPMNLabel"]["dc:Bounds"];l.x=Number(c["-x"])+Number(c["-width"])/2,l.y=Number(c["-y"])+Number(c["-height"])/2}var d={id:t["-bpmnElement"],type:e,x:o,y:r,properties:u};return i&&(d.children=i),l&&(d.text=l),d}function Ix(t,e){var n,o=e["-name"]?"".concat(e["-name"]):"";if(o){var r=t["bpmndi:BPMNLabel"]["dc:Bounds"],i=0;o.split("\n").forEach(function(t){i<t.length&&(i=t.length)}),n={value:o,x:Number(r["-x"])+10*i/2,y:Number(r["-y"])+7}}var a={};Object.entries(e).forEach(function(t){var e=wx(t,2),n=e[0],o=e[1];Ox.includes(n)||(a[n]=o)}),a=Px(a);var s=t["di:waypoint"].map(function(t){return{x:Number(t["-x"]),y:Number(t["-y"])}}),l={id:e["-id"],type:mx.FLOW,pointsList:s,sourceNodeId:e["-sourceRef"],targetNodeId:e["-targetRef"],properties:a};return n&&(l.text=n),l}var jx=function(){function t(t){var e=t.lf,n=this;this.adapterOut=function(t,e){var o,r,i=_x({},n.processAttributes);Dx(i,t,e);var a={"-id":"BPMNPlane_1","-bpmnElement":i["-id"]};!function(t,e){t["bpmndi:BPMNEdge"]=e.edges.map(function(t){var e,n=t.id,o=t.pointsList.map(function(t){return{"-x":t.x,"-y":t.y}}),r={"-id":"".concat(n,"_di"),"-bpmnElement":n,"di:waypoint":o};return(null===(e=t.text)||void 0===e?void 0:e.value)&&(r["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":t.text.x-10*t.text.value.length/2,"-y":t.text.y-7,"-width":10*t.text.value.length,"-height":14}}),r}),t["bpmndi:BPMNShape"]=e.nodes.map(function(t){var e,n=t.id,o=100,r=80,i=t.x,a=t.y,s=jx.shapeConfigMap.get(t.type);s&&(o=s.width,r=s.height),i-=o/2,a-=r/2;var l={"-id":"".concat(n,"_di"),"-bpmnElement":n,"dc:Bounds":{"-x":i,"-y":a,"-width":o,"-height":r}};return(null===(e=t.text)||void 0===e?void 0:e.value)&&(l["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":t.text.x-10*t.text.value.length/2,"-y":t.text.y-7,"-width":10*t.text.value.length,"-height":14}}),l})}(a,t);var s=n.definitionAttributes;s["bpmn:process"]=i,s["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":a};var l={"bpmn:definitions":s};if(null===(o=null==e?void 0:e.mapping)||void 0===o?void 0:o.out){var u=null===(r=null==e?void 0:e.mapping)||void 0===r?void 0:r.out,c=function(t){Array.isArray(t)&&t.forEach(function(t){return c(t)}),"object"==typeof t&&Object.keys(t).forEach(function(e){var n;(n=u[e])?(t[n]=He.cloneDeep(t[e]),delete t[e],c(t[n])):c(t[e])})};c(l)}return l},this.adapterIn=function(t,e){if(t)return Rx(t,e)},e.adapterIn=this.adapterIn,e.adapterOut=this.adapterOut,this.processAttributes={"-isExecutable":"true","-id":"Process"},this.definitionAttributes={"-id":"Definitions","-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.10"}}return t.prototype.setCustomShape=function(e,n){t.shapeConfigMap.set(e,n)},t.pluginName="bpmn-adapter",t.shapeConfigMap=new Map,t}();jx.shapeConfigMap.set(mx.START,{width:V_,height:K_}),jx.shapeConfigMap.set(mx.END,{width:q_,height:Z_}),jx.shapeConfigMap.set(mx.INTERMEDIATE_CATCH,{width:Q_,height:tx}),jx.shapeConfigMap.set(mx.INTERMEDIATE_THROW,{width:Q_,height:tx}),jx.shapeConfigMap.set(mx.BOUNDARY,{width:$_,height:J_}),jx.shapeConfigMap.set(mx.PARALLEL_GATEWAY,{width:ex,height:nx}),jx.shapeConfigMap.set(mx.INCLUSIVE_GATEWAY,{width:ox,height:rx}),jx.shapeConfigMap.set(mx.EXCLUSIVE_GATEWAY,{width:ix,height:ax}),jx.shapeConfigMap.set(mx.SYSTEM,{width:sx,height:lx}),jx.shapeConfigMap.set(mx.USER,{width:ux,height:cx}),jx.shapeConfigMap.set(mx.SUBPROCESS,{width:dx,height:px}),function(t){function e(e){var n=t.call(this,e)||this;n.adapterXmlIn=function(t){var e,o=(e=t,(new hx.ObjTree).parseXML(e));return n.adapterIn(o,n.props)},n.adapterXmlOut=function(t){return function(t){var e="";for(var n in t)e+=vx(t[n],n,0);return e}(n.adapterOut(t,n.props))};var o=e.lf,r=e.props;return o.adapterIn=n.adapterXmlIn,o.adapterOut=n.adapterXmlOut,n.props=r,n}bx(e,t),e.pluginName="BPMNAdapter"}(jx);var Bx=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Hx=function(){return Hx=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Hx.apply(this,arguments)};!function(t){function e(){var e=t.apply(this,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(arguments),!1))||this;return e.childrenPositionMap=new Map,e.onNodeRotate=function(t){var n=t.model,o=e.props,r=o.model,i=o.graphModel,a=r.transformWithContainer,s=r.isRestrict,l=e.childrenPositionMap;if(a&&!s&&n.id===r.id){var u={x:r.x,y:r.y};$o(Array.from(r.children),function(t){var e=i.getNodeModelById(t);if(e){var o={x:e.x,y:e.y};l.has(e.id)?o=l.get(e.id):l.set(e.id,o);var r=n.rotate*(180/Math.PI);r<0&&(r+=360);var a=r*(Math.PI/180),s=function(t,e,n){var o=e.x,r=e.y,i=t.x-o,a=t.y-r;return{x:i*Math.cos(n)-a*Math.sin(n)+o,y:i*Math.sin(n)+a*Math.cos(n)+r}}(o,u,a);e.moveTo(s.x,s.y),e.rotate=n.rotate}})}},e.onNodeResize=function(t){var n=t.deltaX,o=t.deltaY,r=t.index,i=t.model,a=t.preData,s=e.props,l=s.model,u=s.graphModel,c=l.transformWithContainer,d=l.isRestrict;if(c&&!d&&i.id===l.id){var p=a.properties||{},h=p.width,f=p.height;$o(Array.from(l.children),function(t){var e=u.getNodeModelById(t);if(e){var i=e.width/h*n,a=e.height/f*o;Dg({deltaX:i,deltaY:a,index:r,nodeModel:e,graphModel:u,cancelCallback:function(){}})}})}},e.onNodeMouseMove=function(){},e.graphRendered=function(){var t=e.props.model;t.isCollapsed&&t.toggleCollapse(!0)},e}Bx(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.props.graphModel.eventCenter;e.on("node:rotate",this.onNodeRotate),e.on("node:resize",this.onNodeResize),e.on("node:mousemove",this.onNodeMouseMove),e.on("graph:rendered",this.graphRendered)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this);var e=this.props.graphModel.eventCenter;e.off("node:rotate",this.onNodeRotate),e.off("node:resize",this.onNodeResize),e.off("node:mousemove",this.onNodeMouseMove),e.off("graph:rendered",this.graphRendered)},e.prototype.getNodesInGroup=function(t,e){var n=this,o=[];return t.isGroup&&$o(Array.from(t.children),function(t){o.push(t);var r=e.getNodeModelById(t);(null==r?void 0:r.isGroup)&&(o=o.concat(n.getNodesInGroup(r,e)))}),o},e.prototype.getResizeControl=function(){var e=this.props.model,n=e.resizable,o=e.isCollapsed;return n&&!o?t.prototype.getResizeControl.call(this):null},e.prototype.getAppendAreaShape=function(){var t=this.props.model,e=t.width,n=t.height,o=t.x,r=t.y,i=t.radius;if(!t.groupAddable)return null;var a=t.getNodeStyle().strokeWidth,s=void 0===a?0:a,l=t.getAddableOutlineStyle(),u=e+s+8,c=n+s+8;return zl("rect",Hx(Hx({},l),{width:u,height:c,x:o-u/2,y:r-c/2,rx:i,ry:i}))},e.prototype.getCollapseIcon=function(t,e){return"M ".concat(t+3,",").concat(e+6," ").concat(t+11,",").concat(e+6," M").concat(t+7,",").concat(e+2," ").concat(t+7,",").concat(e+10)},e.prototype.getExpandIcon=function(t,e){return"M ".concat(t+3,",").concat(e+6," ").concat(t+11,",").concat(e+6," ")},e.prototype.getOperateIcon=function(){var t=this.props.model,e=t.x,n=t.y,o=e-t.width/2+10,r=n-t.height/2+10;if(!t.collapsible)return null;var i=zl("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:(null==t?void 0:t.isCollapsed)?this.getCollapseIcon(o,r):this.getExpandIcon(o,r)});return zl("g",{},[zl("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#f4f5f6",stroke:"#cecece",cursor:"pointer",x:o,y:r,onClick:function(){t.toggleCollapse(!t.isCollapsed)}}),i])},e.prototype.getShape=function(){return zl("g",{},[this.getAppendAreaShape(),t.prototype.getShape.call(this),this.getOperateIcon()])}}(rm);var zx=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Fx=function(){return Fx=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Fx.apply(this,arguments)},Wx=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Xx=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},Ux=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};!function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.isGroup=!0,o.isRestrict=!1,o.autoResize=!1,o.collapsible=!0,o.isCollapsed=!1,o.groupAddable=!1,o.transformWithContainer=!1,o.childrenLastCollapseStateDict=new Map,o.childrenLastCollapseStateDict=new Map,o.initNodeData(e),o.setAttributes(),o}zx(e,t),e.prototype.initNodeData=function(e){var n;t.prototype.initNodeData.call(this,e);var o=null!==(n=e.properties)&&void 0!==n?n:{},r=o.children,i=o.width,a=o.height,s=o.collapsedWidth,l=o.collapsedHeight,u=o.collapsible,c=o.isCollapsed,d=o.zIndex,p=o.isRestrict,h=o.autoResize,f=o.autoToFront,g=o.transformWithContainer;this.children=r?new Set(r):new Set,this.zIndex=null!=d?d:-1e4,this.isCollapsed=null!=c&&c,this.setProperties({isCollapsed:null!=c&&c});var y=null!=i?i:400,v=null!=a?a:230;this.width=y,this.height=v,this.expandWidth=y,this.expandHeight=v,this.collapsedWidth=null!=s?s:80,this.collapsedHeight=null!=l?l:60,this.isRestrict=null!=p&&p,this.transformWithContainer=null!=g&&g,this.autoResize=null!=h&&h,this.collapsible=null==u||u,this.autoToFront=null!=f&&f,this.text.editable=!1,this.text.draggable=!1},e.prototype.setAttributes=function(){t.prototype.setAttributes.call(this)},e.prototype.getData=function(){var e=this,n=t.prototype.getData.call(this),o=[];return $o(Array.from(this.children),function(t){var n=e.graphModel.getNodeModelById(t);n&&!n.virtual&&o.push(t)}),n.children=o,n.properties&&(n.properties.children=o,n.properties.isCollapsed=this.isCollapsed),n},e.prototype.getNodesInGroup=function(t){var e=[];return t.isGroup&&$o(Array.from(t.children),function(t){e.push(t)}),e},e.prototype.getMoveDistance=function(e,n,o){void 0===o&&(o=!1);var r=Xx(t.prototype.getMoveDistance.call(this,e,n,o),2),i=r[0],a=r[1],s=this.getNodesInGroup(this);return this.graphModel.moveNodes(s,e,n,o),[i,a]},e.prototype.getHistoryData=function(){var e=t.prototype.getHistoryData.call(this);e.children=Array.from(this.children),e.isGroup=!0;var n=this,o=n.x,r=n.y,i=n.collapsedWidth,a=n.collapsedHeight,s=n.expandWidth,l=n.expandHeight;return n.isCollapsed&&(e.x=o+s/2-i/2,e.y=r+l/2-a/2,e.text&&(e.text.x=e.text.x+s/2-i/2,e.text.y=e.text.y+l/2-a/2)),e},e.prototype.toggleCollapse=function(t){var e=this,n=this.graphModel,o=!!t;this.isCollapsed=o,this.setProperties({isCollapsed:o}),n.eventCenter.emit("dynamicGroup:collapse",{collapse:o,nodeModel:this}),o?this.collapse():this.expand();var r=Ux(Ux([],Xx(this.incoming.edges),!1),Xx(this.outgoing.edges),!1);$o(Array.from(this.children),function(n){var o,i,a=e.graphModel.elementsModelMap.get(n);if(a){var s=a.isCollapsed;if(a.isGroup){var l=a;if(l.isCollapsed||l.toggleCollapse(t),!t){var u=null===(o=e.childrenLastCollapseStateDict)||void 0===o?void 0:o.get(n);void 0!==u&&u!==a.isCollapsed&&l.toggleCollapse(u)}}if(null===(i=e.childrenLastCollapseStateDict)||void 0===i||i.set(n,!!s),a.visible=!t,a.BaseType===_h.NODE){var c=a.incoming.edges,d=a.outgoing.edges;r=Ux(Ux(Ux([],Xx(r),!1),Xx(c),!1),Xx(d),!1)}}}),this.collapseEdge(o,r)},e.prototype.collapse=function(){var t=this,e=t.x,n=t.y,o=t.text,r=t.width,i=t.height,a=t.collapsedWidth,s=t.collapsedHeight;this.x=e-r/2+a/2,this.y=n-i/2+s/2,this.text.x=o.x-r/2+a/2,this.text.y=o.y-i/2+s/2,this.expandWidth=r,this.expandHeight=i,this.width=a,this.height=s},e.prototype.expand=function(){var t=this,e=t.x,n=t.y,o=t.text,r=t.expandWidth,i=t.expandHeight,a=t.collapsedWidth,s=t.collapsedHeight;this.width=r,this.height=i,this.x=e+this.width/2-a/2,this.y=n+this.height/2-s/2,this.text.x=o.x+this.width/2-a/2,this.text.y=o.y+this.height/2-s/2},e.prototype.createVirtualEdge=function(t){t.pointsList=void 0;var e=this.graphModel.addEdge(t);e.virtual=!0,e.text.editable=!1,e.isCollapsedEdge=!0},e.prototype.collapseEdge=function(t,e){var n=this,o=this.graphModel;$o(e,function(e,r){var i,a=e.getData(),s=a.targetNodeId,l=a.sourceNodeId,u=Fx(Fx({},a),{id:"".concat(a.id,"__").concat(r),text:null===(i=a.text)||void 0===i?void 0:i.value});e.virtual&&o.deleteEdgeById(e.id);var c=o.dynamicGroup.getGroupByNodeId(s);c||(c=o.getNodeModelById(s));var d=o.dynamicGroup.getGroupByNodeId(l);d||(d=o.getNodeModelById(l)),t&&e.visible&&(n.children.has(l)||n.id===l?(u.startPoint=void 0,u.sourceNodeId=n.id):(u.endPoint=void 0,u.targetNodeId=n.id),c.id===n.id&&d.id===n.id||n.createVirtualEdge(u),e.visible=!1),t||e.visible||(c&&c.isGroup&&c.isCollapsed?(u.targetNodeId=c.id,u.endPoint=void 0,n.createVirtualEdge(u)):d&&d.isGroup&&d.isCollapsed?(u.sourceNodeId=d.id,u.startPoint=void 0,n.createVirtualEdge(u)):e.visible=!0)})},e.prototype.isAllowAppendIn=function(t){return!0},e.prototype.setAllowAppendChild=function(t){this.groupAddable=t},e.prototype.addChild=function(t){this.children.add(t);var e=this.getData();this.graphModel.eventCenter.emit("group:add-node",{data:e,childId:t})},e.prototype.removeChild=function(t){this.children.delete(t);var e=this.getData();this.graphModel.eventCenter.emit("group:remove-node",{data:e})},e.prototype.toBack=function(){this.zIndex--},e.prototype.getResizeOutlineStyle=function(){var e=t.prototype.getResizeOutlineStyle.call(this);return e.stroke="none",e},e.prototype.getAnchorStyle=function(){var e=t.prototype.getAnchorStyle.call(this);return e.stroke="transparent",e.fill="transparent",e.hover&&(e.hover.fill="transparent",e.hover.stroke="transparent"),e},e.prototype.getAddableOutlineStyle=function(){return{stroke:"#feb663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},Wx([Qu],e.prototype,"isCollapsed",void 0),Wx([Qu],e.prototype,"groupAddable",void 0),Wx([Qu],e.prototype,"transformWithContainer",void 0)}(Iy);var Gx;!function(t){t.HORIZONTAL="horizontal",t.VERTICAL="vertical"}(Gx||(Gx={}));var Yx,Vx=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kx=function(){return Kx=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Kx.apply(this,arguments)},qx=function(t){function e(e){var n=t.call(this,e)||this;n.textRef={current:null},n.setHoverOn=function(){var t=n.props.element;t.isDragging||n.state.isHovered||(n.setState({isHovered:!0}),t.setHovered(!0))},n.setHoverOff=function(){var t=n.props.element;n.state.isHovered&&(n.setState({isHovered:!1}),t.setHovered(!1))},n.handleMouseDown=function(t){var e,o=n.props,r=o.label,i=o.graphModel.editConfigModel.nodeTextDraggable;!(null!==(e=r.draggable)&&void 0!==e?e:i)||n.state.isDragging||n.state.isEditing||n.stepDrag.handleMouseDown(t)},n.handleMouseUp=function(t){n.state.isDragging&&n.stepDrag.handleMouseUp(t)},n.handleDragging=function(t){var e=t.deltaX,o=t.deltaY;n.state.isDragging||n.setState({isDragging:!0});var r=n.props,i=r.label,a=r.graphModel,s=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(a.transformModel.fixDeltaXY(e,o),2),l=s[0],u=s[1];n.setElementModelLabelInfo({x:i.x+l,y:i.y+u}),a.eventCenter.emit("label:drag",{data:i.getData(),model:i})},n.handleDragEnd=function(){n.setState({isDragging:!1})},n.handleClick=function(t){var e=n.props,o=e.label,r=e.element,i=e.graphModel;r.setSelected(!n.state.isSelected),n.setState({isSelected:!n.state.isSelected}),n.setElementModelLabelInfo({isSelected:!0}),i.eventCenter.emit("label:click",{data:o.getData(),e:t,model:r})},n.handleDbClick=function(t){var e=n.props,o=e.label,r=e.element;if(e.graphModel.eventCenter.emit("label:dblclick",{data:o.getData(),e:t,model:r}),o.editable){if(r.setSelected(),r.setElementState(mh.TEXT_EDIT),n.setState({isEditing:!0}),n.textRef.current){n.textRef.current.contentEditable="true",n.textRef.current.focus();var i=document.createRange(),a=window.getSelection();i.selectNodeContents(n.textRef.current),i.collapse(!1),null==a||a.removeAllRanges(),null==a||a.addRange(i)}}else r.setSelected(!0)},n.handleBlur=function(t){var e=n.props,o=e.label,r=e.element;e.graphModel.eventCenter.emit("label:blur",{e:t,model:r,data:o.getData(),element:n.textRef.current}),n.setState({isDragging:!1,isHovered:!1,isSelected:!1})},n.handleInput=function(t){var e=n.props,o=e.label;e.graphModel.eventCenter.emit("label:input",{e:t,data:o.getData()})},n.reCalcLabelSize=function(){};var o=e.label,r=e.graphModel,i=r.gridSize,a=r.eventCenter;return n.stepDrag=new kh({onDragging:n.handleDragging,onDragEnd:n.handleDragEnd,step:i,eventType:"LABEL",model:o,eventCenter:a}),n.state={isEditing:!1,isHovered:!1,isDragging:!1,isSelected:!1},n}return Vx(e,t),e.prototype.setElementModelLabelInfo=function(t){var e=this.props,n=e.label,o=e.element,r=e.graphModel,i=o.properties._label,a=vr(i,function(t){return t.id===n.id}),s=i[a];i[a]=Kx(Kx({},s),t);var l=r.getElement(o.id);null==l||l.setProperty("_label",i)},e.prototype.componentDidMount=function(){var t=this,e=this.props,n=e.label,o=e.element;e.graphModel.eventCenter.on("blank:click,node:click,edge:click,label:click",function(e){var r,i,a,s,l=e.data;if(("label"!==(null==l?void 0:l.type)||"label"===l.type&&l.id!==n.id||t.state.isSelected)&&t.setState({isSelected:!1}),("label"!==(null==l?void 0:l.type)||"label"==l.type&&l.id!==n.id)&&t.state.isEditing){t.setState({isEditing:!1});var u=null!==(i=null===(r=t.textRef.current)||void 0===r?void 0:r.innerText)&&void 0!==i?i:"",c=null!==(s=null===(a=t.textRef.current)||void 0===a?void 0:a.innerHTML)&&void 0!==s?s:"";t.setElementModelLabelInfo({value:u,content:c,isSelected:!1}),o.setElementState(mh.DEFAULT)}("label"!==(null==l?void 0:l.type)||"label"==l.type&&l.id!==n.id)&&t.textRef.current&&(t.textRef.current.contentEditable="false")})},e.prototype.componentDidUpdate=function(){},e.prototype.componentWillUnmount=function(){this.props.graphModel.eventCenter.off("blank:click,node:click,edge:click")},e.prototype.render=function(){var t,e=this.props,n=e.label,o=e.element,r=e.graphModel,i=this.state,a=i.isDragging,s=i.isHovered,l=i.isSelected,u=i.isEditing,c=r.transformModel.getTransformStyle().transform,d=n.id,p=n.x,h=n.y,f=n.zIndex,g=n.vertical,y=n.style,v=n.rotate,m=n.content,b=n.labelWidth,_=n.textOverflowMode,x=null!=b?b:"node"===o.BaseType?o.width-20:80,E={left:"".concat(p-x/2,"px"),top:"".concat(h-10,"px"),width:"".concat(x,"px"),height:"20px",zIndex:null!=f?f:1,transform:v?"".concat(c," rotate(").concat(v,"deg)"):"".concat(c," rotate(").concat(g?-.25:0,"turn)")};return ph("div",{id:"element-container-".concat(d),className:Wv("lf-label-editor-container"),style:E,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onDblClick:this.handleDbClick,onBlur:this.handleBlur,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,children:ph("div",{ref:this.textRef,id:"editor-container-".concat(d),className:Wv("lf-label-editor",(t={"lf-label-editor-dragging":a,"lf-label-editor-editing":u,"lf-label-editor-hover":!u&&(s||l)},t["lf-label-editor-".concat(_)]=!u,t)),onInput:this.handleInput,style:Kx({maxWidth:"".concat(x,"px"),boxSizing:"border-box",display:"inline-block",background:u||"edge"===o.BaseType?"#fff":"transparent"},y),dangerouslySetInnerHTML:{__html:m}})})},e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e),e}(Xl),Zx=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},$x=rg,Jx=function(){function t(t,e,n){var o;this.type="label",this.content="",this.value="",this.style={},this.vertical=!1,this.editable=!0,this.draggable=!0,this.textOverflowMode="default",this.element=e,this.graphModel=n,this.id=null!==(o=t.id)&&void 0!==o?o:$x(),this.initLabelData(t)}return t.prototype.initLabelData=function(t){sn(this,t)},t.prototype.getData=function(){return{id:this.id,x:this.x,y:this.y,type:"label",content:this.content,value:this.value,rotate:this.rotate,style:xd(this.style),draggable:this.draggable,editable:this.editable,labelWidth:this.labelWidth,textOverflowMode:this.textOverflowMode,vertical:this.vertical}},Zx([Qu],t.prototype,"x",void 0),Zx([Qu],t.prototype,"y",void 0),Zx([Qu],t.prototype,"content",void 0),Zx([Qu],t.prototype,"value",void 0),Zx([Qu],t.prototype,"rotate",void 0),Zx([Qu],t.prototype,"style",void 0),Zx([Qu],t.prototype,"zIndex",void 0),Zx([Qu],t.prototype,"vertical",void 0),Zx([Qu],t.prototype,"editable",void 0),Zx([Qu],t.prototype,"draggable",void 0),Zx([Qu],t.prototype,"labelWidth",void 0),Zx([Qu],t.prototype,"textOverflowMode",void 0),t}(),Qx={exports:{}},tE=Qx.exports;var eE=(Yx||(Yx=1,function(t){var e,n;"classList"in document.createElement("_")||function(t){if("Element"in t){var e="classList",n="prototype",o=t.Element[n],r=Object,i=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[n].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},s=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},l=function(t,e){if(""===e)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(t,e)},u=function(t){for(var e=i.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],o=0,r=n.length;o<r;o++)this.push(n[o]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},c=u[n]=[],d=function(){return new u(this)};if(s[n]=Error[n],c.item=function(t){return this[t]||null},c.contains=function(t){return-1!==l(this,t+="")},c.add=function(){var t,e=arguments,n=0,o=e.length,r=!1;do{-1===l(this,t=e[n]+"")&&(this.push(t),r=!0)}while(++n<o);r&&this._updateClassName()},c.remove=function(){var t,e,n=arguments,o=0,r=n.length,i=!1;do{for(e=l(this,t=n[o]+"");-1!==e;)this.splice(e,1),i=!0,e=l(this,t)}while(++o<r);i&&this._updateClassName()},c.toggle=function(t,e){t+="";var n=this.contains(t),o=n?!0!==e&&"remove":!1!==e&&"add";return o&&this[o](t),!0===e||!1===e?e:!n},c.toString=function(){return this.join(" ")},r.defineProperty){var p={get:d,enumerable:!0,configurable:!0};try{r.defineProperty(o,e,p)}catch(h){-2146823252===h.number&&(p.enumerable=!1,r.defineProperty(o,e,p))}}else r[n].__defineGetter__&&o.__defineGetter__(e,d)}}(self),function(t){if(t.URL=t.URL||t.webkitURL,t.Blob&&t.URL)try{return void new Blob}catch(o){}var e=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||function(t){var e=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},o=function(t,e,n){this.data=t,this.size=t.length,this.type=e,this.encoding=n},r=n.prototype,i=o.prototype,a=t.FileReaderSync,s=function(t){this.code=this[this.name=t]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),u=l.length,c=t.URL||t.webkitURL||t,d=c.createObjectURL,p=c.revokeObjectURL,h=c,f=t.btoa,g=t.atob,y=t.ArrayBuffer,v=t.Uint8Array,m=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(o.fake=i.fake=!0;u--;)s.prototype[l[u]]=u+1;return c.createObjectURL||(h=t.URL=function(t){var e,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=t,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(e=t.match(m),n.origin=e&&e[1])),n}),h.createObjectURL=function(t){var e,n=t.type;return null===n&&(n="application/octet-stream"),t instanceof o?(e="data:"+n,"base64"===t.encoding?e+";base64,"+t.data:"URI"===t.encoding?e+","+decodeURIComponent(t.data):f?e+";base64,"+f(t.data):e+","+encodeURIComponent(t.data)):d?d.call(c,t):void 0},h.revokeObjectURL=function(t){"data:"!==t.substring(0,5)&&p&&p.call(c,t)},r.append=function(t){var n=this.data;if(v&&(t instanceof y||t instanceof v)){for(var r="",i=new v(t),l=0,u=i.length;l<u;l++)r+=String.fromCharCode(i[l]);n.push(r)}else if("Blob"===e(t)||"File"===e(t)){if(!a)throw new s("NOT_READABLE_ERR");var c=new a;n.push(c.readAsBinaryString(t))}else t instanceof o?"base64"===t.encoding&&g?n.push(g(t.data)):"URI"===t.encoding?n.push(decodeURIComponent(t.data)):"raw"===t.encoding&&n.push(t.data):("string"!=typeof t&&(t+=""),n.push(unescape(encodeURIComponent(t))))},r.getBlob=function(t){return arguments.length||(t=null),new o(this.data.join(""),t,"raw")},r.toString=function(){return"[object BlobBuilder]"},i.slice=function(t,e,n){var r=arguments.length;return r<3&&(n=null),new o(this.data.slice(t,r>1?e:this.data.length),n,this.encoding)},i.toString=function(){return"[object Blob]"},i.close=function(){this.size=0,delete this.data},n}(t);t.Blob=function(t,n){var o=n&&n.type||"",r=new e;if(t)for(var i=0,a=t.length;i<a;i++)Uint8Array&&t[i]instanceof Uint8Array?r.append(t[i].buffer):r.append(t[i]);var s=r.getBlob(o);return!s.slice&&s.webkitSlice&&(s.slice=s.webkitSlice),s};var n=Object.getPrototypeOf||function(t){return t.__proto__};t.Blob.prototype=n(new t.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||tE.content||tE),e=tE,n=function(){function t(t,e){return this.init(t,e)}var e,n,o,r,i,a,s,l,u,c,d;return t.extensions={},function(e){function n(t,e){var n,o=Array.prototype.slice.call(arguments,2);e=e||{};for(var r=0;r<o.length;r++){var i=o[r];if(i)for(n in i)i.hasOwnProperty(n)&&void 0!==i[n]&&(t||!1===e.hasOwnProperty(n))&&(e[n]=i[n])}return e}var o=!1;try{var r=document.createElement("div"),i=document.createTextNode(" ");r.appendChild(i),o=r.contains(i)}catch(s){}var a={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,isMac:e.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77,V:86},isMetaCtrlKey:function(t){return!!(a.isMac&&t.metaKey||!a.isMac&&t.ctrlKey)},isKey:function(t,e){var n=a.getKeyCode(t);return!1===Array.isArray(e)?n===e:-1!==e.indexOf(n)},getKeyCode:function(t){var e=t.which;return null===e&&(e=null!==t.charCode?t.charCode:t.keyCode),e},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function(){var t=[!0].concat(Array.prototype.slice.call(arguments));return n.apply(this,t)},defaults:function(){var t=[!1].concat(Array.prototype.slice.call(arguments));return n.apply(this,t)},createLink:function(t,e,n,o){var r=t.createElement("a");return a.moveTextRangeIntoElement(e[0],e[e.length-1],r),r.setAttribute("href",n),o&&("_blank"===o&&r.setAttribute("rel","noopener noreferrer"),r.setAttribute("target",o)),r},findOrCreateMatchingTextNodes:function(t,e,n){for(var o=t.createTreeWalker(e,NodeFilter.SHOW_ALL,null,!1),r=[],i=0,s=!1,l=null,u=null;null!==(l=o.nextNode());)if(!(l.nodeType>3))if(3===l.nodeType){if(!s&&n.start<i+l.nodeValue.length&&(s=!0,u=a.splitStartNodeIfNeeded(l,n.start,i)),s&&a.splitEndNodeIfNeeded(l,u,n.end,i),s&&i===n.end)break;if(s&&i>n.end+1)throw new Error("PerformLinking overshot the target!");s&&r.push(u||l),i+=l.nodeValue.length,null!==u&&(i+=u.nodeValue.length,o.nextNode()),u=null}else"img"===l.tagName.toLowerCase()&&(!s&&n.start<=i&&(s=!0),s&&r.push(l));return r},splitStartNodeIfNeeded:function(t,e,n){return e!==n?t.splitText(e-n):null},splitEndNodeIfNeeded:function(t,e,n,o){var r,i;r=o+t.nodeValue.length+(e?e.nodeValue.length:0)-1,i=n-o-(e?t.nodeValue.length:0),r>=n&&o!==r&&0!==i&&(e||t).splitText(i)},splitByBlockElements:function(e){if(3!==e.nodeType&&1!==e.nodeType)return[];var n=[],o=t.util.blockContainerElementNames.join(",");if(3===e.nodeType||0===e.querySelectorAll(o).length)return[e];for(var r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];3===i.nodeType?n.push(i):1===i.nodeType&&(0===i.querySelectorAll(o).length?n.push(i):n=n.concat(t.util.splitByBlockElements(i)))}return n},findAdjacentTextNodeWithContent:function(t,e,n){var o,r=!1,i=n.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);for(o=i.nextNode();o;){if(o===e)r=!0;else if(r&&3===o.nodeType&&o.nodeValue&&o.nodeValue.trim().length>0)break;o=i.nextNode()}return o},findPreviousSibling:function(t){if(!t||a.isMediumEditorElement(t))return!1;for(var e=t.previousSibling;!e&&!a.isMediumEditorElement(t.parentNode);)e=(t=t.parentNode).previousSibling;return e},isDescendant:function(t,e,n){if(!t||!e)return!1;if(t===e)return!!n;if(1!==t.nodeType)return!1;if(o||3!==e.nodeType)return t.contains(e);for(var r=e.parentNode;null!==r;){if(r===t)return!0;r=r.parentNode}return!1},isElement:function(t){return!(!t||1!==t.nodeType)},throttle:function(t,e){var n,o,r,i=null,a=0,s=function(){a=Date.now(),i=null,r=t.apply(n,o),i||(n=o=null)};return e||0===e||(e=50),function(){var l=Date.now(),u=e-(l-a);return n=this,o=arguments,u<=0||u>e?(i&&(clearTimeout(i),i=null),a=l,r=t.apply(n,o),i||(n=o=null)):i||(i=setTimeout(s,u)),r}},traverseUp:function(t,e){if(!t)return!1;do{if(1===t.nodeType){if(e(t))return t;if(a.isMediumEditorElement(t))return!1}t=t.parentNode}while(t);return!1},htmlEntities:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(e,n){var o,r,i,s,l,u,c,d=!1,p=["insertHTML",!1,n];if(!t.util.isEdge&&e.queryCommandSupported("insertHTML"))try{return e.execCommand.apply(e,p)}catch(h){}if((o=e.getSelection()).rangeCount){if(c=(r=o.getRangeAt(0)).commonAncestorContainer,a.isMediumEditorElement(c)&&!c.firstChild)r.selectNode(c.appendChild(e.createTextNode("")));else if(3===c.nodeType&&0===r.startOffset&&r.endOffset===c.nodeValue.length||3!==c.nodeType&&c.innerHTML===r.toString()){for(;!a.isMediumEditorElement(c)&&c.parentNode&&1===c.parentNode.childNodes.length&&!a.isMediumEditorElement(c.parentNode);)c=c.parentNode;r.selectNode(c)}for(r.deleteContents(),(i=e.createElement("div")).innerHTML=n,s=e.createDocumentFragment();i.firstChild;)l=i.firstChild,u=s.appendChild(l);r.insertNode(s),u&&((r=r.cloneRange()).setStartAfter(u),r.collapse(!0),t.selection.selectRange(e,r)),d=!0}return e.execCommand.callListeners&&e.execCommand.callListeners(p,d),d},execFormatBlock:function(e,n){var o=a.getTopBlockContainer(t.selection.getSelectionStart(e));if("blockquote"===n){if(o&&Array.prototype.slice.call(o.childNodes).some(function(t){return a.isBlockContainer(t)}))return e.execCommand("outdent",!1,null);if(a.isIE)return e.execCommand("indent",!1,n)}if(o&&n===o.nodeName.toLowerCase()&&(n="p"),a.isIE&&(n="<"+n+">"),o&&"blockquote"===o.nodeName.toLowerCase()){if(a.isIE&&"<p>"===n)return e.execCommand("outdent",!1,n);if((a.isFF||a.isEdge)&&"p"===n)return Array.prototype.slice.call(o.childNodes).some(function(t){return!a.isBlockContainer(t)})&&e.execCommand("formatBlock",!1,n),e.execCommand("outdent",!1,n)}return e.execCommand("formatBlock",!1,n)},setTargetBlank:function(t,e){var n,o=e||!1;if("a"===t.nodeName.toLowerCase())t.target="_blank",t.rel="noopener noreferrer";else for(t=t.getElementsByTagName("a"),n=0;n<t.length;n+=1)!1!==o&&o!==t[n].attributes.href.value||(t[n].target="_blank",t[n].rel="noopener noreferrer")},removeTargetBlank:function(t,e){var n;if("a"===t.nodeName.toLowerCase())t.removeAttribute("target"),t.removeAttribute("rel");else for(t=t.getElementsByTagName("a"),n=0;n<t.length;n+=1)e===t[n].attributes.href.value&&(t[n].removeAttribute("target"),t[n].removeAttribute("rel"))},addClassToAnchors:function(t,e){var n,o,r=e.split(" ");if("a"===t.nodeName.toLowerCase())for(o=0;o<r.length;o+=1)t.classList.add(r[o]);else{var i=t.getElementsByTagName("a");if(0===i.length){var s=a.getClosestTag(t,"a");t=s?[s]:[]}else t=i;for(n=0;n<t.length;n+=1)for(o=0;o<r.length;o+=1)t[n].classList.add(r[o])}},isListItem:function(t){if(!t)return!1;if("li"===t.nodeName.toLowerCase())return!0;for(var e=t.parentNode,n=e.nodeName.toLowerCase();"li"===n||!a.isBlockContainer(e)&&"div"!==n;){if("li"===n)return!0;if(!(e=e.parentNode))return!1;n=e.nodeName.toLowerCase()}return!1},cleanListDOM:function(e,n){if("li"===n.nodeName.toLowerCase()){var o=n.parentElement;"p"===o.parentElement.nodeName.toLowerCase()&&(a.unwrap(o.parentElement,e),t.selection.moveCursor(e,n.firstChild,n.firstChild.textContent.length))}},splitOffDOMTree:function(t,e,n){for(var o=e,r=null,i=!n;o!==t;){var a,s=o.parentNode,l=s.cloneNode(!1),u=i?o:s.firstChild;for(r&&(i?l.appendChild(r):a=r),r=l;u;){var c=u.nextSibling;u===o?(u.hasChildNodes()?u=u.cloneNode(!1):u.parentNode.removeChild(u),u.textContent&&r.appendChild(u),u=i?c:null):(u.parentNode.removeChild(u),(u.hasChildNodes()||u.textContent)&&r.appendChild(u),u=c)}a&&r.appendChild(a),o=s}return r},moveTextRangeIntoElement:function(t,e,n){if(!t||!e)return!1;var o=a.findCommonRoot(t,e);if(!o)return!1;if(e===t){var r=t.parentNode,i=t.nextSibling;return r.removeChild(t),n.appendChild(t),i?r.insertBefore(n,i):r.appendChild(n),n.hasChildNodes()}for(var s,l,u,c=[],d=0;d<o.childNodes.length;d++)if(u=o.childNodes[d],s){if(a.isDescendant(u,e,!0)){l=u;break}c.push(u)}else a.isDescendant(u,t,!0)&&(s=u);var p=l.nextSibling,h=o.ownerDocument.createDocumentFragment();return s===t?(s.parentNode.removeChild(s),h.appendChild(s)):h.appendChild(a.splitOffDOMTree(s,t)),c.forEach(function(t){t.parentNode.removeChild(t),h.appendChild(t)}),l===e?(l.parentNode.removeChild(l),h.appendChild(l)):h.appendChild(a.splitOffDOMTree(l,e,!0)),n.appendChild(h),l.parentNode===o?o.insertBefore(n,l):p?o.insertBefore(n,p):o.appendChild(n),n.hasChildNodes()},depthOfNode:function(t){for(var e=0,n=t;null!==n.parentNode;)n=n.parentNode,e++;return e},findCommonRoot:function(t,e){for(var n=a.depthOfNode(t),o=a.depthOfNode(e),r=t,i=e;n!==o;)n>o?(r=r.parentNode,n-=1):(i=i.parentNode,o-=1);for(;r!==i;)r=r.parentNode,i=i.parentNode;return r},isElementAtBeginningOfBlock:function(t){for(var e;!a.isBlockContainer(t)&&!a.isMediumEditorElement(t);){for(e=t;e=e.previousSibling;)if((3===e.nodeType?e.nodeValue:e.textContent).length>0)return!1;t=t.parentNode}return!0},isMediumEditorElement:function(t){return t&&t.getAttribute&&!!t.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(t){return a.traverseUp(t,function(t){return a.isMediumEditorElement(t)})},isBlockContainer:function(t){return t&&3!==t.nodeType&&-1!==a.blockContainerElementNames.indexOf(t.nodeName.toLowerCase())},getClosestBlockContainer:function(t){return a.traverseUp(t,function(t){return a.isBlockContainer(t)||a.isMediumEditorElement(t)})},getTopBlockContainer:function(t){var e=!!a.isBlockContainer(t)&&t;return a.traverseUp(t,function(t){return a.isBlockContainer(t)&&(e=t),!(e||!a.isMediumEditorElement(t)||(e=t,0))}),e},getFirstSelectableLeafNode:function(t){for(;t&&t.firstChild;)t=t.firstChild;if("table"===(t=a.traverseUp(t,function(t){return-1===a.emptyElementNames.indexOf(t.nodeName.toLowerCase())})).nodeName.toLowerCase()){var e=t.querySelector("th, td");e&&(t=e)}return t},getFirstTextNode:function(t){return a.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"),a._getFirstTextNode(t)},_getFirstTextNode:function(t){if(3===t.nodeType)return t;for(var e=0;e<t.childNodes.length;e++){var n=a._getFirstTextNode(t.childNodes[e]);if(null!==n)return n}return null},ensureUrlHasProtocol:function(t){return-1===t.indexOf("://")?"http://"+t:t},warn:function(){void 0!==e.console&&"function"==typeof e.console.warn&&e.console.warn.apply(e.console,arguments)},deprecated:function(t,e,n){var o=t+" is deprecated, please use "+e+" instead.";n&&(o+=" Will be removed in "+n),a.warn(o)},deprecatedMethod:function(t,e,n,o){a.deprecated(t,e,o),"function"==typeof this[e]&&this[e].apply(this,n)},cleanupAttrs:function(t,e){e.forEach(function(e){t.removeAttribute(e)})},cleanupTags:function(t,e){-1!==e.indexOf(t.nodeName.toLowerCase())&&t.parentNode.removeChild(t)},unwrapTags:function(e,n){-1!==n.indexOf(e.nodeName.toLowerCase())&&t.util.unwrap(e,document)},getClosestTag:function(t,e){return a.traverseUp(t,function(t){return t.nodeName.toLowerCase()===e.toLowerCase()})},unwrap:function(t,e){for(var n=e.createDocumentFragment(),o=Array.prototype.slice.call(t.childNodes),r=0;r<o.length;r++)n.appendChild(o[r]);n.childNodes.length?t.parentNode.replaceChild(n,t):t.parentNode.removeChild(t)},guid:function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}};t.util=a}(window),(e=function(e){t.util.extend(this,e)}).extend=function(e){var n,o=this;n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return o.apply(this,arguments)},t.util.extend(n,o);var r=function(){this.constructor=n};return r.prototype=o.prototype,n.prototype=new r,e&&t.util.extend(n.prototype,e),n},e.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,getInteractionElements:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(t){return this.base.options[t]}},["execAction","on","off","subscribe","trigger"].forEach(function(t){e.prototype[t]=function(){return this.base[t].apply(this.base,arguments)}}),t.Extension=e,function(){function e(e){return t.util.isBlockContainer(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var n={findMatchingSelectionParent:function(e,n){var o,r=n.getSelection();return 0!==r.rangeCount&&(o=r.getRangeAt(0).commonAncestorContainer,t.util.traverseUp(o,e))},getSelectionElement:function(e){return this.findMatchingSelectionParent(function(e){return t.util.isMediumEditorElement(e)},e)},exportSelection:function(t,e){if(!t)return null;var n=null,o=e.getSelection();if(o.rangeCount>0){var r,i=o.getRangeAt(0),a=i.cloneRange();a.selectNodeContents(t),a.setEnd(i.startContainer,i.startOffset),n={start:r=a.toString().length,end:r+i.toString().length},this.doesRangeStartWithImages(i,e)&&(n.startsWithImage=!0);var s=this.getTrailingImageCount(t,n,i.endContainer,i.endOffset);if(s&&(n.trailingImageCount=s),0!==r){var l=this.getIndexRelativeToAdjacentEmptyBlocks(e,t,i.startContainer,i.startOffset);-1!==l&&(n.emptyBlocksIndex=l)}}return n},importSelection:function(t,e,n,o){if(t&&e){var r=n.createRange();r.setStart(e,0),r.collapse(!0);var i,a=e,s=[],l=0,u=!1,c=!1,d=0,p=!1,h=!1,f=null;for((o||t.startsWithImage||void 0!==t.emptyBlocksIndex)&&(h=!0);!p&&a;)if(a.nodeType>3)a=s.pop();else{if(3!==a.nodeType||c){if(t.trailingImageCount&&c&&("img"===a.nodeName.toLowerCase()&&d++,d===t.trailingImageCount)){for(var g=0;a.parentNode.childNodes[g]!==a;)g++;r.setEnd(a.parentNode,g+1),p=!0}if(!p&&1===a.nodeType)for(var y=a.childNodes.length-1;y>=0;)s.push(a.childNodes[y]),y-=1}else i=l+a.length,!u&&t.start>=l&&t.start<=i&&(h||t.start<i?(r.setStart(a,t.start-l),u=!0):f=a),u&&t.end>=l&&t.end<=i&&(t.trailingImageCount?c=!0:(r.setEnd(a,t.end-l),p=!0)),l=i;p||(a=s.pop())}!u&&f&&(r.setStart(f,f.length),r.setEnd(f,f.length)),void 0!==t.emptyBlocksIndex&&(r=this.importSelectionMoveCursorPastBlocks(n,e,t.emptyBlocksIndex,r)),o&&(r=this.importSelectionMoveCursorPastAnchor(t,r)),this.selectRange(n,r)}},importSelectionMoveCursorPastAnchor:function(e,n){if(e.start===e.end&&3===n.startContainer.nodeType&&n.startOffset===n.startContainer.nodeValue.length&&t.util.traverseUp(n.startContainer,function(t){return"a"===t.nodeName.toLowerCase()})){for(var o=n.startContainer,r=n.startContainer.parentNode;null!==r&&"a"!==r.nodeName.toLowerCase();)r.childNodes[r.childNodes.length-1]!==o?r=null:(o=r,r=r.parentNode);if(null!==r&&"a"===r.nodeName.toLowerCase()){for(var i=null,a=0;null===i&&a<r.parentNode.childNodes.length;a++)r.parentNode.childNodes[a]===r&&(i=a);n.setStart(r.parentNode,i+1),n.collapse(!0)}}return n},importSelectionMoveCursorPastBlocks:function(n,o,r,i){var a,s,l=n.createTreeWalker(o,NodeFilter.SHOW_ELEMENT,e,!1),u=i.startContainer,c=0;for(r=r||1,a=3===u.nodeType&&t.util.isBlockContainer(u.previousSibling)?u.previousSibling:t.util.getClosestBlockContainer(u);l.nextNode();)if(s){if(s=l.currentNode,++c===r)break;if(s.textContent.length>0)break}else a===l.currentNode&&(s=l.currentNode);return s||(s=a),i.setStart(t.util.getFirstSelectableLeafNode(s),0),i},getIndexRelativeToAdjacentEmptyBlocks:function(n,o,r,i){if(r.textContent.length>0&&i>0)return-1;var a=r;if(3!==a.nodeType&&(a=r.childNodes[i]),a){if(!t.util.isElementAtBeginningOfBlock(a))return-1;var s=t.util.findPreviousSibling(a);if(!s)return-1;if(s.nodeValue)return-1}for(var l=t.util.getClosestBlockContainer(r),u=n.createTreeWalker(o,NodeFilter.SHOW_ELEMENT,e,!1),c=0;u.nextNode();){var d=""===u.currentNode.textContent;if((d||c>0)&&(c+=1),u.currentNode===l)return c;d||(c=0)}return c},doesRangeStartWithImages:function(t,e){if(0!==t.startOffset||1!==t.startContainer.nodeType)return!1;if("img"===t.startContainer.nodeName.toLowerCase())return!0;var n=t.startContainer.querySelector("img");if(!n)return!1;for(var o=e.createTreeWalker(t.startContainer,NodeFilter.SHOW_ALL,null,!1);o.nextNode();){var r=o.currentNode;if(r===n)break;if(r.nodeValue)return!1}return!0},getTrailingImageCount:function(t,e,n,o){if(0===o||1!==n.nodeType)return 0;if("img"!==n.nodeName.toLowerCase()&&!n.querySelector("img"))return 0;for(var r=n.childNodes[o-1];r.hasChildNodes();)r=r.lastChild;for(var i,a=t,s=[],l=0,u=!1,c=!1,d=!1,p=0;!d&&a;)if(a.nodeType>3)a=s.pop();else{if(3!==a.nodeType||c){if("img"===a.nodeName.toLowerCase()&&p++,a===r)d=!0;else if(1===a.nodeType)for(var h=a.childNodes.length-1;h>=0;)s.push(a.childNodes[h]),h-=1}else p=0,i=l+a.length,!u&&e.start>=l&&e.start<=i&&(u=!0),u&&e.end>=l&&e.end<=i&&(c=!0),l=i;d||(a=s.pop())}return p},selectionContainsContent:function(t){var e=t.getSelection();if(!e||e.isCollapsed||!e.rangeCount)return!1;if(""!==e.toString().trim())return!0;var n=this.getSelectedParentElement(e.getRangeAt(0));return!(!n||!("img"===n.nodeName.toLowerCase()||1===n.nodeType&&n.querySelector("img")))},selectionInContentEditableFalse:function(t){var e,n=this.findMatchingSelectionParent(function(t){var n=t&&t.getAttribute("contenteditable");return"true"===n&&(e=!0),"#text"!==t.nodeName&&"false"===n},t);return!e&&n},getSelectionHtml:function(t){var e,n,o,r="",i=t.getSelection();if(i.rangeCount){for(o=t.createElement("div"),e=0,n=i.rangeCount;e<n;e+=1)o.appendChild(i.getRangeAt(e).cloneContents());r=o.innerHTML}return r},getCaretOffsets:function(t,e){var n,o;return e||(e=window.getSelection().getRangeAt(0)),n=e.cloneRange(),o=e.cloneRange(),n.selectNodeContents(t),n.setEnd(e.endContainer,e.endOffset),o.selectNodeContents(t),o.setStart(e.endContainer,e.endOffset),{left:n.toString().length,right:o.toString().length}},rangeSelectsSingleNode:function(t){var e=t.startContainer;return e===t.endContainer&&e.hasChildNodes()&&t.endOffset===t.startOffset+1},getSelectedParentElement:function(t){return t?this.rangeSelectsSingleNode(t)&&3!==t.startContainer.childNodes[t.startOffset].nodeType?t.startContainer.childNodes[t.startOffset]:3===t.startContainer.nodeType?t.startContainer.parentNode:t.startContainer:null},getSelectedElements:function(t){var e,n,o,r=t.getSelection();if(!r.rangeCount||r.isCollapsed||!r.getRangeAt(0).commonAncestorContainer)return[];if(3===(e=r.getRangeAt(0)).commonAncestorContainer.nodeType){for(n=[],o=e.commonAncestorContainer;o.parentNode&&1===o.parentNode.childNodes.length;)n.push(o.parentNode),o=o.parentNode;return n}return[].filter.call(e.commonAncestorContainer.getElementsByTagName("*"),function(t){return"function"!=typeof r.containsNode||r.containsNode(t,!0)})},selectNode:function(t,e){var n=e.createRange();n.selectNodeContents(t),this.selectRange(e,n)},select:function(t,e,n,o,r){var i=t.createRange();return i.setStart(e,n),o?i.setEnd(o,r):i.collapse(!0),this.selectRange(t,i),i},clearSelection:function(t,e){e?t.getSelection().collapseToStart():t.getSelection().collapseToEnd()},moveCursor:function(t,e,n){this.select(t,e,n)},getSelectionRange:function(t){var e=t.getSelection();return 0===e.rangeCount?null:e.getRangeAt(0)},selectRange:function(t,e){var n=t.getSelection();n.removeAllRanges(),n.addRange(e)},getSelectionStart:function(t){var e=t.getSelection().anchorNode;return e&&3===e.nodeType?e.parentNode:e}};t.selection=n}(),function(){function e(e,n){return!!e&&e.some(function(e){if("function"!=typeof e.getInteractionElements)return!1;var o=e.getInteractionElements();return!!o&&(Array.isArray(o)||(o=[o]),o.some(function(e){return t.util.isDescendant(e,n,!0)}))})}var n=function(t){this.base=t,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}};n.prototype={InputEventOnContenteditableSupported:!t.util.isIE&&!t.util.isEdge,attachDOMEvent:function(e,n,o,r){var i=this.base.options.contentWindow,a=this.base.options.ownerDocument;e=t.util.isElement(e)||[i,a].indexOf(e)>-1?[e]:e,Array.prototype.forEach.call(e,function(t){t.addEventListener(n,o,r),this.events.push([t,n,o,r])}.bind(this))},detachDOMEvent:function(e,n,o,r){var i,a,s=this.base.options.contentWindow,l=this.base.options.ownerDocument;e&&(e=t.util.isElement(e)||[s,l].indexOf(e)>-1?[e]:e,Array.prototype.forEach.call(e,function(t){-1!==(i=this.indexOfListener(t,n,o,r))&&(a=this.events.splice(i,1)[0])[0].removeEventListener(a[1],a[2],a[3])}.bind(this)))},indexOfListener:function(t,e,n,o){var r,i,a;for(r=0,i=this.events.length;r<i;r+=1)if((a=this.events[r])[0]===t&&a[1]===e&&a[2]===n&&a[3]===o)return r;return-1},detachAllDOMEvents:function(){for(var t=this.events.pop();t;)t[0].removeEventListener(t[1],t[2],t[3]),t=this.events.pop()},detachAllEventsFromElement:function(t){for(var e=this.events.filter(function(e){return e&&e[0].getAttribute&&e[0].getAttribute("medium-editor-index")===t.getAttribute("medium-editor-index")}),n=0,o=e.length;n<o;n++){var r=e[n];this.detachDOMEvent(r[0],r[1],r[2],r[3])}},attachAllEventsToElement:function(t){this.listeners.editableInput&&(this.contentCache[t.getAttribute("medium-editor-index")]=t.innerHTML),this.eventsCache&&this.eventsCache.forEach(function(e){this.attachDOMEvent(t,e.name,e.handler.bind(this))},this)},enableCustomEvent:function(t){void 0!==this.disabledEvents[t]&&delete this.disabledEvents[t]},disableCustomEvent:function(t){this.disabledEvents[t]=!0},attachCustomEvent:function(t,e){this.setupListener(t),this.customEvents[t]||(this.customEvents[t]=[]),this.customEvents[t].push(e)},detachCustomEvent:function(t,e){var n=this.indexOfCustomListener(t,e);-1!==n&&this.customEvents[t].splice(n,1)},indexOfCustomListener:function(t,e){return this.customEvents[t]&&this.customEvents[t].length?this.customEvents[t].indexOf(e):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(t,e,n){this.customEvents[t]&&!this.disabledEvents[t]&&this.customEvents[t].forEach(function(t){t(e,n)})},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach(function(t){t.removeAttribute("data-medium-focused")})},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=function(t){this.handleDocumentExecCommand(t)}.bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var t=this.options.ownerDocument;if(this.execCommandListener&&t.execCommand.listeners){var e=t.execCommand.listeners.indexOf(this.execCommandListener);-1!==e&&t.execCommand.listeners.splice(e,1),t.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var t=this.options.ownerDocument;if(!t.execCommand.listeners){var e=function(e,n){t.execCommand.listeners&&t.execCommand.listeners.forEach(function(t){t({command:e[0],value:e[2],args:e,result:n})})},n=function(){var n=t.execCommand.orig.apply(this,arguments);if(!t.execCommand.listeners)return n;var o=Array.prototype.slice.call(arguments);return e(o,n),n};n.orig=t.execCommand,n.listeners=[],n.callListeners=e,t.execCommand=n}},unwrapExecCommand:function(){var t=this.options.ownerDocument;t.execCommand.orig&&(t.execCommand=t.execCommand.orig)},setupListener:function(t){if(!this.listeners[t]){switch(t){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache={},this.base.elements.forEach(function(t){this.contentCache[t.getAttribute("medium-editor-index")]=t.innerHTML},this),this.InputEventOnContenteditableSupported&&this.attachToEachElement("input",this.handleInput),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownSpace":case"editableKeydownEnter":case"editableKeydownTab":case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[t]=!0}},attachToEachElement:function(t,e){this.eventsCache||(this.eventsCache=[]),this.base.elements.forEach(function(n){this.attachDOMEvent(n,t,e.bind(this))},this),this.eventsCache.push({name:t,handler:e})},cleanupElement:function(t){var e=t.getAttribute("medium-editor-index");e&&(this.detachAllEventsFromElement(t),this.contentCache&&delete this.contentCache[e])},focusElement:function(t){t.focus(),this.updateFocus(t,{target:t,type:"focus"})},updateFocus:function(n,o){var r,i=this.base.getFocusedElement();i&&"click"===o.type&&this.lastMousedownTarget&&(t.util.isDescendant(i,this.lastMousedownTarget,!0)||e(this.base.extensions,this.lastMousedownTarget))&&(r=i),r||this.base.elements.some(function(e){return!r&&t.util.isDescendant(e,n,!0)&&(r=e),!!r},this);var a=!t.util.isDescendant(i,n,!0)&&!e(this.base.extensions,n);r!==i&&(i&&a&&(i.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",o,i)),r&&(r.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",o,r))),a&&this.triggerCustomEvent("externalInteraction",o)},updateInput:function(t,e){if(this.contentCache){var n=t.getAttribute("medium-editor-index"),o=t.innerHTML;o!==this.contentCache[n]&&this.triggerCustomEvent("editableInput",e,t),this.contentCache[n]=o}},handleDocumentSelectionChange:function(e){if(e.currentTarget&&e.currentTarget.activeElement){var n,o=e.currentTarget.activeElement;this.base.elements.some(function(e){return!!t.util.isDescendant(e,o,!0)&&(n=e,!0)},this),n&&this.updateInput(n,{target:o,currentTarget:n})}},handleDocumentExecCommand:function(){var t=this.base.getFocusedElement();t&&this.updateInput(t,{target:t,currentTarget:t})},handleBodyClick:function(t){this.updateFocus(t.target,t)},handleBodyFocus:function(t){this.updateFocus(t.target,t)},handleBodyMousedown:function(t){this.lastMousedownTarget=t.target},handleInput:function(t){this.updateInput(t.currentTarget,t)},handleClick:function(t){this.triggerCustomEvent("editableClick",t,t.currentTarget)},handleBlur:function(t){this.triggerCustomEvent("editableBlur",t,t.currentTarget)},handleKeypress:function(t){if(this.triggerCustomEvent("editableKeypress",t,t.currentTarget),this.keypressUpdateInput){var e={target:t.target,currentTarget:t.currentTarget};setTimeout(function(){this.updateInput(e.currentTarget,e)}.bind(this),0)}},handleKeyup:function(t){this.triggerCustomEvent("editableKeyup",t,t.currentTarget)},handleMouseover:function(t){this.triggerCustomEvent("editableMouseover",t,t.currentTarget)},handleDragging:function(t){this.triggerCustomEvent("editableDrag",t,t.currentTarget)},handleDrop:function(t){this.triggerCustomEvent("editableDrop",t,t.currentTarget)},handlePaste:function(t){this.triggerCustomEvent("editablePaste",t,t.currentTarget)},handleKeydown:function(e){return this.triggerCustomEvent("editableKeydown",e,e.currentTarget),t.util.isKey(e,t.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",e,e.currentTarget):t.util.isKey(e,t.util.keyCode.ENTER)||e.ctrlKey&&t.util.isKey(e,t.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",e,e.currentTarget):t.util.isKey(e,t.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",e,e.currentTarget):t.util.isKey(e,[t.util.keyCode.DELETE,t.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",e,e.currentTarget):void 0}},t.Events=n}(),n=t.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(e){n.isBuiltInButton(e)?t.Extension.call(this,this.defaults[e]):t.Extension.call(this,e)},init:function(){t.Extension.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames},createButton:function(){var t=this.document.createElement("button"),e=this.contentDefault,n=this.getAria(),o=this.getEditorOption("buttonLabels");return t.classList.add("medium-editor-action"),t.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach(function(e){t.classList.add(e)}),t.setAttribute("data-action",this.getAction()),n&&(t.setAttribute("title",n),t.setAttribute("aria-label",n)),this.attrs&&Object.keys(this.attrs).forEach(function(e){t.setAttribute(e,this.attrs[e])},this),"fontawesome"===o&&this.contentFA&&(e=this.contentFA),t.innerHTML=e,t},handleClick:function(t){t.preventDefault(),t.stopPropagation();var e=this.getAction();e&&this.execAction(e)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var t=null;return this.useQueryState&&(t=this.base.queryCommandState(this.getAction())),t},isAlreadyApplied:function(t){var e,n,o=!1,r=this.getTagNames();return!1===this.knownState||!0===this.knownState?this.knownState:(r&&r.length>0&&(o=-1!==r.indexOf(t.nodeName.toLowerCase())),!o&&this.style&&(e=this.style.value.split("|"),n=this.window.getComputedStyle(t,null).getPropertyValue(this.style.prop),e.forEach(function(t){this.knownState||((o=-1!==n.indexOf(t))||"text-decoration"!==this.style.prop)&&(this.knownState=o)},this)),o)}}),n.isBuiltInButton=function(e){return"string"==typeof e&&t.extensions.button.prototype.defaults.hasOwnProperty(e)},t.extensions.button=n,t.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},html:{name:"html",action:"html",aria:"evaluate html",tagNames:["iframe","object"],contentDefault:"<b>html</b>",contentFA:'<i class="fa fa-code"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}},o=t.extensions.button.extend({init:function(){t.extensions.button.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:!0,getForm:function(){},isDisplayed:function(){return!!this.hasForm&&this.getForm().classList.contains(this.activeClass)},showForm:function(){this.hasForm&&this.getForm().classList.add(this.activeClass)},hideForm:function(){this.hasForm&&this.getForm().classList.remove(this.activeClass)},showToolbarDefaultActions:function(){var t=this.base.getExtensionByName("toolbar");t&&t.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var t=this.base.getExtensionByName("toolbar");t&&t.hideToolbarDefaultActions()},setToolbarPosition:function(){var t=this.base.getExtensionByName("toolbar");t&&t.setToolbarPosition()}}),t.extensions.form=o,r=t.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){t.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(e){e.preventDefault(),e.stopPropagation();var n=t.selection.getSelectionRange(this.document);return"a"===n.startContainer.nodeName.toLowerCase()||"a"===n.endContainer.nodeName.toLowerCase()||t.util.getClosestTag(t.selection.getSelectedParentElement(n),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(e){t.util.isKey(e,t.util.keyCode.K)&&t.util.isMetaCtrlKey(e)&&!e.shiftKey&&this.handleClick(e)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var t=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return t.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),t.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&t.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target" id="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">','<label for="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">',this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&t.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),t.join("")},isDisplayed:function(){return t.extensions.form.prototype.isDisplayed.apply(this)},hideForm:function(){t.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(e){var n=this.getInput(),o=this.getAnchorTargetCheckbox(),r=this.getAnchorButtonCheckbox();if("string"==typeof(e=e||{value:""})&&(e={value:e}),this.base.saveSelection(),this.hideToolbarDefaultActions(),t.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),n.value=e.value,n.focus(),o&&(o.checked="_blank"===e.target),r){var i=e.buttonClass?e.buttonClass.split(" "):[];r.checked=-1!==i.indexOf(this.customClassOption)}},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},getFormOpts:function(){var t=this.getAnchorTargetCheckbox(),e=this.getAnchorButtonCheckbox(),n={value:this.getInput().value.trim()};return this.linkValidation&&(n.value=this.checkLinkFormat(n.value)),n.target="_self",t&&t.checked&&(n.target="_blank"),e&&e.checked&&(n.buttonClass=this.customClassOption),n},doFormSave:function(){var t=this.getFormOpts();this.completeFormSave(t)},completeFormSave:function(t){this.base.restoreSelection(),this.execAction(this.action,t),this.base.checkSelection()},ensureEncodedUri:function(t){return t===decodeURI(t)?encodeURI(t):t},ensureEncodedUriComponent:function(t){return t===decodeURIComponent(t)?encodeURIComponent(t):t},ensureEncodedParam:function(t){var e=t.split("="),n=e[0],o=e[1];return n+(void 0===o?"":"="+this.ensureEncodedUriComponent(o))},ensureEncodedQuery:function(t){return t.split("&").map(this.ensureEncodedParam.bind(this)).join("&")},checkLinkFormat:function(t){var e=/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i.test(t),n="",o=t.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/),r=o[1],i=o[2],a=o[3];if(/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/.test(t))return"tel:"+t;if(!e){var s=r.split("/")[0];(s.match(/.+(\.|:).+/)||"localhost"===s)&&(n="http://")}return n+this.ensureEncodedUri(r)+(void 0===i?"":"?"+this.ensureEncodedQuery(i))+(void 0===a?"":"#"+a)},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(t){var e=t.querySelector(".medium-editor-toolbar-close"),n=t.querySelector(".medium-editor-toolbar-save"),o=t.querySelector(".medium-editor-toolbar-input");this.on(t,"click",this.handleFormClick.bind(this)),this.on(o,"keyup",this.handleTextboxKeyup.bind(this)),this.on(e,"click",this.handleCloseClick.bind(this)),this.on(n,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var t=this.document.createElement("div");return t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),t.innerHTML=this.getTemplate(),this.attachFormEvents(t),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(e){if(e.keyCode===t.util.keyCode.ENTER)return e.preventDefault(),void this.doFormSave();e.keyCode===t.util.keyCode.ESCAPE&&(e.preventDefault(),this.doFormCancel())},handleFormClick:function(t){t.stopPropagation()},handleSaveClick:function(t){t.preventDefault(),this.doFormSave()},handleCloseClick:function(t){t.preventDefault(),this.doFormCancel()}}),t.extensions.anchor=r,i=t.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:!1,showOnEmptyLinks:!0,init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getInteractionElements:function(){return this.getPreviewElement()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var t=this.document.createElement("div");return t.id="medium-editor-anchor-preview-"+this.getEditorId(),t.className="medium-editor-anchor-preview",t.innerHTML=this.getTemplate(),this.on(t,"click",this.handleClick.bind(this)),t},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview&&this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(t){return!(!this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&!t.getAttribute("data-disable-preview"))||(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=t.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=t.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=t,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(t){t=t||this.activeAnchor;var e,n,o,r,i,a=this.window.innerWidth,s=this.anchorPreview.offsetHeight,l=t.getBoundingClientRect(),u=this.diffLeft,c=this.diffTop,d=this.getEditorOption("elementsContainer"),p=["absolute","fixed"].indexOf(window.getComputedStyle(d).getPropertyValue("position"))>-1,h={};e=this.anchorPreview.offsetWidth/2;var f=this.base.getExtensionByName("toolbar");f&&(u=f.diffLeft,c=f.diffTop),n=u-e,p?(r=d.getBoundingClientRect(),["top","left"].forEach(function(t){h[t]=l[t]-r[t]}),h.width=l.width,h.height=l.height,l=h,a=r.width,i=d.scrollTop):i=this.window.pageYOffset,o=l.left+l.width/2,i+=s+l.top+l.height-c-this.anchorPreview.offsetHeight,this.anchorPreview.style.top=Math.round(i)+"px",this.anchorPreview.style.right="initial",o<e?(this.anchorPreview.style.left=n+e+"px",this.anchorPreview.style.right="initial"):a-o<e?(this.anchorPreview.style.left="auto",this.anchorPreview.style.right=0):(this.anchorPreview.style.left=n+o+"px",this.anchorPreview.style.right="initial")},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this)),this.subscribe("positionedToolbar",this.handlePositionedToolbar.bind(this))},handlePositionedToolbar:function(){this.showWhenToolbarIsVisible||this.hidePreview()},handleClick:function(t){var e=this.base.getExtensionByName("anchor"),n=this.activeAnchor;e&&n&&(t.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay(function(){if(n){var t={value:n.attributes.href.value,target:n.getAttribute("target"),buttonClass:n.getAttribute("class")};e.showForm(t),n=null}}.bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(e){var n=t.util.getClosestTag(e.target,"a");if(!1!==n){if(!this.showOnEmptyLinks&&(!/href=["']\S+["']/.test(n.outerHTML)||/href=["']#\S+["']/.test(n.outerHTML)))return!0;var o=this.base.getExtensionByName("toolbar");if(!this.showWhenToolbarIsVisible&&o&&o.isDisplayed&&o.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==n&&this.detachPreviewHandlers(),this.anchorToPreview=n,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay(function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}.bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(t){t.relatedTarget&&/anchor-preview/.test(t.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;(new Date).getTime()-this.lastOver>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}}),t.extensions.anchorPreview=i,function(){var e,n,o,r,i;function a(e){return!t.util.getClosestTag(e,"a")}e=[" ","\t","\n","\r"," "," "," "," "," ","\u2028","\u2029"],o="(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.]("+(n="com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw")+")\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?«»“”‘’])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.("+n+"))",r=new RegExp("^("+n+")$","i"),i=new RegExp(o,"gi");var s=t.Extension.extend({init:function(){t.Extension.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},isLastInstance:function(){for(var t=0,e=0;e<this.window._mediumEditors.length;e++){var n=this.window._mediumEditors[e];null!==n&&void 0!==n.getExtensionByName("autoLink")&&t++}return 1===t},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(t,e){this.performLinking(e)},onKeypress:function(e){this.disableEventHandling||t.util.isKey(e,[t.util.keyCode.SPACE,t.util.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout(function(){try{var t=this.base.exportSelection();this.performLinking(e.target)&&this.base.importSelection(t,!0)}catch(n){window.console&&window.console.error("Failed to perform linking",n),this.disableEventHandling=!0}}.bind(this),0))},performLinking:function(e){var n=t.util.splitByBlockElements(e),o=!1;0===n.length&&(n=[e]);for(var r=0;r<n.length;r++)o=this.removeObsoleteAutoLinkSpans(n[r])||o,o=this.performLinkingWithinElement(n[r])||o;return this.base.events.updateInput(e,{target:e,currentTarget:e}),o},removeObsoleteAutoLinkSpans:function(e){if(!e||3===e.nodeType)return!1;for(var n=e.querySelectorAll('span[data-auto-link="true"]'),o=!1,r=0;r<n.length;r++){var i=n[r].textContent;if(-1===i.indexOf("://")&&(i=t.util.ensureUrlHasProtocol(i)),n[r].getAttribute("data-href")!==i&&a(n[r])){o=!0;var s=i.replace(/\s+$/,"");if(n[r].getAttribute("data-href")===s){var l=i.length-s.length,u=t.util.splitOffDOMTree(n[r],this.splitTextBeforeEnd(n[r],l));n[r].parentNode.insertBefore(u,n[r].nextSibling)}else t.util.unwrap(n[r],this.document)}}return o},splitTextBeforeEnd:function(t,e){for(var n,o,r,i=this.document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null,!1),a=!0;a;)a=null!==i.lastChild();for(;e>0&&null!==r;)(o=(n=i.currentNode).nodeValue).length>e?(r=n.splitText(o.length-e),e=0):(r=i.previousNode(),e-=o.length);return r},performLinkingWithinElement:function(e){for(var n=this.findLinkableText(e),o=0;o<n.length;o++){var r=t.util.findOrCreateMatchingTextNodes(this.document,e,n[o]);this.shouldNotLink(r)||this.createAutoLink(r,n[o].href)}return!1},shouldNotLink:function(e){for(var n=!1,o=0;o<e.length&&!1===n;o++)n=!!t.util.traverseUp(e[o],function(t){return"a"===t.nodeName.toLowerCase()||t.getAttribute&&"true"===t.getAttribute("data-auto-link")});return n},findLinkableText:function(t){for(var n=t.textContent,o=null,a=[];null!==(o=i.exec(n));){var s=o.index+o[0].length;!(0!==o.index&&-1===e.indexOf(n[o.index-1])||s!==n.length&&-1===e.indexOf(n[s]))&&(-1!==o[0].indexOf("/")||r.test(o[0].split(".").pop().split("?").shift()))&&a.push({href:o[0],start:o.index,end:s})}return a},createAutoLink:function(e,n){n=t.util.ensureUrlHasProtocol(n);var o=t.util.createLink(this.document,e,n,this.getEditorOption("targetBlank")?"_blank":null),r=this.document.createElement("span");for(r.setAttribute("data-auto-link","true"),r.setAttribute("data-href",n),o.insertBefore(r,o.firstChild);o.childNodes.length>1;)r.appendChild(o.childNodes[1])}});t.extensions.autoLink=s}(),function(){var e="medium-editor-dragover";function n(n){var o=t.util.getContainerEditorElement(n);Array.prototype.slice.call(o.parentElement.querySelectorAll("."+e)).forEach(function(t){t.classList.remove(e)})}var o=t.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){t.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(t){t.preventDefault(),t.dataTransfer.dropEffect="copy";var o=t.target.classList?t.target:t.target.parentElement;n(o),"dragover"===t.type&&o.classList.add(e)},handleDrop:function(t){t.preventDefault(),t.stopPropagation(),this.base.selectElement(t.target);var e=this.base.exportSelection();e.start=e.end,this.base.importSelection(e),t.dataTransfer.files&&Array.prototype.slice.call(t.dataTransfer.files).forEach(function(t){this.isAllowedFile(t)&&t.type.match("image")&&this.insertImageFile(t)},this),n(t.target)},isAllowedFile:function(t){return this.allowedTypes.some(function(e){return!!t.type.match(e)})},insertImageFile:function(e){if("function"==typeof FileReader){var n=new FileReader;n.readAsDataURL(e),n.addEventListener("load",function(e){var n=this.document.createElement("img");n.src=e.target.result,t.util.insertHTMLCommand(this.document,n.outerHTML)}.bind(this))}}});t.extensions.fileDragging=o}(),a=t.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){t.Extension.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach(function(t){var e=t.key.charCodeAt(0);this.keys[e]||(this.keys[e]=[]),this.keys[e].push(t)},this)},handleKeydown:function(e){var n=t.util.getKeyCode(e);if(this.keys[n]){var o=t.util.isMetaCtrlKey(e),r=!!e.shiftKey,i=!!e.altKey;this.keys[n].forEach(function(t){t.meta!==o||t.shift!==r||t.alt!==i&&void 0!==t.alt||(e.preventDefault(),e.stopPropagation(),"function"==typeof t.command?t.command.apply(this):!1!==t.command&&this.execAction(t.command))},this)}}}),t.extensions.keyboardCommands=a,s=t.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){t.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(t){if(t.preventDefault(),t.stopPropagation(),!this.isDisplayed()){var e=this.document.queryCommandValue("fontName")+"";this.showForm(e)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getSelect().value=""},showForm:function(t){var e=this.getSelect();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),e.value=t||"",e.focus()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontName(),this.base.checkSelection()},createForm:function(){var t,e=this.document,n=e.createElement("div"),o=e.createElement("select"),r=e.createElement("a"),i=e.createElement("a");n.className="medium-editor-toolbar-form",n.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),this.on(n,"click",this.handleFormClick.bind(this));for(var a=0;a<this.fonts.length;a++)(t=e.createElement("option")).innerHTML=this.fonts[a],t.value=this.fonts[a],o.appendChild(t);return o.className="medium-editor-toolbar-select",n.appendChild(o),this.on(o,"change",this.handleFontChange.bind(this)),i.setAttribute("href","#"),i.className="medium-editor-toobar-save",i.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",n.appendChild(i),this.on(i,"click",this.handleSaveClick.bind(this),!0),r.setAttribute("href","#"),r.className="medium-editor-toobar-close",r.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",n.appendChild(r),this.on(r,"click",this.handleCloseClick.bind(this)),n},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){t.selection.getSelectedElements(this.document).forEach(function(t){"font"===t.nodeName.toLowerCase()&&t.hasAttribute("face")&&t.removeAttribute("face")})},handleFontChange:function(){var t=this.getSelect().value;""===t?this.clearFontName():this.execAction("fontName",{value:t})},handleFormClick:function(t){t.stopPropagation()},handleSaveClick:function(t){t.preventDefault(),this.doFormSave()},handleCloseClick:function(t){t.preventDefault(),this.doFormCancel()}}),t.extensions.fontName=s,l=t.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){t.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(t){if(t.preventDefault(),t.stopPropagation(),!this.isDisplayed()){var e=this.document.queryCommandValue("fontSize")+"";this.showForm(e)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(t){var e=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),e.value=t||"",e.focus()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var t=this.document,e=t.createElement("div"),n=t.createElement("input"),o=t.createElement("a"),r=t.createElement("a");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(e,"click",this.handleFormClick.bind(this)),n.setAttribute("type","range"),n.setAttribute("min","1"),n.setAttribute("max","7"),n.className="medium-editor-toolbar-input",e.appendChild(n),this.on(n,"change",this.handleSliderChange.bind(this)),r.setAttribute("href","#"),r.className="medium-editor-toobar-save",r.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",e.appendChild(r),this.on(r,"click",this.handleSaveClick.bind(this),!0),o.setAttribute("href","#"),o.className="medium-editor-toobar-close",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",e.appendChild(o),this.on(o,"click",this.handleCloseClick.bind(this)),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){t.selection.getSelectedElements(this.document).forEach(function(t){"font"===t.nodeName.toLowerCase()&&t.hasAttribute("size")&&t.removeAttribute("size")})},handleSliderChange:function(){var t=this.getInput().value;"4"===t?this.clearFontSize():this.execAction("fontSize",{value:t})},handleFormClick:function(t){t.stopPropagation()},handleSaveClick:function(t){t.preventDefault(),this.doFormSave()},handleCloseClick:function(t){t.preventDefault(),this.doFormCancel()}}),t.extensions.fontSize=l,function(){var e="%ME_PASTEBIN%",n=null,o=null,r=function(t){t.stopPropagation()};function i(t,e,n){var o=t.clipboardData||e.clipboardData||n.dataTransfer,r={};if(!o)return r;if(o.getData){var i=o.getData("Text");i&&i.length>0&&(r["text/plain"]=i)}if(o.types)for(var a=0;a<o.types.length;a++){var s=o.types[a];r[s]=o.getData(s)}return r}var a=t.Extension.extend({forcePlainText:!0,cleanPastedHTML:!1,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[],init:function(){t.Extension.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&(this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.getEditorElements().forEach(function(t){this.on(t,"paste",this.handlePaste.bind(this))},this),this.subscribe("addElement",this.handleAddElement.bind(this)))},handleAddElement:function(t,e){this.on(e,"paste",this.handlePaste.bind(this))},destroy:function(){(this.forcePlainText||this.cleanPastedHTML)&&this.removePasteBin()},handlePaste:function(t,e){if(!t.defaultPrevented){var n=i(t,this.window,this.document),o=n["text/html"],r=n["text/plain"];this.window.clipboardData&&void 0===t.clipboardData&&!o&&(o=r),(o||r)&&(t.preventDefault(),this.doPaste(o,r,e))}},doPaste:function(e,n,o){var r,i,a="";if(this.cleanPastedHTML&&e)return this.cleanPaste(e);if(n){if(this.getEditorOption("disableReturn")||o&&o.getAttribute("data-disable-return"))a=t.util.htmlEntities(n);else if((r=n.split(/[\r\n]+/g)).length>1)for(i=0;i<r.length;i+=1)""!==r[i]&&(a+="<p>"+t.util.htmlEntities(r[i])+"</p>");else a=t.util.htmlEntities(r[0]);t.util.insertHTMLCommand(this.document,a)}},handlePasteBinPaste:function(t){if(t.defaultPrevented)this.removePasteBin();else{var e=i(t,this.window,this.document),n=e["text/html"],r=e["text/plain"],a=o;if(!this.cleanPastedHTML||n)return t.preventDefault(),this.removePasteBin(),this.doPaste(n,r,a),void this.trigger("editablePaste",{currentTarget:a,target:a},a);setTimeout(function(){this.cleanPastedHTML&&(n=this.getPasteBinHtml()),this.removePasteBin(),this.doPaste(n,r,a),this.trigger("editablePaste",{currentTarget:a,target:a},a)}.bind(this),0)}},handleKeydown:function(e,n){t.util.isKey(e,t.util.keyCode.V)&&t.util.isMetaCtrlKey(e)&&(e.stopImmediatePropagation(),this.removePasteBin(),this.createPasteBin(n))},createPasteBin:function(i){var a,s=t.selection.getSelectionRange(this.document),l=this.window.pageYOffset;o=i,s&&((a=s.getClientRects()).length?l+=a[0].top:void 0!==s.startContainer.getBoundingClientRect?l+=s.startContainer.getBoundingClientRect().top:l+=s.getBoundingClientRect().top),n=s;var u=this.document.createElement("div");u.id=this.pasteBinId="medium-editor-pastebin-"+ +Date.now(),u.setAttribute("style","border: 1px red solid; position: absolute; top: "+l+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0"),u.setAttribute("contentEditable",!0),u.innerHTML=e,this.document.body.appendChild(u),this.on(u,"focus",r),this.on(u,"focusin",r),this.on(u,"focusout",r),u.focus(),t.selection.selectNode(u,this.document),this.boundHandlePaste||(this.boundHandlePaste=this.handlePasteBinPaste.bind(this)),this.on(u,"paste",this.boundHandlePaste)},removePasteBin:function(){null!==n&&(t.selection.selectRange(this.document,n),n=null),null!==o&&(o=null);var e=this.getPasteBin();e&&e&&(this.off(e,"focus",r),this.off(e,"focusin",r),this.off(e,"focusout",r),this.off(e,"paste",this.boundHandlePaste),e.parentElement.removeChild(e))},getPasteBin:function(){return this.document.getElementById(this.pasteBinId)},getPasteBinHtml:function(){var t=this.getPasteBin();if(!t)return!1;if(t.firstChild&&"mcepastebin"===t.firstChild.id)return!1;var n=t.innerHTML;return!(!n||n===e)&&n},cleanPaste:function(t){var e,n,o,r,i=/<p|<br|<div/.test(t),a=[].concat(this.preCleanReplacements||[],[[new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g),""],[new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g),""],[new RegExp(/<br>$/i),""],[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|“|”)(((?!&quot;|&rdquo;|&ldquo;|"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|"|“|”)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],[new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi),"$1"]],this.cleanReplacements||[]);for(e=0;e<a.length;e+=1)t=t.replace(a[e][0],a[e][1]);if(!i)return this.pasteHTML(t);for((o=this.document.createElement("div")).innerHTML="<p>"+t.split("<br><br>").join("</p><p>")+"</p>",n=o.querySelectorAll("a,p,div,br"),e=0;e<n.length;e+=1)switch((r=n[e]).innerHTML=r.innerHTML.replace(/\n/gi," "),r.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(r);break;case"br":this.filterLineBreak(r)}this.pasteHTML(o.innerHTML)},pasteHTML:function(e,n){n=t.util.defaults({},n,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags,unwrapTags:this.unwrapTags});var o,r,i,a,s=this.document.createDocumentFragment();for(s.appendChild(this.document.createElement("body")),(a=s.querySelector("body")).innerHTML=e,this.cleanupSpans(a),o=a.querySelectorAll("*"),i=0;i<o.length;i+=1)"a"===(r=o[i]).nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&t.util.setTargetBlank(r),t.util.cleanupAttrs(r,n.cleanAttrs),t.util.cleanupTags(r,n.cleanTags),t.util.unwrapTags(r,n.unwrapTags);t.util.insertHTMLCommand(this.document,a.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(t){return t&&("p"===t.nodeName.toLowerCase()||"div"===t.nodeName.toLowerCase())},filterCommonBlocks:function(t){/^\s*$/.test(t.textContent)&&t.parentNode&&t.parentNode.removeChild(t)},filterLineBreak:function(t){this.isCommonBlock(t.previousElementSibling)?this.removeWithParent(t):!this.isCommonBlock(t.parentNode)||t.parentNode.firstChild!==t&&t.parentNode.lastChild!==t?t.parentNode&&1===t.parentNode.childElementCount&&""===t.parentNode.textContent&&this.removeWithParent(t):this.removeWithParent(t)},removeWithParent:function(t){t&&t.parentNode&&(t.parentNode.parentNode&&1===t.parentNode.childElementCount?t.parentNode.parentNode.removeChild(t.parentNode):t.parentNode.removeChild(t))},cleanupSpans:function(e){var n,o,r,i=e.querySelectorAll(".replace-with"),a=function(t){return t&&"#text"!==t.nodeName&&"false"===t.getAttribute("contenteditable")};for(n=0;n<i.length;n+=1)o=i[n],r=this.document.createElement(o.classList.contains("bold")?"b":"i"),o.classList.contains("bold")&&o.classList.contains("italic")?r.innerHTML="<i>"+o.innerHTML+"</i>":r.innerHTML=o.innerHTML,o.parentNode.replaceChild(r,o);for(i=e.querySelectorAll("span"),n=0;n<i.length;n+=1){if(o=i[n],t.util.traverseUp(o,a))return!1;t.util.unwrap(o,this.document)}}});t.extensions.paste=a}(),u=t.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){t.Extension.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(this.initElement,this)},handleAddElement:function(t,e){this.initElement(e)},initElement:function(t){t.getAttribute("data-placeholder")||t.setAttribute("data-placeholder",this.text),this.updatePlaceholder(t)},destroy:function(){this.getEditorElements().forEach(this.cleanupElement,this)},handleRemoveElement:function(t,e){this.cleanupElement(e)},cleanupElement:function(t){t.getAttribute("data-placeholder")===this.text&&t.removeAttribute("data-placeholder")},showPlaceholder:function(e){e&&(t.util.isFF&&0===e.childNodes.length?(e.classList.add("medium-editor-placeholder-relative"),e.classList.remove("medium-editor-placeholder")):(e.classList.add("medium-editor-placeholder"),e.classList.remove("medium-editor-placeholder-relative")))},hidePlaceholder:function(t){t&&(t.classList.remove("medium-editor-placeholder"),t.classList.remove("medium-editor-placeholder-relative"))},updatePlaceholder:function(t,e){if(t.querySelector("img, blockquote, ul, ol, table")||""!==t.textContent.replace(/^\s+|\s+$/g,""))return this.hidePlaceholder(t);e||this.showPlaceholder(t)},attachEventHandlers:function(){this.hideOnClick&&this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableInput",this.handleInput.bind(this)),this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("addElement",this.handleAddElement.bind(this)),this.subscribe("removeElement",this.handleRemoveElement.bind(this))},handleInput:function(t,e){var n=this.hideOnClick&&e===this.base.getFocusedElement();this.updatePlaceholder(e,n)},handleFocus:function(t,e){this.hidePlaceholder(e)},handleBlur:function(t,e){this.updatePlaceholder(e)}}),t.extensions.placeholder=u,c=t.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,sticky:!1,stickyTopOffset:0,updateOnEmptySelection:!1,relativeContainer:null,init:function(){t.Extension.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.relativeContainer?this.relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(t,e){return this.base.extensions.forEach(function(n){if(n!==this)return t.apply(e||this,arguments)},this)},createToolbar:function(){var t=this.document.createElement("div");return t.id="medium-editor-toolbar-"+this.getEditorId(),t.className="medium-editor-toolbar",this.static?t.className+=" static-toolbar":this.relativeContainer?t.className+=" medium-editor-relative-toolbar":t.className+=" medium-editor-stalker-toolbar",t.appendChild(this.createToolbarButtons()),this.forEachExtension(function(e){e.hasForm&&t.appendChild(e.getForm())}),this.attachEventHandlers(),t},createToolbarButtons:function(){var e,n,o,r,i,a,s=this.document.createElement("ul");return s.id="medium-editor-toolbar-actions"+this.getEditorId(),s.className="medium-editor-toolbar-actions",s.style.display="block",this.buttons.forEach(function(o){"string"==typeof o?(i=o,a=null):(i=o.name,a=o),(r=this.base.addBuiltInExtension(i,a))&&"function"==typeof r.getButton&&(n=r.getButton(this.base),e=this.document.createElement("li"),t.util.isElement(n)?e.appendChild(n):e.innerHTML=n,s.appendChild(e))},this),(o=s.querySelectorAll("button")).length>0&&(o[0].classList.add(this.firstButtonClass),o[o.length-1].classList.add(this.lastButtonClass)),s},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getInteractionElements:function(){return this.getToolbarElement()},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=t.util.throttle(function(){this.base.isActive&&this.positionToolbarIfShown()}.bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.static&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(e){if(e&&e.target&&t.util.isDescendant(this.getToolbarElement(),e.target))return!1;this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay(function(){this.showToolbar()}.bind(this))},hideExtensionForms:function(){this.forEachExtension(function(t){t.hasForm&&t.isDisplayed()&&t.hideForm()})},multipleBlockElementsSelected:function(){var e=new RegExp("<("+t.util.blockContainerElementNames.join("|")+")[^>]*>","g"),n=t.selection.getSelectionHtml(this.document).replace(/<[^\/>][^>]*><\/[^>]+>/gim,"").match(e);return!!n&&n.length>1},modifySelection:function(){var e=this.window.getSelection().getRangeAt(0);if(this.standardizeSelectionStart&&e.startContainer.nodeValue&&e.startOffset===e.startContainer.nodeValue.length){var n=t.util.findAdjacentTextNodeWithContent(t.selection.getSelectionElement(this.window),e.startContainer,this.document);if(n){for(var o=0;0===n.nodeValue.substr(o,1).trim().length;)o+=1;e=t.selection.select(this.document,n,o,e.endContainer,e.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||t.selection.selectionInContentEditableFalse(this.window))return this.hideToolbar();var e=t.selection.getSelectionElement(this.window);return!e||-1===this.getEditorElements().indexOf(e)||e.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this.static?this.showAndUpdateToolbar():!t.selection.selectionContainsContent(this.document)||!1===this.allowMultiParagraphSelection&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension(function(t){"function"==typeof t.isActive&&"function"==typeof t.setInactive&&t.setInactive()}),this.checkActiveButtons()},checkActiveButtons:function(){var e,n=[],o=null,r=t.selection.getSelectionRange(this.document),i=function(t){"function"==typeof t.checkState?t.checkState(e):"function"==typeof t.isActive&&"function"==typeof t.isAlreadyApplied&&"function"==typeof t.setActive&&!t.isActive()&&t.isAlreadyApplied(e)&&t.setActive()};if(r&&(this.forEachExtension(function(t){"function"!=typeof t.queryCommandState||null===(o=t.queryCommandState())?n.push(t):o&&"function"==typeof t.setActive&&t.setActive()}),e=t.selection.getSelectedParentElement(r),this.getEditorElements().some(function(n){return t.util.isDescendant(n,e,!0)})))for(;e&&(n.forEach(i),!t.util.isMediumEditorElement(e));)e=e.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var t=this.base.getFocusedElement(),e=this.window.getSelection();if(!t)return this;!this.static&&e.isCollapsed||(this.showToolbar(),this.relativeContainer||(this.static?this.positionStaticToolbar(t):this.positionToolbar(e)),this.trigger("positionedToolbar",{},this.base.getFocusedElement()))},positionStaticToolbar:function(t){this.getToolbarElement().style.left="0";var e,n=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,o=this.window.innerWidth,r=this.getToolbarElement(),i=t.getBoundingClientRect(),a=i.top+n,s=i.left+i.width/2,l=r.offsetHeight,u=r.offsetWidth,c=u/2;switch(this.sticky?n>a+t.offsetHeight-l-this.stickyTopOffset?(r.style.top=a+t.offsetHeight-l+"px",r.classList.remove("medium-editor-sticky-toolbar")):n>a-l-this.stickyTopOffset?(r.classList.add("medium-editor-sticky-toolbar"),r.style.top=this.stickyTopOffset+"px"):(r.classList.remove("medium-editor-sticky-toolbar"),r.style.top=a-l+"px"):r.style.top=a-l+"px",this.align){case"left":e=i.left;break;case"right":e=i.right-u;break;case"center":e=s-c}e<0?e=0:e+u>o&&(e=o-Math.ceil(u)-1),r.style.left=e+"px"},positionToolbar:function(t){this.getToolbarElement().style.left="0",this.getToolbarElement().style.right="initial";var e=t.getRangeAt(0),n=e.getBoundingClientRect();(!n||0===n.height&&0===n.width&&e.startContainer===e.endContainer)&&(n=1===e.startContainer.nodeType&&e.startContainer.querySelector("img")?e.startContainer.querySelector("img").getBoundingClientRect():e.startContainer.getBoundingClientRect());var o,r,i=this.window.innerWidth,a=this.getToolbarElement(),s=a.offsetHeight,l=a.offsetWidth/2,u=this.diffLeft-l,c=this.getEditorOption("elementsContainer"),d=["absolute","fixed"].indexOf(window.getComputedStyle(c).getPropertyValue("position"))>-1,p={},h={};d?(r=c.getBoundingClientRect(),["top","left"].forEach(function(t){h[t]=n[t]-r[t]}),h.width=n.width,h.height=n.height,n=h,i=r.width,p.top=c.scrollTop):p.top=this.window.pageYOffset,o=n.left+n.width/2,p.top+=n.top-s,n.top<50?(a.classList.add("medium-toolbar-arrow-over"),a.classList.remove("medium-toolbar-arrow-under"),p.top+=50+n.height-this.diffTop):(a.classList.add("medium-toolbar-arrow-under"),a.classList.remove("medium-toolbar-arrow-over"),p.top+=this.diffTop),o<l?(p.left=u+l,p.right="initial"):i-o<l?(p.left="auto",p.right=0):(p.left=u+o,p.right="initial"),["top","left","right"].forEach(function(t){a.style[t]=p[t]+(isNaN(p[t])?"":"px")})}}),t.extensions.toolbar=c,d=t.Extension.extend({init:function(){t.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(t){var e="medium-editor-dragover";t.preventDefault(),t.dataTransfer.dropEffect="copy","dragover"===t.type?t.target.classList.add(e):"dragleave"===t.type&&t.target.classList.remove(e)},handleDrop:function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files,0).some(function(e){var n,o;e.type.match("image")&&((n=new FileReader).readAsDataURL(e),o="medium-img-"+ +new Date,t.util.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+o+'" />'),n.onload=function(){var t=this.document.getElementById(o);t&&(t.removeAttribute("id"),t.removeAttribute("class"),t.src=n.result)}.bind(this))}.bind(this)),e.target.classList.remove("medium-editor-dragover")}}),t.extensions.imageDragging=d,function(){function e(e){var n=t.selection.getSelectionStart(this.options.ownerDocument),o=n.textContent,r=t.selection.getCaretOffsets(n);(void 0===o[r.left-1]||""===o[r.left-1].trim()||void 0!==o[r.left]&&""===o[r.left].trim())&&e.preventDefault()}function n(e,n){if(this.options.disableReturn||n.getAttribute("data-disable-return"))e.preventDefault();else if(this.options.disableDoubleReturn||n.getAttribute("data-disable-double-return")){var o=t.selection.getSelectionStart(this.options.ownerDocument);(o&&""===o.textContent.trim()&&"li"!==o.nodeName.toLowerCase()||o.previousElementSibling&&"br"!==o.previousElementSibling.nodeName.toLowerCase()&&""===o.previousElementSibling.textContent.trim())&&e.preventDefault()}}function o(e){var n=t.selection.getSelectionStart(this.options.ownerDocument);"pre"===(n&&n.nodeName.toLowerCase())&&(e.preventDefault(),t.util.insertHTMLCommand(this.options.ownerDocument,"    ")),t.util.isListItem(n)&&(e.preventDefault(),e.shiftKey?this.options.ownerDocument.execCommand("outdent",!1,null):this.options.ownerDocument.execCommand("indent",!1,null))}function r(e){var n,o=t.selection.getSelectionStart(this.options.ownerDocument),r=o.nodeName.toLowerCase(),i=/^(\s+|<br\/?>)?$/i,a=/h\d/i;t.util.isKey(e,[t.util.keyCode.BACKSPACE,t.util.keyCode.ENTER])&&o.previousElementSibling&&a.test(r)&&0===t.selection.getCaretOffsets(o).left?t.util.isKey(e,t.util.keyCode.BACKSPACE)&&i.test(o.previousElementSibling.innerHTML)?(o.previousElementSibling.parentNode.removeChild(o.previousElementSibling),e.preventDefault()):!this.options.disableDoubleReturn&&t.util.isKey(e,t.util.keyCode.ENTER)&&((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",o.previousElementSibling.parentNode.insertBefore(n,o),e.preventDefault()):t.util.isKey(e,t.util.keyCode.DELETE)&&o.nextElementSibling&&o.previousElementSibling&&!a.test(r)&&i.test(o.innerHTML)&&a.test(o.nextElementSibling.nodeName.toLowerCase())?(t.selection.moveCursor(this.options.ownerDocument,o.nextElementSibling),o.previousElementSibling.parentNode.removeChild(o),e.preventDefault()):t.util.isKey(e,t.util.keyCode.BACKSPACE)&&"li"===r&&i.test(o.innerHTML)&&!o.previousElementSibling&&!o.parentElement.previousElementSibling&&o.nextElementSibling&&"li"===o.nextElementSibling.nodeName.toLowerCase()?((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",o.parentElement.parentElement.insertBefore(n,o.parentElement),t.selection.moveCursor(this.options.ownerDocument,n),o.parentElement.removeChild(o),e.preventDefault()):t.util.isKey(e,t.util.keyCode.BACKSPACE)&&!1!==t.util.getClosestTag(o,"blockquote")&&0===t.selection.getCaretOffsets(o).left?(e.preventDefault(),t.util.execFormatBlock(this.options.ownerDocument,"p")):t.util.isKey(e,t.util.keyCode.ENTER)&&!1!==t.util.getClosestTag(o,"blockquote")&&0===t.selection.getCaretOffsets(o).right?((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",o.parentElement.insertBefore(n,o.nextSibling),t.selection.moveCursor(this.options.ownerDocument,n),e.preventDefault()):t.util.isKey(e,t.util.keyCode.BACKSPACE)&&t.util.isMediumEditorElement(o.parentElement)&&!o.previousElementSibling&&o.nextElementSibling&&i.test(o.innerHTML)&&(e.preventDefault(),t.selection.moveCursor(this.options.ownerDocument,o.nextSibling),o.parentElement.removeChild(o))}function i(e){var n=t.selection.getSelectionStart(this.options.ownerDocument);n&&(t.util.isMediumEditorElement(n)&&0===n.children.length&&!t.util.isBlockContainer(n)&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),!t.util.isKey(e,t.util.keyCode.ENTER)||t.util.isListItem(n)||t.util.isBlockContainer(n)||("a"===n.nodeName.toLowerCase()?this.options.ownerDocument.execCommand("unlink",!1,null):e.shiftKey||e.ctrlKey||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function a(t,e){var n=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');n&&(n.value=e.innerHTML.trim())}function s(t){t._mediumEditors||(t._mediumEditors=[null]),this.id||(this.id=t._mediumEditors.length),t._mediumEditors[this.id]=this}function l(t){t._mediumEditors&&t._mediumEditors[this.id]&&(t._mediumEditors[this.id]=null)}function u(e,n,o){var r=[];if(e||(e=[]),"string"==typeof e&&(e=n.querySelectorAll(e)),t.util.isElement(e)&&(e=[e]),o)for(var i=0;i<e.length;i++){var a=e[i];!t.util.isElement(a)||a.getAttribute("data-medium-editor-element")||a.getAttribute("medium-editor-textarea-id")||r.push(a)}else r=Array.prototype.slice.apply(e);return r}function c(t){var e=t.parentNode.querySelector('textarea[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]');e&&(e.classList.remove("medium-editor-hidden"),e.removeAttribute("medium-editor-textarea-id")),t.parentNode&&t.parentNode.removeChild(t)}function d(t,e,n){return"function"==typeof(t=function(t,e){return Object.keys(e).forEach(function(n){void 0===t[n]&&(t[n]=e[n])}),t}(t,{window:n.options.contentWindow,document:n.options.ownerDocument,base:n})).init&&t.init(),t.name||(t.name=e),t}function p(){return!this.elements.every(function(t){return!!t.getAttribute("data-disable-toolbar")})&&!1!==this.options.toolbar}function h(){return!!p.call(this)&&!1!==this.options.anchorPreview}function f(){return!1!==this.options.placeholder}function g(){return!1!==this.options.autoLink}function y(){return!1!==this.options.imageDragging}function v(){return!1!==this.options.keyboardCommands}function m(){return!this.options.extensions.imageDragging}function b(t){for(var e=this.options.ownerDocument.createElement("div"),n=Date.now(),o="medium-editor-"+n,r=t.attributes;this.options.ownerDocument.getElementById(o);)n++,o="medium-editor-"+n;e.className=t.className,e.id=o,e.innerHTML=t.value,t.setAttribute("medium-editor-textarea-id",o);for(var i=0,a=r.length;i<a;i++)e.hasAttribute(r[i].nodeName)||e.setAttribute(r[i].nodeName,r[i].value);return t.form&&this.on(t.form,"reset",function(t){t.defaultPrevented||this.resetContent(this.options.ownerDocument.getElementById(o))}.bind(this)),t.classList.add("medium-editor-hidden"),t.parentNode.insertBefore(e,t),e}function _(e,o){if(!e.getAttribute("data-medium-editor-element")){"textarea"===e.nodeName.toLowerCase()&&(e=b.call(this,e),this.instanceHandleEditableInput||(this.instanceHandleEditableInput=a.bind(this),this.subscribe("editableInput",this.instanceHandleEditableInput))),this.options.disableEditing||e.getAttribute("data-disable-editing")||(e.setAttribute("contentEditable",!0),e.setAttribute("spellcheck",this.options.spellcheck)),this.instanceHandleEditableKeydownEnter||(e.getAttribute("data-disable-return")||e.getAttribute("data-disable-double-return"))&&(this.instanceHandleEditableKeydownEnter=n.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter)),this.options.disableReturn||e.getAttribute("data-disable-return")||this.on(e,"keyup",i.bind(this));var r=t.util.guid();e.setAttribute("data-medium-editor-element",!0),e.classList.add("medium-editor-element"),e.setAttribute("role","textbox"),e.setAttribute("aria-multiline",!0),e.setAttribute("data-medium-editor-editor-index",o),e.setAttribute("medium-editor-index",r),C[r]=e.innerHTML,this.events.attachAllEventsToElement(e)}return e}function x(){this.subscribe("editableKeydownTab",o.bind(this)),this.subscribe("editableKeydownDelete",r.bind(this)),this.subscribe("editableKeydownEnter",r.bind(this)),this.options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",e.bind(this)),this.instanceHandleEditableKeydownEnter||(this.options.disableReturn||this.options.disableDoubleReturn)&&(this.instanceHandleEditableKeydownEnter=n.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter))}function E(){if(this.extensions=[],Object.keys(this.options.extensions).forEach(function(t){"toolbar"!==t&&this.options.extensions[t]&&this.extensions.push(d(this.options.extensions[t],t,this))},this),m.call(this)){var e=this.options.fileDragging;e||(e={},y.call(this)||(e.allowedTypes=[])),this.addBuiltInExtension("fileDragging",e)}var n={paste:!0,"anchor-preview":h.call(this),autoLink:g.call(this),keyboardCommands:v.call(this),placeholder:f.call(this)};Object.keys(n).forEach(function(t){n[t]&&this.addBuiltInExtension(t)},this);var o=this.options.extensions.toolbar;if(!o&&p.call(this)){var r=t.util.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});o=new t.extensions.toolbar(r)}o&&this.extensions.push(d(o,"toolbar",this))}function w(e,n){return n&&[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]].forEach(function(e){n.hasOwnProperty(e[0])&&void 0!==n[e[0]]&&t.util.deprecated(e[0],e[1],"v6.0.0")}),t.util.defaults({},n,e)}function S(e,n){var o,r;if(o=/^append-(.+)$/gi.exec(e))return t.util.execFormatBlock(this.options.ownerDocument,o[1]);if("fontSize"===e)return n.size&&t.util.deprecated(".size option for fontSize command",".value","6.0.0"),r=n.value||n.size,this.options.ownerDocument.execCommand("fontSize",!1,r);if("fontName"===e)return n.name&&t.util.deprecated(".name option for fontName command",".value","6.0.0"),r=n.value||n.name,this.options.ownerDocument.execCommand("fontName",!1,r);if("createLink"===e)return this.createLink(n);if("image"===e){var i=this.options.contentWindow.getSelection().toString().trim();return this.options.ownerDocument.execCommand("insertImage",!1,i)}if("html"===e){var a=this.options.contentWindow.getSelection().toString().trim();return t.util.insertHTMLCommand(this.options.ownerDocument,a)}if(/justify([A-Za-z]*)$/g.exec(e)){var s=this.options.ownerDocument.execCommand(e,!1,null),l=t.selection.getSelectedParentElement(t.selection.getSelectionRange(this.options.ownerDocument));return l&&O.call(this,t.util.getTopBlockContainer(l)),s}return r=n&&n.value,this.options.ownerDocument.execCommand(e,!1,r)}function O(e){if(e){var n,o=Array.prototype.slice.call(e.childNodes).filter(function(t){var e="div"===t.nodeName.toLowerCase();return e&&!n&&(n=t.style.textAlign),e});o.length&&(this.saveSelection(),o.forEach(function(e){if(e.style.textAlign===n){var o=e.lastChild;if(o){t.util.unwrap(e,this.options.ownerDocument);var r=this.options.ownerDocument.createElement("BR");o.parentNode.insertBefore(r,o.nextSibling)}}},this),e.style.textAlign=n,this.restoreSelection())}}var C={};t.prototype={init:function(t,e){return this.options=w.call(this,this.defaults,e),this.origElements=t,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(s.call(this,this.options.contentWindow),this.events=new t.Events(this),this.elements=[],this.addElements(this.origElements),0!==this.elements.length&&(this.isActive=!0,E.call(this),x.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach(function(t){"function"==typeof t.destroy&&t.destroy()},this),this.events.destroy(),this.elements.forEach(function(t){this.options.spellcheck&&(t.innerHTML=t.innerHTML),t.removeAttribute("contentEditable"),t.removeAttribute("spellcheck"),t.removeAttribute("data-medium-editor-element"),t.classList.remove("medium-editor-element"),t.removeAttribute("role"),t.removeAttribute("aria-multiline"),t.removeAttribute("medium-editor-index"),t.removeAttribute("data-medium-editor-editor-index"),t.getAttribute("medium-editor-textarea-id")&&c(t)},this),this.elements=[],this.instanceHandleEditableKeydownEnter=null,this.instanceHandleEditableInput=null,l.call(this,this.options.contentWindow))},on:function(t,e,n,o){return this.events.attachDOMEvent(t,e,n,o),this},off:function(t,e,n,o){return this.events.detachDOMEvent(t,e,n,o),this},subscribe:function(t,e){return this.events.attachCustomEvent(t,e),this},unsubscribe:function(t,e){return this.events.detachCustomEvent(t,e),this},trigger:function(t,e,n){return this.events.triggerCustomEvent(t,e,n),this},delay:function(t){var e=this;return setTimeout(function(){e.isActive&&t()},this.options.delay)},serialize:function(){var t,e={},n=this.elements.length;for(t=0;t<n;t+=1)e[""!==this.elements[t].id?this.elements[t].id:"element-"+t]={value:this.elements[t].innerHTML.trim()};return e},getExtensionByName:function(t){var e;return this.extensions&&this.extensions.length&&this.extensions.some(function(n){return n.name===t&&(e=n,!0)}),e},addBuiltInExtension:function(e,n){var o,r=this.getExtensionByName(e);if(r)return r;switch(e){case"anchor":o=t.util.extend({},this.options.anchor,n),r=new t.extensions.anchor(o);break;case"anchor-preview":r=new t.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":r=new t.extensions.autoLink;break;case"fileDragging":r=new t.extensions.fileDragging(n);break;case"fontname":r=new t.extensions.fontName(this.options.fontName);break;case"fontsize":r=new t.extensions.fontSize(n);break;case"keyboardCommands":r=new t.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":r=new t.extensions.paste(this.options.paste);break;case"placeholder":r=new t.extensions.placeholder(this.options.placeholder);break;default:t.extensions.button.isBuiltInButton(e)&&(n?(o=t.util.defaults({},n,t.extensions.button.prototype.defaults[e]),r=new t.extensions.button(o)):r=new t.extensions.button(e))}return r&&this.extensions.push(d(r,e,this)),r},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var t=this.getExtensionByName("toolbar");return t&&t.checkState(),this},queryCommandState:function(t){var e,n=null;(e=/^full-(.+)$/gi.exec(t))&&(t=e[1]);try{n=this.options.ownerDocument.queryCommandState(t)}catch(o){n=null}return n},execAction:function(e,n){var o,r;return(o=/^full-(.+)$/gi.exec(e))?(this.saveSelection(),this.selectAllContents(),r=S.call(this,o[1],n),this.restoreSelection()):r=S.call(this,e,n),"insertunorderedlist"!==e&&"insertorderedlist"!==e||t.util.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),r},getSelectedParentElement:function(e){return void 0===e&&(e=this.options.contentWindow.getSelection().getRangeAt(0)),t.selection.getSelectedParentElement(e)},selectAllContents:function(){var e=t.selection.getSelectionElement(this.options.contentWindow);if(e){for(;1===e.children.length;)e=e.children[0];this.selectElement(e)}},selectElement:function(e){t.selection.selectNode(e,this.options.ownerDocument);var n=t.selection.getSelectionElement(this.options.contentWindow);n&&this.events.focusElement(n)},getFocusedElement:function(){var t;return this.elements.some(function(e){return!t&&e.getAttribute("data-medium-focused")&&(t=e),!!t},this),t},exportSelection:function(){var e=t.selection.getSelectionElement(this.options.contentWindow),n=this.elements.indexOf(e),o=null;return n>=0&&(o=t.selection.exportSelection(e,this.options.ownerDocument)),null!==o&&0!==n&&(o.editableElementIndex=n),o},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(e,n){if(e){var o=this.elements[e.editableElementIndex||0];t.selection.importSelection(e,o,this.options.ownerDocument,n)}},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(e){var n,o=t.selection.getSelectionElement(this.options.contentWindow),r={};if(-1!==this.elements.indexOf(o)){try{if(this.events.disableCustomEvent("editableInput"),e.url&&t.util.deprecated(".url option for createLink",".value","6.0.0"),(n=e.url||e.value)&&n.trim().length>0){var i=this.options.contentWindow.getSelection();if(i){var a,s,l,u,c=i.getRangeAt(0),d=c.commonAncestorContainer;if(3===c.endContainer.nodeType&&3!==c.startContainer.nodeType&&0===c.startOffset&&c.startContainer.firstChild===c.endContainer&&(d=c.endContainer),s=t.util.getClosestBlockContainer(c.startContainer),l=t.util.getClosestBlockContainer(c.endContainer),3!==d.nodeType&&0!==d.textContent.length&&s===l){var p=s||o,h=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),a=this.exportSelection(),h.appendChild(p.cloneNode(!0)),o===p?t.selection.select(this.options.ownerDocument,p.firstChild,0,p.lastChild,3===p.lastChild.nodeType?p.lastChild.nodeValue.length:p.lastChild.childNodes.length):t.selection.select(this.options.ownerDocument,p,0,p,p.childNodes.length);var f=this.exportSelection();0===(u=t.util.findOrCreateMatchingTextNodes(this.options.ownerDocument,h,{start:a.start-f.start,end:a.end-f.start,editableElementIndex:a.editableElementIndex})).length&&((h=this.options.ownerDocument.createDocumentFragment()).appendChild(d.cloneNode(!0)),u=[h.firstChild.firstChild,h.firstChild.lastChild]),t.util.createLink(this.options.ownerDocument,u,n.trim());var g=(h.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;t.util.insertHTMLCommand(this.options.ownerDocument,h.firstChild.innerHTML.replace(/^\s+/,"")),a.start-=g,a.end-=g,this.importSelection(a)}else this.options.ownerDocument.execCommand("createLink",!1,n);this.options.targetBlank||"_blank"===e.target?t.util.setTargetBlank(t.selection.getSelectionStart(this.options.ownerDocument),n):t.util.removeTargetBlank(t.selection.getSelectionStart(this.options.ownerDocument),n),e.buttonClass&&t.util.addClassToAnchors(t.selection.getSelectionStart(this.options.ownerDocument),e.buttonClass)}}if(this.options.targetBlank||"_blank"===e.target||e.buttonClass){(r=this.options.ownerDocument.createEvent("HTMLEvents")).initEvent("input",!0,!0,this.options.contentWindow);for(var y=0,v=this.elements.length;y<v;y+=1)this.elements[y].dispatchEvent(r)}}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",r,o)}},cleanPaste:function(t){this.getExtensionByName("paste").cleanPaste(t)},pasteHTML:function(t,e){this.getExtensionByName("paste").pasteHTML(t,e)},setContent:function(t,e){if(e=e||0,this.elements[e]){var n=this.elements[e];n.innerHTML=t,this.checkContentChanged(n)}},getContent:function(t){return t=t||0,this.elements[t]?this.elements[t].innerHTML.trim():null},checkContentChanged:function(e){e=e||t.selection.getSelectionElement(this.options.contentWindow),this.events.updateInput(e,{target:e,currentTarget:e})},resetContent:function(t){if(t){var e=this.elements.indexOf(t);-1!==e&&this.setContent(C[t.getAttribute("medium-editor-index")],e)}else this.elements.forEach(function(t,e){this.setContent(C[t.getAttribute("medium-editor-index")],e)},this)},addElements:function(t){var e=u(t,this.options.ownerDocument,!0);if(0===e.length)return!1;e.forEach(function(t){t=_.call(this,t,this.id),this.elements.push(t),this.trigger("addElement",{target:t,currentTarget:t},t)},this)},removeElements:function(t){var e=u(t,this.options.ownerDocument).map(function(t){return t.getAttribute("medium-editor-textarea-id")&&t.parentNode?t.parentNode.querySelector('div[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]'):t});this.elements=this.elements.filter(function(t){return-1===e.indexOf(t)||(this.events.cleanupElement(t),t.getAttribute("medium-editor-textarea-id")&&c(t),this.trigger("removeElement",{target:t,currentTarget:t},t),!1)},this)}},t.getEditorFromElement=function(t){var e=t.getAttribute("data-medium-editor-editor-index"),n=t&&t.ownerDocument&&(t.ownerDocument.defaultView||t.ownerDocument.parentWindow);return n&&n._mediumEditors&&n._mediumEditors[e]?n._mediumEditors[e]:null}}(),t.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableExtraSpaces:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0},t.parseVersionString=function(t){var e=t.split("-"),n=e[0].split("."),o=e.length>1?e[1]:"";return{major:parseInt(n[0],10),minor:parseInt(n[1],10),revision:parseInt(n[2],10),preRelease:o,toString:function(){return[n[0],n[1],n[2]].join(".")+(o?"-"+o:"")}}},t.version=t.parseVersionString.call(this,"5.23.3"),t}(),"undefined"!=typeof process&&process&&process.versions&&process.versions.electron?e.MediumEditor=n:t.exports=n}(Qx)),Qx.exports);const nE=be(eE);var oE=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},rE=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),iE=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(l){r=!0,i=l}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();String.prototype.startsWith=String.prototype.startsWith||function(t){return 0===this.indexOf(t)},String.prototype.padStart=String.prototype.padStart||function(t,e){for(var n=this;n.length<t;)n=e+n;return n};var aE={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function sE(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e>0?t.toFixed(e).replace(/0+$/,"").replace(/\.$/,""):t.toString())||"0"}var lE=function(){function t(e,n,o,r){oE(this,t);var i=this;if(void 0===e);else if(Array.isArray(e))this.rgba=e;else if(void 0===o){var a=e&&""+e;a&&function(e){if(e.startsWith("hsl")){var n=e.match(/([\-\d\.e]+)/g).map(Number),o=iE(n,4),r=o[0],a=o[1],s=o[2],l=o[3];void 0===l&&(l=1),r/=360,a/=100,s/=100,i.hsla=[r,a,s,l]}else if(e.startsWith("rgb")){var u=e.match(/([\-\d\.e]+)/g).map(Number),c=iE(u,4),d=c[0],p=c[1],h=c[2],f=c[3];void 0===f&&(f=1),i.rgba=[d,p,h,f]}else e.startsWith("#")?i.rgba=t.hexToRgb(e):i.rgba=t.nameToRgb(e)||t.hexToRgb(e)}(a.toLowerCase())}else this.rgba=[e,n,o,void 0===r?1:r]}return rE(t,[{key:"printRGB",value:function(t){var e=(t?this.rgba:this.rgba.slice(0,3)).map(function(t,e){return sE(t,3===e?3:0)});return t?"rgba("+e+")":"rgb("+e+")"}},{key:"printHSL",value:function(t){var e=[360,100,100,1],n=["","%","%",""],o=(t?this.hsla:this.hsla.slice(0,3)).map(function(t,o){return sE(t*e[o],3===o?3:1)+n[o]});return t?"hsla("+o+")":"hsl("+o+")"}},{key:"printHex",value:function(t){var e=this.hex;return t?e:e.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=t.hslToRgb(this._hsla)},set:function(t){3===t.length&&(t[3]=1),this._rgba=t,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=t.rgbToHsl(this._rgba)},set:function(t){3===t.length&&(t[3]=1),this._hsla=t,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map(function(t,e){return e<3?t.toString(16):Math.round(255*t).toString(16)}).map(function(t){return t.padStart(2,"0")}).join("")},set:function(e){this.rgba=t.hexToRgb(e)}}],[{key:"hexToRgb",value:function(t){var e=(t.startsWith("#")?t.slice(1):t).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!e.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+t);var n=e.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map(function(t){return parseInt(t,16)});return n[3]=n[3]/255,n}},{key:"nameToRgb",value:function(e){var n=e.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),o=aE[n];return void 0===o?o:t.hexToRgb(o.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(t){var e=iE(t,4),n=e[0],o=e[1],r=e[2],i=e[3];n/=255,o/=255,r/=255;var a=Math.max(n,o,r),s=Math.min(n,o,r),l=void 0,u=void 0,c=(a+s)/2;if(a===s)l=u=0;else{var d=a-s;switch(u=c>.5?d/(2-a-s):d/(a+s),a){case n:l=(o-r)/d+(o<r?6:0);break;case o:l=(r-n)/d+2;break;case r:l=(n-o)/d+4}l/=6}return[l,u,c,i]}},{key:"hslToRgb",value:function(t){var e=iE(t,4),n=e[0],o=e[1],r=e[2],i=e[3],a=void 0,s=void 0,l=void 0;if(0===o)a=s=l=r;else{var u=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},c=r<.5?r*(1+o):r+o-r*o,d=2*r-c;a=u(d,c,n+1/3),s=u(d,c,n),l=u(d,c,n-1/3)}var p=[255*a,255*s,255*l].map(Math.round);return p[3]=i,p}}]),t}(),uE=function(){function t(){oE(this,t),this._events=[]}return rE(t,[{key:"add",value:function(t,e,n){t.addEventListener(e,n,!1),this._events.push({target:t,type:e,handler:n})}},{key:"remove",value:function(e,n,o){this._events=this._events.filter(function(r){var i=!0;return e&&e!==r.target&&(i=!1),n&&n!==r.type&&(i=!1),o&&o!==r.handler&&(i=!1),i&&t._doRemove(r.target,r.type,r.handler),!i})}},{key:"destroy",value:function(){this._events.forEach(function(e){return t._doRemove(e.target,e.type,e.handler)}),this._events=[]}}],[{key:"_doRemove",value:function(t,e,n){t.removeEventListener(e,n,!1)}}]),t}();function cE(t,e,n){var o=!1;function r(t,e,n){return Math.max(e,Math.min(t,n))}function i(t,i,a){if(a&&(o=!0),o){t.preventDefault();var s=e.getBoundingClientRect(),l=s.width,u=s.height,c=i.clientX,d=i.clientY,p=r(c-s.left,0,l),h=r(d-s.top,0,u);n(p/l,h/u)}}function a(t,e){1===(void 0===t.buttons?t.which:t.buttons)?i(t,t,e):o=!1}function s(t,e){1===t.touches.length?i(t,t.touches[0],e):o=!1}t.add(e,"mousedown",function(t){a(t,!0)}),t.add(e,"touchstart",function(t){s(t,!0)}),t.add(window,"mousemove",a),t.add(e,"touchmove",s),t.add(window,"mouseup",function(t){o=!1}),t.add(e,"touchend",function(t){o=!1}),t.add(e,"touchcancel",function(t){o=!1})}var dE="keydown",pE="mousedown",hE="focusin";function fE(t,e){return(e||document).querySelector(t)}function gE(t,e,n,o,r){t.add(e,dE,function(t){n.indexOf(t.key)>=0&&o(t)})}var yE=function(){function t(e){oE(this,t),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new uE,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(e)}return rE(t,[{key:"setOptions",value:function(t){var e=this;if(t){var n=this.settings;if(t instanceof HTMLElement)n.parent=t;else{n.parent&&t.parent&&n.parent!==t.parent&&(this._events.remove(n.parent),this._popupInited=!1),function(t,e){for(var n in t)e[n]=t[n]}(t,n),t.onChange&&(this.onChange=t.onChange),t.onDone&&(this.onDone=t.onDone),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose);var o=t.color||t.colour;o&&this._setColor(o)}var r=n.parent;if(r&&n.popup&&!this._popupInited){var i=function(t){return e.openHandler(t)};this._events.add(r,"click",i),gE(this._events,r,[" ","Spacebar","Enter"],i),this._popupInited=!0}else t.parent&&!n.popup&&this.show()}}},{key:"openHandler",value:function(t){if(this.show()){t&&t.preventDefault(),this.settings.parent.style.pointerEvents="none";var e=t&&t.type===dE?this._domEdit:this.domElement;setTimeout(function(){return e.focus()},100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(t){var e=t&&t.type,n=!1;if(t)if(e===pE||e===hE){var o=(this.__containedEvent||0)+100;t.timeStamp>o&&(n=!0)}else!function(t){t.preventDefault(),t.stopPropagation()}(t),n=!0;else n=!0;n&&this.hide()&&(this.settings.parent.style.pointerEvents="",e!==pE&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(t,e){this.closeHandler(),this.setOptions(t),e&&this.openHandler()}},{key:"setColor",value:function(t,e){this._setColor(t,{silent:e})}},{key:"_setColor",value:function(t,e){if("string"==typeof t&&(t=t.trim()),t){e=e||{};var n=void 0;try{n=new lE(t)}catch(r){if(e.failSilently)return;throw r}if(!this.settings.alpha){var o=n.hsla;o[3]=1,n.hsla=o}this.colour=this.color=n,this._setHSLA(null,null,null,null,e)}}},{key:"setColour",value:function(t,e){this.setColor(t,e)}},{key:"show",value:function(){if(!this.settings.parent)return!1;if(this.domElement){var t=this._toggleDOM(!0);return this._setPosition(),t}var e,n,o=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',r=(e=o,(n=document.createElement("div")).innerHTML=e,n.firstElementChild);return this.domElement=r,this._domH=fE(".picker_hue",r),this._domSL=fE(".picker_sl",r),this._domA=fE(".picker_alpha",r),this._domEdit=fE(".picker_editor input",r),this._domSample=fE(".picker_sample",r),this._domOkay=fE(".picker_done button",r),this._domCancel=fE(".picker_cancel button",r),r.classList.add("layout_"+this.settings.layout),this.settings.alpha||r.classList.add("no_alpha"),this.settings.editor||r.classList.add("no_editor"),this.settings.cancelButton||r.classList.add("no_cancel"),this._ifPopup(function(){return r.classList.add("popup")}),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var t=this,e=this,n=this.domElement,o=this._events;function r(t,e,n){o.add(t,e,n)}r(n,"click",function(t){return t.preventDefault()}),cE(o,this._domH,function(t,n){return e._setHSLA(t)}),cE(o,this._domSL,function(t,n){return e._setHSLA(null,t,1-n)}),this.settings.alpha&&cE(o,this._domA,function(t,n){return e._setHSLA(null,null,null,1-n)});var i=this._domEdit;r(i,"input",function(t){e._setColor(this.value,{fromEditor:!0,failSilently:!0})}),r(i,"focus",function(t){var e=this;e.selectionStart===e.selectionEnd&&e.select()}),this._ifPopup(function(){var e=function(e){return t.closeHandler(e)};r(window,pE,e),r(window,hE,e),gE(o,n,["Esc","Escape"],e);var i=function(e){t.__containedEvent=e.timeStamp};r(n,pE,i),r(n,hE,i),r(t._domCancel,"click",e)});var a=function(e){t._ifPopup(function(){return t.closeHandler(e)}),t.onDone&&t.onDone(t.colour)};r(this._domOkay,"click",a),gE(o,n,["Enter"],a)}},{key:"_setPosition",value:function(){var t=this.settings.parent,e=this.domElement;t!==e.parentNode&&t.appendChild(e),this._ifPopup(function(n){"static"===getComputedStyle(t).position&&(t.style.position="relative");var o=!0===n?"popup_right":"popup_"+n;["popup_top","popup_bottom","popup_left","popup_right"].forEach(function(t){t===o?e.classList.add(t):e.classList.remove(t)}),e.classList.add(o)})}},{key:"_setHSLA",value:function(t,e,n,o,r){r=r||{};var i=this.colour,a=i.hsla;[t,e,n,o].forEach(function(t,e){(t||0===t)&&(a[e]=t)}),i.hsla=a,this._updateUI(r),this.onChange&&!r.silent&&this.onChange(i)}},{key:"_updateUI",value:function(t){if(this.domElement){t=t||{};var e=this.colour,n=e.hsla,o="hsl("+360*n[0]+", 100%, 50%)",r=e.hslString,i=e.hslaString,a=this._domH,s=this._domSL,l=this._domA,u=fE(".picker_selector",a),c=fE(".picker_selector",s),d=fE(".picker_selector",l);m(0,u,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=o,m(0,c,n[1]),b(0,c,1-n[2]),s.style.color=r,b(0,d,1-n[3]);var p=r,h=p.replace("hsl","hsla").replace(")",", 0)"),f="linear-gradient("+[p,h]+")";if(this._domA.style.background=f+", linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",!t.fromEditor){var g=this.settings.editorFormat,y=this.settings.alpha,v=void 0;switch(g){case"rgb":v=e.printRGB(y);break;case"hsl":v=e.printHSL(y);break;default:v=e.printHex(y)}this._domEdit.value=v}this._domSample.style.color=i}function m(t,e,n){e.style.left=100*n+"%"}function b(t,e,n){e.style.top=100*n+"%"}}},{key:"_ifPopup",value:function(t,e){this.settings.parent&&this.settings.popup?t&&t(this.settings.popup):e&&e()}},{key:"_toggleDOM",value:function(t){var e=this.domElement;if(!e)return!1;var n=t?"":"none",o=e.style.display!==n;return o&&(e.style.display=n),o}}]),t}(),vE=document.createElement("style");vE.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(vE),yE.StyleElement=vE;var mE,bE={exports:{}};function _E(){return mE||(mE=1,bE.exports=function(){var t="object",e="function",n="undefined",o=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],r=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],i=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],a=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function s(n,o){var r=typeof n[o];return r==e||!(r!=t||!n[o])||"unknown"==r}function l(e,n){return!(typeof e[n]!=t||!e[n])}function u(t,e){return typeof t[e]!=n}function c(t){return function(e,n){for(var o=n.length;o--;)if(!t(e,n[o]))return!1;return!0}}var d=c(s),p=c(l),h=c(u);function f(t){return t&&d(t,a)&&h(t,i)}function g(t){return l(t,"body")?t.body:t.getElementsByTagName("body")[0]}var y,v,m={},b=typeof window!=n&&typeof document!=n,_={isHostMethod:s,isHostObject:l,isHostProperty:u,areHostMethods:d,areHostObjects:p,areHostProperties:h,isTextRange:f,getBody:g,forEach:[].forEach?function(t,e){t.forEach(e)}:function(t,e){for(var n=0,o=t.length;n<o;++n)e(t[n],n)}},x={version:"1.3.2",initialized:!1,isBrowser:b,supported:!0,util:_,features:{},modules:m,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==n||rangyAutoInitialize}};function E(t){typeof console!=n&&s(console,"log")&&console.log(t)}function w(t,e){b&&e?alert(t):E(t)}function S(t){x.initialized=!0,x.supported=!1,w("Rangy is not supported in this environment. Reason: "+t,x.config.alertOnFail)}function O(t){w("Rangy warning: "+t,x.config.alertOnWarn)}x.fail=S,x.warn=O,{}.hasOwnProperty?(_.extend=y=function(t,e,n){var o,r;for(var i in e)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&e.hasOwnProperty(i)&&(o=t[i],r=e[i],n&&null!==o&&"object"==typeof o&&null!==r&&"object"==typeof r&&y(o,r,!0),t[i]=r);return e.hasOwnProperty("toString")&&(t.toString=e.toString),t},_.createOptions=function(t,e){var n={};return y(n,e),t&&y(n,t),n}):S("hasOwnProperty not supported"),b||S("Rangy can only run in a browser"),function(){var t;if(b){var e=document.createElement("div");e.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(t){return n.call(t,0)})}catch(o){}}t||(t=function(t){for(var e=[],n=0,o=t.length;n<o;++n)e[n]=t[n];return e}),_.toArray=t}(),b&&(s(document,"addEventListener")?v=function(t,e,n){t.addEventListener(e,n,!1)}:s(document,"attachEvent")?v=function(t,e,n){t.attachEvent("on"+e,n)}:S("Document does not have required addEventListener or attachEvent method"),_.addListener=v);var C=[];function T(t){return t.message||t.description||String(t)}function M(){if(b&&!x.initialized){var t,e=!1,n=!1;s(document,"createRange")&&(t=document.createRange(),d(t,r)&&h(t,o)&&(e=!0));var i=g(document);if(i&&"body"==i.nodeName.toLowerCase())if(i&&s(i,"createTextRange")&&f(t=i.createTextRange())&&(n=!0),e||n){var a;for(var l in x.initialized=!0,x.features={implementsDomRange:e,implementsTextRange:n},m)(a=m[l])instanceof k&&a.init(a,x);for(var u=0,c=C.length;u<c;++u)try{C[u](x)}catch(p){E("Rangy init listener threw an exception. Continuing. Detail: "+T(p))}}else S("Neither Range nor TextRange are available");else S("No body element found")}}function N(t,e,n){n&&(t+=" in module "+n.name),x.warn("DEPRECATED: "+t+" is deprecated. Please use "+e+" instead.")}function A(t,e,n,o){t[e]=function(){return N(e,n,o),t[n].apply(t,_.toArray(arguments))}}_.deprecationNotice=N,_.createAliasForDeprecatedMethod=A,x.init=M,x.addInitListener=function(t){x.initialized?t(x):C.push(t)};var P=[];function D(t){t=t||window,M();for(var e=0,n=P.length;e<n;++e)P[e](t)}function k(t,e,n){this.name=t,this.dependencies=e,this.initialized=!1,this.supported=!1,this.initializer=n}function R(t,e,n){var o=new k(t,e,function(e){if(!e.initialized){e.initialized=!0;try{n(x,e),e.supported=!0}catch(o){E("Module '"+t+"' failed to load: "+T(o)),o.stack&&E(o.stack)}}});return m[t]=o,o}function L(){}function I(){}x.addShimListener=function(t){P.push(t)},b&&(x.shim=x.createMissingNativeApi=D,A(x,"createMissingNativeApi","shim")),k.prototype={init:function(){for(var t,e,n=this.dependencies||[],o=0,r=n.length;o<r;++o){if(e=n[o],!((t=m[e])&&t instanceof k))throw new Error("required module '"+e+"' not found");if(t.init(),!t.supported)throw new Error("required module '"+e+"' not supported")}this.initializer(this)},fail:function(t){throw this.initialized=!0,this.supported=!1,new Error(t)},warn:function(t){x.warn("Module "+this.name+": "+t)},deprecationNotice:function(t,e){x.warn("DEPRECATED: "+t+" in module "+this.name+" is deprecated. Please use "+e+" instead")},createError:function(t){return new Error("Error in Rangy "+this.name+" module: "+t)}},x.createModule=function(t){var e,n;2==arguments.length?(e=arguments[1],n=[]):(e=arguments[2],n=arguments[1]);var o=R(t,n,e);x.initialized&&x.supported&&o.init()},x.createCoreModule=function(t,e,n){R(t,e,n)},x.RangePrototype=L,x.rangePrototype=new L,x.selectionPrototype=new I,x.createCoreModule("DomUtil",[],function(t,e){var n="undefined",o=t.util,r=o.getBody;o.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||e.fail("document missing a Node creation method"),o.isHostMethod(document,"getElementsByTagName")||e.fail("document missing getElementsByTagName method");var i=document.createElement("div");o.areHostMethods(i,["insertBefore","appendChild","cloneNode"])||e.fail("Incomplete Element implementation"),o.isHostProperty(i,"innerHTML")||e.fail("Element is missing innerHTML property");var a=document.createTextNode("test");o.areHostMethods(a,["splitText","deleteData","insertData","appendData","cloneNode"])||e.fail("Incomplete Text Node implementation");var s=function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1};function l(t){var e;return typeof t.namespaceURI==n||null===(e=t.namespaceURI)||"http://www.w3.org/1999/xhtml"==e}function u(t){var e=t.parentNode;return 1==e.nodeType?e:null}function c(t){for(var e=0;t=t.previousSibling;)++e;return e}function d(t){switch(t.nodeType){case 7:case 10:return 0;case 3:case 8:return t.length;default:return t.childNodes.length}}function p(t,e){var n,o=[];for(n=t;n;n=n.parentNode)o.push(n);for(n=e;n;n=n.parentNode)if(s(o,n))return n;return null}function h(t,e,n){for(var o=n?e:e.parentNode;o;){if(o===t)return!0;o=o.parentNode}return!1}function f(t,e){return h(t,e,!0)}function g(t,e,n){for(var o,r=n?t:t.parentNode;r;){if((o=r.parentNode)===e)return r;r=o}return null}function y(t){var e=t.nodeType;return 3==e||4==e||8==e}function v(t){if(!t)return!1;var e=t.nodeType;return 3==e||8==e}function m(t,e){var n=e.nextSibling,o=e.parentNode;return n?o.insertBefore(t,n):o.appendChild(t),t}function b(t,e,n){var o=t.cloneNode(!1);if(o.deleteData(0,e),t.deleteData(e,t.length-e),m(o,t),n)for(var r,i=0;r=n[i++];)r.node==t&&r.offset>e?(r.node=o,r.offset-=e):r.node==t.parentNode&&r.offset>c(t)&&++r.offset;return o}function _(t){if(9==t.nodeType)return t;if(typeof t.ownerDocument!=n)return t.ownerDocument;if(typeof t.document!=n)return t.document;if(t.parentNode)return _(t.parentNode);throw e.createError("getDocument: no document found for node")}function x(t){var o=_(t);if(typeof o.defaultView!=n)return o.defaultView;if(typeof o.parentWindow!=n)return o.parentWindow;throw e.createError("Cannot get a window object for node")}function E(t){if(typeof t.contentDocument!=n)return t.contentDocument;if(typeof t.contentWindow!=n)return t.contentWindow.document;throw e.createError("getIframeDocument: No Document object found for iframe element")}function w(t){if(typeof t.contentWindow!=n)return t.contentWindow;if(typeof t.contentDocument!=n)return t.contentDocument.defaultView;throw e.createError("getIframeWindow: No Window object found for iframe element")}function S(t){return t&&o.isHostMethod(t,"setTimeout")&&o.isHostObject(t,"document")}function O(t,e,n){var r;if(t?o.isHostProperty(t,"nodeType")?r=1==t.nodeType&&"iframe"==t.tagName.toLowerCase()?E(t):_(t):S(t)&&(r=t.document):r=document,!r)throw e.createError(n+"(): Parameter must be a Window object or DOM node");return r}function C(t){for(var e;e=t.parentNode;)t=e;return t}function T(t,n,o,r){var i,a,s,l,u;if(t==o)return n===r?0:n<r?-1:1;if(i=g(o,t,!0))return n<=c(i)?-1:1;if(i=g(t,o,!0))return c(i)<r?-1:1;if(!(a=p(t,o)))throw new Error("comparePoints error: nodes have no common ancestor");if((s=t===a?a:g(t,a,!0))===(l=o===a?a:g(o,a,!0)))throw e.createError("comparePoints got to case 4 and childA and childB are the same!");for(u=a.firstChild;u;){if(u===s)return-1;if(u===l)return 1;u=u.nextSibling}}var M,N=!1;function A(t){try{return t.parentNode,!1}catch(e){return!0}}function P(t){if(!t)return"[No node]";if(N&&A(t))return"[Broken node]";if(y(t))return'"'+t.data+'"';if(1==t.nodeType){var e=t.id?' id="'+t.id+'"':"";return"<"+t.nodeName+e+">[index:"+c(t)+",length:"+t.childNodes.length+"]["+(t.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return t.nodeName}function D(t){for(var e,n=_(t).createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n}function k(t,e,n){var o=r(t),i=t.createElement("div");i.contentEditable=""+!!n,e&&(i.innerHTML=e);var a=o.firstChild;return a?o.insertBefore(i,a):o.appendChild(i),i}function R(t){return t.parentNode.removeChild(t)}function L(t){this.root=t,this._next=t}function I(t){return new L(t)}function j(t,e){this.node=t,this.offset=e}function B(t){this.code=this[t],this.codeName=t,this.message="DOMException: "+this.codeName}!function(){var e=document.createElement("b");e.innerHTML="1";var n=e.firstChild;e.innerHTML="<br />",N=A(n),t.features.crashyTextNodes=N}(),typeof window.getComputedStyle!=n?M=function(t,e){return x(t).getComputedStyle(t,null)[e]}:typeof document.documentElement.currentStyle!=n?M=function(t,e){return t.currentStyle?t.currentStyle[e]:""}:e.fail("No means of obtaining computed style properties found"),L.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var t,e,n=this._current=this._next;if(this._current)if(t=n.firstChild)this._next=t;else{for(e=null;n!==this.root&&!(e=n.nextSibling);)n=n.parentNode;this._next=e}return this._current},detach:function(){this._current=this._next=this.root=null}},j.prototype={equals:function(t){return!!t&&this.node===t.node&&this.offset==t.offset},inspect:function(){return"[DomPosition("+P(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},B.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},B.prototype.toString=function(){return this.message},t.dom={arrayContains:s,isHtmlNamespace:l,parentElement:u,getNodeIndex:c,getNodeLength:d,getCommonAncestor:p,isAncestorOf:h,isOrIsAncestorOf:f,getClosestAncestorIn:g,isCharacterDataNode:y,isTextOrCommentNode:v,insertAfter:m,splitDataNode:b,getDocument:_,getWindow:x,getIframeWindow:w,getIframeDocument:E,getBody:r,isWindow:S,getContentDocument:O,getRootContainer:C,comparePoints:T,isBrokenNode:A,inspectNode:P,getComputedStyleProperty:M,createTestElement:k,removeNode:R,fragmentFromNodeChildren:D,createIterator:I,DomPosition:j},t.DOMException=B}),x.createCoreModule("DomRange",["DomUtil"],function(t,e){var n=t.dom,o=t.util,r=n.DomPosition,i=t.DOMException,a=n.isCharacterDataNode,s=n.getNodeIndex,l=n.isOrIsAncestorOf,u=n.getDocument,c=n.comparePoints,d=n.splitDataNode,p=n.getClosestAncestorIn,h=n.getNodeLength,f=n.arrayContains,g=n.getRootContainer,y=t.features.crashyTextNodes,v=n.removeNode;function m(t,e){return 3!=t.nodeType&&(l(t,e.startContainer)||l(t,e.endContainer))}function b(t){return t.document||u(t.startContainer)}function _(t){return g(t.startContainer)}function x(t){return new r(t.parentNode,s(t))}function E(t){return new r(t.parentNode,s(t)+1)}function w(t,e,o){var r=11==t.nodeType?t.firstChild:t;return a(e)?o==e.length?n.insertAfter(t,e):e.parentNode.insertBefore(t,0==o?e:d(e,o)):o>=e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[o]),r}function S(t,e,n){if(Z(t),Z(e),b(e)!=b(t))throw new i("WRONG_DOCUMENT_ERR");var o=c(t.startContainer,t.startOffset,e.endContainer,e.endOffset),r=c(t.endContainer,t.endOffset,e.startContainer,e.startOffset);return n?o<=0&&r>=0:o<0&&r>0}function O(t){for(var e,n,o,r=b(t.range).createDocumentFragment();n=t.next();){if(e=t.isPartiallySelectedSubtree(),n=n.cloneNode(!e),e&&(o=t.getSubtreeIterator(),n.appendChild(O(o)),o.detach()),10==n.nodeType)throw new i("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function C(t,e,o){var r,i,a,s;for(o=o||{stop:!1};a=t.next();)if(t.isPartiallySelectedSubtree()){if(!1===e(a))return void(o.stop=!0);if(C(s=t.getSubtreeIterator(),e,o),s.detach(),o.stop)return}else for(r=n.createIterator(a);i=r.next();)if(!1===e(i))return void(o.stop=!0)}function T(t){for(var e;t.next();)t.isPartiallySelectedSubtree()?(T(e=t.getSubtreeIterator()),e.detach()):t.remove()}function M(t){for(var e,n,o=b(t.range).createDocumentFragment();e=t.next();){if(t.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),n=t.getSubtreeIterator(),e.appendChild(M(n)),n.detach()):t.remove(),10==e.nodeType)throw new i("HIERARCHY_REQUEST_ERR");o.appendChild(e)}return o}function N(t,e,n){var o,r=!(!e||!e.length),i=!!n;r&&(o=new RegExp("^("+e.join("|")+")$"));var s=[];return C(new P(t,!1),function(e){if((!r||o.test(e.nodeType))&&(!i||n(e))){var l=t.startContainer;if(e!=l||!a(l)||t.startOffset!=l.length){var u=t.endContainer;e==u&&a(u)&&0==t.endOffset||s.push(e)}}}),s}function A(t){return"["+(void 0===t.getName?"Range":t.getName())+"("+n.inspectNode(t.startContainer)+":"+t.startOffset+", "+n.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function P(t,e){if(this.range=t,this.clonePartiallySelectedTextNodes=e,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var n=t.commonAncestorContainer;this.sc===this.ec&&a(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||a(this.sc)?p(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||a(this.ec)?p(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}P.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,a(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t,e,n=this._current;!a(n)||n!==this.sc&&n!==this.ec?n.parentNode&&v(n):(t=n===this.sc?this.so:0)!=(e=n===this.ec?this.eo:n.length)&&n.deleteData(t,e-t)},isPartiallySelectedSubtree:function(){return m(this._current,this.range)},getSubtreeIterator:function(){var t;if(this.isSingleCharacterDataNode)(t=this.range.cloneRange()).collapse(!1);else{t=new vt(b(this.range));var e=this._current,n=e,o=0,r=e,i=h(e);l(e,this.sc)&&(n=this.sc,o=this.so),l(e,this.ec)&&(r=this.ec,i=this.eo),yt(t,n,o,r,i)}return new P(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var D=[1,3,4,5,7,8,10],k=[2,9,11],R=[5,6,10,12],L=[1,3,4,5,7,8,10,11],I=[1,3,4,5,7,8];function j(t){return function(e,n){for(var o,r=n?e:e.parentNode;r;){if(o=r.nodeType,f(t,o))return r;r=r.parentNode}return null}}var B=j([9,11]),H=j(R),z=j([6,10,12]),F=j([1]);function W(t,e){if(z(t,e))throw new i("INVALID_NODE_TYPE_ERR")}function X(t,e){if(!f(e,t.nodeType))throw new i("INVALID_NODE_TYPE_ERR")}function U(t,e){if(e<0||e>(a(t)?t.length:t.childNodes.length))throw new i("INDEX_SIZE_ERR")}function G(t,e){if(B(t,!0)!==B(e,!0))throw new i("WRONG_DOCUMENT_ERR")}function Y(t){if(H(t,!0))throw new i("NO_MODIFICATION_ALLOWED_ERR")}function V(t,e){if(!t)throw new i(e)}function K(t,e){return e<=(a(t)?t.length:t.childNodes.length)}function q(t){return!!t.startContainer&&!!t.endContainer&&!(y&&(n.isBrokenNode(t.startContainer)||n.isBrokenNode(t.endContainer)))&&g(t.startContainer)==g(t.endContainer)&&K(t.startContainer,t.startOffset)&&K(t.endContainer,t.endOffset)}function Z(t){if(!q(t))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+t.inspect()+")")}var $=document.createElement("style"),J=!1;try{$.innerHTML="<b>x</b>",J=3==$.firstChild.nodeType}catch(mt){}t.features.htmlParsingConforms=J;var Q=J?function(t){var e=this.startContainer,o=u(e);if(!e)throw new i("INVALID_STATE_ERR");var r=null;return 1==e.nodeType?r=e:a(e)&&(r=n.parentElement(e)),(r=null===r||"HTML"==r.nodeName&&n.isHtmlNamespace(u(r).documentElement)&&n.isHtmlNamespace(r)?o.createElement("body"):r.cloneNode(!1)).innerHTML=t,n.fragmentFromNodeChildren(r)}:function(t){var e=b(this).createElement("body");return e.innerHTML=t,n.fragmentFromNodeChildren(e)};function tt(t,e){Z(t);var n=t.startContainer,o=t.startOffset,r=t.endContainer,i=t.endOffset,l=n===r;a(r)&&i>0&&i<r.length&&d(r,i,e),a(n)&&o>0&&o<n.length&&(n=d(n,o,e),l?(i-=o,r=n):r==n.parentNode&&i>=s(n)&&i++,o=0),t.setStartAndEnd(n,o,r,i)}function et(t){Z(t);var e=t.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(t.cloneContents()),e.innerHTML}var nt=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ot=0,rt=1,it=2,at=3,st=0,lt=1,ut=2,ct=3;function dt(t){t.START_TO_START=ot,t.START_TO_END=rt,t.END_TO_END=it,t.END_TO_START=at,t.NODE_BEFORE=st,t.NODE_AFTER=lt,t.NODE_BEFORE_AND_AFTER=ut,t.NODE_INSIDE=ct}function pt(t){dt(t),dt(t.prototype)}function ht(t,e){return function(){Z(this);var n,o=this.startContainer,r=this.startOffset,i=this.commonAncestorContainer,a=new P(this,!0);o!==i&&(o=(n=E(p(o,i,!0))).node,r=n.offset),C(a,Y),a.reset();var s=t(a);return a.detach(),e(this,o,r,o,r),s}}function ft(e,n){function r(t,e){return function(n){X(n,D),X(g(n),k);var o=(t?x:E)(n);(e?i:l)(this,o.node,o.offset)}}function i(t,e,o){var r=t.endContainer,i=t.endOffset;e===t.startContainer&&o===t.startOffset||(g(e)==g(r)&&1!=c(e,o,r,i)||(r=e,i=o),n(t,e,o,r,i))}function l(t,e,o){var r=t.startContainer,i=t.startOffset;e===t.endContainer&&o===t.endOffset||(g(e)==g(r)&&-1!=c(e,o,r,i)||(r=e,i=o),n(t,r,i,e,o))}var u=function(){};u.prototype=t.rangePrototype,e.prototype=new u,o.extend(e.prototype,{setStart:function(t,e){W(t,!0),U(t,e),i(this,t,e)},setEnd:function(t,e){W(t,!0),U(t,e),l(this,t,e)},setStartAndEnd:function(){var t=arguments,e=t[0],o=t[1],r=e,i=o;switch(t.length){case 3:i=t[2];break;case 4:r=t[2],i=t[3]}W(e,!0),U(e,o),W(r,!0),U(r,i),n(this,e,o,r,i)},setBoundary:function(t,e,n){this["set"+(n?"Start":"End")](t,e)},setStartBefore:r(!0,!0),setStartAfter:r(!1,!0),setEndBefore:r(!0,!1),setEndAfter:r(!1,!1),collapse:function(t){Z(this),t?n(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):n(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(t){W(t,!0),n(this,t,0,t,h(t))},selectNode:function(t){W(t,!1),X(t,D);var e=x(t),o=E(t);n(this,e.node,e.offset,o.node,o.offset)},extractContents:ht(M,n),deleteContents:ht(T,n),canSurroundContents:function(){Z(this),Y(this.startContainer),Y(this.endContainer);var t=new P(this,!0),e=t._first&&m(t._first,this)||t._last&&m(t._last,this);return t.detach(),!e},splitBoundaries:function(){tt(this)},splitBoundariesPreservingPositions:function(t){tt(this,t)},normalizeBoundaries:function(){Z(this);var t,e=this.startContainer,o=this.startOffset,r=this.endContainer,i=this.endOffset,l=function(t){var e=t.nextSibling;e&&e.nodeType==t.nodeType&&(r=t,i=t.length,t.appendData(e.data),v(e))},u=function(t){var n=t.previousSibling;if(n&&n.nodeType==t.nodeType){e=t;var a=t.length;if(o=n.length,t.insertData(0,n.data),v(n),e==r)i+=o,r=e;else if(r==t.parentNode){var l=s(t);i==l?(r=t,i=a):i>l&&i--}}},c=!0;if(a(r))i==r.length?l(r):0==i&&(t=r.previousSibling)&&t.nodeType==r.nodeType&&(i=t.length,e==r&&(c=!1),t.appendData(r.data),v(r),r=t);else{if(i>0){var d=r.childNodes[i-1];d&&a(d)&&l(d)}c=!this.collapsed}if(c){if(a(e))0==o?u(e):o==e.length&&(t=e.nextSibling)&&t.nodeType==e.nodeType&&(r==t&&(r=e,i+=e.length),e.appendData(t.data),v(t));else if(o<e.childNodes.length){var p=e.childNodes[o];p&&a(p)&&u(p)}}else e=r,o=i;n(this,e,o,r,i)},collapseToPoint:function(t,e){W(t,!0),U(t,e),this.setStartAndEnd(t,e)},parentElement:function(){return Z(this),this.commonAncestorContainer?F(this.commonAncestorContainer,!0):null}}),pt(e)}function gt(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:n.getCommonAncestor(t.startContainer,t.endContainer)}function yt(t,e,o,r,i){t.startContainer=e,t.startOffset=o,t.endContainer=r,t.endOffset=i,t.document=n.getDocument(e),gt(t)}function vt(t){yt(this,t,0,t,0)}o.extend(t.rangePrototype,{compareBoundaryPoints:function(t,e){var n,o,r,i;Z(this),G(this.startContainer,e.startContainer);var a=t==at||t==ot?"start":"end",s=t==rt||t==ot?"start":"end";return n=this[a+"Container"],o=this[a+"Offset"],r=e[s+"Container"],i=e[s+"Offset"],c(n,o,r,i)},insertNode:function(t){if(Z(this),X(t,L),Y(this.startContainer),l(t,this.startContainer))throw new i("HIERARCHY_REQUEST_ERR");var e=w(t,this.startContainer,this.startOffset);this.setStartBefore(e)},cloneContents:function(){var t,e;if(Z(this),this.collapsed)return b(this).createDocumentFragment();if(this.startContainer===this.endContainer&&a(this.startContainer))return(t=this.startContainer.cloneNode(!0)).data=t.data.slice(this.startOffset,this.endOffset),(e=b(this).createDocumentFragment()).appendChild(t),e;var n=new P(this,!0);return t=O(n),n.detach(),t},canSurroundContents:function(){Z(this),Y(this.startContainer),Y(this.endContainer);var t=new P(this,!0),e=t._first&&m(t._first,this)||t._last&&m(t._last,this);return t.detach(),!e},surroundContents:function(t){if(X(t,I),!this.canSurroundContents())throw new i("INVALID_STATE_ERR");var e=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);w(t,this.startContainer,this.startOffset),t.appendChild(e),this.selectNode(t)},cloneRange:function(){Z(this);for(var t,e=new vt(b(this)),n=nt.length;n--;)e[t=nt[n]]=this[t];return e},toString:function(){Z(this);var t=this.startContainer;if(t===this.endContainer&&a(t))return 3==t.nodeType||4==t.nodeType?t.data.slice(this.startOffset,this.endOffset):"";var e=[],n=new P(this,!0);return C(n,function(t){3!=t.nodeType&&4!=t.nodeType||e.push(t.data)}),n.detach(),e.join("")},compareNode:function(t){Z(this);var e=t.parentNode,n=s(t);if(!e)throw new i("NOT_FOUND_ERR");var o=this.comparePoint(e,n),r=this.comparePoint(e,n+1);return o<0?r>0?ut:st:r>0?lt:ct},comparePoint:function(t,e){return Z(this),V(t,"HIERARCHY_REQUEST_ERR"),G(t,this.startContainer),c(t,e,this.startContainer,this.startOffset)<0?-1:c(t,e,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Q,toHtml:function(){return et(this)},intersectsNode:function(t,e){if(Z(this),g(t)!=_(this))return!1;var n=t.parentNode,o=s(t);if(!n)return!0;var r=c(n,o,this.endContainer,this.endOffset),i=c(n,o+1,this.startContainer,this.startOffset);return e?r<=0&&i>=0:r<0&&i>0},isPointInRange:function(t,e){return Z(this),V(t,"HIERARCHY_REQUEST_ERR"),G(t,this.startContainer),c(t,e,this.startContainer,this.startOffset)>=0&&c(t,e,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){return S(this,t,!1)},intersectsOrTouchesRange:function(t){return S(this,t,!0)},intersection:function(t){if(this.intersectsRange(t)){var e=c(this.startContainer,this.startOffset,t.startContainer,t.startOffset),n=c(this.endContainer,this.endOffset,t.endContainer,t.endOffset),o=this.cloneRange();return-1==e&&o.setStart(t.startContainer,t.startOffset),1==n&&o.setEnd(t.endContainer,t.endOffset),o}return null},union:function(t){if(this.intersectsOrTouchesRange(t)){var e=this.cloneRange();return-1==c(t.startContainer,t.startOffset,this.startContainer,this.startOffset)&&e.setStart(t.startContainer,t.startOffset),1==c(t.endContainer,t.endOffset,this.endContainer,this.endOffset)&&e.setEnd(t.endContainer,t.endOffset),e}throw new i("Ranges do not intersect")},containsNode:function(t,e){return e?this.intersectsNode(t,!1):this.compareNode(t)==ct},containsNodeContents:function(t){return this.comparePoint(t,0)>=0&&this.comparePoint(t,h(t))<=0},containsRange:function(t){var e=this.intersection(t);return null!==e&&t.equals(e)},containsNodeText:function(t){var e=this.cloneRange();e.selectNode(t);var n=e.getNodes([3]);if(n.length>0){e.setStart(n[0],0);var o=n.pop();return e.setEnd(o,o.length),this.containsRange(e)}return this.containsNodeContents(t)},getNodes:function(t,e){return Z(this),N(this,t,e)},getDocument:function(){return b(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(e){var o=b(this),r=t.createRange(o);e=e||n.getBody(o),r.selectNodeContents(e);var i=this.intersection(r),a=0,s=0;return i&&(r.setEnd(i.startContainer,i.startOffset),s=(a=r.toString().length)+i.toString().length),{start:a,end:s,containerNode:e}},moveToBookmark:function(t){var e=t.containerNode,n=0;this.setStart(e,0),this.collapse(!0);for(var o,r,i,a,s=[e],l=!1,u=!1;!u&&(o=s.pop());)if(3==o.nodeType)r=n+o.length,!l&&t.start>=n&&t.start<=r&&(this.setStart(o,t.start-n),l=!0),l&&t.end>=n&&t.end<=r&&(this.setEnd(o,t.end-n),u=!0),n=r;else for(i=(a=o.childNodes).length;i--;)s.push(a[i])},getName:function(){return"DomRange"},equals:function(t){return vt.rangesEqual(this,t)},isValid:function(){return q(this)},inspect:function(){return A(this)},detach:function(){}}),ft(vt,yt),o.extend(vt,{rangeProperties:nt,RangeIterator:P,copyComparisonConstants:pt,createPrototypeRange:ft,inspect:A,toHtml:et,getRangeDocument:b,rangesEqual:function(t,e){return t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset}}),t.DomRange=vt}),x.createCoreModule("WrappedRange",["DomRange"],function(t,e){var n,o,r=t.dom,i=t.util,a=r.DomPosition,s=t.DomRange,l=r.getBody,u=r.getContentDocument,c=r.isCharacterDataNode;if(t.features.implementsDomRange&&function(){var o,a,c=s.rangeProperties;function d(t){for(var e,n=c.length;n--;)t[e=c[n]]=t.nativeRange[e];t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset}function p(t,e,n,o,r){var i=t.startContainer!==e||t.startOffset!=n,a=t.endContainer!==o||t.endOffset!=r,s=!t.equals(t.nativeRange);(i||a||s)&&(t.setEnd(o,r),t.setStart(e,n))}n=function(t){if(!t)throw e.createError("WrappedRange: Range must be specified");this.nativeRange=t,d(this)},s.createPrototypeRange(n,p),(o=n.prototype).selectNode=function(t){this.nativeRange.selectNode(t),d(this)},o.cloneContents=function(){return this.nativeRange.cloneContents()},o.surroundContents=function(t){this.nativeRange.surroundContents(t),d(this)},o.collapse=function(t){this.nativeRange.collapse(t),d(this)},o.cloneRange=function(){return new n(this.nativeRange.cloneRange())},o.refresh=function(){d(this)},o.toString=function(){return this.nativeRange.toString()};var h=document.createTextNode("test");l(document).appendChild(h);var f=document.createRange();f.setStart(h,0),f.setEnd(h,0);try{f.setStart(h,1),o.setStart=function(t,e){this.nativeRange.setStart(t,e),d(this)},o.setEnd=function(t,e){this.nativeRange.setEnd(t,e),d(this)},a=function(t){return function(e){this.nativeRange[t](e),d(this)}}}catch(b){o.setStart=function(t,e){try{this.nativeRange.setStart(t,e)}catch(n){this.nativeRange.setEnd(t,e),this.nativeRange.setStart(t,e)}d(this)},o.setEnd=function(t,e){try{this.nativeRange.setEnd(t,e)}catch(n){this.nativeRange.setStart(t,e),this.nativeRange.setEnd(t,e)}d(this)},a=function(t,e){return function(n){try{this.nativeRange[t](n)}catch(o){this.nativeRange[e](n),this.nativeRange[t](n)}d(this)}}}o.setStartBefore=a("setStartBefore","setEndBefore"),o.setStartAfter=a("setStartAfter","setEndAfter"),o.setEndBefore=a("setEndBefore","setStartBefore"),o.setEndAfter=a("setEndAfter","setStartAfter"),o.selectNodeContents=function(t){this.setStartAndEnd(t,0,r.getNodeLength(t))},f.selectNodeContents(h),f.setEnd(h,3);var g=document.createRange();g.selectNodeContents(h),g.setEnd(h,4),g.setStart(h,2),-1==f.compareBoundaryPoints(f.START_TO_END,g)&&1==f.compareBoundaryPoints(f.END_TO_START,g)?o.compareBoundaryPoints=function(t,e){return t==(e=e.nativeRange||e).START_TO_END?t=e.END_TO_START:t==e.END_TO_START&&(t=e.START_TO_END),this.nativeRange.compareBoundaryPoints(t,e)}:o.compareBoundaryPoints=function(t,e){return this.nativeRange.compareBoundaryPoints(t,e.nativeRange||e)};var y=document.createElement("div");y.innerHTML="123";var v=y.firstChild,m=l(document);m.appendChild(y),f.setStart(v,1),f.setEnd(v,2),f.deleteContents(),"13"==v.data&&(o.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},o.extractContents=function(){var t=this.nativeRange.extractContents();return d(this),t}),m.removeChild(y),m=null,i.isHostMethod(f,"createContextualFragment")&&(o.createContextualFragment=function(t){return this.nativeRange.createContextualFragment(t)}),l(document).removeChild(h),o.getName=function(){return"WrappedRange"},t.WrappedRange=n,t.createNativeRange=function(t){return(t=u(t,e,"createNativeRange")).createRange()}}(),t.features.implementsTextRange){var d=function(t){var e=t.parentElement(),n=t.duplicate();n.collapse(!0);var o=n.parentElement();(n=t.duplicate()).collapse(!1);var i=n.parentElement(),a=o==i?o:r.getCommonAncestor(o,i);return a==e?a:r.getCommonAncestor(e,a)},p=function(t){return 0==t.compareEndPoints("StartToEnd",t)},h=function(t,e,n,o,i){var s=t.duplicate();s.collapse(n);var l=s.parentElement();if(r.isOrIsAncestorOf(e,l)||(l=e),!l.canHaveHTML){var u=new a(l.parentNode,r.getNodeIndex(l));return{boundaryPosition:u,nodeInfo:{nodeIndex:u.offset,containerElement:u.node}}}var d=r.getDocument(l).createElement("span");d.parentNode&&r.removeNode(d);for(var p,h,f,g,y,v=n?"StartToStart":"StartToEnd",m=i&&i.containerElement==l?i.nodeIndex:0,b=l.childNodes.length,_=b,x=_;x==b?l.appendChild(d):l.insertBefore(d,l.childNodes[x]),s.moveToElementText(d),0!=(p=s.compareEndPoints(v,t))&&m!=_;){if(-1==p){if(_==m+1)break;m=x}else _=_==m+1?m:x;x=Math.floor((m+_)/2),l.removeChild(d)}if(y=d.nextSibling,-1==p&&y&&c(y)){var E;if(s.setEndPoint(n?"EndToStart":"EndToEnd",t),/[\r\n]/.test(y.data)){var w=s.duplicate(),S=w.text.replace(/\r\n/g,"\r").length;for(E=w.moveStart("character",S);-1==(p=w.compareEndPoints("StartToEnd",w));)E++,w.moveStart("character",1)}else E=s.text.length;g=new a(y,E)}else h=(o||!n)&&d.previousSibling,g=(f=(o||n)&&d.nextSibling)&&c(f)?new a(f,0):h&&c(h)?new a(h,h.data.length):new a(l,r.getNodeIndex(d));return r.removeNode(d),{boundaryPosition:g,nodeInfo:{nodeIndex:x,containerElement:l}}},f=function(t,e){var n,o,i,a,s=t.offset,u=r.getDocument(t.node),d=l(u).createTextRange(),p=c(t.node);return p?o=(n=t.node).parentNode:(n=s<(a=t.node.childNodes).length?a[s]:null,o=t.node),(i=u.createElement("span")).innerHTML="&#feff;",n?o.insertBefore(i,n):o.appendChild(i),d.moveToElementText(i),d.collapse(!e),o.removeChild(i),p&&d[e?"moveStart":"moveEnd"]("character",s),d};(o=function(t){this.textRange=t,this.refresh()}).prototype=new s(document),o.prototype.refresh=function(){var t,e,n,o=d(this.textRange);p(this.textRange)?e=t=h(this.textRange,o,!0,!0).boundaryPosition:(t=(n=h(this.textRange,o,!0,!1)).boundaryPosition,e=h(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(t.node,t.offset),this.setEnd(e.node,e.offset)},o.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(o);var g=function(t){if(t.collapsed)return f(new a(t.startContainer,t.startOffset),!0);var e=f(new a(t.startContainer,t.startOffset),!0),n=f(new a(t.endContainer,t.endOffset),!1),o=l(s.getRangeDocument(t)).createTextRange();return o.setEndPoint("StartToStart",e),o.setEndPoint("EndToEnd",n),o};if(o.rangeToTextRange=g,o.prototype.toTextRange=function(){return g(this)},t.WrappedTextRange=o,!t.features.implementsDomRange||t.config.preferTextRange){var y=Function("return this;")();void 0===y.Range&&(y.Range=o),t.createNativeRange=function(t){return t=u(t,e,"createNativeRange"),l(t).createTextRange()},t.WrappedRange=o}}t.createRange=function(n){return n=u(n,e,"createRange"),new t.WrappedRange(t.createNativeRange(n))},t.createRangyRange=function(t){return t=u(t,e,"createRangyRange"),new s(t)},i.createAliasForDeprecatedMethod(t,"createIframeRange","createRange"),i.createAliasForDeprecatedMethod(t,"createIframeRangyRange","createRangyRange"),t.addShimListener(function(e){var n=e.document;void 0===n.createRange&&(n.createRange=function(){return t.createRange(n)}),n=e=null})}),x.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(t,e){t.config.checkSelectionRanges=!0;var n,o,r="boolean",i="number",a=t.dom,s=t.util,l=s.isHostMethod,u=t.DomRange,c=t.WrappedRange,d=t.DOMException,p=a.DomPosition,h=t.features,f="Control",g=a.getDocument,y=a.getBody,v=u.rangesEqual;function m(t){return"string"==typeof t?/^backward(s)?$/i.test(t):!!t}function b(t,n){if(t){if(a.isWindow(t))return t;if(t instanceof Z)return t.win;var o=a.getContentDocument(t,e,n);return a.getWindow(o)}return window}function _(t){return b(t,"getWinSelection").getSelection()}function x(t){return b(t,"getDocSelection").document.selection}function E(t){var e=!1;return t.anchorNode&&(e=1==a.comparePoints(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)),e}var w=l(window,"getSelection"),S=s.isHostObject(document,"selection");h.implementsWinGetSelection=w,h.implementsDocSelection=S;var O=S&&(!w||t.config.preferTextRange);if(O)n=x,t.isSelectionValid=function(t){var e=b(t,"isSelectionValid").document,n=e.selection;return"None"!=n.type||g(n.createRange().parentElement())==e};else{if(!w)return e.fail("Neither document.selection or window.getSelection() detected."),!1;n=_,t.isSelectionValid=function(){return!0}}t.getNativeSelection=n;var C=n();if(!C)return e.fail("Native selection was null (possibly issue 138?)"),!1;var T=t.createNativeRange(document),M=y(document),N=s.areHostProperties(C,["anchorNode","focusNode","anchorOffset","focusOffset"]);h.selectionHasAnchorAndFocus=N;var A=l(C,"extend");h.selectionHasExtend=A;var P=l(C,"setBaseAndExtent");h.selectionHasSetBaseAndExtent=P;var D=typeof C.rangeCount==i;h.selectionHasRangeCount=D;var k=!1,R=!0,L=A?function(e,n){var o=u.getRangeDocument(n),r=t.createRange(o);r.collapseToPoint(n.endContainer,n.endOffset),e.addRange(X(r)),e.extend(n.startContainer,n.startOffset)}:null;s.areHostMethods(C,["addRange","getRangeAt","removeAllRanges"])&&typeof C.rangeCount==i&&h.implementsDomRange&&function(){var e=window.getSelection();if(e){for(var n=e.rangeCount,o=n>1,r=[],i=E(e),s=0;s<n;++s)r[s]=e.getRangeAt(s);var l=a.createTestElement(document,"",!1),u=l.appendChild(document.createTextNode("   ")),c=document.createRange();if(c.setStart(u,1),c.collapse(!0),e.removeAllRanges(),e.addRange(c),R=1==e.rangeCount,e.removeAllRanges(),!o){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&parseInt(d[1])>=36)k=!1;else{var p=c.cloneRange();c.setStart(u,0),p.setEnd(u,3),p.setStart(u,2),e.addRange(c),e.addRange(p),k=2==e.rangeCount}}for(a.removeNode(l),e.removeAllRanges(),s=0;s<n;++s)0==s&&i?L?L(e,r[s]):(t.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),e.addRange(r[s])):e.addRange(r[s])}}(),h.selectionSupportsMultipleRanges=k,h.collapsedNonEditableSelectionsSupported=R;var I,j,B=!1;function H(t,e,n){var o=n?"end":"start",r=n?"start":"end";t.anchorNode=e[o+"Container"],t.anchorOffset=e[o+"Offset"],t.focusNode=e[r+"Container"],t.focusOffset=e[r+"Offset"]}function z(t){var e=t.nativeSelection;t.anchorNode=e.anchorNode,t.anchorOffset=e.anchorOffset,t.focusNode=e.focusNode,t.focusOffset=e.focusOffset}function F(t){t.anchorNode=t.focusNode=null,t.anchorOffset=t.focusOffset=0,t.rangeCount=0,t.isCollapsed=!0,t._ranges.length=0,W(t)}function W(t){t.type=0==t.rangeCount?"None":o(t)?"Caret":"Range"}function X(e){var n;return e instanceof u?((n=t.createNativeRange(e.getDocument())).setEnd(e.endContainer,e.endOffset),n.setStart(e.startContainer,e.startOffset)):e instanceof c?n=e.nativeRange:h.implementsDomRange&&e instanceof a.getWindow(e.startContainer).Range&&(n=e),n}function U(t){if(!t.length||1!=t[0].nodeType)return!1;for(var e=1,n=t.length;e<n;++e)if(!a.isAncestorOf(t[0],t[e]))return!1;return!0}function G(t){var n=t.getNodes();if(!U(n))throw e.createError("getSingleElementFromRange: range "+t.inspect()+" did not consist of a single element");return n[0]}function Y(t){return!!t&&void 0!==t.text}function V(t,e){var n=new c(e);t._ranges=[n],H(t,n,!1),t.rangeCount=1,t.isCollapsed=n.collapsed,W(t)}function K(e){if(e._ranges.length=0,"None"==e.docSelection.type)F(e);else{var n=e.docSelection.createRange();if(Y(n))V(e,n);else{e.rangeCount=n.length;for(var o,r=g(n.item(0)),i=0;i<e.rangeCount;++i)(o=t.createRange(r)).selectNode(n.item(i)),e._ranges.push(o);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed,H(e,e._ranges[e.rangeCount-1],!1),W(e)}}}function q(t,n){for(var o=t.docSelection.createRange(),r=G(n),i=g(o.item(0)),a=y(i).createControlRange(),s=0,l=o.length;s<l;++s)a.add(o.item(s));try{a.add(r)}catch(u){throw e.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),K(t)}function Z(t,e,n){this.nativeSelection=t,this.docSelection=e,this._ranges=[],this.win=n,this.refresh()}function $(t){t.win=t.anchorNode=t.focusNode=t._ranges=null,t.rangeCount=t.anchorOffset=t.focusOffset=0,t.detached=!0,W(t)}M&&l(M,"createControlRange")&&(I=M.createControlRange(),s.areHostProperties(I,["item","add"])&&(B=!0)),h.implementsControlRange=B,o=N?function(t){return t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset}:function(t){return!!t.rangeCount&&t.getRangeAt(t.rangeCount-1).collapsed},l(C,"getRangeAt")?j=function(t,e){try{return t.getRangeAt(e)}catch(n){return null}}:N&&(j=function(e){var n=g(e.anchorNode),o=t.createRange(n);return o.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset),o}),Z.prototype=t.selectionPrototype;var J=[];function Q(t,e){for(var n,o,r=J.length;r--;)if(o=(n=J[r]).selection,"deleteAll"==e)$(o);else if(n.win==t)return"delete"==e?(J.splice(r,1),!0):o;return"deleteAll"==e&&(J.length=0),null}var tt=function(t){if(t&&t instanceof Z)return t.refresh(),t;var e=Q(t=b(t,"getNativeSelection")),o=n(t),r=S?x(t):null;return e?(e.nativeSelection=o,e.docSelection=r,e.refresh()):(e=new Z(o,r,t),J.push({win:t,selection:e})),e};t.getSelection=tt,s.createAliasForDeprecatedMethod(t,"getIframeSelection","getSelection");var et,nt=Z.prototype;function ot(t,n){for(var o,r=g(n[0].startContainer),i=y(r).createControlRange(),a=0,s=n.length;a<s;++a){o=G(n[a]);try{i.add(o)}catch(l){throw e.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}i.select(),K(t)}if(!O&&N&&s.areHostMethods(C,["removeAllRanges","addRange"])){nt.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),F(this)};var rt=function(t,e){L(t.nativeSelection,e),t.refresh()};nt.addRange=D?function(e,n){if(B&&S&&this.docSelection.type==f)q(this,e);else if(m(n)&&A)rt(this,e);else{var r;k?r=this.rangeCount:(this.removeAllRanges(),r=0);var i=X(e).cloneRange();try{this.nativeSelection.addRange(i)}catch(s){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==r+1){if(t.config.checkSelectionRanges){var a=j(this.nativeSelection,this.rangeCount-1);a&&!v(a,e)&&(e=new c(a))}this._ranges[this.rangeCount-1]=e,H(this,e,it(this.nativeSelection)),this.isCollapsed=o(this),W(this)}else this.refresh()}}:function(t,e){m(e)&&A?rt(this,t):(this.nativeSelection.addRange(X(t)),this.refresh())},nt.setRanges=function(t){if(B&&S&&t.length>1)ot(this,t);else{this.removeAllRanges();for(var e=0,n=t.length;e<n;++e)this.addRange(t[e])}}}else{if(!(l(C,"empty")&&l(T,"select")&&B&&O))return e.fail("No means of selecting a Range or TextRange was found"),!1;nt.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var t;if(this.anchorNode)t=g(this.anchorNode);else if(this.docSelection.type==f){var e=this.docSelection.createRange();e.length&&(t=g(e.item(0)))}t&&(y(t).createTextRange().select(),this.docSelection.empty())}}catch(n){}F(this)},nt.addRange=function(e){this.docSelection.type==f?q(this,e):(t.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,H(this,e,!1),W(this))},nt.setRanges=function(t){this.removeAllRanges();var e=t.length;e>1?ot(this,t):e&&this.addRange(t[0])}}if(nt.getRangeAt=function(t){if(t<0||t>=this.rangeCount)throw new d("INDEX_SIZE_ERR");return this._ranges[t].cloneRange()},O)et=function(e){var n;t.isSelectionValid(e.win)?n=e.docSelection.createRange():(n=y(e.win.document).createTextRange()).collapse(!0),e.docSelection.type==f?K(e):Y(n)?V(e,n):F(e)};else if(l(C,"getRangeAt")&&typeof C.rangeCount==i)et=function(e){if(B&&S&&e.docSelection.type==f)K(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var n=0,r=e.rangeCount;n<r;++n)e._ranges[n]=new t.WrappedRange(e.nativeSelection.getRangeAt(n));H(e,e._ranges[e.rangeCount-1],it(e.nativeSelection)),e.isCollapsed=o(e),W(e)}else F(e)};else{if(!N||typeof C.isCollapsed!=r||typeof T.collapsed!=r||!h.implementsDomRange)return e.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;et=function(t){var e,n=t.nativeSelection;n.anchorNode?(e=j(n,0),t._ranges=[e],t.rangeCount=1,z(t),t.isCollapsed=o(t),W(t)):F(t)}}nt.refresh=function(t){var e=t?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(et(this),t){var r=e.length;if(r!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;r--;)if(!v(e[r],this._ranges[r]))return!0;return!1}};var it,at=function(t,e){var n=t.getAllRanges();t.removeAllRanges();for(var o=0,r=n.length;o<r;++o)v(e,n[o])||t.addRange(n[o]);t.rangeCount||F(t)};function st(t,e){if(t.win.document!=g(e))throw new d("WRONG_DOCUMENT_ERR")}function lt(t,e){if(e<0||e>(a.isCharacterDataNode(t)?t.length:t.childNodes.length))throw new d("INDEX_SIZE_ERR")}function ut(e){return function(n,o){var r;this.rangeCount?(r=this.getRangeAt(0))["set"+(e?"Start":"End")](n,o):(r=t.createRange(this.win.document)).setStartAndEnd(n,o),this.setSingleRange(r,this.isBackward())}}function ct(t){var e=[],n=new p(t.anchorNode,t.anchorOffset),o=new p(t.focusNode,t.focusOffset),r="function"==typeof t.getName?t.getName():"Selection";if(void 0!==t.rangeCount)for(var i=0,a=t.rangeCount;i<a;++i)e[i]=u.inspect(t.getRangeAt(i));return"["+r+"(Ranges: "+e.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}nt.removeRange=B&&S?function(t){if(this.docSelection.type==f){for(var e=this.docSelection.createRange(),n=G(t),o=g(e.item(0)),r=y(o).createControlRange(),i=!1,a=0,s=e.length;a<s;++a)e.item(a)!==n||i?r.add(e.item(a)):i=!0;r.select(),K(this)}else at(this,t)}:function(t){at(this,t)},!O&&N&&h.implementsDomRange?(it=E,nt.isBackward=function(){return it(this)}):it=nt.isBackward=function(){return!1},nt.isBackwards=nt.isBackward,nt.toString=function(){for(var t=[],e=0,n=this.rangeCount;e<n;++e)t[e]=""+this._ranges[e];return t.join("")},nt.collapse=function(e,n){st(this,e);var o=t.createRange(e);o.collapseToPoint(e,n),this.setSingleRange(o),this.isCollapsed=!0},nt.collapseToStart=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var t=this._ranges[0];this.collapse(t.startContainer,t.startOffset)},nt.collapseToEnd=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var t=this._ranges[this.rangeCount-1];this.collapse(t.endContainer,t.endOffset)},nt.selectAllChildren=function(e){st(this,e);var n=t.createRange(e);n.selectNodeContents(e),this.setSingleRange(n)},P?nt.setBaseAndExtent=function(t,e,n,o){this.nativeSelection.setBaseAndExtent(t,e,n,o),this.refresh()}:A&&(nt.setBaseAndExtent=function(e,n,o,r){lt(e,n),lt(o,r),st(this,e),st(this,o);var i=t.createRange(node),s=-1==a.comparePoints(e,n,o,r);s?i.setStartAndEnd(o,r,e,n):i.setStartAndEnd(e,n,o,r),this.setSingleRange(i,s)}),nt.deleteFromDocument=function(){if(B&&S&&this.docSelection.type==f){for(var t,e=this.docSelection.createRange();e.length;)t=e.item(0),e.remove(t),a.removeNode(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,r=n.length;o<r;++o)n[o].deleteContents();this.addRange(n[r-1])}}},nt.eachRange=function(t,e){for(var n=0,o=this._ranges.length;n<o;++n)if(t(this.getRangeAt(n)))return e},nt.getAllRanges=function(){var t=[];return this.eachRange(function(e){t.push(e)}),t},nt.setSingleRange=function(t,e){this.removeAllRanges(),this.addRange(t,e)},nt.callMethodOnEachRange=function(t,e){var n=[];return this.eachRange(function(o){n.push(o[t].apply(o,e||[]))}),n},nt.setStart=ut(!0),nt.setEnd=ut(!1),t.rangePrototype.select=function(t){tt(this.getDocument()).setSingleRange(this,t)},nt.changeEachRange=function(t){var e=[],n=this.isBackward();this.eachRange(function(n){t(n),e.push(n)}),this.removeAllRanges(),n&&1==e.length?this.addRange(e[0],"backward"):this.setRanges(e)},nt.containsNode=function(t,e){return this.eachRange(function(n){return n.containsNode(t,e)},!0)||!1},nt.getBookmark=function(t){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[t])}},nt.moveToBookmark=function(e){for(var n,o,r=[],i=0;n=e.rangeBookmarks[i++];)(o=t.createRange(this.win)).moveToBookmark(n),r.push(o);e.backward?this.setSingleRange(r[0],"backward"):this.setRanges(r)},nt.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},nt.restoreRanges=function(t){this.removeAllRanges();for(var e,n=0;e=t.ranges[n];++n)this.addRange(e,t.backward&&0==n)},nt.toHtml=function(){var t=[];return this.eachRange(function(e){t.push(u.toHtml(e))}),t.join("")},h.implementsTextRange&&(nt.getNativeTextRange=function(){var n;if(n=this.docSelection){var o=n.createRange();if(Y(o))return o;throw e.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return t.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw e.createError("getNativeTextRange: selection contains no range")}),nt.getName=function(){return"WrappedSelection"},nt.inspect=function(){return ct(this)},nt.detach=function(){Q(this.win,"delete"),$(this)},Z.detachAll=function(){Q(null,"deleteAll")},Z.inspect=ct,Z.isDirectionBackward=m,t.Selection=Z,t.selectionPrototype=nt,t.addShimListener(function(t){void 0===t.getSelection&&(t.getSelection=function(){return tt(t)}),t=null})});var j=!1,B=function(t){j||(j=!0,!x.initialized&&x.config.autoInitialize&&M())};return b&&("complete"==document.readyState?B():(s(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",B,!1),v(window,"load",B))),x}()),bE.exports}const xE=be(_E());var EE,wE,SE={exports:{}};EE||(EE=1,SE.exports=((wE=_E()).createModule("ClassApplier",["WrappedSelection"],function(t,e){var n=t.dom,o=n.DomPosition,r=n.arrayContains,i=t.util,a=i.forEach,s="span",l=i.isHostMethod(document,"createElementNS");function u(t,e){for(var n in t)if(t.hasOwnProperty(n)&&!1===e(n,t[n]))return!1;return!0}function c(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function d(t,e){return!!t&&new RegExp("(?:^|\\s)"+e+"(?:\\s|$)").test(t)}function p(t,e){return"object"==typeof t.classList?t.classList.contains(e):d("string"==typeof t.className?t.className:t.getAttribute("class"),e)}function h(t,e){if("object"==typeof t.classList)t.classList.add(e);else{var n="string"==typeof t.className,o=n?t.className:t.getAttribute("class");o?d(o,e)||(o+=" "+e):o=e,n?t.className=o:t.setAttribute("class",o)}}var f=function(){function t(t,e,n){return e&&n?" ":""}return function(e,n){if("object"==typeof e.classList)e.classList.remove(n);else{var o="string"==typeof e.className,r=o?e.className:e.getAttribute("class");r=r.replace(new RegExp("(^|\\s)"+n+"(\\s|$)"),t),o?e.className=r:e.setAttribute("class",r)}}}();function g(t){return"string"==typeof t.className?t.className:t.getAttribute("class")}function y(t){return t&&t.split(/\s+/).sort().join(" ")}function v(t){return y(g(t))}function m(t,e){return v(t)==v(e)}function b(t,e){for(var n=e.split(/\s+/),o=0,r=n.length;o<r;++o)if(!p(t,c(n[o])))return!1;return!0}function _(t){var e=t.parentNode;return e&&1==e.nodeType&&!/^(textarea|style|script|select|iframe)$/i.test(e.nodeName)}function x(t,e,n,o,r){var i=t.node,a=t.offset,s=i,l=a;i==o&&a>r&&++l,i!=e||a!=n&&a!=n+1||(s=o,l+=r-n),i==e&&a>n+1&&--l,t.node=s,t.offset=l}function E(t,e,n){t.node==e&&t.offset>n&&--t.offset}function w(t,e,o,r){-1==o&&(o=e.childNodes.length);var i=t.parentNode,s=n.getNodeIndex(t);a(r,function(t){x(t,i,s,e,o)}),e.childNodes.length==o?e.appendChild(t):e.insertBefore(t,e.childNodes[o])}function S(t,e){var o=t.parentNode,r=n.getNodeIndex(t);a(e,function(t){E(t,o,r)}),n.removeNode(t)}function O(t,e,n,o,r){for(var i,a=[];i=t.firstChild;)w(i,e,n++,r),a.push(i);return S(t,r),a}function C(t,e){return O(t,t.parentNode,n.getNodeIndex(t),!0,e)}function T(t,e){var n=t.cloneRange();n.selectNodeContents(e);var o=n.intersection(t);return""!=(o?o.toString():"")}function M(t){for(var e,n=t.getNodes([3]),o=0;(e=n[o])&&!T(t,e);)++o;for(var r=n.length-1;(e=n[r])&&!T(t,e);)--r;return n.slice(o,r+1)}function N(t,e){if(t.attributes.length!=e.attributes.length)return!1;for(var n,o,r,i=0,a=t.attributes.length;i<a;++i)if("class"!=(r=(n=t.attributes[i]).name)){if(null===n!=(null===(o=e.attributes.getNamedItem(r))))return!1;if(n.specified!=o.specified)return!1;if(n.specified&&n.nodeValue!==o.nodeValue)return!1}return!0}function A(t,e){for(var n,o=0,i=t.attributes.length;o<i;++o)if(n=t.attributes[o].name,(!e||!r(e,n))&&t.attributes[o].specified&&"class"!=n)return!0;return!1}var P=n.getComputedStyleProperty,D="boolean"==typeof document.createElement("div").isContentEditable?function(t){return t&&1==t.nodeType&&t.isContentEditable}:function(t){return!(!t||1!=t.nodeType||"false"==t.contentEditable)&&("true"==t.contentEditable||D(t.parentNode))};function k(t){var e;return t&&1==t.nodeType&&((e=t.parentNode)&&9==e.nodeType&&"on"==e.designMode||D(t)&&!D(t.parentNode))}function R(t){return(D(t)||1!=t.nodeType&&D(t.parentNode))&&!k(t)}var L=/^inline(-block|-table)?$/i;function I(t){return t&&1==t.nodeType&&!L.test(P(t,"display"))}var j=/[^\r\n\t\f \u200B]/;function B(t){if(0==t.data.length)return!0;if(j.test(t.data))return!1;switch(P(t.parentNode,"whiteSpace")){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(t.data))return!1}return I(t.previousSibling)||I(t.nextSibling)}function H(t){var e,n,r=[];for(e=0;n=t[e++];)r.push(new o(n.startContainer,n.startOffset),new o(n.endContainer,n.endOffset));return r}function z(t,e){for(var n,o,r,i=0,a=t.length;i<a;++i)n=t[i],o=e[2*i],r=e[2*i+1],n.setStartAndEnd(o.node,o.offset,r.node,r.offset)}function F(t,e){return n.isCharacterDataNode(t)?0==e?!!t.previousSibling:e!=t.length||!!t.nextSibling:e>0&&e<t.childNodes.length}function W(t,o,r,i){var a,s,l=0==r;if(n.isAncestorOf(o,t))return t;if(n.isCharacterDataNode(o)){var u=n.getNodeIndex(o);if(0==r)r=u;else{if(r!=o.length)throw e.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+r+" in "+o.data);r=u+1}o=o.parentNode}if(F(o,r)){a=o.cloneNode(!1),s=o.parentNode,a.id&&a.removeAttribute("id");for(var c,d=0;c=o.childNodes[r];)w(c,a,d++,i);return w(a,s,n.getNodeIndex(o)+1,i),o==t?a:W(t,s,n.getNodeIndex(a),i)}if(t!=o){a=o.parentNode;var p=n.getNodeIndex(o);return l||p++,W(t,a,p,i)}return t}function X(t,e){return t.namespaceURI==e.namespaceURI&&t.tagName.toLowerCase()==e.tagName.toLowerCase()&&m(t,e)&&N(t,e)&&"inline"==P(t,"display")&&"inline"==P(e,"display")}function U(t){var e=t?"nextSibling":"previousSibling";return function(n,o){var r=n.parentNode,i=n[e];if(i){if(i&&3==i.nodeType)return i}else if(o&&(i=r[e])&&1==i.nodeType&&X(r,i)){var a=i[t?"firstChild":"lastChild"];if(a&&3==a.nodeType)return a}return null}}var G=U(!1),Y=U(!0);function V(t){this.isElementMerge=1==t.nodeType,this.textNodes=[];var e=this.isElementMerge?t.lastChild:t;e&&(this.textNodes[0]=e)}V.prototype={doMerge:function(t){var e=this.textNodes,o=e[0];if(e.length>1){var r,i=n.getNodeIndex(o),s=[],l=0;a(e,function(u,c){r=u.parentNode,c>0&&(r.removeChild(u),r.hasChildNodes()||n.removeNode(r),t&&a(t,function(t){t.node==u&&(t.node=o,t.offset+=l),t.node==r&&t.offset>i&&(--t.offset,t.offset==i+1&&c<e.length-1&&(t.node=o,t.offset=l))})),s[c]=u.data,l+=u.data.length}),o.data=s.join("")}return o.data},getLength:function(){for(var t=this.textNodes.length,e=0;t--;)e+=this.textNodes[t].length;return e},toString:function(){var t=[];return a(this.textNodes,function(e,n){t[n]="'"+e.data+"'"}),"[Merge("+t.join(",")+")]"}};var K=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],q={};function Z(t,e,n){var o,r,i,a,s=this;s.cssClass=s.className=t;var l=null,d={};if("object"==typeof e&&null!==e){for(void 0!==e.elementTagName&&(e.elementTagName=e.elementTagName.toLowerCase()),n=e.tagNames,l=e.elementProperties,d=e.elementAttributes,r=0;a=K[r++];)e.hasOwnProperty(a)&&(s[a]=e[a]);o=e.normalize}else o=e;s.normalize=void 0===o||o,s.attrExceptions=[];var p=document.createElement(s.elementTagName);s.elementProperties=s.copyPropertiesToElement(l,p,!0),u(d,function(t,e){s.attrExceptions.push(t),d[t]=""+e}),s.elementAttributes=d,s.elementSortedClassName=s.elementProperties.hasOwnProperty("className")?y(s.elementProperties.className+" "+t):t,s.applyToAnyTagName=!1;var h=typeof n;if("string"==h)"*"==n?s.applyToAnyTagName=!0:s.tagNames=c(n.toLowerCase()).split(/\s*,\s*/);else if("object"==h&&"number"==typeof n.length)for(s.tagNames=[],r=0,i=n.length;r<i;++r)"*"==n[r]?s.applyToAnyTagName=!0:s.tagNames.push(n[r].toLowerCase());else s.tagNames=[s.elementTagName]}function $(t,e,n){return new Z(t,e,n)}Z.prototype={elementTagName:s,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(t,e,n){var o,r,i,a,s,l,u={};for(var c in t)if(t.hasOwnProperty(c))if(a=t[c],s=e[c],"className"==c)h(e,a),h(e,this.className),e[c]=y(e[c]),n&&(u[c]=a);else if("style"==c){for(o in r=s,n&&(u[c]=i={}),t[c])t[c].hasOwnProperty(o)&&(r[o]=a[o],n&&(i[o]=r[o]));this.attrExceptions.push(c)}else e[c]=a,n&&(u[c]=e[c],l=q.hasOwnProperty(c)?q[c]:c,this.attrExceptions.push(l));return n?u:""},copyAttributesToElement:function(t,e){for(var n in t)t.hasOwnProperty(n)&&!/^class(?:Name)?$/i.test(n)&&e.setAttribute(n,t[n])},appliesToElement:function(t){return r(this.tagNames,t.tagName.toLowerCase())},getEmptyElements:function(t){var e=this;return t.getNodes([1],function(t){return e.appliesToElement(t)&&!t.hasChildNodes()})},hasClass:function(t){return 1==t.nodeType&&(this.applyToAnyTagName||this.appliesToElement(t))&&p(t,this.className)},getSelfOrAncestorWithClass:function(t){for(;t;){if(this.hasClass(t))return t;t=t.parentNode}return null},isModifiable:function(t){return!this.applyToEditableOnly||R(t)},isIgnorableWhiteSpaceNode:function(t){return this.ignoreWhiteSpace&&t&&3==t.nodeType&&B(t)},postApply:function(t,e,n,o){var r,i,s=t[0],l=t[t.length-1],u=[],c=s,d=l,p=0,h=l.length;a(t,function(t){(i=G(t,!o))?(r||(r=new V(i),u.push(r)),r.textNodes.push(t),t===s&&(c=r.textNodes[0],p=c.length),t===l&&(d=r.textNodes[0],h=r.getLength())):r=null});var f=Y(l,!o);if(f&&(r||(r=new V(l),u.push(r)),r.textNodes.push(f)),u.length){for(var g=0,y=u.length;g<y;++g)u[g].doMerge(n);e.setStartAndEnd(c,p,d,h)}},createContainer:function(t){var e=n.getDocument(t),o=l&&!n.isHtmlNamespace(t)&&t.namespaceURI?e.createElementNS(t.namespaceURI,this.elementTagName):e.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,o,!1),this.copyAttributesToElement(this.elementAttributes,o),h(o,this.className),this.onElementCreate&&this.onElementCreate(o,this),o},elementHasProperties:function(t,e){var n=this;return u(e,function(e,o){if("className"==e)return b(t,o);if("object"==typeof o){if(!n.elementHasProperties(t[e],o))return!1}else if(t[e]!==o)return!1})},elementHasAttributes:function(t,e){return u(e,function(e,n){if(t.getAttribute(e)!==n)return!1})},applyToTextNode:function(t,e){if(_(t)){var n=t.parentNode;if(1==n.childNodes.length&&this.useExistingElements&&this.appliesToElement(n)&&this.elementHasProperties(n,this.elementProperties)&&this.elementHasAttributes(n,this.elementAttributes))h(n,this.className);else{var o=t.parentNode,r=this.createContainer(o);o.insertBefore(r,t),r.appendChild(t)}}},isRemovable:function(t){return t.tagName.toLowerCase()==this.elementTagName&&v(t)==this.elementSortedClassName&&this.elementHasProperties(t,this.elementProperties)&&!A(t,this.attrExceptions)&&this.elementHasAttributes(t,this.elementAttributes)&&this.isModifiable(t)},isEmptyContainer:function(t){var e=t.childNodes.length;return 1==t.nodeType&&this.isRemovable(t)&&(0==e||1==e&&this.isEmptyContainer(t.firstChild))},removeEmptyContainers:function(t){var e=this,n=t.getNodes([1],function(t){return e.isEmptyContainer(t)}),o=[t],r=H(o);a(n,function(t){S(t,r)}),z(o,r)},undoToTextNode:function(t,e,n,o){if(!e.containsNode(n)){var r=e.cloneRange();r.selectNode(n),r.isPointInRange(e.endContainer,e.endOffset)&&(W(n,e.endContainer,e.endOffset,o),e.setEndAfter(n)),r.isPointInRange(e.startContainer,e.startOffset)&&(n=W(n,e.startContainer,e.startOffset,o))}this.isRemovable(n)?C(n,o):f(n,this.className)},splitAncestorWithClass:function(t,e,n){var o=this.getSelfOrAncestorWithClass(t);o&&W(o,t,e,n)},undoToAncestor:function(t,e){this.isRemovable(t)?C(t,e):f(t,this.className)},applyToRange:function(t,e){var n=this,o=H((e=e||[])||[]);t.splitBoundariesPreservingPositions(o),n.removeEmptyElements&&n.removeEmptyContainers(t);var r=M(t);if(r.length){a(r,function(t){n.isIgnorableWhiteSpaceNode(t)||n.getSelfOrAncestorWithClass(t)||!n.isModifiable(t)||n.applyToTextNode(t,o)});var i=r[r.length-1];t.setStartAndEnd(r[0],0,i,i.length),n.normalize&&n.postApply(r,t,o,!1),z(e,o)}var s=n.getEmptyElements(t);a(s,function(t){h(t,n.className)})},applyToRanges:function(t){for(var e=t.length;e--;)this.applyToRange(t[e],t);return t},applyToSelection:function(e){var n=t.getSelection(e);n.setRanges(this.applyToRanges(n.getAllRanges()))},undoToRange:function(t,e){var n=this,o=H(e=e||[]);t.splitBoundariesPreservingPositions(o),n.removeEmptyElements&&n.removeEmptyContainers(t,o);var r,i,s=M(t),l=s[s.length-1];if(s.length){n.splitAncestorWithClass(t.endContainer,t.endOffset,o),n.splitAncestorWithClass(t.startContainer,t.startOffset,o);for(var u=0,c=s.length;u<c;++u)r=s[u],(i=n.getSelfOrAncestorWithClass(r))&&n.isModifiable(r)&&n.undoToAncestor(i,o);t.setStartAndEnd(s[0],0,l,l.length),n.normalize&&n.postApply(s,t,o,!0),z(e,o)}var d=n.getEmptyElements(t);a(d,function(t){f(t,n.className)})},undoToRanges:function(t){for(var e=t.length;e--;)this.undoToRange(t[e],t);return t},undoToSelection:function(e){var n=t.getSelection(e),o=t.getSelection(e).getAllRanges();this.undoToRanges(o),n.setRanges(o)},isAppliedToRange:function(t){if(t.collapsed||""==t.toString())return!!this.getSelfOrAncestorWithClass(t.commonAncestorContainer);var e=t.getNodes([3]);if(e.length)for(var n,o=0;n=e[o++];)if(!this.isIgnorableWhiteSpaceNode(n)&&T(t,n)&&this.isModifiable(n)&&!this.getSelfOrAncestorWithClass(n))return!1;return!0},isAppliedToRanges:function(t){var e=t.length;if(0==e)return!1;for(;e--;)if(!this.isAppliedToRange(t[e]))return!1;return!0},isAppliedToSelection:function(e){var n=t.getSelection(e);return this.isAppliedToRanges(n.getAllRanges())},toggleRange:function(t){this.isAppliedToRange(t)?this.undoToRange(t):this.applyToRange(t)},toggleSelection:function(t){this.isAppliedToSelection(t)?this.undoToSelection(t):this.applyToSelection(t)},getElementsWithClassIntersectingRange:function(t){var e=[],n=this;return t.getNodes([3],function(t){var o=n.getSelfOrAncestorWithClass(t);o&&!r(e,o)&&e.push(o)}),e},detach:function(){}},Z.util={hasClass:p,addClass:h,removeClass:f,getClass:g,hasSameClasses:m,hasAllClasses:b,replaceWithOwnChildren:C,elementsHaveSameNonClassAttributes:N,elementHasNonClassAttributes:A,splitNodeAt:W,isEditableElement:D,isEditingHost:k,isEditable:R},t.CssClassApplier=t.ClassApplier=Z,t.createClassApplier=$,i.createAliasForDeprecatedMethod(t,"createCssClassApplier","createClassApplier",e)}),wE));var OE={toolbar:{allowMultiParagraphSelection:!0,buttons:["bold","colorpicker","italic","underline","strikethrough","quote","justifyLeft","justifyCenter","justifyRight","justifyFull","superscript","subscript","orderedlist","unorderedlist","pre","removeFormat","outdent","indent","h2","h3"],standardizeSelectionStart:!1,updateOnEmptySelection:!1},placeholder:{text:"请输入内容",hideOnClick:!0},disableEditing:!0};function CE(t){var e,n,o=(null===(e=null==t?void 0:t.extensions)||void 0===e?void 0:e.button)||(null===(n=null==t?void 0:t.extensions)||void 0===n?void 0:n.button),r=(null==t?void 0:t.Extension)||(null==t?void 0:t.Extension),i=o||r;return i?i.extend({name:"colorpicker",tagNames:["mark"],contentDefault:"<b>Color</b>",aria:"Color Picker",action:"colorPicker",init:function(){var t,e,n=this;try{xE.init()}catch(r){console.error("rangy.init failed")}try{null===(e=null===(t=null==o?void 0:o.prototype)||void 0===t?void 0:t.init)||void 0===e||e.call(this)}catch(i){console.error("ButtonBase.init failed")}this.colorPicker=new yE({parent:this.button||void 0,color:"#000",onDone:function(t){var e,o,r,i,a;try{n.coloredText&&(null===(o=(e=n.coloredText).isAppliedToSelection)||void 0===o?void 0:o.call(e))&&n.coloredText.undoToSelection(),n.coloredText=xE.createClassApplier("colored",{elementTagName:"span",elementProperties:{style:{color:t.hex}},normalize:!0}),n.coloredText.toggleSelection(),null===(i=null===(r=n.base)||void 0===r?void 0:r.checkContentChanged)||void 0===i||i.call(r),null===(a=n.setInactive)||void 0===a||a.call(n)}catch(s){console.error("Picker.onDone failed")}}})},getButton:function(){return this.button},handleClick:function(){var t,e,n;null===(t=this.setActive)||void 0===t||t.call(this),null===(n=null===(e=this.colorPicker)||void 0===e?void 0:e.show)||void 0===n||n.call(e)},isAlreadyApplied:function(t){var e,n;return"mark"===(null===(n=null===(e=null==t?void 0:t.nodeName)||void 0===e?void 0:e.toLowerCase)||void 0===n?void 0:n.call(e))},isActive:function(){var t,e;return null===(e=null===(t=this.button)||void 0===t?void 0:t.classList)||void 0===e?void 0:e.contains("medium-editor-button-active")},setInactive:function(){var t,e;null===(e=null===(t=this.button)||void 0===t?void 0:t.classList)||void 0===e||e.remove("medium-editor-button-active")},setActive:function(){var t,e;null===(e=null===(t=this.button)||void 0===t?void 0:t.classList)||void 0===e||e.add("medium-editor-button-active")}}):(console.warn("MediumEditor button/extension base not available; using noop extension"),function(){return function(){}}())}var TE=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ME=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},NE=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};!function(t){function e(e){var n=t.call(this,e)||this;n.labelMap=new Map;var o=e.lf,r=e.graphModel;return n.lf=o,n.graphModel=r,n.state={tick:0},n}TE(e,t),e.prototype.componentDidMount=function(){var t=this,e=this.props.graphModel;this.editor=new nE(".lf-label-editor",de(OE,{autoLink:!0,extensions:{colorPicker:new(CE(nE))}})),e.eventCenter.on("text:update,node:mousemove,node:resize,node:rotate,node:drag,label:drop,node:drop",function(){}),e.eventCenter.on("node:properties-change,node:properties-delete",function(){t.setState({tick:t.state.tick+1})})},e.prototype.componentDidUpdate=function(){var t;this.editor&&this.editor.elements.length>0?this.editor.addElements(".lf-label-editor"):(null===(t=this.editor)||void 0===t||t.destroy(),this.editor=new nE(".lf-label-editor",de(OE,{autoLink:!0,extensions:{colorPicker:new(CE(nE))}})))},e.prototype.componentWillUnmount=function(){var t;null===(t=this.editor)||void 0===t||t.destroy()},e.prototype.getLabels=function(){var t=this,e=this.props,n=e.lf.extension,o=e.graphModel,r=NE(NE([],ME(o.nodes),!1),ME(o.edges),!1);if(n.label){var i=[];return $o(r,function(e){var n,r;$o(null!==(r=null===(n=e.getData().properties)||void 0===n?void 0:n._label)&&void 0!==r?r:[],function(n){var r=t.labelMap,a=new Jx(n,e,o);r.set(a.id,a),i.push(ph(qx,{label:a,element:e,graphModel:o},a.id))})}),i}return null},e.prototype.render=function(){return ph("foreignObject",{id:"lf-label-overlay",class:"lf-label-overlay",children:this.getLabels()})},e.toolName="label-edit-tool",e=function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}([Db],e)}(Xl);var AE=function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{l(o.next(t))}catch(e){i(e)}}function s(t){try{l(o.throw(t))}catch(e){i(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}l((o=o.apply(t,e||[])).next())})},PE=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(l){s=[6,l],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},DE=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},kE=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},RE={};function LE(t){return t.startsWith("data:text/plain")}function IE(t){return AE(this,void 0,void 0,function(){return PE(this,function(e){return RE[t]?[2,RE[t]]:[2,new Promise(function(e,n){try{fetch(t).then(function(t){return t.blob()}).then(function(o){var r=new FileReader;r.onloadend=function(){e(RE[t]=r.result)},r.onerror=n,r.readAsDataURL(o)}).catch(function(){e(RE[t]=t)})}catch(o){return RE[t]=t}})]})})}function jE(t,e){return AE(this,void 0,void 0,function(){var n,o,r;return PE(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(n=t.getAttribute(e)||"").startsWith("data:")?[2]:[4,IE(n)];case 1:return LE(o=i.sent())?[2]:(t.setAttribute(e,o),[3,3]);case 2:return r=i.sent(),console.error(r),[3,3];case 3:return[2]}})})}function BE(t,e){return AE(this,void 0,void 0,function(){var n,o;return PE(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e.startsWith("data:")?[2]:[4,IE(e)];case 1:return LE(n=r.sent())?[2]:(t.style.backgroundImage="url(".concat(n,")"),[3,3]);case 2:return o=r.sent(),console.error(o),[3,3];case 3:return[2]}})})}function HE(t){return AE(this,void 0,void 0,function(){var e,n,o,r,i,a,s,l,u;return PE(this,function(c){switch(c.label){case 0:for(e=[t],o=[];e.length;)(n=e.shift()).children.length&&e.push.apply(e,kE([],DE(n.children),!1)),n instanceof HTMLElement&&(r=n.style,i=r.background,a=r.backgroundImage,(s=i.match(/url\(["']?(.*?)["']?\)/))&&s[1]&&(u=s[1],o.push(BE(n,u))),(l=a.match(/url\(["']?(.*?)["']?\)/))&&l[1]&&(u=l[1],o.push(BE(n,u)))),n instanceof HTMLImageElement?o.push(jE(n,"src")):n instanceof SVGImageElement&&o.push(jE(n,"href"));return[4,Promise.all(o)];case 1:return c.sent(),[2]}})})}function zE(t,e,n){var o=document.createElement("canvas");o.width=e,o.height=n;var r=o.getContext("2d");return r&&r.drawImage(t,0,0,t.width,t.height,0,0,e,n),o}var FE=function(){return FE=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},FE.apply(this,arguments)},WE=function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{l(o.next(t))}catch(e){i(e)}}function s(t){try{l(o.throw(t))}catch(e){i(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}l((o=o.apply(t,e||[])).next())})},XE=function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(l){s=[6,l],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},UE=function(){function t(t){var e=t.lf,n=this;this.lf=e,this.customCssRules="",this.useGlobalRules=!0,e.getSnapshot=function(t,e){return WE(n,void 0,void 0,function(){return XE(this,function(n){switch(n.label){case 0:return[4,this.getSnapshot(t,e)];case 1:return[2,n.sent()]}})})},e.getSnapshotBlob=function(t,e,o){return WE(n,void 0,void 0,function(){return XE(this,function(n){switch(n.label){case 0:return[4,this.getSnapshotBlob(t,e,o)];case 1:return[2,n.sent()]}})})},e.getSnapshotBase64=function(t,e,o){return WE(n,void 0,void 0,function(){return XE(this,function(n){switch(n.label){case 0:return[4,this.getSnapshotBase64(t,e,o)];case 1:return[2,n.sent()]}})})}}return t.prototype.getSvgRootElement=function(t){return t.container.querySelector(".lf-canvas-overlay")},t.prototype.triggerDownload=function(t){var e=new MouseEvent("click",{view:document.defaultView,bubbles:!1,cancelable:!0}),n=document.createElement("a");n.setAttribute("download",this.fileName),n.setAttribute("href",t),n.setAttribute("target","_blank"),n.dispatchEvent(e)},t.prototype.removeAnchor=function(t){for(var e=t.childNodes,n=t.childNodes&&t.childNodes.length,o=0;o<n;o++){var r=e[o];(r.classList&&Array.from(r.classList)||[]).indexOf("lf-anchor")>-1&&(t.removeChild(t.childNodes[o]),n--,o--)}},t.prototype.removeRotateControl=function(t){for(var e=t.childNodes,n=t.childNodes&&t.childNodes.length,o=0;o<n;o++){var r=e[o];(r.classList&&Array.from(r.classList)||[]).indexOf("lf-rotate-control")>-1&&(t.removeChild(t.childNodes[o]),n--,o--)}},t.prototype.convertImageToBase64=function(t){return WE(this,void 0,void 0,function(){return XE(this,function(e){return[2,new Promise(function(e,n){var o=new Image;o.crossOrigin="anonymous",o.onload=function(){var t=document.createElement("canvas");t.width=o.width,t.height=o.height;var n=t.getContext("2d");null==n||n.drawImage(o,0,0);var r=t.toDataURL("image/png");e(r)},o.onerror=function(){n(new Error("Failed to load image: ".concat(t)))},o.src=t})]})})},t.prototype.isRelativePath=function(t){return!(t.startsWith("data:")||t.startsWith("http://")||t.startsWith("https://")||t.startsWith("//"))},t.prototype.processImages=function(t){return WE(this,void 0,void 0,function(){var e,n,o,r,i,a,s,l,u,c,d,p;return XE(this,function(h){switch(h.label){case 0:e=t.getElementsByTagName("image"),i=0,h.label=1;case 1:if(!(i<e.length))return[3,6];if(u=e[i],!(n=u.getAttributeNS("http://www.w3.org/1999/xlink","href")||u.getAttribute("href"))||!this.isRelativePath(n))return[3,5];h.label=2;case 2:return h.trys.push([2,4,,5]),[4,this.convertImageToBase64(n)];case 3:return d=h.sent(),u.setAttributeNS("http://www.w3.org/1999/xlink","href",d),u.setAttribute("href",d),[3,5];case 4:return o=h.sent(),console.warn("Failed to convert image to base64: ".concat(n),o),[3,5];case 5:return i++,[3,1];case 6:r=t.getElementsByTagName("foreignObject"),i=0,h.label=7;case 7:if(!(i<r.length))return[3,14];a=r[i],s=a.getElementsByTagName("img"),l=0,h.label=8;case 8:if(!(l<s.length))return[3,13];if(u=s[l],!(c=u.getAttribute("src"))||!this.isRelativePath(c))return[3,12];h.label=9;case 9:return h.trys.push([9,11,,12]),[4,this.convertImageToBase64(c)];case 10:return d=h.sent(),u.setAttribute("src",d),[3,12];case 11:return p=h.sent(),console.warn("Failed to convert image to base64: ".concat(c),p),[3,12];case 12:return l++,[3,8];case 13:return i++,[3,7];case 14:return[2]}})})},t.prototype.cloneSvg=function(t){return WE(this,arguments,void 0,function(t,e){var n,o,r,i,a,s,l,u,c,d,p=this;return void 0===e&&(e=!0),XE(this,function(h){switch(h.label){case 0:if(n=t.cloneNode(!0),o=n.lastChild,r=null===(d=null==o?void 0:o.childNodes)||void 0===d?void 0:d.length)for(i=0;i<r;i++)a=null==o?void 0:o.childNodes[i],(s=a.classList&&Array.from(a.classList))&&s.indexOf("lf-base")<0?(null==o||o.removeChild(o.childNodes[i]),r--,i--):(l=null==o?void 0:o.childNodes[i])&&l.childNodes.forEach(function(t){var e=t;p.removeAnchor(e.firstChild),p.removeRotateControl(e.firstChild)});return[4,this.processImages(n)];case 1:return h.sent(),e&&((u=document.createElement("style")).innerHTML=this.getClassRules(),(c=document.createElement("foreignObject")).appendChild(u),n.appendChild(c)),[2,n]}})})},t.prototype.getClassRules=function(){var t="";if(this.useGlobalRules)for(var e=document.styleSheets,n=0;n<e.length;n++){var o=e[n];try{for(var r=0;r<o.cssRules.length;r++)t+=o.cssRules[r].cssText}catch(i){console.log("CSS scripts from different sources have been filtered out")}}return this.customCssRules&&(t+=this.customCssRules),t},t.prototype.getCanvasScaleRatio=function(t,e){var n=32767,o=268435456,r=t*e;if(t<=n&&e<=n&&r<=o)return 1;var i=n/t,a=n/e,s=o/r;return Math.min(i,a,s)},t.prototype.getCanvasData=function(t,e){return WE(this,void 0,void 0,function(){var n,o,r,i,a,s,l,u,c,d,p,h,f,g,y,v,m,b,_,x,E,w,S,O,C,T,M,N,A,P,D,k,R,L,I;return XE(this,function(j){switch(j.label){case 0:return n=e.width,o=e.height,r=e.backgroundColor,i=e.padding,a=void 0===i?40:i,[4,this.cloneSvg(t,!1)];case 1:return s=j.sent(),(l=window.devicePixelRatio||1)<1&&(l=1),u=this.lf.graphModel.rootEl.querySelector(".lf-base"),c=u.getBoundingClientRect(),d=this.lf.container.querySelector(".lf-canvas-overlay"),p=d.getBoundingClientRect(),h=c.x-p.x,f=c.y-p.y,g=this.lf.graphModel,y=g.transformModel,v=y.SCALE_X,m=y.SCALE_Y,b=y.TRANSLATE_X,_=y.TRANSLATE_Y,x=e.safetyFactor||1,E=c.width/v,w=c.height/m,S=E*(x-1),O=w*(x-1),C=Math.ceil(E+S),T=Math.ceil(w+O),(M=document.createElement("canvas")).style.width="".concat(C,"px"),M.style.height="".concat(T,"px"),N=e.safetyMargin||0,A=C*l,P=T*l,(D=this.getCanvasScaleRatio(A,P))<1&&(A=Math.floor(A*D),P=Math.floor(P*D)),s.lastChild.style.transform="matrix(".concat(D,", 0, 0, ").concat(D,", ").concat((-h+b)*(1/v)*D+a+S/2+N,", ").concat((-f+_)*(1/m)*D+a+O/2+N,")"),M.width=A+2*(a+N)*l,M.height=P+2*(a+N)*l,(k=M.getContext("2d"))&&(k.clearRect(0,0,M.width,M.height),k.scale(l,l),r?(k.fillStyle=r,k.fillRect(0,0,M.width,M.height)):k.clearRect(0,0,M.width,M.height)),R=new Image,(L=document.createElement("style")).innerHTML=this.getClassRules(),(I=document.createElement("foreignObject")).appendChild(L),s.appendChild(I),[2,new Promise(function(t){R.onload=function(){var e=navigator.userAgent.indexOf("Firefox")>-1;try{e?createImageBitmap(R,{resizeWidth:n&&o?zE(M,n,o).width:M.width,resizeHeight:n&&o?zE(M,n,o).height:M.height}).then(function(e){null==k||k.drawImage(e,0,0),t(n&&o?zE(M,n,o):M)}):(null==k||k.drawImage(R,0,0),t(n&&o?zE(M,n,o):M))}catch(r){null==k||k.drawImage(R,0,0),t(n&&o?zE(M,n,o):M)}};var e="data:image/svg+xml;charset=utf-8,".concat((new XMLSerializer).serializeToString(s)).replace(/\n/g,"").replace(/\t/g,"").replace(/#/g,"%23");R.src=e})]}})})},t.prototype.withExportPreparation=function(t,e){return WE(this,void 0,void 0,function(){var n,o,r,i,a,s=this;return XE(this,function(l){switch(l.label){case 0:n=this.lf.graphModel.getPartial(),o=(null!=e?e:{}).partial,r=void 0===o?n:o,i=this.lf.getEditConfig(),this.lf.updateEditConfig({isSilentMode:!0,stopScrollGraph:!0,stopMoveGraph:!0}),l.label=1;case 1:return l.trys.push([1,,6,7]),n===r?[3,3]:(this.lf.graphModel.setPartial(r),[4,new Promise(function(e){s.lf.graphModel.eventCenter.once("graph:updated",function(){return WE(s,void 0,void 0,function(){var o;return XE(this,function(r){switch(r.label){case 0:return[4,t()];case 1:return o=r.sent(),this.lf.graphModel.setPartial(n),e(o),[2]}})})})})]);case 2:return a=l.sent(),[3,5];case 3:return[4,t()];case 4:a=l.sent(),l.label=5;case 5:return[3,7];case 6:return this.lf.updateEditConfig(i),[7];case 7:return[2,a]}})})},t.prototype.getSnapshot=function(t,e){return WE(this,void 0,void 0,function(){var n=this;return XE(this,function(o){switch(o.label){case 0:return[4,this.withExportPreparation(function(){return n.snapshot(t,e)},e)];case 1:return o.sent(),[2]}})})},t.prototype.snapshot=function(t,e){return WE(this,void 0,void 0,function(){var n,o,r,i,a,s,l,u,c,d=this;return XE(this,function(p){switch(p.label){case 0:return o=(n=null!=e?e:{}).fileType,r=void 0===o?"png":o,i=n.quality,this.fileName="".concat(null!=t?t:"logic-flow.".concat(Date.now()),".").concat(r),[4,HE(a=this.getSvgRootElement(this.lf))];case 1:return p.sent(),"svg"!==r?[3,3]:[4,this.cloneSvg(a)];case 2:return s=p.sent(),l=(new XMLSerializer).serializeToString(s),u=new Blob([l],{type:"image/svg+xml;charset=utf-8"}),c=URL.createObjectURL(u),this.triggerDownload(c),[3,4];case 3:this.getCanvasData(a,null!=e?e:{}).then(function(t){var e=t.toDataURL("image/".concat(r),i).replace("image/".concat(r),"image/octet-stream");d.triggerDownload(e)}),p.label=4;case 4:return[2]}})})},t.prototype.getSnapshotBlob=function(t,e,n){return WE(this,void 0,void 0,function(){var o=this;return XE(this,function(r){switch(r.label){case 0:return[4,this.withExportPreparation(function(){return o.snapshotBlob(n,e,t)},n)];case 1:return[2,r.sent()]}})})},t.prototype.snapshotBlob=function(t,e,n){return WE(this,void 0,void 0,function(){var o,r,i,a=this;return XE(this,function(s){switch(s.label){case 0:return o=(null!=t?t:{}).fileType,r=void 0===o?e:o,[4,HE(i=this.getSvgRootElement(this.lf))];case 1:return s.sent(),[2,new Promise(function(e){a.getCanvasData(i,FE({backgroundColor:n},null!=t?t:{})).then(function(t){t.toBlob(function(n){e({data:n,width:t.width,height:t.height})},"image/".concat(null!=r?r:"png"))})})]}})})},t.prototype.getSnapshotBase64=function(t,e,n){return WE(this,void 0,void 0,function(){var o=this;return XE(this,function(r){switch(r.label){case 0:return[4,this.withExportPreparation(function(){return o._getSnapshotBase64(t,e,n)},n)];case 1:return[2,r.sent()]}})})},t.prototype._getSnapshotBase64=function(t,e,n){return WE(this,void 0,void 0,function(){var o,r,i,a=this;return XE(this,function(s){switch(s.label){case 0:return o=(null!=n?n:{}).fileType,r=void 0===o?e:o,[4,HE(i=this.getSvgRootElement(this.lf))];case 1:return s.sent(),[2,new Promise(function(e){a.getCanvasData(i,FE({backgroundColor:t},null!=n?n:{})).then(function(t){var n=t.toDataURL("image/".concat(null!=r?r:"png"));e({data:n,width:t.width,height:t.height})})})]}})})},t.pluginName="snapshot",t}(),GE=function(){function t(t){var e=t.lf,n=this;this.controlItems=[{key:"zoom-out",iconClass:"lf-control-zoomOut",title:"缩小流程图",text:"缩小",onClick:function(){n.lf.zoom(!1)}},{key:"zoom-in",iconClass:"lf-control-zoomIn",title:"放大流程图",text:"放大",onClick:function(){n.lf.zoom(!0)}},{key:"reset",iconClass:"lf-control-fit",title:"恢复流程原有尺寸",text:"适应",onClick:function(){n.lf.resetZoom()}},{key:"undo",iconClass:"lf-control-undo",title:"回到上一步",text:"上一步",onClick:function(){n.lf.undo()}},{key:"redo",iconClass:"lf-control-redo",title:"移到下一步",text:"下一步",onClick:function(){n.lf.redo()}}],this.lf=e}return t.prototype.render=function(t,e){this.destroy();var n=this.getControlTool();this.toolEl=n,e.appendChild(n),this.domContainer=e},t.prototype.destroy=function(){this.domContainer&&this.toolEl&&this.domContainer.contains(this.toolEl)&&this.domContainer.removeChild(this.toolEl)},t.prototype.addItem=function(t){this.controlItems.push(t)},t.prototype.removeItem=function(t){var e=this.controlItems.findIndex(function(e){return e.key===t});return-1==e?null:this.controlItems.splice(e,1)[0]},t.prototype.getControlTool=function(){var t=this,e="lf-control-item",n="lf-control-item disabled",o=document.createElement("div"),r=[];return o.className="lf-control",this.controlItems.forEach(function(o){var i=document.createElement("div"),a=document.createElement("i"),s=document.createElement("span");switch(i.className=n,o.onClick&&(i.onclick=o.onClick.bind(null,t.lf)),o.onMouseEnter&&(i.onmouseenter=o.onMouseEnter.bind(null,t.lf)),o.onMouseLeave&&(i.onmouseleave=o.onMouseLeave.bind(null,t.lf)),a.className=o.iconClass,s.className="lf-control-text",s.title=o.title,s.innerText=o.text,i.append(a,s),o.key){case"undo":t.lf.on("history:change",function(t){var o=t.data.undoAble;i.className=o?e:n});break;case"redo":t.lf.on("history:change",function(t){var o=t.data.redoAble;i.className=o?e:n});break;default:i.className=e}r.push(i)}),o.append.apply(o,function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}(r),!1)),o},t.pluginName="control",t}(),YE=function(){return YE=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},YE.apply(this,arguments)},VE=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},KE=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},qE="lf:defaultNodeMenu",ZE="lf:defaultEdgeMenu",$E="lf:defaultGraphMenu",JE="lf:defaultSelectionMenu",QE={nodeMenu:qE,edgeMenu:ZE,graphMenu:$E,selectionMenu:JE},tw={nodeMenu:[],edgeMenu:[],graphMenu:[],selectionMenu:[]},ew=function(){function t(t){var e=t.lf,n=this;this.__currentData=null,this.__isSilentMode=!1,this.lf=e,this.__menuDOM=document.createElement("ul"),this.__isSilentMode=e.graphModel.editConfigModel.isSilentMode,this.menuTypeMap=new Map,this.init(),this.lf.setMenuConfig=function(t){n.setMenuConfig(t)},this.lf.addMenuConfig=function(t){n.addMenuConfig(t)},this.lf.setMenuByType=function(t){n.setMenuByType(t)},this.lf.changeMenuItemDisableStatus=function(t,e,o){n.changeMenuItemDisableStatus(t,e,o)},this.lf.getMenuConfig=function(t){return n.getMenuConfig(t)},this.lf.resetMenuConfigByType=function(t){n.resetMenuConfigByType(t)}}return t.prototype.init=function(){var t,e,n,o=this;tw.nodeMenu=[{text:"删除",callback:function(t){o.lf.deleteNode(t.id)}},{text:"编辑文本",callback:function(t){o.lf.graphModel.editText(t.id)}},{text:"复制",callback:function(t){o.lf.cloneNode(t.id)}}],null===(t=this.menuTypeMap)||void 0===t||t.set(qE,tw.nodeMenu),tw.edgeMenu=[{text:"删除",callback:function(t){o.lf.deleteEdge(t.id)}},{text:"编辑文本",callback:function(t){o.lf.graphModel.editText(t.id)}}],null===(e=this.menuTypeMap)||void 0===e||e.set(ZE,tw.edgeMenu),tw.graphMenu=[],tw.selectionMenu=[{text:"删除",callback:function(t){o.lf.clearSelectElements(),t.edges.forEach(function(t){return o.lf.deleteEdge(t.id)}),t.nodes.forEach(function(t){return o.lf.deleteNode(t.id)})}}],null===(n=this.menuTypeMap)||void 0===n||n.set(JE,tw.selectionMenu)},t.prototype.showMenu=function(t,e,n,o){if(!this.__isSilentMode&&n&&n.length){var r=this.__menuDOM;if(r){if(r.innerHTML="",r.append.apply(r,KE([],VE(this.__getMenuDom(n)),!1)),!r.children.length)return;if(r.style.display="block",!o)return r.style.top="".concat(e,"px"),void(r.style.left="".concat(t,"px"));var i=o.width,a=o.height,s=o.clientX,l=o.clientY,u=this.lf.graphModel,c=r.offsetWidth,d=!0,p=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h=p-s,f=u.rootEl.getBoundingClientRect(),g=f.left+f.width;g<p&&(h=g-s),h<c&&(d=!1),r.style.left="".concat(d?t:t-i,"px");var y=r.offsetHeight,v=!0,m=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,b=m-l,_=f.top+f.height;_<m&&(b=_-l),b<y&&(v=!1),r.style.top="".concat(v?e:e-a,"px")}}},t.prototype.processMenuConfig=function(t,e){var n=this;if(t){["nodeMenu","edgeMenu","graphMenu","selectionMenu"].forEach(function(o){var r,i,a,s,l=t[o],u=QE[o];if(void 0!==l)if("set"===e)null===(r=n.menuTypeMap)||void 0===r||r.set(u,l||[]);else if("add"===e&&Array.isArray(l)){var c=null!==(a=null===(i=n.menuTypeMap)||void 0===i?void 0:i.get(u))&&void 0!==a?a:[];null===(s=n.menuTypeMap)||void 0===s||s.set(u,c.concat(l))}})}},t.prototype.createImageElement=function(t,e){var n=document.createElement("img");return n.src=t,n.alt=e,n.style.width="16px",n.style.height="16px",n.style.objectFit="contain",n},t.prototype.isImageFile=function(t){return[".png",".jpg",".jpeg",".gif",".svg",".webp",".ico",".bmp"].some(function(e){return t.toLowerCase().includes(e)})},t.prototype.processIcon=function(t,e,n){var o;if("string"==typeof e){var r=e;if(r.startsWith("data:image/")){var i=this.createImageElement(r,n||"icon");t.appendChild(i)}else if(this.isImageFile(r)){i=this.createImageElement(r,n||"icon");t.appendChild(i)}else if(r.includes("<")&&r.includes(">"))t.innerHTML=r;else if(r.includes(" ")||r.startsWith(".")){var a=r.replace(/^\./,"").split(" ");(o=t.classList).add.apply(o,KE([],VE(a),!1))}else t.classList.add(r)}},t.prototype.__getMenuDom=function(t){var e=this,n=[];return t&&t.length>0&&t.forEach(function(t){var o=document.createElement("li");if(t.className?o.className="lf-menu-item ".concat(t.disabled?"lf-menu-item__disabled":""," ").concat(t.className):o.className="lf-menu-item ".concat(t.disabled?"lf-menu-item__disabled":""),t.icon){var r=document.createElement("span");r.className="lf-menu-item-icon",e.processIcon(r,t.icon,t.text),o.appendChild(r)}var i=document.createElement("span");i.className="lf-menu-item-text",t.text&&(i.innerText=t.text),o.appendChild(i),t.disabled&&o.setAttribute("disabled","true"),o.onclickCallback=t.callback,n.push(o)}),n},t.prototype.updateMenuItemDOMStatus=function(t,e){if(this.__menuDOM&&"none"!==this.__menuDOM.style.display){var n=Array.from(this.__menuDOM.querySelectorAll(".lf-menu-item")).find(function(e){var n=e.querySelector(".lf-menu-item-text");return(null==n?void 0:n.textContent)===t});if(n){var o=n;e?(o.classList.add("lf-menu-item__disabled"),o.setAttribute("disabled","true")):(o.classList.remove("lf-menu-item__disabled"),o.removeAttribute("disabled"))}}},t.prototype.setupSilentModeListener=function(){var t=this;this.__editConfigChangeHandler=function(e){var n=e.data.isSilentMode;n!==t.__isSilentMode&&(t.__isSilentMode=n,t.updateMenuVisibility(!n))},this.lf.on("editConfig:changed",this.__editConfigChangeHandler)},t.prototype.updateMenuVisibility=function(t){this.__menuDOM&&(t?this.__currentData&&(this.__menuDOM.style.display="block"):(this.__menuDOM.style.display="none",this.__currentData=null))},t.prototype.refreshCurrentMenu=function(){var t,e,n,o,r,i,a,s,l,u,c;if(this.__menuDOM&&"none"!==this.__menuDOM.style.display&&this.__currentData){var d=this.__menuDOM.style,p=d.left,h=d.top,f=[];if(this.__currentData&&"object"==typeof this.__currentData)if("sourceNodeId"in this.__currentData&&"targetNodeId"in this.__currentData){if(y=this.lf.graphModel.getEdgeModelById(this.__currentData.id)){var g=null===(e=this.menuTypeMap)||void 0===e?void 0:e.get(y.type);f=y.menu&&Array.isArray(y.menu)?y.menu:g||(null!==(o=null===(n=this.menuTypeMap)||void 0===n?void 0:n.get(ZE))&&void 0!==o?o:[])}}else if("id"in this.__currentData&&"type"in this.__currentData){var y;if(y=this.lf.graphModel.getNodeModelById(this.__currentData.id)){g=null===(r=this.menuTypeMap)||void 0===r?void 0:r.get(y.type);f=y.menu&&Array.isArray(y.menu)?y.menu:g||(null!==(a=null===(i=this.menuTypeMap)||void 0===i?void 0:i.get(qE))&&void 0!==a?a:[])}}else f="nodes"in this.__currentData&&"edges"in this.__currentData?null!==(l=null===(s=this.menuTypeMap)||void 0===s?void 0:s.get(JE))&&void 0!==l?l:[]:null!==(c=null===(u=this.menuTypeMap)||void 0===u?void 0:u.get($E))&&void 0!==c?c:[];f&&f.length>0?(this.__menuDOM.innerHTML="",(t=this.__menuDOM).append.apply(t,KE([],VE(this.__getMenuDom(f)),!1)),p&&(this.__menuDOM.style.left=p),h&&(this.__menuDOM.style.top=h)):(this.__menuDOM.style.display="none",this.__currentData=null)}},t.prototype.setMenuByType=function(t){var e,n=t.type,o=t.menu;n&&o&&(null===(e=this.menuTypeMap)||void 0===e||e.set(n,o),this.refreshCurrentMenu())},t.prototype.getMenuConfig=function(t){var e,n;return null!==(n=null===(e=this.menuTypeMap)||void 0===e?void 0:e.get(QE[t]))&&void 0!==n?n:[]},t.prototype.resetMenuConfigByType=function(t){var e;this.setMenuConfig(((e={})[t]=tw[t],e))},t.prototype.resetAllMenuConfig=function(){this.setMenuConfig(tw)},t.prototype.setMenuConfig=function(t){this.processMenuConfig(t,"set"),this.refreshCurrentMenu()},t.prototype.addMenuConfig=function(t){this.processMenuConfig(t,"add"),this.refreshCurrentMenu()},t.prototype.changeMenuItem=function(t,e){if("add"===t)this.addMenuConfig(e);else{if("reset"!==t)throw new Error("The first parameter of changeMenuConfig should be 'add' or 'reset'");this.setMenuConfig(e)}},t.prototype.changeMenuItemDisableStatus=function(t,e,n){var o,r;if(t&&e){var i=null!==(r=null===(o=this.menuTypeMap)||void 0===o?void 0:o.get(QE[t]))&&void 0!==r?r:[];if(i.length){var a=i.find(function(t){return t.text===e});a?(a.disabled=n,this.updateMenuItemDOMStatus(e,n)):console.warn("menuItem: ".concat(e," is not exist"))}else console.warn("menuMap: ".concat(t," is not exist"))}else console.warn("params is vaild")},t.prototype.render=function(t,e){var n=this;t.graphModel.editConfigModel.isSilentMode||(this.__container=e,this.__currentData=null,this.setupSilentModeListener(),this.__menuDOM&&(this.__menuDOM.className="lf-menu",e.appendChild(this.__menuDOM),this.__menuDOM.addEventListener("click",function(t){t.stopPropagation();for(var e=t.target;-1===Array.from(e.classList).indexOf("lf-menu-item")&&-1===Array.from(e.classList).indexOf("lf-menu");)e=null==e?void 0:e.parentElement;Array.from(e.classList).indexOf("lf-menu-item__disabled")>-1||(Array.from(e.classList).indexOf("lf-menu-item")>-1?(e.onclickCallback(n.__currentData,e),n.__menuDOM&&(n.__menuDOM.style.display="none"),n.__currentData=null):console.warn("点击区域不在菜单项内，请检查代码！"))},!0)),this.lf.on("node:contextmenu",function(t){var e,o,r=t.data,i=t.position,a=t.e,s=i.domOverlayPosition,l=s.x,u=s.y,c=r.id,d=n.lf.graphModel.getNodeModelById(c);if(d&&!n.__isSilentMode){var p=[],h=null===(e=n.menuTypeMap)||void 0===e?void 0:e.get(d.type);p=d&&d.menu&&Array.isArray(d.menu)?d.menu:h||(null===(o=n.menuTypeMap)||void 0===o?void 0:o.get(qE)),n.__currentData=r,n.showMenu(l,u,p,{width:d.width,height:d.height,clientX:a.clientX,clientY:a.clientY})}}),this.lf.on("edge:contextmenu",function(t){var e,o,r,i=t.data,a=t.position,s=t.e,l=a.domOverlayPosition,u=l.x,c=l.y,d=i.id,p=n.lf.graphModel.getEdgeModelById(d);if(p&&!n.__isSilentMode){var h=[],f=null===(e=n.menuTypeMap)||void 0===e?void 0:e.get(p.type);h=p&&p.menu&&Array.isArray(p.menu)?p.menu:f||(null!==(r=null===(o=n.menuTypeMap)||void 0===o?void 0:o.get(ZE))&&void 0!==r?r:[]),n.__currentData=i,n.showMenu(u,c,h,{width:p.width,height:p.height,clientX:s.clientX,clientY:s.clientY})}}),this.lf.on("blank:contextmenu",function(t){var e,o,r=t.position;if(!n.__isSilentMode){var i=null!==(o=null===(e=n.menuTypeMap)||void 0===e?void 0:e.get($E))&&void 0!==o?o:[],a=r.domOverlayPosition,s=a.x,l=a.y;n.__currentData=YE({},r.canvasOverlayPosition),n.showMenu(s,l,i)}}),this.lf.on("selection:contextmenu",function(t){var e,o=t.data,r=t.position;if(!n.__isSilentMode){var i=null===(e=n.menuTypeMap)||void 0===e?void 0:e.get(JE),a=r.domOverlayPosition,s=a.x,l=a.y;n.__currentData=o,n.showMenu(s,l,i)}}),this.lf.on("node:mousedown",function(){n.__menuDOM.style.display="none"}),this.lf.on("edge:click",function(){n.__menuDOM.style.display="none"}),this.lf.on("blank:click",function(){n.__menuDOM.style.display="none"}))},t.prototype.destroy=function(){var t;this.__editConfigChangeHandler&&this.lf.off("editConfig:changed",this.__editConfigChangeHandler),this.__menuDOM&&(null===(t=null==this?void 0:this.__container)||void 0===t||t.removeChild(this.__menuDOM),this.__menuDOM=void 0)},t.pluginName="menu",t}(),nw=function(){function t(t){var e=t.lf,n=this;this.lf=e,this.lf.setPatternItems=function(t){n.setPatternItems(t)}}return t.prototype.render=function(t,e){var n=this;this.destroy(),this.shapeList&&0!==this.shapeList.length?(this.panelEl=document.createElement("div"),this.panelEl.className="lf-dndpanel",this.shapeList.forEach(function(t){var e;null===(e=n.panelEl)||void 0===e||e.appendChild(n.createDndItem(t))}),e.appendChild(this.panelEl),this.domContainer=e):this.domContainer=e},t.prototype.destroy=function(){this.domContainer&&this.panelEl&&this.domContainer.contains(this.panelEl)&&this.domContainer.removeChild(this.panelEl)},t.prototype.setPatternItems=function(t){this.shapeList=t,this.domContainer&&this.render(this.lf,this.domContainer)},t.prototype.createDndItem=function(t){var e=this,n=document.createElement("div");n.className=t.className?"lf-dnd-item ".concat(t.className):"lf-dnd-item";var o=document.createElement("div");if(o.className="lf-dnd-shape",t.icon&&(o.style.backgroundImage="url(".concat(t.icon,")")),n.appendChild(o),t.label){var r=document.createElement("div");r.innerText=t.label,r.className="lf-dnd-text",n.appendChild(r)}return t.disabled?(n.classList.add("disabled"),n.onmousedown=function(){t.callback&&t.callback(e.lf,e.domContainer)},n):(n.onmousedown=function(){t.type&&e.lf.dnd.startDrag({type:t.type,properties:t.properties,text:t.text}),t.callback&&t.callback(e.lf,e.domContainer)},n.ondblclick=function(n){e.lf.graphModel.eventCenter.emit("dnd:panel-dbclick",{e:n,data:t})},n.onclick=function(n){e.lf.graphModel.eventCenter.emit("dnd:panel-click",{e:n,data:t})},n.oncontextmenu=function(n){e.lf.graphModel.eventCenter.emit("dnd:panel-contextmenu",{e:n,data:t})},n)},t.pluginName="dndPanel",t}(),ow=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},rw=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},iw=function(){function t(t){var e,n=t.lf,o=t.options,r=this;this.disabled=!0,this.isWholeNode=!0,this.isWholeEdge=!0,this.originStatusSaved=!1,this.exclusiveMode=!1,this.mouseDownInfo=null,this.originalStopMoveGraph=!1,this.handleBlankMouseDown=function(t){var e=t.e;r.handleMouseDown(e)},this.draw=function(t){var e=r.lf.getPointByClient(t.clientX,t.clientY).domOverlayPosition,n=e.x,o=e.y;if(r.endPoint={x:n,y:o},r.startPoint){var i=r.startPoint,a=i.x,s=i.y,l=a,u=s,c=n-a,d=o-s;n<a&&(l=n,c=a-n),o<s&&(u=o,d=s-o),r.wrapper&&(r.wrapper.style.left="".concat(l,"px"),r.wrapper.style.top="".concat(u,"px"),r.wrapper.style.width="".concat(c,"px"),r.wrapper.style.height="".concat(d,"px"))}},this.drawOff=function(t){if(r.lf.updateEditConfig({stopMoveGraph:r.originalStopMoveGraph}),r.originStatusSaved=!1,r.mouseDownInfo){var e=r.mouseDownInfo,n=e.x,o=e.y,i=e.time;if(Math.abs(t.clientX-n)<5&&Math.abs(t.clientY-o)<5&&Date.now()-i<200)return r.lf.clearSelectElements(),void r.cleanupSelectionState()}var a=ne(r.startPoint),s=ne(r.endPoint);if(document.removeEventListener("mousemove",r.draw),r.exclusiveMode||document.removeEventListener("mouseup",r.drawOff),a&&s){n=a.x,o=a.y;var l=s.x,u=s.y,c=[Math.min(n,l),Math.min(o,u)],d=[Math.max(n,l),Math.max(o,u)];if(r.lf.emit("selection:selected-area",{topLeft:c,bottomRight:d}),Math.abs(l-n)<10&&Math.abs(u-o)<10)return void(r.wrapper&&(r.wrapper.oncontextmenu=null,r.container&&r.wrapper.parentNode===r.container&&r.container.removeChild(r.wrapper),r.wrapper=void 0));var p=r.lf.graphModel.getAreaElement(c,d,r.isWholeEdge,r.isWholeNode,!0),h=r.lf.graphModel,f=h.dynamicGroup,g=h.group,y=[],v=r.lf.getSelectElements(),m=new Set(rw(rw([],ow(v.nodes.map(function(t){return t.id})),!1),ow(v.edges.map(function(t){return t.id})),!1));p.forEach(function(t){if(g){var e=g.getNodeGroup(t.id);if(p.includes(e))return}if(f){e=f.getGroupByNodeId(t.id);if(p.includes(e))return}r.exclusiveMode&&m.has(t.id)?r.lf.deselectElementById(t.id):(r.lf.selectElementById(t.id,!0),y.push(t))}),r.startPoint=void 0,r.endPoint=void 0,y.length>0&&r.lf.emit("selection:drop",{e:t}),r.lf.emit("selection:selected",{elements:y,leftTopPoint:c,rightBottomPoint:d})}r.wrapper&&(r.wrapper.oncontextmenu=null,r.container&&r.wrapper.parentNode===r.container&&r.container.removeChild(r.wrapper),r.wrapper=void 0)},this.lf=n,this.exclusiveMode=null!==(e=null==o?void 0:o.exclusiveMode)&&void 0!==e&&e,n.openSelectionSelect=function(){r.openSelectionSelect()},n.closeSelectionSelect=function(){r.closeSelectionSelect()},n.setSelectionSelectMode=function(t){r.setExclusiveMode(t)},this.handleMouseDown=this.handleMouseDown.bind(this),this.draw=this.draw.bind(this),this.drawOff=this.drawOff.bind(this)}return t.prototype.render=function(t,e){this.container=e},t.prototype.cleanupSelectionState=function(){this.wrapper&&(this.wrapper.oncontextmenu=null,this.container&&this.wrapper.parentNode===this.container&&this.container.removeChild(this.wrapper),this.wrapper=void 0),this.startPoint=void 0,this.endPoint=void 0,this.mouseDownInfo=null,document.removeEventListener("mousemove",this.draw),document.removeEventListener("mouseup",this.drawOff)},t.prototype.setExclusiveMode=function(t){void 0===t&&(t=!1),this.exclusiveMode!==t&&(this.cleanupSelectionState(),this.exclusiveMode=t,this.container&&!this.disabled&&(this.removeEventListeners(),this.addEventListeners()))},t.prototype.addEventListeners=function(){this.container&&(this.exclusiveMode?(this.container.style.pointerEvents="auto",this.container.addEventListener("mousedown",this.handleMouseDown)):(this.container.style.pointerEvents="none",this.lf.on("blank:mousedown",this.handleBlankMouseDown)))},t.prototype.removeEventListeners=function(){this.container&&(this.container.style.pointerEvents="none",this.container.removeEventListener("mousedown",this.handleMouseDown)),this.lf.off("blank:mousedown",this.handleBlankMouseDown)},t.prototype.handleMouseDown=function(t){var e;if(this.container&&!this.disabled&&!(2===t.button)){this.cleanupSelectionState(),this.mouseDownInfo={x:t.clientX,y:t.clientY,time:Date.now()},this.originStatusSaved||(this.originalStopMoveGraph=this.lf.getEditConfig().stopMoveGraph,this.originStatusSaved=!0),this.lf.updateEditConfig({stopMoveGraph:!0});var n=this.lf.getPointByClient(t.clientX,t.clientY).domOverlayPosition,o=n.x,r=n.y;this.startPoint={x:o,y:r},this.endPoint={x:o,y:r};var i=document.createElement("div");i.className="lf-selection-select",i.oncontextmenu=function(t){t.preventDefault()},i.style.top="".concat(this.startPoint.y,"px"),i.style.left="".concat(this.startPoint.x,"px"),null===(e=this.container)||void 0===e||e.appendChild(i),this.wrapper=i,document.addEventListener("mousemove",this.draw),document.addEventListener("mouseup",this.drawOff)}},t.prototype.setSelectionSense=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0),this.isWholeEdge=t,this.isWholeNode=e},t.prototype.openSelectionSelect=function(){this.disabled||this.closeSelectionSelect(),this.container&&(this.cleanupSelectionState(),this.addEventListeners(),this.open())},t.prototype.closeSelectionSelect=function(){if(this.container){if(this.wrapper&&this.startPoint&&this.endPoint){var t=ne(this.endPoint),e=new MouseEvent("mouseup",{clientX:t.x,clientY:t.y});this.drawOff(e)}this.cleanupSelectionState(),this.removeEventListeners(),this.close()}},t.prototype.open=function(){this.disabled=!1},t.prototype.close=function(){this.disabled=!0},t.pluginName="selectionSelect",t}(),aw=function(){return aw=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},aw.apply(this,arguments)},sw=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},lw=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},uw=function(t,e){var n=[],o=[],r=function(t,o,i){t&&(i&&o.unshift.apply(o,lw([],sw(e.getEdgeModels({sourceNodeId:t.id,targetNodeId:null==i?void 0:i.id}).map(function(t){return t.id})),!1)),o.includes(t.id)?n.push(o):(o.unshift(t.id),t.incoming.nodes.length?t.incoming.nodes.forEach(function(e){r(e,o.slice(),t)}):n.push(o)))},i=function(t,n,r){t&&(r&&n.push.apply(n,lw([],sw(e.getEdgeModels({sourceNodeId:null==r?void 0:r.id,targetNodeId:t.id}).map(function(t){return t.id})),!1)),n.includes(t.id)?o.push(n):(n.push(t.id),t.outgoing.nodes.length?t.outgoing.nodes.forEach(function(e){i(e,n.slice(),t)}):o.push(n)))};return r(t,[]),i(t,[]),lw([],sw(new Set(lw(lw([],sw(n.flat()),!1),sw(o.flat()),!1))),!1)},cw=function(){function t(t){var e=t.lf,n=t.options;this.mode="path",this.enable=!0,this.tempStyles={};var o=n.mode,r=void 0===o?"path":o,i=n.enable,a=void 0===i||i;this.lf=e,this.mode=r,this.enable=a}return t.prototype.setMode=function(t){this.mode=t},t.prototype.setEnable=function(t){this.enable=t},t.prototype.highlightSingle=function(t){var e=this.lf.getModelById(t);"node"===(null==e?void 0:e.BaseType)?e.updateStyles(this.tempStyles[t]):"edge"===(null==e?void 0:e.BaseType)&&(e.updateStyles(this.tempStyles[t]),e.sourceNode.updateStyles(this.tempStyles[e.sourceNode.id]),e.targetNode.updateStyles(this.tempStyles[e.targetNode.id])),this.lf.emit("highlight:single",{data:e})},t.prototype.highlightNeighbours=function(t){var e=this,n=this.lf.getModelById(t),o=[];if("node"===(null==n?void 0:n.BaseType)){n.updateStyles(this.tempStyles[t]);var r=n.incoming,i=r.nodes,a=r.edges,s=n.outgoing,l=s.nodes,u=s.edges;Co(i,l).forEach(function(t){t.updateStyles(e.tempStyles[t.id])}),Co(a,u).forEach(function(t){t.updateStyles(e.tempStyles[t.id])}),o=Hs(Co(o,i,l,a,u),"id")}else"edge"===(null==n?void 0:n.BaseType)&&(n.updateStyles(this.tempStyles[t]),n.sourceNode.updateStyles(this.tempStyles[n.sourceNode.id]),n.targetNode.updateStyles(this.tempStyles[n.targetNode.id]),o=[n.sourceNode,n.targetNode]);this.lf.emit("highlight:neighbours",{data:n,relateElements:o})},t.prototype.highlightPath=function(t){var e=this,n=function(t,e){var n=e.getModelById(t);return uw("node"===(null==n?void 0:n.BaseType)?n:null==n?void 0:n.targetNode,e)}(t,this.lf),o=[];n.forEach(function(t){var n=e.lf.getModelById(t);null==n||n.updateStyles(e.tempStyles[t]),o.push(n)}),this.lf.emit("highlight:path",{data:this.lf.getModelById(t),relateElements:o})},t.prototype.highlight=function(t,e){var n=this;(void 0===e&&(e=this.mode),this.enable)&&(Object.keys(this.tempStyles).length&&this.restoreHighlight(),Object.values(this.lf.graphModel.modelsMap).forEach(function(t){var e="node"===t.BaseType?t.getNodeStyle():t.getEdgeStyle();n.tempStyles[t.id]=aw({},e),t.setStyles({opacity:.1})}),{single:this.highlightSingle.bind(this),neighbour:this.highlightNeighbours.bind(this),path:this.highlightPath.bind(this)}[e](t))},t.prototype.restoreHighlight=function(){var t=this;Object.keys(this.tempStyles).length&&(Object.values(this.lf.graphModel.modelsMap).forEach(function(e){var n,o=null!==(n=t.tempStyles[e.id])&&void 0!==n?n:{};e.updateStyles(aw({},o))}),this.tempStyles={})},t.prototype.render=function(){var t=this;this.lf.on("node:mouseenter",function(e){var n=e.data;return t.highlight(n.id)}),this.lf.on("edge:mouseenter",function(e){var n=e.data;return t.highlight(n.id)}),this.lf.on("node:mouseleave",this.restoreHighlight.bind(this)),this.lf.on("edge:mouseleave",this.restoreHighlight.bind(this)),this.lf.on("history:change",this.restoreHighlight.bind(this))},t.prototype.destroy=function(){},t.pluginName="highlight",t}(),dw=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),pw=function(){return pw=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},pw.apply(this,arguments)},hw=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},fw={tr:"tl",lb:"tl",tl:"tr",rb:"tr",br:"bl",lt:"bl",bl:"br",rt:"br"};function gw(t,e,n,o){var r,i=function(t,e){var n=e[0]-t[0],o=e[1]-t[1],r=Math.abs(n),i=Math.abs(o);return i<=1&&r>1?n<0?"l":"r":r<=1&&i>1?o<0?"t":"b":r<=1&&i<=1?"":r<i?n<0?"l":"r":o<0?"t":"b"},a=i(t,e),s=i(e,n),l=Math.min(Math.hypot(e[0]-t[0],e[1]-t[1])/2,Math.hypot(n[0]-e[0],n[1]-e[1])/2,o)||.2*o,u="".concat(a).concat(s),c=fw[u]||"-",d="";if("-"===c)d+="L ".concat(e[0]," ").concat(e[1]);else{var p=hw(function(t,e,n,o){var r=[t[0],t[1]],i=[t[0],t[1]];switch(n){case"tl":return"tr"===e?(r[1]+=o,i[0]+=o):"lb"===e&&(r[0]+=o,i[1]+=o),[r,i];case"tr":return"tl"===e?(r[1]+=o,i[0]-=o):"rb"===e&&(r[0]-=o,i[1]+=o),[r,i];case"bl":return"br"===e?(r[1]-=o,i[0]+=o):"lt"===e&&(r[0]+=o,i[1]-=o),[r,i];case"br":return"bl"===e?(r[1]-=o,i[0]-=o):"rt"===e&&(r[0]-=o,i[1]-=o),[r,i];default:return[]}}(e,u,c,l),2),h=p[0],f=p[1];h&&f&&(d+="L ".concat(h[0]," ").concat(h[1]," Q ").concat(e[0]," ").concat(e[1]," ").concat(f[0]," ").concat(f[1]),r=hw(f,2),e[0]=r[0],e[1]=r[1])}return d}!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}dw(e,t),e.prototype.getEdge=function(){var t=this.props.model,e=t.points,n=t.isAnimation,o=t.arrowConfig,r=t.radius,i=void 0===r?5:r,a=t.getEdgeStyle(),s=t.getEdgeAnimationStyle(),l=function(t){for(var e=t,n=1;n<e.length-1;){var o=hw(e[n-1],2),r=o[0],i=o[1],a=hw(e[n],2),s=a[0],l=a[1],u=hw(e[n+1],2),c=u[0],d=u[1];r===s&&s===c||i===l&&l===d?e.splice(n,1):n++}return e}(e.split(" ").map(function(t){return t.split(",").map(function(t){return+t})})),u=function(t,e){var n=0,o="";if(2===t.length)o+="M".concat(t[n][0]," ").concat(t[n++][1]," L ").concat(t[n][0]," ").concat(t[n][1]);else{for(o+="M".concat(t[n][0]," ").concat(t[n++][1]);n+1<t.length;)o+=gw(t[n-1],t[n],t[1+n++],e);o+="L ".concat(t[n][0]," ").concat(t[n][1])}return o}(l,i),c=pw(pw(pw({style:n?s:{}},a),o),{fill:"none"});return zl("path",pw({d:u},c))}}(Hm),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}dw(e,t)}(dy);var yw=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),vw=function(){return vw=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},vw.apply(this,arguments)},mw=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var o,r,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},bw=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))},_w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return yw(e,t),e.prototype.getLabelShape=function(){var t=this.props.model,e=t.id,n=t.x,o=t.y,r=t.width,i=t.height,a=t.properties,s=this.props.model.getNodeStyle();return zl("svg",{x:n-r/2,y:o-i/2,width:50,height:24,style:"z-index: 0; background: none; overflow: auto;"},[a.labelText?zl("text",{x:0,y:-5,fontSize:"16px",fill:s.stroke},a.labelText):"",a.disabledDelete?"":zl("text",{x:a.labelText?50:0,y:-5,fontSize:"24px",cursor:"pointer",fill:s.stroke,onclick:this.handleCustomDeleteIconClick.bind(this,e)},"x")])},e.prototype.getShape=function(){var t=this.props.model,e=t.x,n=t.y,o=t.width,r=t.height,i=t.id,a=this.props.model.getNodeStyle();return zl("g",{},[zl("rect",vw(vw({},a),{x:e-o/2,y:n-r/2,width:o,height:r,id:i})),this.getLabelShape()])},e.prototype.toFront=function(){},e.prototype.handleCustomDeleteIconClick=function(t){this.props.graphModel.deleteNode(t)},e}(cm),xw=function(t){function e(){var e=t.apply(this,bw([],mw(arguments),!1))||this;return e.d=10,e.isResize=!1,e}return yw(e,t),e.prototype.initNodeData=function(e){e.text={value:"",x:e.x,y:e.y,draggable:!1,editable:!1},t.prototype.initNodeData.call(this,e),this.zIndex=0,this.draggable=!0},e.prototype.setAttributes=function(){var t,e=this;this.points=[],(null===(t=this.properties)||void 0===t?void 0:t.node_selection_ids).length>1&&setTimeout(function(){var t;e.updatePointsByNodes((null===(t=e.properties)||void 0===t?void 0:t.node_selection_ids)||[])})},e.prototype.getNodeStyle=function(){var e=t.prototype.getNodeStyle.call(this);return e.stroke=this.properties.strokeColor||"#008000",e.strokeDasharray="10 5",e},e.prototype.getDefaultAnchor=function(){return[]},e.prototype.updatePoints=function(t){this.points=t},e.prototype.updateCoordinate=function(t){var e=t.x,n=t.y;this.x=e,this.y=n},e.prototype.updatePointsByNodes=function(t){var e=this,n=[],o=1/0,r=1/0,i=-1/0,a=-1/0;t.forEach(function(t){var n=e.graphModel.getNodeModelById(t);if(n){var s=n.width,l=n.height,u=n.x,c=n.y;o=Math.min(o,u-s/2-e.d),r=Math.min(r,c-l/2-e.d),i=Math.max(i,u+s/2+e.d),a=Math.max(a,c+l/2+e.d)}}),n.push([o,r],[i,r],[i,a],[o,a]),[o,r,i,a].some(function(t){return Math.abs(t)===1/0})||(this.updatePoints(n),this.updateCoordinate({x:(i+o)/2,y:(a+r)/2}))},e.prototype.resize=function(e){var n;this.isResize=!0;for(var o=e.width,r=e.height,i=o/this.width,a=r/this.height,s=(this.properties.node_selection_ids||[]).slice(),l=[],u=new Set;s.length;){var c=s.shift(),d=null===(n=this.graphModel.nodesMap[c])||void 0===n?void 0:n.model;d&&(ww(d)?u.has(d.id)||(u.add(d.id),s.push.apply(s,bw([],mw(d.properties.node_selection_ids||[]),!1))):l.push(d))}var p=this.x-this.width/2,h=this.y-this.height/2,f=t.prototype.resize.call(this,e),g=this.x-this.width/2,y=this.y-this.height/2;return l.forEach(function(t){t.width=t.width*i,t.height=t.height*a;var e=(t.x-p)*i+g-t.x,n=(t.y-h)*a+y-t.y;t.move(e,n,!0)}),this.isResize=!1,f},e}(ky),Ew="node-selection";!function(){function t(t){var e=t.lf;this.selectNodes=[],this.d=10,this.lf=e,e.register({type:Ew,view:_w,model:xw})}Object.defineProperty(t.prototype,"selectNodesIds",{get:function(){return this.selectNodes.map(function(t){return t.id})},enumerable:!1,configurable:!0}),t.prototype.addNodeSelection=function(){this.lf.addNode({type:"node-selection",text:"",properties:{node_selection_ids:this.selectNodesIds},x:0,y:0}).updatePointsByNodes(this.selectNodesIds)},t.prototype.updateNodeSelection=function(){var t,e=this.getNodeSelection();e&&(this.lf.setProperties(e.id,{node_selection_ids:this.selectNodesIds}),null===(t=this.lf.getNodeModelById(e.id))||void 0===t||t.updatePointsByNodes(this.selectNodesIds))},t.prototype.getNodeSelection=function(){var t=this,e=this.selectNodesIds,n=this.lf.getGraphRawData(),o=e.filter(function(e){return e!==t.currentClickNode.id});return n.nodes.find(function(t){if("node-selection"===t.type){var e=O(t,"properties.node_selection_ids",[]);return o.every(function(t){return e.includes(t)})}return!1})},t.prototype.onNodeChange=function(t,e){var n=t.graphModel.nodes.filter(function(t){return!!ww(t)&&(t.properties.node_selection_ids||[]).includes(e.id)});Promise.resolve().then(function(){n.forEach(function(t){t.updatePointsByNodes(t.properties.node_selection_ids||[])})})},t.prototype.render=function(t){var e=this;this.lf=t,t.on("node:click",function(n){var o;if(n.e.shiftKey&&n.data.type!==Ew){e.currentClickNode=n.data;var r=!1;e.selectNodesIds.includes(n.data.id)&&(null===(o=e.lf.getNodeModelById(n.data.id))||void 0===o||o.setSelected(!1),r=!0);var i=t.getSelectElements(!0).nodes;e.selectNodes=i,1===e.selectNodes.length?r?e.updateNodeSelection():e.addNodeSelection():e.selectNodes.length>1&&e.updateNodeSelection()}}),t.graphModel.addNodeMoveRules(function(n,o,r){if(e.onNodeChange(t,n),ww(n)&&!n.isResize){var i=n.properties.node_selection_ids||[];return t.graphModel.moveNodes(i,o,r,!0),!0}return!0}),t.graphModel.addNodeResizeRules(function(n){return ww(n)||e.onNodeChange(t,n),!0})},t.pluginName="node-selection"}();var ww=function(t){return!(!t||t.type!==Ew)},Sw=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ow=function(){return Ow=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ow.apply(this,arguments)};!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Sw(e,t),e.prototype.getLabelShape=function(){var t=this.props.model,e=t.x,n=t.y;return zl("text",{x:e-t.width/2+5,y:n-t.height/2+16,fontSize:12,fill:"blue"},t.properties.moreText)},e.prototype.getShape=function(){var t=this.props.model,e=t.x,n=t.y,o=t.width,r=t.height,i=this.props.model.getNodeStyle();return zl("g",{},[zl("rect",Ow(Ow({},i),{fill:"#FFFFFF",x:e-o/2,y:n-r/2})),this.getLabelShape()])}}(rm);export{ny as B,by as C,nw as D,My as E,Wy as H,ay as L,ew as M,dy as P,Iy as R,iw as S,zy as T,zl as _,bm as a,Hm as b,sm as c,rm as d,Im as e,Pb as f,GE as g,km as h,ym as i,Em as j,cw as k,UE as l};
