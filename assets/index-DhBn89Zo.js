import{t as e}from"./table_mixin-B0gHWcei.js";import{e as t}from"./table-example-api-BhZW3ZY4.js";import{U as a}from"./UploadHttpComponent-BJCG3rvV.js";import{d as i}from"./dynamic_form-B7Y8ZvHE.js";import{v as l}from"./validateRules-33HAVMqP.js";import{z as s,A as o,B as d,_ as r,r as n,o as h,c,b as m,F as p,q as g,e as u,w as b,h as f,t as x,d as v,v as y,x as w,D}from"./index-9pCzIQ7O.js";import"./view_file-CHG9eGLA.js";import"./zcq-sb-dky-tsGGPx-L.js";import"./polyfill-lGe4XDVY.js";let T=o.base;const R={loadTableDataService:e=>s({url:"".concat(T,"/gg/queryGg"),method:"post",data:e,showLoading:!0}),saveTableDataService:e=>s({url:"".concat(T,"/gg/saveGgList"),method:"post",data:e,showLoading:!0}),doDelTableDataService:e=>s({url:"".concat(T,"/gg/deleteGg"),method:"post",data:e,showLoading:!0}),exportTableDataFileService:(e,t)=>s({url:"".concat(T,"/common/deleteById"),method:"post",data:e,responseType:"blob",showLoading:!0}).then(e=>{d(e,t,"xlsx")}),downloadModuleService:e=>s({url:"".concat(T,"/common/downLoadModule"),method:"post",data:e,responseType:"blob",showLoading:!0}).then(e=>{d(e,"导入模板","xlsx")})},C={class:"page_content"},L={class:"header-item"},S={class:"header-item"};const k=r({name:"announcement",mixins:[e],components:{UploadHttpComponent:a},data:()=>({time:["",""],total:0,searchParams:{sortOrder:"",sortColumn:""},tableData:[],isAutoWrap:!1}),watch:{time:{handler(e){e?(this.searchParams.startTime=e[0],this.searchParams.endTime=e[1]):(this.searchParams.startTime="",this.searchParams.endTime="")},immediate:!1}},computed:{tableHeaderList:()=>[{type:"checkbox",width:50},{type:"seq",width:60},{field:"ggbt",title:"公告标题",minWidth:120},{field:"yxq",title:"公告有效期",width:150,sortable:!0},{field:"fbr",title:"发布人",width:120},{field:"fbrq",title:"发布日期",width:150,sortable:!0},{field:"nr",title:"公告内容",type:"html",minWidth:120,headerAlign:"center",align:"left"}],tableDetailHeaderList(){return[{field:"ggbt",title:"公告标题",colWidth:"50%",editRender:{name:"ElInput",props:{clearable:!0}}},{field:"yxq",title:"公告有效期",colWidth:"50%",editRender:{name:"ElDatePicker",props:{type:"date",labelFormat:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD"}}},{field:"ggdxIdList",title:"公告对象",colWidth:"50%",editRender:{name:"$ElTreeSelect",data:this.$store.state.selectOptionsObj.ggdx,props:{clearable:!0,filterable:!0,multiple:!0}}},{field:"fbr",title:"发布人",colWidth:"50%",editRender:{}},{field:"fbrq",title:"发布日期",colWidth:"50%",editRender:{}},{field:"fileList",title:"文件",colWidth:"50%",editRender:{name:"vxeUpload",props:{multiple:!0,types:["doc","docx","xls","xlsx","pdf"],type:"gg",limitSize:50}}},{field:"nr",title:"公告内容",editRender:{name:"ElTiptap"}}]},editRules:()=>({ggbt:[{required:!0,message:"公告标题不能为空"}],yxq:[{required:!0,message:"公告有效期不能为空"},l.date.rule],ggdxId:[{required:!0,message:"公告对象不能为空"}]}),gridOptions(){return{height:"auto",border:!0,round:!0,headerAlign:"center",align:"center",loading:!1,rowConfig:{isCurrent:!0,isHover:!0},radioConfig:{highlight:!0},checkboxConfig:{highlight:!0},columnConfig:{resizable:!0},sortConfig:{remote:!0},filterConfig:{remote:!0},headerCellClassName:"row-class",pagerConfig:this.pagerConfig,editConfig:{},proxyConfig:{seq:!0,showResponseMsg:!1,showActionMsg:!1,sort:!0,filter:!0,ajax:{query:({page:e,sorts:t,filters:a})=>this.loadTableApi(e,t,a),queryAll:({sorts:e,filters:t})=>this.loadTableApi({pageSize:1e5,currentPage:1},e,t),delete:({body:e})=>this.doDeleteApi(e.removeRecords),save:({body:e})=>this.doSaveApi(e)}},exportConfig:{filename:"系统公告表格",sheetName:"sheet1",type:"xlsx",mode:"all",modes:["current","selected","all"],message:!1,columns:this.tableHeaderList.filter(e=>"checkbox"!==e.type),exportMethod:this.exportMethod,afterExportMethod:this.afterExportMethod},editRules:this.editRules,columns:this.tableHeaderList}},defaultLeftButtons:()=>[{type:"gradientGreen",name:"查询"}],defaultRightButtons:()=>[{type:"gradientBlue",name:"新增"},{type:"gradientRed",name:"删除"}]},mounted(){},methods:{reloadTableData(){this.$refs.xTable.commitProxy("query")},loadTableData(){this.$refs.xTable.commitProxy("reload")},loadTableApi(e,t,a){let i=this.getRealParams(this.searchParams,e,t,a);return new Promise(t=>{R.loadTableDataService(i).then(a=>{1e5==e.pageSize?(this.total=a.total,t(a.data)):(this.total=a.total,t({result:a.data,page:{total:a.total}}))})})},doAdd(){D.getAddIdService().then(e=>{this.$vxeModal.show(i,{tableHeaderList:this.tableDetailHeaderList,validateRules:this.editRules,row:{id:e.data,fileList:[]},labelWidth:"120px"},{width:1200,title:"新增",height:window.innerHeight-200},{doSubmit:e=>{e.ggdxId=e.ggdxIdList.join(","),R.saveTableDataService({data:[e]}).then(e=>{this.$message.success(e.data),this.$vxeModal.closeAll(),this.loadTableData()})}})})},doSave(){this.$refs.xTable.commitProxy("save")},doSaveApi(e){return new Promise((a,i)=>{let{insertRecords:l,updateRecords:s}=e,o=[...l,...s];t.saveTableDataService({data:o}).then(e=>{this.$message.success(e.data),a()}).catch(()=>{i()})})},doDelete(){const e=this.getCheckboxRecords();e&&e.length>0&&this.$confirm("确认删除勾选的".concat(e.length,"条数据吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$refs.xTable.commitProxy("delete")})},doDeleteApi(e){return new Promise((t,a)=>{let i=e.map(e=>e.id).join(",");R.doDelTableDataService({ids:i}).then(e=>{this.$message.success(e.data),t()}).catch(()=>{a()})})},downloadModule(){t.downloadModuleService()},resetParams(){this.searchParams.keyword="",this.time=["",""],this.$nextTick(function(){this.loadTableData()})},cellDblclick(e){let{row:t}=e;this.openDetail(t)},openDetail(e){this.$vxeModal.show(i,{tableHeaderList:this.tableDetailHeaderList,validateRules:this.editRules,row:e,labelWidth:"120px"},{width:1200,title:"详情",height:window.innerHeight-200},{close:()=>{},doSubmit:e=>{e.ggdxId=e.ggdxIdList.join(","),R.saveTableDataService({data:[e]}).then(e=>{this.$message.success(e.data),this.$vxeModal.closeAll(),this.loadTableData()})}})}}},[["render",function(e,t,a,i,l,s){const o=n("el-button"),d=n("vxe-grid");return h(),c("div",C,[m("header",null,[m("section",null,[m("div",L,[(h(!0),c(p,null,g(s.defaultLeftButtons,(t,a)=>(h(),u(o,{type:t.type,plain:t.plain,key:a+"defaultLeftButtons",onClick:a=>e.btnClick(t)},{default:b(()=>[f(x(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])]),m("section",null,[m("div",S,[(h(!0),c(p,null,g(s.defaultRightButtons,(t,a)=>(h(),u(o,{type:t.type,plain:t.plain,key:a+"defaultRightButtons",onClick:a=>e.btnClick(t)},{default:b(()=>[f(x(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])])]),m("article",null,[v(d,y(s.gridOptions,{ref:"xTable"},w({cellDblclick:s.cellDblclick})),null,16)])])}],["__scopeId","data-v-8d0c4767"]]);export{k as default};
