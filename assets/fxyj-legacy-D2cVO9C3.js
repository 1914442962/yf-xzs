System.register(["./table_mixin-legacy-D9U6ScmD.js","./index-legacy-BhBZRkTD.js","./DateRangerPickerComponent-legacy-CNev8SyW.js","./dynamic_form_plus-legacy-8X25qoOr.js","./polyfill-legacy-aWkUxw0k.js","./zcq-sb-dky-legacy-DHYpiqBX.js","./view_file-legacy-B8YEJj9G.js"],function(e,t){"use strict";var i,a,s,d,l,r,o,n,h,m,u,c,p,f,g,y,b,w,R,C,x;return{setters:[e=>{i=e.t},e=>{a=e.A,s=e.B,d=e.b,l=e.r,r=e.o,o=e.c,n=e.d,h=e.e,m=e.w,u=e.i,c=e.g,p=e.F,f=e.v,g=e.f,y=e.t,b=e.j,w=e.x,R=e.z},e=>{C=e.D},e=>{x=e.d},null,null,null],execute:function(){let t=s.base;const k={loadTableDataService:e=>a({url:`${t}/fxyj/queryRFxyjZxz`,method:"post",data:e,showLoading:!0}),doSendMessageService:e=>a({url:`${t}/fxyj/sendMessageRFxyj`,method:"post",data:e,showLoading:!0}),initZxzToNFxyjService:e=>a({url:`${t}/fxyj/initZxzToNFxyj`,method:"post",data:e})},T={class:"page_content"},j={class:"header-item"},D={class:"header-item"},v={class:"header-item"},P={class:"header-item"};e("default",d({name:"fxyj",mixins:[i],components:{DateRangerPickerComponent:C},data:()=>({buttonType:"今日执行",total:0,searchParams:{keyword:"",sortOrder:"",sortColumn:"",sdt:"",edt:""},tableData:[],isAutoWrap:!1,rqOptions:[{label:"今日执行",value:"今日执行"},{label:"本周执行",value:"本周执行"},{label:"本月执行",value:"本月执行"}]}),watch:{},computed:{tableHeaderList:()=>[{type:"checkbox",width:50,fixed:"left"},{type:"seq",width:60,fixed:"left"},{field:"businessNo",title:"项目编号",width:180},{field:"jxddh",title:"检修单编号",width:180},{field:"topic",title:"主题",minWidth:120,headerAlign:"center",align:"left"},{field:"formattedTimeRange1",title:"时段",width:280},{field:"formattedTimeRange2",title:"延期时段",width:280},{field:"supplyTime",title:"发布日期",width:150,sortable:!0,formatter:["formatterTime"]},{title:"操作",width:160,fixed:"right",slots:{default:"action"}}],tableDetailHeaderList:()=>[{field:"topic",title:"主题",width:"100%",itemClass:"borderRight",editRender:{}},{field:"riskGrade",title:"风险等级",width:"100%",itemClass:"borderRight",editRender:{}},{field:"reason",title:"停电设备/事由",width:"100%",itemClass:"borderRight",editRender:{}},{field:"formattedTimeRange",title:"工期时段",width:"100%",itemClass:"borderRight",editRender:{}},{field:"riskAnalysis",title:"运行安全\n风险分析",width:"100%",itemClass:"borderRight",editRender:{}},{field:"ykcs",title:"风险管控\n实施要求",width:"100%",itemClass:"borderRight",editRender:{}},{field:"singDepartment",title:"签收部门",width:"100%",itemClass:"borderRight",editRender:{}},{field:"staffing",title:"编制",width:"50%",editRender:{}},{field:"zxldUser",title:"审核",width:"50%",itemClass:"borderRight",editRender:{}},{field:"ajb",title:"安监部",width:"100%",itemClass:"borderRight",editRender:{}},{field:"sbb",title:"设备部",width:"100%",itemClass:"borderRight",editRender:{}},{field:"zxldExplan",title:"中心领导审核意见",width:"100%",itemClass:"borderRight",editRender:{}},{field:"zxldUser",title:"中心领导审核人",width:"50%",editRender:{}},{field:"zxldTime",title:"中心领导审核时间",width:"50%",itemClass:"borderRight",editRender:{}},{field:"gsldExplan",title:"公司领导审核意见",width:"100%",itemClass:"borderRight",editRender:{}},{field:"gsldUser",title:"公司领导审核人",width:"50%",itemClass:"borderBottom",editRender:{}},{field:"gsldTime",title:"公司领导审核时间",width:"50%",itemClass:"borderRight borderBottom",editRender:{}}],editRules:()=>({kssj:[{required:!0,message:"开始时间不能为空"},{validator({cellValue:e,row:t}){if(e&&t.jssj&&R(e).isAfter(t.jssj))return new Error("开始时间必须在结束时间之前")}}],jssj:[{required:!0,message:"结束时间不能为空"},{validator({cellValue:e,row:t}){if(e&&t.kssj&&R(e).isBefore(t.kssj))return new Error("结束时间必须在开始时间之后")}}]}),gridOptions(){return{height:"auto",border:!0,round:!0,stripe:!0,headerAlign:"center",keepSource:!0,align:"center",loading:!1,rowConfig:{isCurrent:!0,isHover:!0},columnConfig:{resizable:!0},resizeConfig:{isDblclickAutoWidth:!0},sortConfig:{remote:!0},showOverflow:this.isAutoWrap,headerCellClassName:"row-class",pagerConfig:this.pagerConfig,proxyConfig:{seq:!0,showResponseMsg:!1,showActionMsg:!1,sort:!0,filter:!0,ajax:{query:({page:e,sorts:t,filters:i})=>this.loadTableApi(e,t,i)}},columns:this.tableHeaderList,menuConfig:{body:{options:[[{code:"collect",name:"标记重点"}]]}}}},defaultLeftButtons:()=>[{type:"gradientGreen",name:"查询"},{type:"gradientDarkGreen",name:"重置"},{type:"gradientGreen",name:"自动换行"}],defaultRightButtons:()=>[{type:"gradientBlue",name:"推送至年度风险"},{type:"gradientBlue",name:"发送短信"}]},mounted(){},methods:{resetType(e){this.searchParams.sdt="",this.searchParams.edt="",this.buttonType=e,this.loadTableData()},reloadTableData(){this.$refs.xTable.commitProxy("query")},loadTableData(){this.$refs.xTable.commitProxy("reload")},loadTableApi(e,t,i){let a=JSON.parse(JSON.stringify(this.searchParams));this.searchParams.sdt||this.searchParams.edt||("今日执行"==this.buttonType?(a.sdt=R().format("YYYY-MM-DD"),a.edt=R().format("YYYY-MM-DD")):"本周执行"==this.buttonType?(a.sdt=R().startOf("week").format("YYYY-MM-DD"),a.edt=R().endOf("week").format("YYYY-MM-DD")):(a.sdt=R().startOf("month").format("YYYY-MM-DD"),a.edt=R().endOf("month").format("YYYY-MM-DD")));let s=this.getRealParams(a,e,t,i);return new Promise(t=>{k.loadTableDataService(s).then(i=>{1e5==e.pageSize?(this.total=i.total,t(i.data)):(this.total=i.total,t({result:i.data,page:{total:i.total}}))})})},toggleWrap(){this.isAutoWrap?this.isAutoWrap=!1:this.isAutoWrap="tooltip"},resetParams(){this.searchParams.keyword="",this.searchParams.sortOrder="",this.searchParams.sortColumn="",this.searchParams.sdt="",this.searchParams.edt="",this.$nextTick(function(){this.loadTableData()})},doOpenDetail(e){this.$vxeModal.show(x,{tableHeaderList:this.tableDetailHeaderList,validateRules:this.editRules,labelWidth:"130px",showFooter:!1,row:e},{width:1e3,title:"详情",height:window.innerHeight-100},{close:()=>{}})},doViewLog(e){let t="";t=window.origin.includes("192.168.1")?`http://192.168.1.194:10015/master/window.html#/spa/ycjx-snjh/public-visit?&flag=3&type=dd&id=${e.jxdid}&parentNodeName=地调调度台`:`${window.YCJX_WEBSITE_URL}/master/window.html#/spa/ycjx-snjh/public-visit?&flag=3&type=dd&id=${e.jxdid}&parentNodeName=地调调度台`,window.open(t)},doSendMessage(e){if(e&&e.id)this.doRealSendMessage([e]);else{const e=this.getCheckboxRecords();e&&e.length>0&&this.doRealSendMessage(e)}},doRealSendMessage(e){k.doSendMessageService({data:e}).then(e=>{this.$message.success(e.data)})},doPush(){const e=this.getCheckboxRecords();e&&e.length>0&&k.initZxzToNFxyjService({data:e}).then(e=>{this.$alert(e.data.replaceAll("\n","<br />"),"提示信息",{showConfirmButton:!1,dangerouslyUseHTMLString:!0})})},beforeEditMethod:({row:e,column:t})=>!0}},[["render",function(e,t,i,a,s,d){const R=l("el-button"),C=l("el-button-group"),x=l("DateRangerPickerComponent"),k=l("el-input"),M=l("vxe-button"),Y=l("vxe-grid");return r(),o("div",T,[n("header",null,[n("section",null,[n("div",j,[h(C,null,{default:m(()=>[h(R,{type:"今日执行"===s.buttonType?"gradientBlue":"",onClick:t[0]||(t[0]=e=>d.resetType("今日执行"))},{default:m(()=>[...t[7]||(t[7]=[u("今日执行 ",-1)])]),_:1},8,["type"]),h(R,{type:"本周执行"===s.buttonType?"gradientBlue":"",onClick:t[1]||(t[1]=e=>d.resetType("本周执行"))},{default:m(()=>[...t[8]||(t[8]=[u("本周执行 ",-1)])]),_:1},8,["type"]),h(R,{type:"本月执行"===s.buttonType?"gradientBlue":"",onClick:t[2]||(t[2]=e=>d.resetType("本月执行"))},{default:m(()=>[...t[9]||(t[9]=[u("本月执行 ",-1)])]),_:1},8,["type"])]),_:1})]),h(x,{"start-time":s.searchParams.sdt,"end-time":s.searchParams.edt,updateStartTime:s.searchParams.sdt,"onUpdate:updateStartTime":t[3]||(t[3]=e=>s.searchParams.sdt=e),updateEndTime:s.searchParams.edt,"onUpdate:updateEndTime":t[4]||(t[4]=e=>s.searchParams.edt=e)},null,8,["start-time","end-time","updateStartTime","updateEndTime"]),n("div",D,[h(k,{placeholder:"请输入关键字",modelValue:s.searchParams.keyword,"onUpdate:modelValue":t[5]||(t[5]=e=>s.searchParams.keyword=e),onKeydown:c(d.loadTableData,["enter"]),title:s.searchParams.keyword,clearable:""},null,8,["modelValue","onKeydown","title"])]),n("div",v,[(r(!0),o(p,null,f(d.defaultLeftButtons,(t,i)=>(r(),g(R,{type:t.type,plain:t.plain,key:i+"defaultLeftButtons",onClick:i=>e.btnClick(t)},{default:m(()=>[u(y(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])]),n("section",null,[n("div",P,[(r(!0),o(p,null,f(d.defaultRightButtons,(t,i)=>(r(),g(R,{type:t.type,plain:t.plain,key:i+"defaultRightButtons",onClick:i=>e.btnClick(t)},{default:m(()=>[u(y(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])])]),n("article",null,[h(Y,w(d.gridOptions,{ref:"xTable",onMenuClick:t[6]||(t[6]=t=>e.menuClickEvent(t,"风险预警"))}),{action:m(({row:e})=>[h(M,{mode:"text",status:"primary",onClick:t=>d.doOpenDetail(e)},{default:m(()=>[...t[10]||(t[10]=[u("查看",-1)])]),_:1},8,["onClick"]),e.jxdid?(r(),g(M,{key:0,mode:"text",status:"primary",onClick:t=>d.doViewLog(e)},{default:m(()=>[...t[11]||(t[11]=[u("查看检修单",-1)])]),_:1},8,["onClick"])):b("",!0),h(M,{mode:"text",status:"primary",onClick:t=>d.doSendMessage(e)},{default:m(()=>[...t[12]||(t[12]=[u("发送短信",-1)])]),_:1},8,["onClick"])]),_:1},16)])])}],["__scopeId","data-v-d01917c9"]]))}}});
