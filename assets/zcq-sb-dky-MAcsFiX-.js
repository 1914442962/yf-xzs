import{a1 as e,a2 as l,I as a,H as t,a3 as s,o as i,c as d,a4 as n,q as c,a5 as o,a6 as r,f as h,a7 as u,a8 as p,J as m,a9 as b,aa as v,ab as g,A as S,B as f,b as D,a as C,r as x,e as y,ac as k,ad as z,w as L,d as N,F as I,v as w,p as Z,t as P,i as _,ae as V,af as j,g as M,j as T,ag as X,ah as O,ai as $,aj as A,ak as B,al as E}from"./index-CRHEuOwk.js";const U={__name:"splitpanes",props:{horizontal:{type:Boolean,default:!1},pushOtherPanes:{type:Boolean,default:!0},maximizePanes:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean,default:!1}},emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click","splitter-dblclick"],setup(e,{emit:l}){const d=l,n=e,c=r(),o=m([]),S=p(()=>o.value.reduce((e,l)=>(e[~~l.id]=l)&&e,{})),f=p(()=>o.value.length),D=m(null),C=m(!1),x=m({mouseDown:!1,dragging:!1,activeSplitter:null,cursorOffset:0}),y=m({splitter:null,timeoutId:null}),k=p(()=>({["splitpanes splitpanes--".concat(n.horizontal?"horizontal":"vertical")]:!0,"splitpanes--dragging":x.value.dragging})),z=(e,l)=>{const a=e.target.closest(".splitpanes__splitter");if(a){const{left:l,top:t}=a.getBoundingClientRect(),{clientX:s,clientY:i}="ontouchstart"in window&&e.touches?e.touches[0]:e;x.value.cursorOffset=n.horizontal?i-t:s-l}document.addEventListener("mousemove",L,{passive:!1}),document.addEventListener("mouseup",N),"ontouchstart"in window&&(document.addEventListener("touchmove",L,{passive:!1}),document.addEventListener("touchend",N)),x.value.mouseDown=!0,x.value.activeSplitter=l},L=e=>{x.value.mouseDown&&(e.preventDefault(),x.value.dragging=!0,requestAnimationFrame(()=>{Z(w(e)),R("resize",{event:e},!0)}))},N=e=>{x.value.dragging&&(window.getSelection().removeAllRanges(),R("resized",{event:e},!0)),x.value.mouseDown=!1,x.value.activeSplitter=null,setTimeout(()=>{x.value.dragging=!1,document.removeEventListener("mousemove",L,{passive:!1}),document.removeEventListener("mouseup",N),"ontouchstart"in window&&(document.removeEventListener("touchmove",L,{passive:!1}),document.removeEventListener("touchend",N))},100)},I=(e,l)=>{if(R("splitter-dblclick",{event:e,index:l},!0),n.maximizePanes){let a=0;o.value=o.value.map((e,t)=>(e.size=t===l?e.max:e.min,t!==l&&(a+=e.min),e)),o.value[l].size-=a,R("pane-maximize",{event:e,index:l,pane:o.value[l]}),R("resized",{event:e,index:l},!0)}},w=e=>{const l=D.value.getBoundingClientRect(),{clientX:a,clientY:t}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:a-(n.horizontal?0:x.value.cursorOffset)-l.left,y:t-(n.horizontal?x.value.cursorOffset:0)-l.top}},Z=e=>{const l=x.value.activeSplitter;let a={prevPanesSize:_(l),nextPanesSize:V(l),prevReachedMinPanes:0,nextReachedMinPanes:0};const t=0+(n.pushOtherPanes?0:a.prevPanesSize),s=100-(n.pushOtherPanes?0:a.nextPanesSize),i=Math.max(Math.min((e=>{e=e[n.horizontal?"y":"x"];const l=D.value[n.horizontal?"clientHeight":"clientWidth"];return n.rtl&&!n.horizontal&&(e=l-e),100*e/l})(e),s),t);let d=[l,l+1],c=o.value[d[0]]||null,r=o.value[d[1]]||null;const h=c.max<100&&i>=c.max+a.prevPanesSize,u=r.max<100&&i<=100-(r.max+V(l+1));if(h||u)h?(c.size=c.max,r.size=Math.max(100-c.max-a.prevPanesSize-a.nextPanesSize,0)):(c.size=Math.max(100-r.max-a.prevPanesSize-V(l+1),0),r.size=r.max);else{if(n.pushOtherPanes){const e=P(a,i);if(!e)return;({sums:a,panesToResize:d}=e),c=o.value[d[0]]||null,r=o.value[d[1]]||null}null!==c&&(c.size=Math.min(Math.max(i-a.prevPanesSize-a.prevReachedMinPanes,c.min),c.max)),null!==r&&(r.size=Math.min(Math.max(100-i-a.nextPanesSize-a.nextReachedMinPanes,r.min),r.max))}},P=(e,l)=>{const a=x.value.activeSplitter,t=[a,a+1];return l<e.prevPanesSize+o.value[t[0]].min&&(t[0]=j(a).index,e.prevReachedMinPanes=0,t[0]<a&&o.value.forEach((l,s)=>{s>t[0]&&s<=a&&(l.size=l.min,e.prevReachedMinPanes+=l.min)}),e.prevPanesSize=_(t[0]),void 0===t[0])?(e.prevReachedMinPanes=0,o.value[0].size=o.value[0].min,o.value.forEach((l,t)=>{t>0&&t<=a&&(l.size=l.min,e.prevReachedMinPanes+=l.min)}),o.value[t[1]].size=100-e.prevReachedMinPanes-o.value[0].min-e.prevPanesSize-e.nextPanesSize,null):l>100-e.nextPanesSize-o.value[t[1]].min&&(t[1]=M(a).index,e.nextReachedMinPanes=0,t[1]>a+1&&o.value.forEach((l,s)=>{s>a&&s<t[1]&&(l.size=l.min,e.nextReachedMinPanes+=l.min)}),e.nextPanesSize=V(t[1]-1),void 0===t[1])?(e.nextReachedMinPanes=0,o.value.forEach((l,t)=>{t<f.value-1&&t>=a+1&&(l.size=l.min,e.nextReachedMinPanes+=l.min)}),o.value[t[0]].size=100-e.prevPanesSize-V(t[0]-1),null):{sums:e,panesToResize:t}},_=e=>o.value.reduce((l,a,t)=>l+(t<e?a.size:0),0),V=e=>o.value.reduce((l,a,t)=>l+(t>e+1?a.size:0),0),j=e=>[...o.value].reverse().find(l=>l.index<e&&l.size>l.min)||{},M=e=>o.value.find(l=>l.index>e+1&&l.size>l.min)||{},T=(e,l,a=!1)=>{const t=e-1,s=document.createElement("div");s.classList.add("splitpanes__splitter"),a||(s.onmousedown=e=>z(e,t),typeof window<"u"&&"ontouchstart"in window&&(s.ontouchstart=e=>z(e,t)),s.onclick=e=>((e,l)=>{"ontouchstart"in window&&(e.preventDefault(),y.value.splitter===l?(clearTimeout(y.value.timeoutId),y.value.timeoutId=null,I(e,l),y.value.splitter=null):(y.value.splitter=l,y.value.timeoutId=setTimeout(()=>y.value.splitter=null,500))),x.value.dragging||R("splitter-click",{event:e,index:l},!0)})(e,t+1)),s.ondblclick=e=>I(e,t+1),l.parentNode.insertBefore(s,l)},X=e=>{e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.remove()},O=()=>{var e;const l=Array.from((null==(e=D.value)?void 0:e.children)||[]);for(const t of l)t.className.includes("splitpanes__splitter")&&X(t);let a=0;for(const t of l)t.className.includes("splitpanes__pane")&&(!a&&n.firstSplitter?T(a,t,!0):a&&T(a,t),a++)},$=(e={})=>{e.addedPane||e.removedPane?o.value.some(e=>null!==e.givenSize||e.min||e.max<100)?E(e):A():B(),C.value&&R("resized")},A=()=>{const e=100/f.value;let l=0;const a=[],t=[];for(const s of o.value)s.size=Math.max(Math.min(e,s.max),s.min),l-=s.size,s.size>=s.max&&a.push(s.id),s.size<=s.min&&t.push(s.id);l>.1&&U(l,a,t)},B=()=>{let e=100;const l=[],a=[];let t=0;for(const i of o.value)e-=i.size,null!==i.givenSize&&t++,i.size>=i.max&&l.push(i.id),i.size<=i.min&&a.push(i.id);let s=100;if(e>.1){for(const l of o.value)null===l.givenSize&&(l.size=Math.max(Math.min(e/(f.value-t),l.max),l.min)),s-=l.size;s>.1&&U(s,l,a)}},E=({addedPane:e,removedPane:l}={})=>{var a;let t=100/f.value,s=0;const i=[],d=[];null!==(null!=(a=null==e?void 0:e.givenSize)?a:null)&&(t=(100-e.givenSize)/(f.value-1));for(const n of o.value)s-=n.size,n.size>=n.max&&i.push(n.id),n.size<=n.min&&d.push(n.id);if(!(Math.abs(s)<.1)){for(const l of o.value)null!==(null==e?void 0:e.givenSize)&&(null==e?void 0:e.id)===l.id||(l.size=Math.max(Math.min(t,l.max),l.min)),s-=l.size,l.size>=l.max&&i.push(l.id),l.size<=l.min&&d.push(l.id);s>.1&&U(s,i,d)}},U=(e,l,a)=>{let t;t=e>0?e/(f.value-l.length):e/(f.value-a.length),o.value.forEach((s,i)=>{if(e>0&&!l.includes(s.id)){const l=Math.max(Math.min(s.size+t,s.max),s.min),a=l-s.size;e-=a,s.size=l}else if(!a.includes(s.id)){const l=Math.max(Math.min(s.size+t,s.max),s.min),a=l-s.size;e-=a,s.size=l}}),Math.abs(e)>.1&&v(()=>{C.value&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})},R=(e,l=void 0,a=!1)=>{var t,s;const i=null!=(s=null!=(t=null==l?void 0:l.index)?t:x.value.activeSplitter)?s:null;d(e,{...l,...null!==i&&{index:i},...a&&null!==i&&{prevPane:o.value[i-(n.firstSplitter?1:0)],nextPane:o.value[i+(n.firstSplitter?0:1)]},panes:o.value.map(e=>({min:e.min,max:e.max,size:e.size}))})};a(()=>n.firstSplitter,()=>O()),t(()=>{(()=>{var e;const l=Array.from((null==(e=D.value)?void 0:e.children)||[]);for(const a of l){const e=a.classList.contains("splitpanes__pane"),l=a.classList.contains("splitpanes__splitter");!e&&!l&&(a.remove(),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))}})(),O(),$(),R("ready"),C.value=!0}),s(()=>C.value=!1);const q=()=>{var e;return b("div",{ref:D,class:k.value},null==(e=c.default)?void 0:e.call(c))};return g("panes",o),g("indexedPanes",S),g("horizontal",p(()=>n.horizontal)),g("requestUpdate",({uid:e,...l})=>{const a=S.value[e];for(const[t,s]of Object.entries(l))a[t]=s}),g("onPaneAdd",e=>{var l;let a=-1;Array.from((null==(l=D.value)?void 0:l.children)||[]).some(l=>(l.className.includes("splitpanes__pane")&&a++,l.isSameNode(e.el))),o.value.splice(a,0,{...e,index:a}),o.value.forEach((e,l)=>e.index=l),C.value&&v(()=>{O(),$({addedPane:o.value[a]}),R("pane-add",{pane:o.value[a]})})}),g("onPaneRemove",e=>{const l=o.value.findIndex(l=>l.id===e);o.value[l].el=null;const a=o.value.splice(l,1)[0];o.value.forEach((e,l)=>e.index=l),v(()=>{O(),R("pane-remove",{pane:a}),$({removedPane:{...a}})})}),g("onPaneClick",(e,l)=>{R("pane-click",{event:e,index:S.value[l].index,pane:S.value[l]})}),(e,l)=>(i(),h(u(q)))}},R={__name:"pane",props:{size:{type:[Number,String]},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},setup(r){var h;const u=r,b=e("requestUpdate"),v=e("onPaneAdd"),g=e("horizontal"),S=e("onPaneRemove"),f=e("onPaneClick"),D=null==(h=l())?void 0:h.uid,C=e("indexedPanes"),x=p(()=>C.value[D]),y=m(null),k=p(()=>{const e=isNaN(u.size)||void 0===u.size?0:parseFloat(u.size);return Math.max(Math.min(e,L.value),z.value)}),z=p(()=>{const e=parseFloat(u.minSize);return isNaN(e)?0:e}),L=p(()=>{const e=parseFloat(u.maxSize);return isNaN(e)?100:e}),N=p(()=>{var e;return"".concat(g.value?"height":"width",": ").concat(null==(e=x.value)?void 0:e.size,"%")});return a(()=>k.value,e=>b({uid:D,size:e})),a(()=>z.value,e=>b({uid:D,min:e})),a(()=>L.value,e=>b({uid:D,max:e})),t(()=>{v({id:D,el:y.value,min:z.value,max:L.value,givenSize:void 0===u.size?null:k.value,size:k.value})}),s(()=>S(D)),(e,l)=>(i(),d("div",{ref_key:"paneEl",ref:y,class:"splitpanes__pane",onClick:l[0]||(l[0]=l=>o(f)(l,e._.uid)),style:c(N.value)},[n(e.$slots,"default")],4))}};let q=f.base,W="/fxyj";function F(e){return S({url:"".concat(q).concat(W,"/custom/add"),method:"post",data:e,showLoading:!0})}function K(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let l=16*Math.random()|0;return("x"===e?l:3&l|8).toString(16)})}function J(e){return S({url:"".concat(q).concat(W,"/d5000/load-area-lazy-tree"),method:"post",data:e,showLoading:!0})}const Y={name:"oms-tree",props:{omsDefaultNode:Object},mounted(){console.log("最终传入Tree的node"),console.log(this.omsDefaultNode),this.$refs.tree.setCurrentKey(this.omsDefaultNode),this.$emit("changeTreeNode",{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,level:0,id:this.omsDefaultNode.id,disabled:!0})},data(){return{newWportIsLink:!1,props:{label:"name",children:"zones",isLeaf:"leaf"},count:1,currentNode:{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,disabled:!0}}},methods:{loadNode(e,l){return this.currentNode=e.data,0==e.level?l([{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,level:0,id:this.omsDefaultNode.id,disabled:!0},{name:"线路",pid:"0",level:0,id:"XL",disabled:!0,leaf:!0}]):1==e.level?l(this.OMSCzList.map(e=>(e.leaf=!1,e))):void this.getLoad(l)},getLoad(e){var l;(l=this.currentNode,S({url:"".concat(q).concat(W,"/oms/load-area-lazy-tree"),method:"post",data:l,showLoading:!0})).then(l=>(this.newWportIsLink=!0,l&&0==l.length&&(this.newWportIsLink=!1),e(l))).catch()},doSelectProvince(){this.$refs.tree.setCurrentKey(this.omsDefaultNode),this.$emit("changeTreeNode",{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,level:0,id:this.omsDefaultNode.id,disabled:!0})},doSelectArea(e){this.$refs.tree.setCurrentKey(e),this.$emit("changeTreeNode",e)},clickEvent(e){this.$emit("changeTreeNode",e)}},computed:{...C(["token","userInfo","staticOMSxl","OMSCzList"])}},Q={id:"oms-tree"};const G={class:"search-div"},H={class:"search-itme"},ee={class:"search-itme"},le={class:"search-itme",style:{"margin-left":"10px"}},ae={class:"content-div"},te={class:"select-input"},se={class:"select-content"},ie=["onClick","onDblclick"],de={class:"page-div"},ne={class:"center-content"},ce={class:"cneter-div"},oe={class:"cneter-div"},re={class:"select-content"},he=["onClick"],ue={class:"write-input"},pe={class:"write-input-textarea"},me={class:"bottom-button-div"},be={class:"half-div"},ve={class:"half-div"};const ge=D({name:"zcq-cz-oms",props:{omsDefaultNode:Object,updateSource:String,id:String},components:{DArrowLeft:z,DArrowRight:k,Splitpanes:U,Pane:R,omsTree:D(Y,[["render",function(e,l,a,t,s,n){const c=x("el-tree");return i(),d("div",Q,[y(c,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":[a.omsDefaultNode.id],load:n.loadNode,onNodeClick:n.clickEvent,lazy:"","highlight-current":""},null,8,["props","default-expanded-keys","load","onNodeClick"])])}],["__scopeId","data-v-caa4156b"]])},mounted(){},computed:{czOptions:()=>[{label:"变电站",value:"MW_APP.MWT_UD_SB_BDZ"},{label:"统调电厂",value:"MW_APP.MWT_UD_SB_TDDC"},{label:"非统调电厂",value:"MW_APP.MWT_UD_SB_FTDDC"}]},data:()=>({param:{substation:"MW_APP.MWT_UD_SB_BDZ",dydj:"",text:"",pageSize:"20",pageIndex:0},dyoptions:[{label:"",value:""},{label:"1000kV",value:"1000000"},{label:"500kV",value:"500000"},{label:"220kV",value:"220000"},{label:"110kV",value:"110000"},{label:"35kV",value:"35000"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",treeNode:{},canSelectData:{},alSelectData:{},allDisabled:!1}),methods:{initPx2Rem(){},changeCZLX(){if("{}"==JSON.stringify(this.treeNode))return this.$message({message:"请先选择厂站所在区域",type:"warning"}),void this.dealCZLX();this.restParam(),this.querySubstation()},changeDYDJ(){this.restParam(),this.querySubstation()},changeTreeNode(e){if(console.log("OMS"),console.log(e),"XL"==e.id)return this.treeNode=e,this.allDisabled=!0,this.inputCZ="线路",void this.restParam();this.inputCZ="",this.allDisabled=!1,this.treeNode=e,this.param.value=e.id,this.restParam(),this.querySubstation()},restParam(){this.param.pageIndex=0},querySubstation(){var e;(e=this.param,S({url:"".concat(q).concat(W,"/oms/list-substation"),method:"post",data:e,showLoading:!0})).then(e=>{this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}}).catch()},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectData=e)},dbClickselctAlselect(e){this.allDisabled||(this.canSelectData=e,this.alSelectList=[e])},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex==this.totalPage||(this.param.pageIndex+=e,this.querySubstation())},ClickAlSelcteCanSelct(e){this.allDisabled||(this.alSelectData=e)},dbClickAlselctAlselect(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},turnRight(){this.allDisabled||null==this.canSelectData.czid||(this.alSelectList=[this.canSelectData])},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},confirm(){if(""==this.inputCZ&&0==this.alSelectList.length&&"XL"!=this.treeNode.id)return void this.$message({message:"请选择一个厂站进行保存",type:"warning"});let e={SSDW:"",DWMC:"",CZID:"",CZMC:"",tdcslx:"OMS",stationType:this.param.substation};if(""!=this.inputCZ&&"线路"!=this.inputCZ){let l=this.inputCZ.split(/[(\r\n)\r\n]+/).join(" ");e.CZMC=l,e.label=l,e.czlx="ST",F({name:e.CZMC,sblb:this.param.substation,dq:this.treeNode.id}).then(l=>{e.CZID=l.data,e.id=l.data,this.$emit("refreshCZXX",e),this.$emit("close")})}else"XL"==this.treeNode.id?(e.CZMC="线路",e.czlx="XL",e.id="xl",e.label="线路",e.CZID="XL"):(e.SSDW=this.treeNode.id,e.DWMC=this.treeNode.name,e.CZID=this.alSelectList[0].czid,e.CZMC=this.alSelectList[0].czmc,e.id=this.alSelectList[0].czid,e.label=this.alSelectList[0].czmc,e.czlx="CZ"),this.$emit("refreshCZXX",e),this.$emit("close")},cancel(){this.$emit("close")},dealCZLX(){"BDZ"==this.param.substation?this.param.substation="DC":this.param.substation="BDZ"}}},[["render",function(e,l,a,t,s,n){const c=x("omsTree"),o=x("pane"),r=x("el-option"),u=x("el-select"),p=x("el-input"),m=x("el-button"),b=x("d-arrow-right"),v=x("d-arrow-left"),g=x("splitpanes");return i(),d("div",{id:"czOMS",class:"gljh px2rem-ignore",onClose:l[11]||(l[11]=l=>e.$emit("close"))},[y(g,{style:{height:"100%"},class:"default-theme"},{default:L(()=>[y(o,{size:"25",style:{"overflow-y":"auto"}},{default:L(()=>[y(c,{onChangeTreeNode:n.changeTreeNode,omsDefaultNode:a.omsDefaultNode},null,8,["onChangeTreeNode","omsDefaultNode"])]),_:1}),y(o,{size:"75"},{default:L(()=>[N("div",G,[l[12]||(l[12]=N("div",{class:"search-label"},"厂站类型: ",-1)),N("div",H,[y(u,{class:"search-datepicker",modelValue:s.param.substation,"onUpdate:modelValue":l[0]||(l[0]=e=>s.param.substation=e),placeholder:"请选择",onChange:n.changeCZLX,disabled:s.allDisabled},{default:L(()=>[(i(!0),d(I,null,w(n.czOptions,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),l[13]||(l[13]=N("div",{class:"search-label"},"电压等级: ",-1)),N("div",ee,[y(u,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.dydj=e),placeholder:"请选择",onChange:n.changeDYDJ,disabled:s.allDisabled},{default:L(()=>[(i(!0),d(I,null,w(s.dyoptions,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),l[14]||(l[14]=N("div",{class:"search-label"},"模糊搜索: ",-1)),N("div",le,[y(p,{class:"search-datepicker",onChange:n.changeDYDJ,modelValue:s.param.text,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.text=e),disabled:s.allDisabled,placeholder:"请输入内容"},null,8,["onChange","modelValue","disabled"])])]),N("div",ae,[N("div",te,[N("div",se,[l[17]||(l[17]=N("div",{class:"tilte"},"可选厂站(双击选取厂站)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.canSelectList,(e,l)=>(i(),d("div",{class:Z(["text-label",[e.czid==s.canSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickSelcteCanSelct(e),onDblclick:l=>n.dbClickselctAlselect(e),key:l+"canSelect"},P(e.czmc),43,ie))),128))],2),N("div",de,[y(m,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[3]||(l[3]=e=>n.pageChange(-1))},{default:L(()=>[...l[15]||(l[15]=[_(" 上一页 ",-1)])]),_:1},8,["disabled"]),y(m,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[4]||(l[4]=e=>n.pageChange(1))},{default:L(()=>[...l[16]||(l[16]=[_(" 下一页 ",-1)])]),_:1},8,["disabled"])])]),N("div",ne,[N("div",ce,[N("div",{class:Z(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[5]||(l[5]=(...e)=>n.turnRight&&n.turnRight(...e))},[y(b,{height:"24"})],2)]),N("div",oe,[N("div",{class:Z(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[6]||(l[6]=(...e)=>n.turnLeft&&n.turnLeft(...e))},[y(v,{height:"24"})],2)])]),N("div",re,[l[18]||(l[18]=N("div",{class:"tilte"},"已选厂站(双击删除已选厂站)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.alSelectList,(e,a)=>(i(),d("div",{class:Z(["text-label",[e.czid==s.alSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickAlSelcteCanSelct(e),onDblclick:l[7]||(l[7]=e=>n.dbClickAlselctAlselect()),key:a+"alSelect"},P(e.czmc),43,he))),128))],2)])]),N("div",ue,[l[19]||(l[19]=N("div",{class:"tilte"},[N("span",null,"手工录入"),N("span",{style:{color:"red","margin-left":"4px"}},"(注:厂站列表中没有的厂站允许在此填写)")],-1)),N("div",pe,[y(p,{style:{height:"100%"},type:"textarea",resize:"none",disabled:s.allDisabled,placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[8]||(l[8]=e=>s.inputCZ=e)},null,8,["disabled","modelValue"])])])]),N("div",me,[N("div",be,[N("div",{class:"gljh-btn qd",onClick:l[9]||(l[9]=e=>n.confirm())},"确认")]),N("div",ve,[N("div",{class:"gljh-btn gb",onClick:l[10]||(l[10]=e=>n.cancel())},"取消")])])]),_:1})]),_:1})],32)}],["__scopeId","data-v-274a1fe8"]]),Se={name:"d5000-tree",props:{d5000DefaultNode:Object},mounted(){this.OriginalId=this.d5000DefaultNode.id},data(){return{newWportIsLink:!1,OriginalId:"",props:{label:"name",children:"zones",isLeaf:"leaf"},count:1,currentNode:{name:this.d5000DefaultNode.area,pid:this.d5000DefaultNode.id,disabled:!0}}},methods:{loadNode(e,l){return this.currentNode=e.data,0==e.level?l([{name:this.d5000DefaultNode.area,pid:this.d5000DefaultNode.id,level:0,id:this.d5000DefaultNode.id,disabled:!0},{name:"线路",pid:"0",CZID:"XL",level:0,id:"XL",disabled:!0,leaf:!0}]):1==e.level?l(this.D5000CzList.map(e=>(e.leaf=!1,e))):void this.getLoad(l)},getLoad(e){J(this.currentNode).then(l=>(this.newWportIsLink=!(l&&0==l.length),e(l)))},clickEvent(e){e.id!=this.OriginalId?this.$emit("changeTreeNode",e):this.$refs.tree.setCurrentKey()}},computed:{...C(["token","userInfo","staticOMSxl","D5000CzList"])}},fe={id:"d5000-tree"};const De={class:"search-div"},Ce={class:"search-itme"},xe={class:"search-itme"},ye={class:"search-itme",style:{"margin-left":"10px"}},ke={class:"content-div"},ze={class:"select-input"},Le={class:"select-content"},Ne=["onClick","onDblclick"],Ie={class:"page-div"},we={class:"center-content"},Ze={class:"cneter-div"},Pe={class:"cneter-div"},_e={class:"select-content"},Ve=["onClick"],je={class:"write-input"},Me={class:"write-input-textarea"},Te={class:"content-div"},Xe={class:"select-content"},Oe={class:"nullnode-show-div"},$e={class:"nullnode-show-div-select"},Ae={class:"text-label"},Be={class:"nullnode-show-div"},Ee={class:"write-input-textarea"},Ue={class:"bottom-button-div"},Re={class:"half-div"},qe={class:"half-div"};const We=D({name:"zcq-cz-d5000",props:{d5000DefaultNode:Object,updateSource:String,id:String},components:{DArrowRight:k,DArrowLeft:z,Splitpanes:U,Pane:R,d5000Tree:D(Se,[["render",function(e,l,a,t,s,n){const c=x("el-tree");return i(),d("div",fe,[y(c,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":[a.d5000DefaultNode.id],load:n.loadNode,onNodeClick:n.clickEvent,lazy:"","highlight-current":""},null,8,["props","default-expanded-keys","load","onNodeClick"])])}],["__scopeId","data-v-c8e37669"]])},mounted(){},computed:{czlxOptions:()=>[{label:"变电站",value:"BDZ"},{label:"电厂",value:"DC"}]},data:()=>({guid:K(),param:{subType:"BDZ",subVol:"",subContent:"",pageSize:"20",pageIndex:0},dyoptions:[{label:"",value:""},{label:"1000kV",value:"112871465677750285"},{label:"800kV",value:"112871465677750310"},{label:"500kV",value:"112871465677750274"},{label:"220kV",value:"112871465677750279"},{label:"110kV",value:"112871465677750280"},{label:"35kV",value:"112871465677750275"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",treeNode:{},canSelectData:{},alSelectData:{},allDisabled:!1,alNullNodeInput:"",NullNodeInput:""}),methods:{changeCZLX(){this.restParam(),this.querySubstation()},changeTreeNode(e){if(console.log(e),"XL"==e.id)return this.treeNode=e,this.allDisabled=!0,this.inputCZ="线路",void this.restParam();this.inputCZ="",this.allDisabled=!1,this.treeNode=e,this.param.areaId=e.id,this.param.dbId=e.pid,this.param.level=e.level,this.restParam(),this.querySubstation()},restParam(){this.param.pageIndex=0},querySubstation(){var e;(e=this.param,S({url:"".concat(q).concat(W,"/d5000/list-substation"),method:"post",data:e,showLoading:!0})).then(e=>{this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}}).catch()},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectData=e)},dbClickselctAlselect(e){this.allDisabled||(this.canSelectData=e,this.alSelectList=[e])},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.querySubstation())},ClickAlSelcteCanSelct(e){this.allDisabled||(this.alSelectData=e)},dbClickAlselctAlselect(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},turnRight(){this.allDisabled||null==this.canSelectData.czid||(this.alSelectList=[this.canSelectData])},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},delettextlabel(){this.alNullNodeInput=""},addInpput(){this.alNullNodeInput=this.NullNodeInput},confirm(){if(null==this.treeNode.id){if(""==this.alNullNodeInput)return void this.$message({message:"请输入一个厂站进行保存",type:"warning"})}else if(""==this.inputCZ&&0==this.alSelectList.length&&"XL"!=this.treeNode.id)return void this.$message({message:"请选择一个厂站进行保存",type:"warning"});let e={SSDW:"",DWMC:"",CZID:"",CZMC:"",tdcslx:"D5000",dbId:this.treeNode.pid};if(null==this.treeNode.id)e.CZMC=this.alNullNodeInput,e.czlx="ST",e.label=this.alNullNodeInput,this.dealInputAdd(e);else if(""!=this.inputCZ&&"线路"!=this.inputCZ){let l=this.inputCZ.split(/[(\r\n)\r\n]+/).join(" ");e.CZMC=l,e.label=l,e.czlx="ST",this.dealInputAdd(e)}else"XL"==this.treeNode.id?(e.CZMC="线路",e.czlx="XL",e.CZID="XL",e.id="xl",e.label="线路"):(e.SSDW=this.treeNode.id,e.DWMC=this.treeNode.name,e.CZID=this.alSelectList[0].czid,e.CZMC=this.alSelectList[0].czmc,e.id=this.alSelectList[0].czid,e.label=this.alSelectList[0].czmc,e.czlx="CZ",e.dbId=this.alSelectList[0].dbId,e.fqmc=this.alSelectList[0].fqmc,e.fqmcDispidx=this.alSelectList[0].fqmcDispidx),this.$emit("refreshCZXX",e),this.$emit("close")},dealInputAdd(e){F({name:e.CZMC,sblb:this.param.subType,dq:this.treeNode.id}).then(l=>{e.CZID=l.data,e.id=l.data,this.$emit("refreshCZXX",e),this.$emit("close")})},cancel(){this.$emit("close")}}},[["render",function(e,l,a,t,s,n){const c=x("d5000Tree"),o=x("pane"),r=x("el-option"),u=x("el-select"),p=x("el-input"),m=x("el-button"),b=x("d-arrow-right"),v=x("d-arrow-left"),g=x("splitpanes");return i(),d("div",{id:"czD5000",class:"gljh px2rem-ignore",onClose:l[14]||(l[14]=l=>e.$emit("close"))},[(i(),h(g,{style:{height:"100%"},class:"default-theme",key:s.guid},{default:L(()=>[y(o,{size:20},{default:L(()=>[y(c,{onChangeTreeNode:n.changeTreeNode,d5000DefaultNode:a.d5000DefaultNode},null,8,["onChangeTreeNode","d5000DefaultNode"])]),_:1}),y(o,{size:79},{default:L(()=>[V(N("div",De,[l[15]||(l[15]=N("div",{class:"search-label"},"厂站类型: ",-1)),N("div",Ce,[y(u,{class:"search-datepicker",modelValue:s.param.subType,"onUpdate:modelValue":l[0]||(l[0]=e=>s.param.subType=e),placeholder:"请选择",onChange:n.changeCZLX,disabled:s.allDisabled},{default:L(()=>[(i(!0),d(I,null,w(n.czlxOptions,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),l[16]||(l[16]=N("div",{class:"search-label"},"电压等级: ",-1)),N("div",xe,[y(u,{class:"search-datepicker",modelValue:s.param.subVol,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.subVol=e),placeholder:"请选择",onChange:n.changeCZLX,disabled:s.allDisabled},{default:L(()=>[(i(!0),d(I,null,w(s.dyoptions,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),N("div",ye,[y(p,{class:"search-datepicker",onChange:n.changeCZLX,modelValue:s.param.subContent,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.subContent=e),placeholder:"请输入内容",disabled:s.allDisabled},null,8,["onChange","modelValue","disabled"])])],512),[[j,null!=s.treeNode.id]]),V(N("div",ke,[N("div",ze,[N("div",Le,[l[19]||(l[19]=N("div",{class:"tilte"},"可选厂站(双击选取厂站)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.canSelectList,(e,l)=>(i(),d("div",{class:Z(["text-label",[e.czid==s.canSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickSelcteCanSelct(e),onDblclick:l=>n.dbClickselctAlselect(e),key:l+"canSelect"},P(e.czmc),43,Ne))),128))],2),N("div",Ie,[y(m,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[3]||(l[3]=e=>n.pageChange(-1))},{default:L(()=>[...l[17]||(l[17]=[_(" 上一页 ",-1)])]),_:1},8,["disabled"]),y(m,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[4]||(l[4]=e=>n.pageChange(1))},{default:L(()=>[...l[18]||(l[18]=[_(" 下一页 ",-1)])]),_:1},8,["disabled"])])]),N("div",we,[N("div",Ze,[N("div",{class:Z(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[5]||(l[5]=(...e)=>n.turnRight&&n.turnRight(...e))},[y(b,{height:"24"})],2)]),N("div",Pe,[N("div",{class:Z(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[6]||(l[6]=(...e)=>n.turnLeft&&n.turnLeft(...e))},[y(v,{height:"24"})],2)])]),N("div",_e,[l[20]||(l[20]=N("div",{class:"tilte"},"已选厂站(双击删除已选厂站)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.alSelectList,(e,a)=>(i(),d("div",{class:Z(["text-label",[e.czid==s.alSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickAlSelcteCanSelct(e),onDblclick:l[7]||(l[7]=e=>n.dbClickAlselctAlselect()),key:a+"alSelect"},P(e.czmc),43,Ve))),128))],2)])]),N("div",je,[l[21]||(l[21]=N("div",{class:"tilte"},[_("手工录入("),N("span",{style:{color:"red"}},"注:厂站列表中没有的厂站允许在此填写"),_(")")],-1)),N("div",Me,[y(p,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[8]||(l[8]=e=>s.inputCZ=e),disabled:s.allDisabled},null,8,["modelValue","disabled"])])])],512),[[j,null!=s.treeNode.id]]),V(N("div",Te,[N("div",Xe,[l[22]||(l[22]=N("div",{class:"tilte"},[N("span",null,"已选厂站"),N("span",{style:{color:"red","margin-left":"4px"}},"注：双击可移除已选厂站")],-1)),N("div",Oe,[V(N("div",$e,[N("div",Ae,P(s.alNullNodeInput),1),N("div",{class:"delete-text-label",onClick:l[9]||(l[9]=(...e)=>n.delettextlabel&&n.delettextlabel(...e))})],512),[[j,""!=s.alNullNodeInput]])]),l[23]||(l[23]=N("div",{class:"tilte"},[N("span",null,"手工录入"),N("span",{style:{color:"red","margin-left":"4px"}},"注：左侧设备树中没有的厂站允许在此手工填写")],-1)),N("div",Be,[N("div",Ee,[y(p,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.NullNodeInput,"onUpdate:modelValue":l[10]||(l[10]=e=>s.NullNodeInput=e)},null,8,["modelValue"])]),N("div",{class:"add-input",onClick:l[11]||(l[11]=e=>n.addInpput())},"加入手写")])])],512),[[j,null==s.treeNode.id]]),N("div",Ue,[N("div",Re,[N("div",{class:"gljh-btn qd",onClick:l[12]||(l[12]=e=>n.confirm())},"确认")]),N("div",qe,[N("div",{class:"gljh-btn gb",onClick:l[13]||(l[13]=e=>n.cancel())},"取消")])])]),_:1})]),_:1}))],32)}],["__scopeId","data-v-a552a574"]]);let Fe,Ke;const Je={id:"d5000-tree"};const Ye={class:"filter-div"},Qe={class:"tree-outer"},Ge={class:"content-div"},He={class:"select-content"},el={class:"node-show-div"},ll={class:"text-label"},al={class:"node-show-div"},tl={class:"write-input-textarea"},sl={class:"bottom-button-div"},il={class:"half-div"},dl={class:"half-div"};const nl=D({name:"zcq-cz-dky",props:{d5000DefaultNode:Object,updateSource:String,id:String},components:{DkyCzTree:D({name:"dky-cz-tree",props:{treeFilterKey:{type:String,default:""}},mounted(){this.initData()},data:()=>({props:{label:"label",children:"children",isLeaf:"leaf"},defaultExpandedKeys:[],treeData:[],clickFlag:!1}),methods:{filterNode:(e,l)=>!e||-1!==l.label.indexOf(e),loadTree(){var e;(e={},S({url:"".concat(q).concat(W,"/dky/load-station-lazy-tree"),method:"post",data:e,showLoading:!0})).then(e=>{this.defaultExpandedKeys=[e.data[0].id],this.treeData=e.data})},clickEvent(e){clearTimeout(Fe),e.children||(Fe=setTimeout(()=>{this.clickFlag=!1},650),this.clickFlag&&Ke===e?(this.clickFlag=!1,this.$emit("changeTreeNode",e)):(this.clickFlag=!0,Ke=e))},initData(){this.loadTree()}},watch:{treeFilterKey(e){this.$refs.tree.filter(e)}}},[["render",function(e,l,a,t,s,n){const c=x("el-tree");return i(),d("div",Je,[y(c,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":s.defaultExpandedKeys,onNodeClick:n.clickEvent,data:s.treeData,"highlight-current":"","filter-node-method":n.filterNode},null,8,["props","default-expanded-keys","onNodeClick","data","filter-node-method"])])}],["__scopeId","data-v-dde4e5eb"]]),Splitpanes:U,Pane:R},data:()=>({selectedNode:{},filterKey:"",treeFilterKey:"",guid:K(),selfInput:""}),methods:{filterTree(){this.treeFilterKey=this.filterKey},changeTreeNode(e){"{}"===JSON.stringify(this.selectedNode)&&(this.selectedNode=e)},deleteSelectedNode(){this.selectedNode={}},addInpput(){this.selectedNode={id:"input",label:this.selfInput,czid:"",czmc:this.selfInput}},confirm(){if(!this.selectedNode.id)return void this.$message({message:"请选择或输入一个厂站进行保存",type:"warning"});let e={tdcslx:"DKY"};e.CZID=this.selectedNode.czid,e.CZMC=this.selectedNode.czmc,e.id=this.selectedNode.id,e.label=this.selectedNode.label,this.$emit("refreshCZXX",e),this.$emit("close")},cancel(){this.$emit("close")}}},[["render",function(e,l,a,t,s,n){const c=x("el-input"),o=x("DkyCzTree"),r=x("pane"),u=x("splitpanes");return i(),d("div",{id:"czDKY",class:"gljh px2rem-ignore",onClose:l[8]||(l[8]=l=>e.$emit("close"))},[(i(),h(u,{style:{height:"100%"},class:"default-theme",key:s.guid},{default:L(()=>[y(r,{size:25},{default:L(()=>[N("div",Ye,[y(c,{modelValue:s.filterKey,"onUpdate:modelValue":l[1]||(l[1]=e=>s.filterKey=e),size:"mini",onKeyup:M(n.filterTree,["enter","native"])},{default:L(()=>[N("i",{slot:"suffix",class:"el-input__icon el-icon-search",onClick:l[0]||(l[0]=(...e)=>n.filterTree&&n.filterTree(...e)),style:{cursor:"pointer"}})]),_:1},8,["modelValue","onKeyup"])]),N("div",Qe,[y(o,{onChangeTreeNode:n.changeTreeNode,"tree-filter-key":s.treeFilterKey},null,8,["onChangeTreeNode","tree-filter-key"])])]),_:1}),y(r,{size:75},{default:L(()=>[N("div",Ge,[N("div",He,[l[9]||(l[9]=N("div",{class:"tilte"},[N("span",null,"已选厂站"),N("span",{style:{color:"red","margin-left":"4px"}},"注：双击可移除已选厂站")],-1)),N("div",el,[s.selectedNode.id?(i(),d("div",{key:0,class:"node-show-div-select",onDblclick:l[3]||(l[3]=(...e)=>n.deleteSelectedNode&&n.deleteSelectedNode(...e))},[N("div",ll,P(s.selectedNode.label),1),N("div",{class:"delete-text-label",onClick:l[2]||(l[2]=(...e)=>n.deleteSelectedNode&&n.deleteSelectedNode(...e))})],32)):T("",!0)]),l[10]||(l[10]=N("div",{class:"tilte"},[N("span",null,"手工录入"),N("span",{style:{color:"red"}},"(数据库中没有的厂站可在此手动添加)")],-1)),N("div",al,[N("div",tl,[y(c,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.selfInput,"onUpdate:modelValue":l[4]||(l[4]=e=>s.selfInput=e)},null,8,["modelValue"])]),N("div",{class:"add-input",onClick:l[5]||(l[5]=e=>n.addInpput())},"加入手写")])])]),N("div",sl,[N("div",il,[N("div",{class:"gljh-btn qd",onClick:l[6]||(l[6]=e=>n.confirm())},"确认")]),N("div",dl,[N("div",{class:"gljh-btn gb",onClick:l[7]||(l[7]=e=>n.cancel())},"取消")])])]),_:1})]),_:1}))],32)}],["__scopeId","data-v-91fa9046"]]),cl={name:"czSelect",props:{showD5000:{type:Boolean,default:!0},showDky:{type:Boolean,default:!0},omsDefaultNode:Object,d5000DefaultNode:Object,updateSource:String,unshowDKY:Boolean,showOMS:{type:Boolean,default:!0},id:{type:String,default:""}},components:{},mounted(){},data:()=>({}),methods:{selectCZ(e){"czOMS"==e?this.$vxeModal.show(ge,{omsDefaultNode:this.omsDefaultNode,updateSource:this.updateSource,id:this.id},{width:1010,height:650,title:"厂站选择"},{refreshCZXX:e=>{this.$emit("refreshCZXX",e),this.$emit("close")}}):"czD5000"==e?this.$vxeModal.show(We,{d5000DefaultNode:this.d5000DefaultNode,updateSource:this.updateSource,id:this.id},{width:1010,height:650,title:"厂站选择-D5000"},{refreshCZXX:e=>{console.log(e),this.$emit("refreshCZXX",e),this.$emit("close")}}):"DKY"==e&&this.$vxeModal.show(nl,{d5000DefaultNode:this.d5000DefaultNode,updateSource:this.updateSource,id:this.id},{width:1010,height:650,title:"厂站选择-调控云"},{refreshCZXX:e=>{this.$emit("refreshCZXX",e),this.$emit("close")}})}}},ol={class:"bottom-button"};const rl=D(cl,[["render",function(e,l,a,t,s,n){return i(),d("div",{class:"gljh",onClose:l[3]||(l[3]=l=>e.$emit("close"))},[l[4]||(l[4]=N("div",{class:"top-tip"}," 请选择停电厂站类型 ",-1)),N("div",ol,[a.showOMS?(i(),d("div",{key:0,class:"search-btn",onClick:l[0]||(l[0]=e=>n.selectCZ("czOMS"))},"OMS场所")):T("",!0),V(N("div",{class:"search-btn righ-search",onClick:l[1]||(l[1]=e=>n.selectCZ("czD5000"))}," D5000场所 ",512),[[j,a.showD5000]]),a.showDky?V((i(),d("div",{key:1,class:"search-btn righ-search",onClick:l[2]||(l[2]=e=>n.selectCZ("DKY"))}," 调控云场所 ",512)),[[j,!a.unshowDKY]]):T("",!0)])],32)}],["__scopeId","data-v-8ca3028a"]]),hl={name:"zcq-sb-d5000",props:{paramdata:{type:Object},updateSource:String,sblist:{type:Array},id:{type:String,default:""},isCommon:{type:Boolean,default:!1}},components:{DArrowLeft:z,DArrowRight:k,Bottom:O,Top:X,Splitpanes:U,Pane:R},mounted(){this.sfts=!!this.paramdata.sfts&&this.paramdata.sfts,this.testData=this.paramdata,this.testData.showzsb&&(this.showzsb=!0),this.testData.tdcsParam||(this.testData.tdcsParam={czlx:"",CZID:"",dbId:"",stationType:""}),this.CZLX=this.testData.tdcsParam.czlx,this.param.subType=this.CZLX,this.getAlSelectDevice(),this.param.deviceType=this.options[0].value,"XL"==this.CZLX?(this.options=[{label:"线路",value:"XL"}],this.param.deviceType=this.options[0].value,this.getLeftTree()):("徐州"==this.$store.state.userInfo.cropJc&&(this.options=[{label:"线路",value:"XL"},{label:"母线",value:"MX"},{label:"开关",value:"KG"},{label:"主变",value:"ZB"},{label:"发电机",value:"FDJ"},{label:"电容器",value:"DRQ"},{label:"电抗器",value:"DKQ"},{label:"二次设备",value:"ECSB"}]),setTimeout(()=>{this.sbLoadingFlag=!0,this.selectCZ(this.testData.tdcsParam)},100))},data:()=>({innerSblist:[],sfts:!1,showzsb:!1,curNode:{},defaultExpandId:"",treeData:[],props:{children:"children",label:"name",isLeaf:"leaf"},CZLX:"",testData:{tdcsParam:{CZID:""}},param:{subId:"",dydj:"",dbId:"",deviceType:"",subType:"",deviceContent:"",keyword:"",pageSize:"20",pageIndex:0},options:[{label:"线路",value:"XL"},{label:"母线",value:"MX"},{label:"开关",value:"KG"},{label:"主变",value:"ZB"},{label:"发电机",value:"FDJ"},{label:"电容器",value:"DRQ"},{label:"电抗器",value:"DKQ"}],dydjoptions:[{label:"",value:""},{label:"1000kV",value:"112871465677750285"},{label:"800kV",value:"112871465677750310"},{label:"500kV",value:"112871465677750274"},{label:"220kV",value:"112871465677750279"},{label:"110kV",value:"112871465677750280"},{label:"35kV",value:"112871465677750275"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",canSelectData:{},treeNode:{},alSelectData:{},alSelectDataIndex:-1,allDisabled:!1,NullNodeInputList:[],NullNodeInput:"",selectNode:{CZID:""},unCZSelectFlag:!1,sbLoadingFlag:!1}),methods:{getAlSelectDevice(){this.sblist&&(this.innerSblist=JSON.parse(JSON.stringify(this.sblist)),this.innerSblist.length>0&&(this.innerSblist.forEach(e=>{this.testData.showzsb||(e.zsb=!1),e.checked=!1}),"ST"==this.CZLX?this.NullNodeInputList=JSON.parse(JSON.stringify(this.innerSblist)):this.alSelectList=JSON.parse(JSON.stringify(this.innerSblist))),console.log(this.innerSblist))},loadNode(e,l){let a=e.data;"[object Object]"===Object.prototype.toString.call(a)&&(a.children&&a.children.length>0?l(a.children):J(a).then(e=>{l(e)}).catch())},getLeftTree(){var e;S({url:"".concat(q).concat(W,"/d5000/load-line-lazy-tree"),method:"post",data:e,showLoading:!0}).then(e=>{this.treeData=[e.data],this.defaultExpandId=e.data.id}).catch()},selectCZ(e){this.resetParam(),this.curNode=e,this.selectNode=e,this.param.subId=this.testData.tdcsParam.CZID,this.param.dbId=this.testData.tdcsParam.dbId,this.param.subType=this.testData.tdcsParam.czlx,this.queryD5000Device()},clickEvent(e){console.log(e),0!=e.level?(this.curNode=e,this.param.subId=e.id,this.param.level=e.level,this.param.dbId=e.pid,this.resetParam(),this.queryD5000Device()):this.$refs.tree.setCurrentKey()},changeCZLX(e){this.resetParam(),console.log(e,"flag"),this.queryD5000Device(e)},resetParam(){this.param.pageIndex=0},queryD5000Device(e){var l;this.param.dbId||!e?(this.param.stationType=this.testData.tdcsParam.stationType,this.sbLoadingFlag=!0,"ECSB"==this.param.deviceType?(l=this.param,S({url:"".concat(q).concat(W,"/select/get-second"),method:"post",data:l,showLoading:!0})).then(e=>{e.data&&(e.data.forEach(e=>{e.checked=!1,e.zsb=!1}),this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}),this.sbLoadingFlag=!1}).catch():function(e){return S({url:"".concat(q).concat(W,"/d5000/list-device"),method:"post",data:e,showLoading:!0})}(this.param).then(e=>{e.data&&(e.data.forEach(e=>{e.checked=!1,e.zsb=!1}),this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}),this.sbLoadingFlag=!1}).catch()):this.$message({message:"请先选择厂站",type:"warning"})},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectList.forEach(e=>{e.checked=!1}),e.checked=!0,this.canSelectData=e)},dbClickCanSelect(e){this.allDisabled||(this.canSelectData=e,this.canSelectList.forEach(e=>{e.checked=!1}),this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):(e.isSecond&&(e.label="保护停用"),e.checked=!1,this.alSelectList.push(JSON.parse(JSON.stringify(e))),e.checked=!0))},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.queryD5000Device())},ClickAlSelcteCanSelct(e,l){this.allDisabled||(this.alSelectData=e,this.alSelectDataIndex=l,this.alSelectList.forEach(e=>{e.checked=!1}),e.checked=!0)},dbClickAlselctAlselect(e){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList.splice(e,1),this.alSelectList.forEach(e=>{e.checked=!1}))},selectDevice(e){let l=[];this.alSelectList[e].zsb&&(l.push(this.alSelectList[e]),this.alSelectList.splice(e,1));let a=[],t=[];this.alSelectList.length>0&&this.alSelectList.forEach(e=>{e.zsb?a.push(e):t.push(e)}),this.alSelectList=JSON.parse(JSON.stringify(l.concat(a).concat(t)))},moveUp(){-1!=this.alSelectDataIndex?0!=this.alSelectDataIndex?(this.alSelectList.splice(this.alSelectDataIndex-1,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex+1,1),this.alSelectDataIndex=this.alSelectDataIndex-1):this.$message({message:"已经在第一个，无法上移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},moveDown(){-1!=this.alSelectDataIndex?this.alSelectDataIndex!=this.alSelectList.length-1?(this.alSelectList.splice(this.alSelectDataIndex+2,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex,1),this.alSelectDataIndex=this.alSelectDataIndex+1):this.$message({message:"已经在最后一个，无法下移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},judgeExist(){return-1!=this.alSelectList.findIndex(e=>e.sbid==this.canSelectData.sbid)},turnRight(){this.allDisabled||null==this.canSelectData.sbid||(this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):(this.canSelectData.isSecond&&(this.canSelectData.label="保护停用"),this.alSelectList.push(this.canSelectData)))},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList=[])},delettextlabel(e){this.NullNodeInputList.splice(e,1)},addInpput(){""!=this.NullNodeInput.trim()?this.NullNodeInputList.findIndex(e=>e.sbmc==this.NullNodeInput)>-1?this.$message({message:"无法加入同名设备",type:"warning"}):this.NullNodeInputList.push({sbid:"",sbmc:this.NullNodeInput,sbzt:"",sbddmm:this.NullNodeInput,label:"",realdydj:"",checked:!1,sblx:"手写输入"}):this.$message({message:"无法加入空白设备",type:"warning"})},addInpputCZ(){""!=this.inputCZ.trim()?this.alSelectList.findIndex(e=>e.sbmc==this.inputCZ)>-1?this.$message({message:"无法加入同名设备",type:"warning"}):this.alSelectList.push({sbid:"",sbmc:this.inputCZ,sbzt:"",sbddmm:this.inputCZ,label:"",dydj:"",checked:!1,sblx:"手写输入"}):this.$message({message:"无法加入空白设备",type:"warning"})},confirm(){let e={CZSBList:[]};if(-1!=this.testData.bdlx.indexOf("rjh")&&this.alSelectList.length<1&&this.NullNodeInputList.length<1)return this.$emit("refreshSBXX",e.CZSBList),void this.$emit("close");if(this.alSelectList.length<1&&this.NullNodeInputList.length<1)this.$message({message:"请选择一条数据",type:"warning"});else{if(!this.isCommon&&(-1!=this.testData.bdlx.indexOf("rjh")&&!this.sfts||this.testData.bdlx.indexOf("zcq")>-1)){let e=!1;if(this.alSelectList.forEach(l=>{l.label||(e=!0)}),this.NullNodeInputList.forEach(l=>{l.label||(e=!0)}),e)return void this.$message({message:"请给所有设备选择类型",type:"warning"})}"ST"==this.CZLX?e={CZSBList:this.NullNodeInputList,STSBList:[]}:this.alSelectList.forEach(l=>{""!=l.sbid?e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm:l.sbmc,sbid:l.sbid,label:l.label?l.label:"",realdydj:l.realdydj?l.realdydj:l.dydj?l.dydj:"",zsb:!!l.zsb,sblx:l.sblx?l.sblx:"",sbbm:l.sbbm?l.sbbm:"",isSecond:!!l.isSecond,czid:l.czid?l.czid:l.czid_md?l.czid_md:"",czmc:l.czmc?l.czmc:l.czmc_md?l.czmc_md:""}):(l.realdydj="",e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm.replace(/[\r\n]/g," "):l.sbmc.replace(/[\r\n]/g," "),sbid:l.sbid,label:l.label?l.label:"",realdydj:"",sbbm:"",zsb:!!l.zsb,sblx:"手写输入"}))}),e.CZSBList&&e.CZSBList.length>0&&(e.CZSBList.forEach((e,l)=>{e.sort=l+1}),this.testData.showzsb&&e.CZSBList.sort((e,l)=>e.zsb&&l.zsb?0:e.zsb?-1:1)),this.$emit("refreshSBXX",e.CZSBList),this.$emit("close")}},cancel(){this.$emit("close")}},computed:{...A(["areaEng"]),fromRjh:()=>!0,options2(){return e=>e.isSecond?[{label:"保护停用",value:"保护停用"},{label:"保护信号",value:"保护信号"}]:(this.testData.bdlx.indexOf("rjh")>-1||this.testData.bdlx.indexOf("zcq")>-1)&&"NT"===this.areaEng?[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"},{label:"停机",value:"停机"}]:[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"}]}}},ul={class:"sb-left-tree"},pl={class:"search-div"},ml={class:"search-itme"},bl={class:"search-itme"},vl={class:"search-itme",style:{"margin-left":"10px"}},gl={class:"search-itme",style:{"margin-left":"10px"}},Sl={class:"content-div"},fl={class:"select-input"},Dl={class:"select-content"},Cl=["onClick","onDblclick"],xl={class:"page-div"},yl={class:"center-content"},kl={class:"cneter-div"},zl={class:"cneter-div"},Ll={class:"select-content"},Nl=["onClick","onDblclick"],Il={class:"zsb-check"},wl={class:"selection",style:{display:"flex"}},Zl={style:{color:"red","margin-right":"5px"}},Pl={class:"write-input"},_l={class:"top-hand-div"},Vl={class:"write-input-textarea"},jl={class:"content-div"},Ml={class:"select-content"},Tl={class:"nullnode-show-div"},Xl=["onDblclick"],Ol={class:"text-label"},$l={class:"text-label2",style:{display:"flex"}},Al={style:{color:"red","margin-right":"5px"}},Bl=["onClick"],El={class:"nullnode-show-div"},Ul={class:"write-input-textarea"},Rl={class:"bottom-button-div"},ql={class:"half-div"},Wl={class:"half-div"};const Fl=D(hl,[["render",function(e,l,a,t,s,n){const c=x("el-tree"),o=x("pane"),r=x("el-option"),u=x("el-select"),p=x("el-input"),m=x("el-button"),b=x("Top"),v=x("Bottom"),g=x("d-arrow-right"),S=x("d-arrow-left"),f=x("el-checkbox"),D=x("Splitpanes"),C=$("loading");return i(),d("div",{id:"sbD5000",class:"gljh px2rem-ignore",onClose:l[17]||(l[17]=l=>e.$emit("close"))},[y(D,{style:{height:"100%"},class:"default-theme"},{default:L(()=>[y(o,{size:"20"},{default:L(()=>[V(N("div",{class:Z(["select-cz",s.selectNode.CZID==s.testData.tdcsParam.CZID?"alselect-cz":""]),onClick:l[0]||(l[0]=e=>n.selectCZ(s.testData.tdcsParam))},P(s.testData.tdcsParam.CZMC),3),[[j,"CZ"==s.CZLX]]),V(N("div",ul,[y(c,{ref:"tree","node-key":"id","expand-on-click-node":!1,data:s.treeData,props:s.props,onNodeClick:n.clickEvent,lazy:"",load:n.loadNode,"default-expanded-keys":[s.defaultExpandId],"highlight-current":""},null,8,["data","props","onNodeClick","load","default-expanded-keys"])],512),[[j,"CZ"!=s.CZLX]])]),_:1}),y(o,null,{default:L(()=>[V(N("a",null,[N("div",pl,[l[19]||(l[19]=N("div",{class:"search-label"},"设备类型: ",-1)),N("div",ml,[y(u,{class:"search-datepicker",modelValue:s.param.deviceType,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.deviceType=e),placeholder:"请选择",onChange:n.changeCZLX},{default:L(()=>[(i(!0),d(I,null,w(s.options,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),l[20]||(l[20]=N("div",{class:"search-label"},"电压等级: ",-1)),N("div",bl,[y(u,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.dydj=e),placeholder:"请选择",onChange:n.changeCZLX},{default:L(()=>[(i(!0),d(I,null,w(s.dydjoptions,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),N("div",vl,[y(p,{class:"search-datepicker",onChange:n.changeCZLX,modelValue:s.param.deviceContent,"onUpdate:modelValue":l[3]||(l[3]=e=>s.param.deviceContent=e),placeholder:"请输入内容"},null,8,["onChange","modelValue"])]),N("div",gl,[y(m,{style:{width:"50px","line-height":"0px","text-align":"center","text-indent":"-8px"},class:"",onClick:l[4]||(l[4]=e=>n.changeCZLX(!0))},{default:L(()=>[...l[18]||(l[18]=[_("查询 ",-1)])]),_:1})])]),N("div",Sl,[N("div",fl,[V((i(),d("div",Dl,[l[23]||(l[23]=N("div",{class:"tilte"},"可选设备(双击选取设备)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.canSelectList,(e,l)=>(i(),d("div",{class:Z(["text-label",[1==e.checked?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickSelcteCanSelct(e),onDblclick:l=>n.dbClickCanSelect(e),key:l+"canSelect"},P(e.sbddmm),43,Cl))),128))],2),N("div",xl,[y(m,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[5]||(l[5]=e=>n.pageChange(-1))},{default:L(()=>[...l[21]||(l[21]=[_(" 上一页 ",-1)])]),_:1},8,["disabled"]),y(m,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[6]||(l[6]=e=>n.pageChange(1))},{default:L(()=>[...l[22]||(l[22]=[_(" 下一页 ",-1)])]),_:1},8,["disabled"])])])),[[C,s.sbLoadingFlag]]),N("div",yl,[N("div",{class:"sortbutton upbutton",onClick:l[7]||(l[7]=(...e)=>n.moveUp&&n.moveUp(...e))},[y(b)]),N("div",{class:"sortbutton downbutton",onClick:l[8]||(l[8]=(...e)=>n.moveDown&&n.moveDown(...e))},[y(v)]),N("div",kl,[N("div",{class:Z(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[9]||(l[9]=(...e)=>n.turnRight&&n.turnRight(...e))},[y(g,{height:"24"})],2)]),N("div",zl,[N("div",{class:Z(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[10]||(l[10]=(...e)=>n.turnLeft&&n.turnLeft(...e))},[y(S,{height:"24"})],2)])]),N("div",Ll,[l[25]||(l[25]=N("div",{class:"tilte"},"已选设备(双击删除已选设备)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.alSelectList,(e,t)=>(i(),d("a",{key:t+"alSelect"},[N("div",{class:Z(["text-label",[t==s.alSelectDataIndex?"selctet":"",s.showzsb?"candele show-candele":"candele",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickAlSelcteCanSelct(e,t),onDblclick:e=>n.dbClickAlselctAlselect(t)},P(e.sbddmm?e.sbddmm:e.sbmc),43,Nl),V(N("div",Il,[y(f,{onChange:e=>n.selectDevice(t),modelValue:e.zsb,"onUpdate:modelValue":l=>e.zsb=l},{default:L(()=>[...l[24]||(l[24]=[_("主 ",-1)])]),_:1},8,["onChange","modelValue","onUpdate:modelValue"])],512),[[j,s.showzsb]]),V(N("div",wl,[V(N("span",Zl,"*",512),[[j,!s.sfts]]),y(u,{class:"search-datepicker",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,placeholder:"请选择",clearable:"","allow-create":n.fromRjh,filterable:n.fromRjh},{default:L(()=>[(i(!0),d(I,null,w(n.options2(e),e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","allow-create","filterable"])],512),[[j,!a.isCommon]])]))),128))],2)])]),V(N("div",Pl,[l[26]||(l[26]=N("div",{class:"tilte"},[_("手工录入("),N("span",{style:{color:"red"}},"注:厂站列表中没有的厂站允许在此填写"),_(")")],-1)),N("div",_l,[N("div",Vl,[y(p,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[11]||(l[11]=e=>s.inputCZ=e)},null,8,["modelValue"])]),N("div",{class:"right-button",onClick:l[12]||(l[12]=e=>n.addInpputCZ())},"加入手写")])],512),[[j,s.testData.bdlx&&-1==s.testData.bdlx.indexOf("jl")]])])],512),[[j,"ST"!=s.CZLX]]),V(N("div",jl,[N("div",Ml,[l[27]||(l[27]=N("div",{class:"tilte"},[_("已选设备"),N("span",{style:{color:"red"}},"注：双击可移除已选设备")],-1)),N("div",Tl,[(i(!0),d(I,null,w(s.NullNodeInputList,(e,l)=>(i(),d("div",{class:"nullnode-show-div-select",key:l+"slect",onDblclick:e=>n.delettextlabel(l)},[N("div",Ol,P(e.sbddmm),1),V(N("div",$l,[V(N("span",Al,"*",512),[[j,!s.sfts]]),y(u,{class:"search-datepicker",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,placeholder:"请选择",clearable:"","allow-create":n.fromRjh,filterable:n.fromRjh},{default:L(()=>[(i(!0),d(I,null,w(n.options2(e),e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","allow-create","filterable"])],512),[[j,!a.isCommon]]),N("div",{class:"delete-text-label",onClick:e=>n.delettextlabel(l)},null,8,Bl)],40,Xl))),128))]),l[28]||(l[28]=N("div",{class:"tilte"},[_("手工录入"),N("span",{style:{color:"red"}},"注：左侧设备树中没有的设备允许在此手工填写")],-1)),N("div",El,[N("div",Ul,[y(p,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.NullNodeInput,"onUpdate:modelValue":l[13]||(l[13]=e=>s.NullNodeInput=e)},null,8,["modelValue"])]),N("div",{class:"add-input",onClick:l[14]||(l[14]=e=>n.addInpput())},"加入手写")])])],512),[[j,"ST"==s.CZLX]]),N("div",Rl,[N("div",ql,[N("div",{class:"gljh-btn qd",onClick:l[15]||(l[15]=e=>n.confirm())},"确认")]),N("div",Wl,[N("div",{class:"gljh-btn gb",onClick:l[16]||(l[16]=e=>n.cancel())},"取消")])])]),_:1})]),_:1})],32)}],["__scopeId","data-v-d1b7a154"]]);Fl.install=e=>{e.component(Fl.name,Fl)};const Kl={name:"zcq-sb-oms",props:{paramdata:{type:Object},updateSource:String,sblist:{type:Array},id:{type:String,default:""},isCommon:{type:Boolean,default:!1}},components:{DArrowLeft:z,DArrowRight:k,Bottom:O,Top:X,Splitpanes:U,Pane:R},data:()=>({innerSblist:[],sfts:!1,showzsb:!1,STSBList:[],defaultExpandId:"",CZLX:"",testData:{tdcsParam:{CZID:""}},param:{stationId:"",sbType:"",sbTypeName:"线路",dydj:"",keyword:"",pageSize:"20",pageIndex:0},options:[{label:"线路",value:"MW_APP.MWT_UD_SB_XL"},{label:"母线",value:"MW_APP.MWT_UD_SB_MX"},{label:"断路器",value:"MW_APP.MWT_UD_SB_DLQ"},{label:"间隔单元",value:"MW_APP.MWT_UD_SB_JGDY"},{label:"发电机",value:"MW_APP.MWT_UD_SB_FDJ"},{label:"变压器",value:"MW_APP.MWT_UD_SB_BYQ"},{label:"电抗器",value:"MW_APP.MWT_UD_SB_DKQ"},{label:"电容器",value:"MW_APP.MWT_UD_SB_DLDRQ"},{label:"电流互感器",value:"MW_APP.MWT_UD_SB_DLHGQ"},{label:"电压互感器",value:"MW_APP.MWT_UD_SB_DYHGQ"}],dydjoptions:[{label:"",value:""},{label:"1000kV",value:"1000000"},{label:"500kV",value:"500000"},{label:"220kV",value:"220000"},{label:"110kV",value:"110000"},{label:"35kV",value:"35000"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",canSelectData:{},treeNode:{},alSelectData:{},alSelectDataIndex:-1,allDisabled:!1,alNullNodeInput:"",NullNodeInput:"",selectNode:{CZID:""},unCZSelectFlag:!1,sbLoadingFlag:!1,props:{label:"name",children:"child",isLeaf:"leaf"}}),created(){this.sfts=!!this.paramdata.sfts&&this.paramdata.sfts,this.testData=this.paramdata,this.testData.showzsb&&(this.showzsb=!0),this.CZLX=this.testData.tdcsParam.czlx},mounted(){console.log(this.testData),this.getAlSelectDevice(),this.testData.tdcsParam||(this.testData.tdcsParam={czlx:"",CZID:"",dbId:"",stationType:""}),console.log("this.testData.tdcsParam"),console.log(this.testData.tdcsParam),this.JudgeCZMC(),this.param.sbType=this.options[0].value,this.param.sbTypeName=this.options[0].label,setTimeout(()=>{this.sbLoadingFlag=!0,this.selectCZ(this.testData.tdcsParam)},100)},methods:{getAlSelectDevice(){this.sblist&&(this.innerSblist=JSON.parse(JSON.stringify(this.sblist)),this.innerSblist.forEach(e=>{this.testData.showzsb||(e.zsb=!1),e.checked=!1}),this.alSelectList=JSON.parse(JSON.stringify(this.innerSblist)))},loadNode(e,l){this.currentNode=e.data,0==e.level?(this.currentNode={isFirst:!0,pageFlag:"sd-zcq"},this.getLoad(l)):this.getLoad(l)},getLoad(e){var l;console.log(this.CZLX),"CZ"!=this.CZLX&&(l=this.currentNode,S({url:"".concat(q).concat(W,"/oms/load-line-lazy-tree"),method:"post",data:l,showLoading:!0})).then(l=>(l[0]&&"0"==l[0].level&&(this.defaultExpandId=l[0].id),e(l))).catch()},clickEvent(e){e.leaf?(this.resetParam(),this.param.stationId=e.id,this.queryOMSDevice()):this.$refs.tree.setCurrentKey()},JudgeCZMC(){"CZ"!=this.CZLX&&(this.options=[{label:"线路",value:"MW_APP.MWT_UD_SB_XL"}],this.param.sbType="MW_APP.MWT_UD_SB_XL")},selectCZ(e){this.resetParam(),this.selectNode=e,this.param.stationId=this.testData.tdcsParam.CZID,this.queryOMSDevice()},selectUnCZ(){this.unCZSelectFlag=!0,this.queryOMSDevice()},changeCZLX(){this.param.sbType&&""!=this.param.sbType&&(this.param.sbTypeName=this.options.find(e=>e.value==this.param.sbType).label),this.resetParam(),this.queryOMSDevice()},resetParam(){this.param.pageIndex=0},queryOMSDevice(){var e;this.param.stationType=this.testData.tdcsParam.stationType,this.sbLoadingFlag=!0,(e=this.param,S({url:"".concat(q).concat(W,"/oms/list-device"),method:"post",data:e,showLoading:!0})).then(e=>{e.data&&(e.data.forEach(e=>{e.checked=!1}),this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}),this.sbLoadingFlag=!1}).catch()},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectList.forEach(e=>{e.checked=!1}),this.canSelectData=e,e.checked=!0)},dbClickselctAlselect(e){this.allDisabled||(this.canSelectData=e,this.canSelectList.forEach(e=>{e.checked=!1}),this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):(e.checked=!1,this.alSelectList.push(JSON.parse(JSON.stringify(e))),e.checked=!0))},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.queryOMSDevice())},ClickAlSelcteCanSelct(e,l){this.allDisabled||(this.alSelectData=e,this.alSelectDataIndex=l,this.alSelectList.forEach(e=>{e.checked=!1}),e.checked=!0)},dbClickAlselctAlselect(e){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList.splice(e,1),this.alSelectList.forEach(e=>{e.checked=!1}))},selectDevice(e){let l=[];this.alSelectList[e].zsb&&(l.push(this.alSelectList[e]),this.alSelectList.splice(e,1));let a=[],t=[];this.alSelectList.length>0&&this.alSelectList.forEach(e=>{e.zsb?a.push(e):t.push(e)}),this.alSelectList=JSON.parse(JSON.stringify(l.concat(a).concat(t)))},judgeExist(){return-1!=this.alSelectList.findIndex(e=>e.sbid==this.canSelectData.sbid)},turnRight(){this.allDisabled||null==this.canSelectData.sbid||(this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):this.alSelectList.push(this.canSelectData))},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList=[])},moveUp(){-1!=this.alSelectDataIndex?0!=this.alSelectDataIndex?(this.alSelectList.splice(this.alSelectDataIndex-1,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex+1,1),this.alSelectDataIndex=this.alSelectDataIndex-1):this.$message({message:"已经在第一个，无法上移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},moveDown(){-1!=this.alSelectDataIndex?this.alSelectDataIndex!=this.alSelectList.length-1?(this.alSelectList.splice(this.alSelectDataIndex+2,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex,1),this.alSelectDataIndex=this.alSelectDataIndex+1):this.$message({message:"已经在最后一个，无法下移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},addInpputCZ(){""!=this.inputCZ.trim()?this.alSelectList.findIndex(e=>e.sbmc==this.inputCZ)>-1?this.$message({message:"无法加入同名设备",type:"warning"}):this.alSelectList.push({sbid:"",sbmc:this.inputCZ,sbzt:"",sbddmm:this.inputCZ,label:"",dydj:"",checked:!1,sblx:"手写输入"}):this.$message({message:"无法加入空白设备",type:"warning"})},confirm(){let e={CZSBList:[],STSBList:[]};if(-1!=this.testData.bdlx.indexOf("rjh")&&this.alSelectList.length<1)return this.$emit("refreshSBXX",e.CZSBList),void this.$emit("close");if(this.alSelectList.length<1)this.$message({message:"请选择一条数据",type:"warning"});else{if(console.log("当前是否调试"),console.log(this.sfts),console.log("如果是日计划，并且sfts  为 false  此时必填设备类型"),console.log(-1!=this.testData.bdlx.indexOf("rjh")&&!this.sfts),!this.isCommon&&(-1!=this.testData.bdlx.indexOf("rjh")&&!this.sfts||this.testData.bdlx.indexOf("zcq")>-1)){let e=!1;if(this.alSelectList.forEach(l=>{l.label||(e=!0)}),e)return void this.$message({message:"请给所有设备选择类型",type:"warning"})}this.alSelectList.forEach(l=>{let a="";l.realdydj&&l.realdydj.split("kV")>1?a=l.realdydj:l.dydj&&l.dydj.split("kV")>1?a=l.dydj:l.sbdydjmc&&l.sbdydjmc.split("kV")>1?a=l.sbdydjmc:l.realdydj?a=l.realdydj:l.dyd?a=l.dydj:l.sbdydjmc&&(a=l.sbdydjmc),""!=l.sbid?(l.realdydj=a,e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm:l.sbmc,sbid:l.sbid,label:l.label?l.label:"",realdydj:l.realdydj?l.realdydj:"",zsb:!!l.zsb,sblx:l.sblx?l.sblx:"",sbbm:l.sbbm?l.sbbm:"",rl:l.sbedrl?l.sbedrl:"",czid:l.czid?l.czid:l.czid_md?l.czid_md:"",czmc:l.czmc?l.czmc:l.czmc_md?l.czmc_md:""})):(l.realdydj="",e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm.replace(/[\r\n]/g," "):l.sbmc.replace(/[\r\n]/g," "),sbid:l.sbid,label:l.label?l.label:"",realdydj:"",zsb:!!l.zsb,sblx:"手写输入",sbbm:""}))}),e.CZSBList.forEach((e,l)=>{e.sort=l+1}),this.testData.showzsb&&e.CZSBList.sort((e,l)=>e.zsb&&l.zsb?0:e.zsb?-1:1),this.closeAndReturnData(e)}},closeAndReturnData(e){console.log("设备选择组件开始回传数据"),console.log(e),this.$emit("refreshSBXX",e.CZSBList),this.$emit("close")},cancel(){this.$emit("close")}},computed:{...A(["areaEng"]),fromRjh:()=>!0,options2(){return(this.testData.bdlx.indexOf("rjh")>-1||this.testData.bdlx.indexOf("zcq")>-1)&&"NT"===this.areaEng?[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"},{label:"停机",value:"停机"}]:[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"}]}}},Jl={class:"sb-left-tree"},Yl={class:"search-div"},Ql={class:"search-itme"},Gl={class:"search-itme"},Hl={class:"search-itme",style:{"margin-left":"10px"}},ea={class:"content-div"},la={class:"select-input"},aa={class:"select-content"},ta=["onClick","onDblclick"],sa={class:"page-div"},ia={class:"center-content"},da={class:"cneter-div"},na={class:"cneter-div"},ca={class:"select-content"},oa=["onClick","onDblclick"],ra={class:"zsb-check"},ha={class:"selection",style:{display:"flex"}},ua={style:{color:"red","margin-right":"5px"}},pa={class:"write-input"},ma={class:"top-hand-div"},ba={class:"write-input-textarea"},va={class:"bottom-button-div"},ga={class:"half-div"},Sa={class:"half-div"};const fa=D(Kl,[["render",function(e,l,a,t,s,n){const c=x("el-tree"),o=x("pane"),r=x("el-option"),u=x("el-select"),p=x("el-input"),m=x("el-button"),b=x("Top"),v=x("Bottom"),g=x("d-arrow-right"),S=x("d-arrow-left"),f=x("el-checkbox"),D=x("Splitpanes"),C=$("loading");return i(),d("div",{id:"sbOMS",class:"gljh px2rem-ignore",onClose:l[14]||(l[14]=l=>e.$emit("close"))},[y(D,{style:{height:"100%"},class:"default-theme"},{default:L(()=>[y(o,{size:"20"},{default:L(()=>[V(N("div",{class:Z(["select-cz",s.selectNode.CZID==s.testData.tdcsParam.CZID?"alselect-cz":""]),onClick:l[0]||(l[0]=e=>n.selectCZ(s.testData.tdcsParam))},P(s.testData.tdcsParam.CZMC),3),[[j,"CZ"==s.CZLX]]),N("div",Jl,[V(y(c,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":[s.defaultExpandId],load:n.loadNode,onNodeClick:n.clickEvent,lazy:"","highlight-current":""},null,8,["props","default-expanded-keys","load","onNodeClick"]),[[j,"CZ"!=s.CZLX]])])]),_:1}),y(o,null,{default:L(()=>[N("div",Yl,[l[15]||(l[15]=N("div",{class:"search-label"},"设备类型: ",-1)),N("div",Ql,[y(u,{class:"search-datepicker",modelValue:s.param.sbType,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.sbType=e),placeholder:"请选择",onChange:n.changeCZLX},{default:L(()=>[(i(!0),d(I,null,w(s.options,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),l[16]||(l[16]=N("div",{class:"search-label"},"电压等级: ",-1)),N("div",Gl,[y(u,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.dydj=e),placeholder:"请选择",onChange:n.changeCZLX},{default:L(()=>[(i(!0),d(I,null,w(s.dydjoptions,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),N("div",Hl,[y(p,{class:"search-datepicker",onChange:n.changeCZLX,modelValue:s.param.keyword,"onUpdate:modelValue":l[3]||(l[3]=e=>s.param.keyword=e),placeholder:"请输入内容"},null,8,["onChange","modelValue"])])]),N("div",ea,[N("div",la,[V((i(),d("div",aa,[l[19]||(l[19]=N("div",{class:"tilte"},"可选设备(双击选取设备)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.canSelectList,(e,l)=>(i(),d("div",{class:Z(["text-label",[e.checked?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickSelcteCanSelct(e),onDblclick:l=>n.dbClickselctAlselect(e),key:l+"canSelect"},P(e.sbddmm),43,ta))),128))],2),N("div",sa,[y(m,{class:"el-icon-d-arrow-left page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[4]||(l[4]=e=>n.pageChange(-1))},{default:L(()=>[...l[17]||(l[17]=[_(" 上一页 ",-1)])]),_:1},8,["disabled"]),y(m,{class:"el-icon-d-arrow-right page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[5]||(l[5]=e=>n.pageChange(1))},{default:L(()=>[...l[18]||(l[18]=[_(" 下一页 ",-1)])]),_:1},8,["disabled"])])])),[[C,s.sbLoadingFlag]]),N("div",ia,[N("div",{class:"sortbutton upbutton el-icon-top",onClick:l[6]||(l[6]=(...e)=>n.moveUp&&n.moveUp(...e))},[y(b)]),N("div",{class:"sortbutton downbutton",onClick:l[7]||(l[7]=(...e)=>n.moveDown&&n.moveDown(...e))},[y(v)]),N("div",da,[N("div",{class:Z(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[8]||(l[8]=(...e)=>n.turnRight&&n.turnRight(...e))},[y(g,{height:"24"})],2)]),N("div",na,[N("div",{class:Z(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[9]||(l[9]=(...e)=>n.turnLeft&&n.turnLeft(...e))},[y(S,{height:"24"})],2)])]),N("div",ca,[l[21]||(l[21]=N("div",{class:"tilte"},"已选设备(双击删除已选设备)",-1)),N("div",{class:Z(["show-div",s.allDisabled?"disable-show-div":""])},[(i(!0),d(I,null,w(s.alSelectList,(e,t)=>(i(),d("a",{key:t+"alSelect"},[N("div",{class:Z(["text-label candele",[t==s.alSelectDataIndex?"selctet":"",s.showzsb?"candele show-candele":"candele",s.allDisabled?"disable-text-label":""]]),onClick:l=>n.ClickAlSelcteCanSelct(e,t),onDblclick:e=>n.dbClickAlselctAlselect(t)},P(e.sbddmm?e.sbddmm:e.sbmc),43,oa),V(N("div",ra,[y(f,{onChange:e=>n.selectDevice(t),modelValue:e.zsb,"onUpdate:modelValue":l=>e.zsb=l},{default:L(()=>[...l[20]||(l[20]=[_("主",-1)])]),_:1},8,["onChange","modelValue","onUpdate:modelValue"])],512),[[j,s.showzsb]]),V(N("div",ha,[V(N("span",ua,"*",512),[[j,!s.sfts]]),y(u,{class:"search-datepicker",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,placeholder:"请选择",clearable:"","allow-create":n.fromRjh,filterable:n.fromRjh},{default:L(()=>[(i(!0),d(I,null,w(n.options2,e=>(i(),h(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","allow-create","filterable"])],512),[[j,!a.isCommon]])]))),128))],2)])]),V(N("div",pa,[l[22]||(l[22]=N("div",{class:"tilte"},[_("手工录入("),N("span",{style:{color:"red"}},"注:厂站列表中没有的厂站允许在此填写"),_(")")],-1)),N("div",ma,[N("div",ba,[y(p,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[10]||(l[10]=e=>s.inputCZ=e)},null,8,["modelValue"])]),N("div",{class:"right-button",onClick:l[11]||(l[11]=e=>n.addInpputCZ())},"加入手写")])],512),[[j,s.testData.bdlx&&-1==s.testData.bdlx.indexOf("jl")]])]),N("div",va,[N("div",ga,[N("div",{class:"gljh-btn qd",onClick:l[12]||(l[12]=e=>n.confirm())},"确认")]),N("div",Sa,[N("div",{class:"gljh-btn gb",onClick:l[13]||(l[13]=e=>n.cancel())},"取消")])])]),_:1})]),_:1})],32)}],["__scopeId","data-v-5e787759"]]);fa.install=e=>{e.component(fa.name,fa)};const Da={name:"zcq-sb-dky",props:{isZytdsb:{type:Boolean,default:!1},isTysb:{type:Boolean,default:!1},isBYQ:{type:Boolean,default:!1},isFdj:{type:Boolean,default:!1},isMx:{type:Boolean,default:!1},isXsbty:{type:Boolean,default:!1},paramdata:{type:Object},sblist:{type:Array,default:[]},id:{type:String,default:""}},components:{DArrowLeft:z,DArrowRight:k,ArrowRight:E,ArrowLeft:B,Bottom:O,Top:X,Splitpanes:U,Pane:R},data:()=>({nowArea:"",czParam:{},selectedNodes:[],filterKey:"",treeData:[],treeFilterKey:"",guid:K(),selfInput:"",showzsb:!1,sbLoadingFlag:!1,canSelectList:[],defaultExpandId:"",totalPage:1,props:{children:"children",label:"name",isLeaf:"leaf"},testData:{tdcsParam:{CZID:""}},param:{sblx:"",dydj:"",subId:"",keyword:"",pageSize:"20",pageIndex:0},sblxOptions:[{label:"交流线路",value:"交流线路"},{label:"T接线路",value:"T接线路"},{label:"发电机",value:"发电机"},{label:"变压器",value:"变压器"},{label:"母线",value:"母线"},{label:"断路器",value:"断路器"},{label:"隔离开关",value:"隔离开关"},{label:"并联电容器",value:"并联电容器"},{label:"电流互感器",value:"电流互感器"},{label:"电压互感器",value:"电压互感器"}],dydjoptions:[{label:"全部",value:""},{label:"1000kV",value:"1000kV"},{label:"800kV",value:"800kV"},{label:"500kV",value:"500kV"},{label:"220kV",value:"220kV"},{label:"110kV",value:"110kV"},{label:"35kV",value:"35kV"},{label:"20kV",value:"20kV"},{label:"10kV",value:"10kV"}],CZLX:"",treeNode:{},alSelectDataIndex:-1,alSelectData:{},selectNode:{}}),mounted(){this.nowArea=this.$store.state.userInfo.cropJc,this.testData=this.paramdata,this.czParam=this.paramdata.tdcsParam,this.testData.showzsb&&(this.showzsb=!0),this.testData.tdcsParam||(this.testData.tdcsParam={czlx:"",CZID:"",dbId:"",stationType:""}),this.CZLX=this.testData.tdcsParam.id,"南京"==this.nowArea&&(this.param.dydj="110kV"),"xl"==this.CZLX?(this.sblxOptions=[{label:"交流线路",value:"交流线路"},{label:"T接线路",value:"T接线路"}],"南京"==this.nowArea&&(this.dydjoptions=[{label:"全部",value:""},{label:"1000kV",value:"1000kV"},{label:"800kV",value:"800kV"},{label:"500kV",value:"500kV"},{label:"220kV",value:"220kV"},{label:"110kV",value:"110kV"}],this.param.dydj="110kV"),"常州"==this.nowArea&&(this.dydjoptions=[{label:"110kV",value:"110kV"}],this.param.dydj=this.dydjoptions[0].value),this.param.sblx=this.sblxOptions[0].value,this.param.subId="xl",this.queryDkyDevice()):"input"==this.CZLX?(this.param.sblx=this.sblxOptions[0].value,this.param.subId="input",setTimeout(()=>{this.selectCZ(this.testData.tdcsParam,!0)},100)):(this.isBYQ&&(this.sblxOptions=[{label:"变压器",value:"变压器"}]),this.isMx&&(this.sblxOptions=[{label:"母线",value:"母线"}]),this.isFdj&&(this.sblxOptions=[{label:"发电机",value:"发电机"}]),this.CZLX="CZ",this.param.sblx=this.sblxOptions[0].value,setTimeout(()=>{this.selectCZ(this.testData.tdcsParam)},100)),this.sblist.forEach(e=>{let l="";!l&&e.specialDkyName&&(l=e.specialDkyName),!l&&e.sbddmm&&(l=e.sbddmm);let a="";a="xl"==this.czParam.CZID&&"常州"!=this.nowArea?e.sbddmm:e.simpleDkyName?e.simpleDkyName:e.sbddmm;let t={zsb:e.zsb,sbzt:e.label,id:e.id,label:l,sbmc:a,d5000id:e.d5000id,dydj:e.realdydj,sbid:e.sbid,sblx:e.sblx};this.selectedNodes.push(t)})},methods:{loadNode(e,l){let a=e.data;"[object Object]"===Object.prototype.toString.call(a)&&(a.children&&a.children.length>0?l(a.children):J(a).then(e=>{l(e)}).catch())},resetParam(){this.param.pageIndex=0},filterTree(){this.treeFilterKey=this.filterKey},selectCZ(e,l){this.resetParam(),this.curNode=e,this.selectNode=e,l||(this.param.subId=this.testData.tdcsParam.id),this.queryDkyDevice()},clickEvent(e){this.param.areaId=e.id,this.param.dbId=e.pid,this.param.level=e.level,this.treeNode=e,this.restParam(),this.querySubstation()},changeCZLX(e){this.resetParam(),console.log(e,"flag"),this.queryDkyDevice()},queryDkyDevice(){var e;this.sbLoadingFlag=!0,(e={...this.param,isXsbty:this.isXsbty},S({url:"".concat(q).concat(W,"/dky/load-device-lazy-tree"),method:"post",data:e,showLoading:!0})).then(e=>{e.data.forEach(e=>{e.checked=!1,e.zsb=!1}),this.canSelectList=e.data,this.sbLoadingFlag=!1,this.totalPage=Math.ceil(e.total/20)}).catch(()=>{this.sbLoadingFlag=!1})},pageChange(e){-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.queryDkyDevice())},ClickSelcteCanSelct(e){this.canSelectList.forEach(e=>{e.checked=!1}),e.checked=!0,this.canSelectData=e},dbClickCanSelect(e){this.canSelectData=e,this.canSelectList.forEach(e=>{e.checked=!1}),this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):("常州"===this.nowArea&&(e.sbzt="检修"),e.checked=!1,this.selectedNodes.push(JSON.parse(JSON.stringify(e))),e.checked=!0)},ClickAlSelcteCanSelct(e,l){console.log(e,l),this.canSelectData=e,this.alSelectDataIndex=l,this.selectedNodes.forEach(e=>{e.checked=!1}),e.checked=!0},deleteSelectedNode(e){this.canSelectData={},this.alSelectDataIndex=-1,this.selectedNodes.splice(this.selectedNodes.indexOf(e),1),this.selectedNodes.forEach(e=>{e.checked=!1})},judgeExist(){return-1!=this.selectedNodes.findIndex(e=>e.sbid==this.canSelectData.sbid)},moveUp(){-1!=this.alSelectDataIndex?0!=this.alSelectDataIndex?(this.selectedNodes.splice(this.alSelectDataIndex-1,0,this.selectedNodes[this.alSelectDataIndex]),this.selectedNodes.splice(this.alSelectDataIndex+1,1),this.alSelectDataIndex=this.alSelectDataIndex-1):this.$message({message:"已经在第一个，无法上移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},moveDown(){-1!=this.alSelectDataIndex?this.alSelectDataIndex!=this.selectedNodes.length-1?(this.selectedNodes.splice(this.alSelectDataIndex+2,0,this.selectedNodes[this.alSelectDataIndex]),this.selectedNodes.splice(this.alSelectDataIndex,1),this.alSelectDataIndex=this.alSelectDataIndex+1):this.$message({message:"已经在最后一个，无法下移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},turnRight(){null!=this.canSelectData.sbid&&(this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):this.selectedNodes.push(this.canSelectData))},turnLeft(){this.alSelectData={},this.alSelectDataIndex=-1,this.selectedNodes=[]},addInpput(){let e=Math.random();this.dbClickCanSelect({id:"input"+e,label:this.selfInput,simpleDkyName:this.selfInput,sbmc:this.selfInput,sblx:"手写输入",sbid:"sbinput"+e})},confirm(){if(0===this.selectedNodes.length)return void this.$message({message:"请选择或输入一个设备进行保存",type:"warning"});if(this.showRequireLabel){if(!this.selectedNodes.every(e=>e.sbzt))return void this.$message({message:"请给所有设备选择类型",type:"warning"})}let e=[];for(let l=0;l<this.selectedNodes.length;l++){let a,t=this.selectedNodes[l];if(this.czParam&&"xl"==this.czParam.CZID&&"常州"!=this.nowArea){let e="";e=t.czmc?(t.czmc?t.czmc:"")+":"+(t.sbmc?t.sbmc:""):t.sbmc,a={sbddmm:e,specialDkyName:t.label?t.label:"",simpleDkyName:t.sbmc?t.sbmc:"",sbid:t.sbid,label:t.sbzt?t.sbzt:"",realdydj:t.realdydj?t.realdydj:t.dydj?t.dydj:"",zsb:!!t.zsb,sblx:t.sblx?t.sblx:"",czid:this.czParam.CZID,czmc:this.czParam.CZMC,id:t.id,d5000id:t.d5000id,sort:l+1}}else a={sbddmm:t.label?t.label:"",specialDkyName:t.label?t.label:"",simpleDkyName:t.sbmc?t.sbmc:"",sbid:t.sbid,label:t.sbzt?t.sbzt:"",realdydj:t.realdydj?t.realdydj:t.dydj?t.dydj:"",zsb:!!t.zsb,sblx:t.sblx?t.sblx:"",czid:this.czParam.CZID,czmc:this.czParam.CZMC,id:t.id,d5000id:t.d5000id,sort:l+1,sbedrl:t.sbedrl?t.sbedrl:"",fdlx:t.fdlx?t.fdlx:""};e.push(a)}this.$emit("refreshSBXX",e),this.$emit("close")},cancel(){this.$emit("close")}},computed:{showRequireLabel:()=>!1,showSelectSbzt:()=>!1,sbztOptions1:()=>[{label:"运行",value:"运行"},{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"停用保护",value:"停用保护"},{label:"停用",value:"停用"},{label:"启用",value:"启用"},{label:"充电",value:"充电"}],sbztOptions2(){return this.isTysb?[{label:"主变更换",value:"主变更换"},{label:"保护更换",value:"保护更换"},{label:"流变更换",value:"流变更换"},{label:"线路改造",value:"线路改造"},{label:"压变更换",value:"压变更换"},{label:"新增主变",value:"新增主变"},{label:"新增保护",value:"新增保护"},{label:"新增流变",value:"新增流变"},{label:"新增线路",value:"新增线路"},{label:"新增压变",value:"新增压变"},{label:"母线新增",value:"母线新增"},{label:"母线改造",value:"母线改造"}]:[{label:"主变更换",value:"主变更换"},{label:"保护更换",value:"保护更换"},{label:"流变更换",value:"流变更换"},{label:"线路改造",value:"线路改造"},{label:"压变更换",value:"压变更换"},{label:"新增主变",value:"新增主变"},{label:"新增保护",value:"新增保护"},{label:"新增流变",value:"新增流变"},{label:"新增线路",value:"新增线路"},{label:"新增压变",value:"新增压变"}]},sbztOptions3:()=>[{label:"主变更换",value:"主变更换"},{label:"保护更换",value:"保护更换"},{label:"流变更换",value:"流变更换"},{label:"线路改造",value:"线路改造"},{label:"压变更换",value:"压变更换"},{label:"主变改造",value:"主变改造"},{label:"新增主变",value:"新增主变"},{label:"新增保护",value:"新增保护"},{label:"新增流变",value:"新增流变"},{label:"新增线路",value:"新增线路"},{label:"新增压变",value:"新增压变"}]}},Ca={class:"sb-left-tree alselect-cz"},xa={class:"content-div"},ya={class:"search-div"},ka={class:"search-itme"},za={class:"search-itme"},La={class:"search-itme",style:{"margin-left":"10px"}},Na={class:"search-itme",style:{"margin-left":"10px",width:"80px"}},Ia={class:"select-input"},wa={class:"select-content"},Za={class:"show-div"},Pa=["onClick","onDblclick"],_a={class:"page-div"},Va={class:"center-content"},ja={class:"cneter-div"},Ma={class:"cneter-div"},Ta={class:"select-content"},Xa={class:"node-show-div"},Oa=["onClick","onDblclick"],$a={class:"text-label"},Aa={class:"show-div-right"},Ba={style:{color:"red","margin-right":"5px"}},Ea=["onClick"],Ua={class:"write-input"},Ra={class:"top-hand-div"},qa={class:"write-input-textarea"},Wa={class:"bottom-button-div"},Fa={class:"half-div"},Ka={class:"half-div"};const Ja=D(Da,[["render",function(e,l,a,t,s,n){const c=x("pane"),o=x("el-option"),r=x("el-select"),u=x("el-input"),p=x("el-button"),m=x("Top"),b=x("Bottom"),v=x("d-arrow-right"),g=x("d-arrow-left"),S=x("el-checkbox"),f=x("splitpanes"),D=$("loading");return i(),d("div",{id:"sbDky",class:"gljh px2rem-ignore",onClose:l[15]||(l[15]=l=>e.$emit("close"))},[(i(),h(f,{style:{height:"100%"},class:"default-theme",key:s.guid},{default:L(()=>[y(c,{size:25},{default:L(()=>[V(N("div",{class:Z(["select-cz",s.selectNode.CZID==s.testData.tdcsParam.CZID?"alselect-cz":""]),onClick:l[0]||(l[0]=e=>n.selectCZ(s.testData.tdcsParam))},P(s.testData.tdcsParam.CZMC),3),[[j,"CZ"==s.CZLX||"input"==s.CZLX]]),V(N("div",Ca," 线路 ",512),[[j,"xl"==s.CZLX]])]),_:1}),y(c,{size:75},{default:L(()=>[N("div",xa,[N("div",ya,[l[17]||(l[17]=N("div",{class:"search-label"},"设备类型: ",-1)),N("div",ka,[y(r,{class:"search-datepicker",modelValue:s.param.sblx,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.sblx=e),placeholder:"请选择",onChange:n.changeCZLX},{default:L(()=>[(i(!0),d(I,null,w(s.sblxOptions,e=>(i(),h(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),l[18]||(l[18]=N("div",{class:"search-label"},"电压等级: ",-1)),N("div",za,[y(r,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.dydj=e),placeholder:"请选择",onChange:n.changeCZLX},{default:L(()=>[(i(!0),d(I,null,w(s.dydjoptions,e=>(i(),h(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),N("div",La,[y(u,{class:"search-datepicker",onChange:n.changeCZLX,modelValue:s.param.keyword,"onUpdate:modelValue":l[3]||(l[3]=e=>s.param.keyword=e),placeholder:"请输入内容"},null,8,["onChange","modelValue"])]),N("div",Na,[y(p,{style:{width:"50px","line-height":"0px","text-align":"center","text-indent":"-8px"},class:"",onClick:l[4]||(l[4]=e=>n.changeCZLX(!0))},{default:L(()=>[...l[16]||(l[16]=[_("查询 ",-1)])]),_:1})])]),N("div",Ia,[V((i(),d("div",wa,[l[21]||(l[21]=N("div",{class:"tilte"},"可选设备(双击选取设备)",-1)),N("div",Za,[(i(!0),d(I,null,w(s.canSelectList,(e,l)=>(i(),d("div",{class:Z(["text-label",[1==e.checked?"selctet":""]]),onClick:l=>n.ClickSelcteCanSelct(e),onDblclick:l=>n.dbClickCanSelect(e),key:l+"canSelect"},P(e.label),43,Pa))),128))]),N("div",_a,[y(p,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex,onClick:l[5]||(l[5]=e=>n.pageChange(-1))},{default:L(()=>[...l[19]||(l[19]=[_(" 上一页 ",-1)])]),_:1},8,["disabled"]),y(p,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||0==s.totalPage,onClick:l[6]||(l[6]=e=>n.pageChange(1))},{default:L(()=>[...l[20]||(l[20]=[_(" 下一页 ",-1)])]),_:1},8,["disabled"])])])),[[D,s.sbLoadingFlag]]),N("div",Va,[N("div",{class:"sortbutton upbutton",onClick:l[7]||(l[7]=(...e)=>n.moveUp&&n.moveUp(...e))},[y(m)]),N("div",{class:"sortbutton downbutton",onClick:l[8]||(l[8]=(...e)=>n.moveDown&&n.moveDown(...e))},[y(b)]),N("div",ja,[N("div",{class:"turn-right",onClick:l[9]||(l[9]=(...e)=>n.turnRight&&n.turnRight(...e))},[y(v,{height:"24"})])]),N("div",Ma,[N("div",{class:"turn-left",onClick:l[10]||(l[10]=(...e)=>n.turnLeft&&n.turnLeft(...e))},[y(g,{height:"24"})])])]),N("div",Ta,[l[23]||(l[23]=N("div",{class:"tilte"},[_(" 已选数据"),N("span",{style:{color:"red"}},"注:双击可移除已选数据")],-1)),N("div",Xa,[(i(!0),d(I,null,w(s.selectedNodes,(t,c)=>(i(),d("div",{class:"node-show-div-select",key:"zcqSbDky_SelectedNodes_"+c,onClick:e=>n.ClickAlSelcteCanSelct(t,c),onDblclick:e=>n.deleteSelectedNode(t)},[N("div",$a,P(t.label),1),N("div",Aa,[V(y(S,{onChange:l=>e.selectDevice(t),modelValue:t.zsb,"onUpdate:modelValue":e=>t.zsb=e},{default:L(()=>[...l[22]||(l[22]=[_("主 ",-1)])]),_:1},8,["onChange","modelValue","onUpdate:modelValue"]),[[j,s.showzsb]]),V(N("span",Ba,"*",512),[[j,n.showRequireLabel]]),V(y(r,{class:"search-datepicker",style:{width:"100px"},modelValue:t.sbzt,"onUpdate:modelValue":e=>t.sbzt=e,placeholder:"请选择",clearable:"","allow-create":!0,filterable:!0},{default:L(()=>[(i(!0),d(I,null,w(n.sbztOptions1,e=>(i(),h(o,{key:e.value+c,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),[[j,n.showSelectSbzt&&!a.isTysb]]),N("div",{class:"delete-text-label",onClick:e=>n.deleteSelectedNode(t)},null,8,Ea)])],40,Oa))),128))])]),N("div",Ua,[l[24]||(l[24]=N("div",{class:"tilte"},[N("span",{style:{display:"inline-block"}},"手动录入"),N("span",{style:{color:"red"}},"(数据库中没有的设备可在此手动添加)")],-1)),N("div",Ra,[N("div",qa,[y(u,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.selfInput,"onUpdate:modelValue":l[11]||(l[11]=e=>s.selfInput=e)},null,8,["modelValue"])]),N("div",{class:"add-input",onClick:l[12]||(l[12]=e=>n.addInpput())}," 加入手写 ")])])])]),N("div",Wa,[N("div",Fa,[N("div",{class:"gljh-btn qd",onClick:l[13]||(l[13]=e=>n.confirm())},"确认")]),N("div",Ka,[N("div",{class:"gljh-btn gb",onClick:l[14]||(l[14]=e=>n.cancel())},"取消")])])]),_:1})]),_:1}))],32)}],["__scopeId","data-v-eea98f1a"]]);export{Fl as Z,fa as a,rl as c,Ja as z};
