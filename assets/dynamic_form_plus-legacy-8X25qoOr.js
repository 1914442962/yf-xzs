System.register(["./zcq-sb-dky-legacy-DHYpiqBX.js","./index-legacy-BhBZRkTD.js","./view_file-legacy-B8YEJj9G.js"],function(e,l){"use strict";var t,d,i,r,o,a,s,m,n,p,u,h,f,c,b,y,F,R,V,w,v,g,k,x;return{setters:[e=>{t=e.Z,d=e.a,i=e.z,r=e.c},e=>{o=e.b,a=e.am,s=e.r,m=e.o,n=e.c,p=e.d,u=e.e,h=e.w,f=e.F,c=e.v,b=e.p,y=e.q,F=e.t,R=e.f,V=e.j,w=e.i,v=e.z,g=e.E,k=e.M},e=>{x=e.v}],execute:function(){const l={name:"dynamic_form_plus",components:{Edit:a},props:{validateRules:Array,row:Object,tableHeaderList:Array,labelWidth:{type:String,default:"auto"},showFooter:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},footerButtonList:{type:Array,default:[{type:"gradientDarkGreen",name:"刷新"},{type:"gradientBlue",name:"保存"}]}},data:()=>({ruleForm:{},formItems:[],originData:{}}),computed:{moreConfig:()=>({maxCount:1,layout:"horizontal"})},created(){this.originData=JSON.parse(JSON.stringify(this.row)),console.log("行数据",this.row),this.formItems=this.tableHeaderList.filter(e=>!("radio"==e.type||"checkbox"==e.type||"expand"==e.type||"seq"==e.type)),console.log("表单字段",this.formItems);let e={};for(let t=0;t<this.formItems[t].children;t++){this.formItems[t].field&&(e[this.formItems[t].field]="");for(const{field:l}of this.formItems[t].children)e[l]=""}for(var l in this.ruleForm=Object.assign({},e),this.row)this.ruleForm[l]=this.row[l]},methods:{refreshData(){this.ruleForm=JSON.parse(JSON.stringify(this.originData))},selectBtn(e){switch(e.editRender.props.type){case"tdcs":this.selectCs(e);break;case"tdsb":this.selectSb(e)}},btnClick(e){switch(e.name){case"刷新":this.refreshData();break;case"保存":this.doSubmit();break;case"打印":this.doPrint();break;case"取消":this.$emit("close");break;default:this.$emit("doOperate",{data:this.ruleForm,btn:e})}},selectCs(e){this.$vxeModal.show(r,{omsDefaultNode:this.$store.state.omsDefaultNode,d5000DefaultNode:this.$store.state.d5000DefaultNode,showOMS:!1},{width:600,height:188,title:"选择停电厂站类型"},{refreshCZXX:l=>{this.ruleForm[e.field]=l.CZMC,this.ruleForm[e.field+"Id"]=l.CZID,this.ruleForm[e.field+"lx"]=l.tdcslx,this.ruleForm[e.field+"Param"]=l,this.ruleForm[e.field+"Param0"]=l}})},selectSb(e){if(!this.ruleForm.tdcslx)return void this.$message({message:"停电场所类型为空，请先选择停电场所",type:"warning"});if(!this.ruleForm.tdcsParam)return void this.$message({message:"当前为非对象化场所，请重选场所后再选择停电设备",type:"warning"});let l={id:this.ruleForm.id,tdcsParam:this.ruleForm.tdcsParam,bdlx:"rjh-dd"};"D5000"==this.ruleForm.tdcslx?this.$vxeModal.show(t,{paramdata:l,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-D5000"},{refreshSBXX:l=>{this.ruleForm[e.field+"List"]=l,this.ruleForm[e.field+"List0"]=l,this.ruleForm[e.field+"Id"]=l.map(e=>e.sbid).join(","),this.ruleForm[e.field]=l.map(e=>e.sbddmm).join(",")}}):"OMS"==this.ruleForm.tdcslx?this.$vxeModal.show(d,{paramdata:l,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-OMS"},{refreshSBXX:l=>{this.ruleForm[e.field+"List"]=l,this.ruleForm[e.field+"List0"]=l,this.ruleForm[e.field+"Id"]=l.map(e=>e.sbid).join(","),this.ruleForm[e.field]=l.map(e=>e.sbddmm).join(",")}}):"DKY"==this.ruleForm.tdcslx&&this.$vxeModal.show(i,{paramdata:l,sblist:this.ruleForm[e.field+"List"],isCommon:!0},{width:1e3,height:650,title:"设备选择-DKY"},{refreshSBXX:l=>{this.ruleForm[e.field+"List"]=l,this.ruleForm[e.field+"List0"]=l,this.ruleForm[e.field+"Id"]=l.map(e=>e.sbid).join(","),this.ruleForm[e.field]=l.map(e=>e.sbddmm).join(",")}})},doSubmit(){console.log(this.ruleForm),this.$refs.ruleForm.validate(e=>{if(!e)return console.log("error submit!!"),!1;this.$emit("doSubmit",this.ruleForm)})},uploadMethod({file:e},l){const t=new FormData;return t.append("file",e),t.append("id",this.ruleForm.id),t.append("type",l.editRender.props.type),g.uploadFileService(t).then(e=>e.data)},downloadMethod({option:e}){g.downloadFileGetService({fileId:e.id})},removeMethod({option:e}){e.id&&g.removeFileService({fileId:e.id,id:this.ruleForm.id}).then(()=>{this.$message.success("移除成功")})},previewMethod({option:e}){this.$store.state.isXzs?g.preViewFileGetService({fileId:e.id}):g.preViewFileService({fileId:e.id}).then(e=>{let l=k(e,"pdf")+"#toolbar=0";this.$vxeModal.show(x,{url:l},{width:800,title:"文件预览",height:window.innerHeight-20},{})})},getData(e){this.ruleForm[e.field]=this.$store.state.userInfo.sysUser.nickName,this.ruleForm[e.editRender.associateField]=v().format("YYYY-MM-DD HH:mm:ss")}}},U={id:"dynamic_form_plus",class:"page_content"},I={class:"form_item_merge_label_span"},_={key:9},S={key:9},C={key:0};e("d",o(l,[["render",function(e,l,t,d,i,r){const o=s("Edit"),a=s("el-icon"),v=s("el-input"),g=s("el-input-number"),k=s("el-date-picker"),x=s("el-option"),M=s("el-select"),D=s("el-radio"),$=s("el-radio-group"),E=s("vxe-upload"),L=s("el-form-item"),j=s("el-button"),z=s("el-form");return m(),n("div",U,[p("article",null,[u(z,{model:i.ruleForm,rules:t.validateRules,ref:"ruleForm","label-width":t.labelWidth,disabled:t.disabled},{default:h(()=>[(m(!0),n(f,null,c(i.formItems,(e,t)=>(m(),n(f,null,[e.children&&e.children.length>0?(m(),n("div",{key:"formItems"+t,class:b(["parent_div",e.itemClass])},[p("div",{class:"form_item_merge_label",style:y(e.width?{width:e.width}:{})},[p("span",I,F(e.title),1)],4),(m(!0),n(f,null,c(e.children,(l,d)=>(m(),R(L,{key:"formItems"+t+"children"+d,label:l.title,prop:l.field,class:b(l.itemClass),style:y([l.width?{width:l.width}:{width:"100%"},{position:"relative"}])},{default:h(()=>[l.editRender&&l.editRender.icons?(m(),R(a,{key:0,size:16,style:{position:"absolute",right:"0",top:"0","z-index":"100",cursor:"pointer"},color:"#0cb088"},{default:h(()=>[l.editRender.icons.includes("edit")?(m(),R(o,{key:0,onClick:e=>r.getData(l)},null,8,["onClick"])):V("",!0)]),_:2},1024)):V("",!0),"ElInput"!=l.editRender.name||l.editRender.props.type&&"text"!=l.editRender.props.type?V("",!0):(m(),R(v,{key:1,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,type:"text",disabled:l.disabled,clearable:l.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","disabled","clearable"])),"ElInput"==l.editRender.name&&"number"==l.editRender.props.type?(m(),R(v,{key:2,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,type:"number",min:l.editRender.props.min,max:l.editRender.props.max,disabled:l.disabled,step:l.editRender.props.step,clearable:l.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","min","max","disabled","step","clearable"])):V("",!0),"ElInputNumber"==l.editRender.name?(m(),R(g,{key:3,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,min:l.editRender.props.min,max:l.editRender.props.max,disabled:l.disabled,step:l.editRender.props.step,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","min","max","disabled","step"])):V("",!0),l.editRender&&"ElInput"==l.editRender.name&&"textarea"==l.editRender.props.type?(m(),R(v,{key:4,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,type:"textarea",clearable:l.editRender.props.clearable,disabled:l.disabled,rows:6},null,8,["modelValue","onUpdate:modelValue","clearable","disabled"])):V("",!0),"ElDatePicker"==l.editRender.name&&["year","month","date","datetime"].includes(l.editRender.props.type)?(m(),R(k,{key:5,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,type:l.editRender.props.type,"value-format":l.editRender.props.valueFormat,disabled:l.disabled,"label-format":l.editRender.props.labelFormat},null,8,["modelValue","onUpdate:modelValue","type","value-format","disabled","label-format"])):V("",!0),"ElSelect"==l.editRender.name?(m(),R(M,{key:6,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,clearable:l.editRender.props.clearable,filterable:l.editRender.props.filterable,multiple:l.editRender.props.multiple,disabled:l.disabled},{default:h(()=>[l.editRender.options&&l.editRender.options.length>0?(m(!0),n(f,{key:0},c(l.editRender.options,(l,i)=>(m(),R(x,{key:"formItems"+t+"children"+d+e.field+i,value:l.value,label:l.label},null,8,["value","label"]))),128)):V("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","clearable","filterable","multiple","disabled"])):V("",!0),"$radio"==l.editRender.name?(m(),R($,{key:7,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,disabled:l.disabled},{default:h(()=>[l.editRender.options&&l.editRender.options.length>0?(m(!0),n(f,{key:0},c(l.editRender.options,(l,d)=>(m(),R(D,{key:"radio"+t+e.field+d,value:l.value},{default:h(()=>[w(F(l.label),1)]),_:2},1032,["value"]))),128)):V("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):V("",!0),"vxeUpload"==l.editRender.name?(m(),R(E,{key:8,modelValue:i.ruleForm[l.field],"onUpdate:modelValue":e=>i.ruleForm[l.field]=e,disabled:l.disabled,multiple:l.editRender.props.multiple,"file-types":l.editRender.props.types,"more-config":r.moreConfig,"show-tip":!1,"show-download-button":"","button-text":"上传","limit-size":l.editRender.props.limitSize,"upload-method":e=>r.uploadMethod(e,l),"download-method":r.downloadMethod,"remove-method":r.removeMethod,"preview-method":r.previewMethod},null,8,["modelValue","onUpdate:modelValue","disabled","multiple","file-types","more-config","limit-size","upload-method","download-method","remove-method","preview-method"])):V("",!0),l.editRender.name?V("",!0):(m(),n("p",_,F(i.ruleForm[l.field]),1))]),_:2},1032,["label","prop","class","style"]))),128))],2)):(m(),R(L,{key:"formItems"+t,label:e.title,prop:e.field,class:b(e.itemClass),style:y(e.width?{width:e.width}:{width:"100%"})},{default:h(()=>["ElInput"!=e.editRender.name||e.editRender.props.type&&"text"!=e.editRender.props.type?V("",!0):(m(),R(v,{key:0,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,type:"text",clearable:e.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","clearable"])),"ElInput"==e.editRender.name&&"number"==e.editRender.props.type?(m(),R(v,{key:1,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,type:"number",min:e.editRender.props.min,max:e.editRender.props.max,step:e.editRender.props.step,clearable:e.editRender.props.clearable},null,8,["modelValue","onUpdate:modelValue","min","max","step","clearable"])):V("",!0),"ElInputNumber"==e.editRender.name?(m(),R(g,{key:2,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,min:e.editRender.props.min,max:e.editRender.props.max,step:e.editRender.props.step,"controls-position":"right"},null,8,["modelValue","onUpdate:modelValue","min","max","step"])):V("",!0),e.editRender&&"ElInput"==e.editRender.name&&"textarea"==e.editRender.props.type?(m(),R(v,{key:3,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,type:"textarea",clearable:e.editRender.props.clearable,rows:6},null,8,["modelValue","onUpdate:modelValue","clearable"])):V("",!0),e.editRender&&"$modal"==e.editRender.name?(m(),n(f,{key:4},[u(v,{modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,readonly:"",style:{width:"calc(100% - 78px)","margin-right":"10px"},title:i.ruleForm[e.field]},null,8,["modelValue","onUpdate:modelValue","title"]),u(j,{onClick:l=>r.selectBtn(e),type:"primary",style:{"margin-right":"8px"}},{default:h(()=>[...l[1]||(l[1]=[w("选择 ",-1)])]),_:1},8,["onClick"])],64)):V("",!0),"ElDatePicker"==e.editRender.name&&["year","month","date","datetime"].includes(e.editRender.props.type)?(m(),R(k,{key:5,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,type:e.editRender.props.type,"value-format":e.editRender.props.valueFormat,"label-format":e.editRender.props.labelFormat},null,8,["modelValue","onUpdate:modelValue","type","value-format","label-format"])):V("",!0),"ElSelect"==e.editRender.name?(m(),R(M,{key:6,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,clearable:e.editRender.props.clearable,filterable:e.editRender.props.filterable,multiple:e.editRender.props.multiple},{default:h(()=>[e.editRender.options&&e.editRender.options.length>0?(m(!0),n(f,{key:0},c(e.editRender.options,(l,d)=>(m(),R(x,{key:"formItems"+t+e.field+d,value:l.value,label:l.label},null,8,["value","label"]))),128)):V("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","clearable","filterable","multiple"])):V("",!0),"$radio"==e.editRender.name?(m(),R($,{key:7,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l},{default:h(()=>[e.editRender.options&&e.editRender.options.length>0?(m(!0),n(f,{key:0},c(e.editRender.options,(l,d)=>(m(),R(D,{key:"radio"+t+e.field+d,value:l.value},{default:h(()=>[w(F(l.label),1)]),_:2},1032,["value"]))),128)):V("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue"])):V("",!0),"vxeUpload"==e.editRender.name?(m(),R(E,{key:8,modelValue:i.ruleForm[e.field],"onUpdate:modelValue":l=>i.ruleForm[e.field]=l,multiple:e.editRender.props.multiple,"file-types":e.editRender.props.types,"more-config":r.moreConfig,"show-tip":!1,"show-download-button":"","button-text":"上传","limit-size":e.editRender.props.limitSize,"upload-method":l=>r.uploadMethod(l,e),"download-method":r.downloadMethod,"remove-method":r.removeMethod},null,8,["modelValue","onUpdate:modelValue","multiple","file-types","more-config","limit-size","upload-method","download-method","remove-method"])):V("",!0),e.editRender.name?V("",!0):(m(),n("p",S,F(i.ruleForm[e.field]),1))]),_:2},1032,["label","prop","class","style"]))],64))),256))]),_:1},8,["model","rules","label-width","disabled"])]),t.showFooter?(m(),n("footer",C,[u(j,{type:"gradientGray",onClick:l[0]||(l[0]=l=>e.$emit("close"))},{default:h(()=>[...l[2]||(l[2]=[w("取消",-1)])]),_:1}),(m(!0),n(f,null,c(t.footerButtonList,(e,l)=>(m(),R(j,{key:"footerButtonList"+l,type:e.type,onClick:l=>r.btnClick(e)},{default:h(()=>[w(F(e.name),1)]),_:2},1032,["type","onClick"]))),128))])):V("",!0)])}],["__scopeId","data-v-50cbf25c"]]))}}});
