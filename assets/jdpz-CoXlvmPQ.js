import{t as e,v as t}from"./table_mixin-BbK9105O.js";import{j as a}from"./jdpz-api-B7AZpnxR.js";import{b as l,r as i,o as s,c as r,d as o,i as d,e as n,w as c,F as h,v as m,f as u,t as p,x as f,s as g}from"./index-CRHEuOwk.js";import{g as b}from"./gzt-api-N3ev1ztC.js";import"./polyfill-lGe4XDVY.js";const x={class:"page_content"},k={class:"header-item"},y={class:"header-item"},v={class:"header-item"};const D=l({name:"jdpz",mixins:[e],data:()=>({time:["",""],total:0,searchParams:{mklx:"",pageIndex:0,pageSize:999},tableData:[],isAutoWrap:!1,treeData:[]}),watch:{"searchParams.mklx":{handler(e){e&&this.reloadTableData()},immediate:!1}},computed:{tableHeaderList:()=>[{type:"checkbox",width:50,fixed:"left"},{type:"seq",width:60,fixed:"left"},{width:60,dragSort:!0,fixed:"left"},{field:"mklx",title:"模块名称",minWidth:120},{field:"byValue",title:"模块路径",minWidth:120,editRender:{name:"ElInput",props:{clearable:!0}}},{field:"mc",title:"节点名称",minWidth:120,editRender:{name:"ElInput",props:{clearable:!0}}},{field:"url",title:"节点跳转路径",minWidth:120,editRender:{name:"ElInput",props:{clearable:!0}}}],editRules:()=>({byValue:[{required:!0,message:"模块路径不能为空"}],mc:[{required:!0,message:"节点名称不能为空"}],url:[{required:!0,message:"跳转路径不能为空"}]}),gridOptions(){return{height:"auto",keepSource:!0,border:!0,round:!0,stripe:!0,headerAlign:"center",align:"center",loading:!1,rowConfig:{isCurrent:!0,isHover:!0,drag:!0},radioConfig:{highlight:!0},checkboxConfig:{highlight:!0,range:!0},columnConfig:{resizable:!0},resizeConfig:{isDblclickAutoWidth:!0},sortConfig:{remote:!0},filterConfig:{remote:!0},showOverflow:this.isAutoWrap,headerCellClassName:"row-class",proxyConfig:{autoLoad:!1,seq:!0,showResponseMsg:!1,showActionMsg:!1,sort:!0,filter:!0,ajax:{query:()=>this.loadTableApi(),delete:({body:e})=>this.doDeleteApi(e.removeRecords)}},editConfig:{trigger:"click",mode:"cell",showStatus:!0,showIcon:!0,beforeEditMethod:this.beforeEditMethod},editRules:this.editRules,columns:this.tableHeaderList}},defaultLeftButtons:()=>[{type:"gradientGreen",name:"查询"}],defaultRightButtons:()=>[{type:"gradientBlue",name:"新增"},{type:"gradientBlue",name:"保存"},{type:"gradientRed",name:"删除"}]},created(){this.resetMklx()},mounted(){},methods:{reloadTableData(){this.$refs.xTable.commitProxy("query")},loadTableData(){this.$refs.xTable.commitProxy("reload")},loadTableApi(){return new Promise((e,t)=>{a.loadTableDataService(this.searchParams).then(t=>{e(t.data)})})},toggleWrap(){this.isAutoWrap?this.isAutoWrap=!1:this.isAutoWrap="tooltip"},doAdd(){let e={mklx:this.searchParams.mklx,byValue:""};this.$refs.xTable.insertAt(e,-1).then(e=>{this.$refs.xTable.setEditRow(e)})},doSave(){let e=this.$refs.xTable.getTableData().tableData;a.saveTableDataService({data:e}).then(e=>{this.$message.success(e.data),this.reloadTableData()})},doDelete(){const e=this.getCheckboxRecords();e&&e.length>0&&this.$confirm("确认删除勾选的".concat(e.length,"条数据吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$refs.xTable.commitProxy("delete")})},doDeleteApi(e){return new Promise((t,l)=>{let i=e.map(e=>e.id).join(",");a.doDelTableDataService({ids:i}).then(e=>{this.$message.success(e.data),t()}).catch(()=>{l()})})},async resetMklx(){await g.dispatch("getSelectOptions"),this.$store.state.selectOptionsObj.jdpz.length>0&&(this.searchParams.mklx=this.$store.state.selectOptionsObj.jdpz[0].value)},beforeEditMethod:({row:e,column:t})=>!0,doAddMk(){this.$vxeModal.show(t,{title:"请输入新增模块类型"},{width:420,title:"模块类型",height:260},{returnData:e=>{a.saveMkDataService({mklx:e}).then(e=>{this.$message.success(e.data),this.resetMklx()})}})},doDelMk(){this.$confirm("确认删除".concat(this.searchParams.mklx,"模块吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a.doDelMkDataService({mklx:this.searchParams.mklx}).then(e=>{this.$message.success(e.data),this.resetMklx()})})},loadTreeData(){b.loadTreeDataService({}).then(e=>{this.treeData=e.data})}}},[["render",function(e,t,a,l,g,b){const D=i("el-option"),C=i("el-select"),T=i("el-button"),w=i("vxe-grid");return s(),r("div",x,[o("header",null,[o("section",null,[o("div",k,[t[1]||(t[1]=d(" 模块类型： ",-1)),n(C,{modelValue:g.searchParams.mklx,"onUpdate:modelValue":t[0]||(t[0]=e=>g.searchParams.mklx=e),placeholder:"请选择",clearable:!1,filterable:""},{default:c(()=>[(s(!0),r(h,null,m(e.$store.state.selectOptionsObj.jdpz,e=>(s(),u(D,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),o("div",y,[(s(!0),r(h,null,m(b.defaultLeftButtons,(t,a)=>(s(),u(T,{type:t.type,plain:t.plain,key:a+"defaultLeftButtons",onClick:a=>e.btnClick(t)},{default:c(()=>[d(p(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))])]),o("section",null,[o("div",v,[(s(!0),r(h,null,m(b.defaultRightButtons,(t,a)=>(s(),u(T,{type:t.type,plain:t.plain,key:a+"defaultRightButtons",onClick:a=>e.btnClick(t)},{default:c(()=>[d(p(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128)),n(T,{type:"gradientBlue",onClick:b.doAddMk},{default:c(()=>[...t[2]||(t[2]=[d("新增模块",-1)])]),_:1},8,["onClick"]),n(T,{type:"gradientRed",onClick:b.doDelMk},{default:c(()=>[...t[3]||(t[3]=[d("删除模块",-1)])]),_:1},8,["onClick"])])])]),o("article",null,[n(w,f(b.gridOptions,{ref:"xTable"}),null,16)])])}],["__scopeId","data-v-36d72830"]]);export{D as default};
