import{t as e,g as t}from"./table_mixin-CrQv_gJb.js";import{v as a}from"./view_simple_table-Cw6E6Tsa.js";import{_ as s,r as i,o,c as r,b as l,d as n,w as d,F as h,q as c,e as m,h as g,t as u,v as p}from"./index-DrZ2SOez.js";import"./polyfill-lGe4XDVY.js";const f=new BroadcastChannel("YFZLQD-channel"),b={class:"page_content"},x={class:"header-item"};const w=s({name:"db",mixins:[e],components:{},data:()=>({total:0,searchParams:{type:"",sortOrder:"",sortColumn:""},tabList:[],isAutoWrap:!1}),watch:{"searchParams.type":{handler(e){e&&this.loadTableData()},immediate:!1}},computed:{tableHeaderList:()=>[{type:"checkbox",width:50,fixed:"left"},{type:"seq",width:60,fixed:"left"},{field:"userName",title:"标注人",width:180},{field:"createTime",title:"标注时间",width:180,sortable:!0},{field:"yy",title:"标注原因",minWidth:120,headerAlign:"center",align:"left"},{title:"操作",width:150,fixed:"right",slots:{default:"action"}}],gridOptions(){return{height:"auto",keepSource:!0,border:!0,round:!0,headerAlign:"center",align:"center",loading:!1,rowConfig:{isCurrent:!0,isHover:!0},radioConfig:{highlight:!0},checkboxConfig:{highlight:!0,reserve:!0,showServeStatus:!0,range:!0},columnConfig:{resizable:!0},resizeConfig:{isDblclickAutoWidth:!0},sortConfig:{remote:!0},filterConfig:{remote:!0},showOverflow:this.isAutoWrap,headerCellClassName:"row-class",pagerConfig:this.pagerConfig,proxyConfig:{seq:!0,showResponseMsg:!1,showActionMsg:!1,sort:!0,filter:!0,autoLoad:!1,ajax:{query:({page:e,sorts:t,filters:a})=>this.loadTableApi(e,t,a)}},exportConfig:{filename:"测试表格",sheetName:"sheet1",type:"xlsx",mode:"all",modes:["current","selected","all"],message:!1,columns:this.tableHeaderList.filter(e=>"checkbox"!==e.type),exportMethod:this.exportMethod,afterExportMethod:this.afterExportMethod},columns:this.tableHeaderList}}},mounted(){this.getTabList(),f.onmessage=e=>{"refresh_grrj"===e.data.type&&this.getTabList()}},unmounted(){f.onmessage=null,f.close()},methods:{getTabList(e){t.loadTabDataService({}).then(t=>{this.tabList=t.data,e?this.tabList.length>0&&this.loadTableData():this.tabList.length>0&&(this.searchParams.type=this.tabList[0].name)})},reloadTableData(){this.$refs.xTable.commitProxy("query")},loadTableData(){this.$refs.xTable.commitProxy("reload")},loadTableApi(e,a,s){let i=this.getRealParams(this.searchParams,e,a,s);return new Promise(a=>{t.loadTableDataService(i).then(t=>{1e5==e.pageSize?(this.total=t.total,a(t.data)):(this.total=t.total,a({result:t.data,page:{total:t.total}}))})})},toggleWrap(){this.isAutoWrap?this.isAutoWrap=!1:this.isAutoWrap="tooltip"},doViewLog(e){this.$vxeModal.show(a,{tableHeaderList:JSON.parse(e.headerList),tableData:JSON.parse(e.data)},{width:window.innerWidth-100,title:"详情",height:400},{})},doDelete(e){this.$confirm("确认移除当前数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.deleteDataService({ids:e.id}).then(e=>{this.$message.success(e.data),this.getTabList(!0)})})}}},[["render",function(e,t,a,s,f,w){const y=i("el-button"),C=i("el-button-group"),L=i("vxe-button"),T=i("vxe-grid");return o(),r("div",b,[l("header",null,[l("section",null,[l("div",x,[n(C,null,{default:d(()=>[(o(!0),r(h,null,c(f.tabList,(e,t)=>(o(),m(y,{key:"tabList"+t,onClick:t=>f.searchParams.type=e.name,type:f.searchParams.type==e.name?"gradientBlue":""},{default:d(()=>[g(u(e.name+"（"+e.total+"）"),1)]),_:2},1032,["onClick","type"]))),128))]),_:1})])]),t[0]||(t[0]=l("section",null,null,-1))]),l("article",null,[n(T,p(w.gridOptions,{ref:"xTable"}),{action:d(({row:e})=>[n(L,{mode:"text",status:"primary",onClick:t=>w.doViewLog(e)},{default:d(()=>[...t[1]||(t[1]=[g("详情",-1)])]),_:1},8,["onClick"]),n(L,{mode:"text",status:"error",onClick:t=>w.doDelete(e)},{default:d(()=>[...t[2]||(t[2]=[g("移除",-1)])]),_:1},8,["onClick"])]),_:1},16)])])}],["__scopeId","data-v-95c216a2"]]);export{w as default};
