import{z as e,A as t,_ as a,r as s,o as r,c as o,b as i,t as l,i as n,d,w as c,h}from"./index-CIzN2UtG.js";let p=t.base;const g={addDataService:t=>e({url:"".concat(p,"/first/saveGrrj"),method:"post",data:t,showLoading:!0}),deleteDataService:t=>e({url:"".concat(p,"/first/deleteGrrj"),method:"post",data:t,showLoading:!0}),loadTabDataService:t=>e({url:"".concat(p,"/first/getGrrjTab"),method:"post",data:t,showLoading:!0}),loadTableDataService:t=>e({url:"".concat(p,"/first/queryGrrj"),method:"post",data:t,showLoading:!0})},m={name:"view_prompt",props:{title:{type:String},isRequire:{type:Boolean,default:!0},defaultTextarea:String},data:()=>({textarea:""}),created(){this.defaultTextarea&&(this.textarea=this.defaultTextarea)},methods:{returnData(){!this.isRequire||this.textarea&&""!=this.textarea?(this.$emit("returnData",this.textarea),this.$emit("close")):this.$message.warning("内容不能为空")}}},u={id:"view_prompt"},f={key:0};const b=a(m,[["render",function(e,t,a,p,g,m){const b=s("el-input"),x=s("el-button");return r(),o("div",u,[i("article",null,[a.title?(r(),o("p",f,l(a.title)+"：",1)):n("",!0),d(b,{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"请输入内容",modelValue:g.textarea,"onUpdate:modelValue":t[0]||(t[0]=e=>g.textarea=e)},null,8,["modelValue"])]),i("footer",null,[d(x,{type:"gradientGray",onClick:t[1]||(t[1]=t=>e.$emit("close"))},{default:c(()=>[...t[2]||(t[2]=[h("取消",-1)])]),_:1}),d(x,{type:"gradientGreen",onClick:m.returnData},{default:c(()=>[...t[3]||(t[3]=[h("确定",-1)])]),_:1},8,["onClick"])])])}],["__scopeId","data-v-79fb2537"]]),x=new BroadcastChannel("YFZLQD-channel"),k={data:()=>({pagerConfig:{currentPage:1,pageSize:20,layouts:["Home","PrevPage","JumpNumber","NextPage","End","Sizes","FullJump","Total"],size:"small",slots:{total:({total:e})=>d("span",{style:"margin-right:6px;vertical-align:initial"},[" ",h("共")," ",d("span",{style:"font-weight:bold;vertical-align:baseline"},[e])," ",h("条记录")]),left:"pagerLeft"}},pagerParam:{currentPage:1,pageSize:20}}),beforeRouteLeave(e,t,a){if(!this.$store.state.aliveTabs.some(e=>e.url===t.name)){let e=this.$vnode,t=e&&e.parent;if(t&&t.componentInstance&&t.componentInstance.cache){var s=null==e.key?e.componentOptions.Ctor.cid+(e.componentOptions.tag?"::".concat(e.componentOptions.tag):""):e.key,r=t.componentInstance.cache,o=t.componentInstance.keys;if(r[s]){if(this.$destroy(),o.length){var i=o.indexOf(s);i>-1&&o.splice(i,1)}r[s]=null}}}a()},methods:{trimSpecial:e=>e.replace(/[`~!@#$%^&*_\-+=<>?:"{}|,.\/;'\\[\]·~！@#¥%……&*——\-+={}|《》？：“”【】、；‘’，。、～]/g,""),btnClick(e){switch(e.name){case"查询":this.loadTableData();break;case"重置":this.resetParams();break;case"确定":this.doConfirm();break;case"刷新":this.reloadTableData();break;case"查看日志":this.doViewDialog();break;case"查看流程图":this.doViewFlow();break;case"新建":case"新增":this.doAdd();break;case"生成":this.doSc();break;case"初始化":this.doInit();break;case"导出":case"导出当前页":this.doExport();break;case"导出全部":this.doExport(!0);break;case"自动换行":this.toggleWrap();break;case"提交":default:this.doOperation(e);break;case"删除":this.doDelete();break;case"保存":this.doSave();break;case"复制":this.doCopy();break;case"同步":this.doSync();break;case"下载导入模版":case"下载":this.downloadModule();break;case"导入":this.doImport();break;case"上传文件":this.readFileEvent();break;case"发送短信":this.doSendMessage();break;case"推送至年度风险":this.doPush()}},getCheckboxRecord(){const e=this.$refs.xTable.getCheckboxRecords();return!e||0===e.length||e.length>1?(this.$message.warning("请选择一条数据！"),[]):e},getRadioRecord(){let e=this.$refs.xTable.getRadioRecord();if(e&&0!==e.length)return e;this.$message.warning("请选择一条数据")},getCheckboxRecords(){const e=this.$refs.xTable.getCheckboxRecords();return e&&0!==e.length?e:(this.$message.warning("请至少选择一条数据！"),[])},getUpdateRecords(){const e=[...this.$refs.xTable.getUpdateRecords(),...this.$refs.xTable.getInsertRecords()];return e&&0!==e.length?e:(this.$message.warning("数据未修改！"),[])},doExport(){this.$refs.xTable.openExport()},filterMethod(e){console.log(e);let{options:t,row:a,column:s}=e;return!s.filterRender||!s.filterRender||"VxeSelect"!=s.filterRender.name||(!t[0].data||(t[0].data=t[0].data.filter(e=>e),t[0].data.includes(a[s.field])))},exportMethod({options:e}){const t={filename:e.filename,sheetName:e.sheetName,isHeader:e.isHeader,original:e.original,mode:e.mode,ids:"selected"===e.mode?e.data.map(e=>e.id):[],fields:e.columns.map(e=>({field:e.field,title:e.title}))};return this.$refs.xTable.exportData(t)},afterExportMethod(){this.$message.success("导出成功")},sortChangeEvent(e){let{property:t,order:a}=e;this.searchParams.sortOrder=a||"",this.searchParams.sortColumn=t,this.loadTableData()},menuClickEvent(e,t){const{menu:a}=e;"collect"===a.code&&this.$vxeModal.show(b,{title:"请输入标记原因并将当前数据标记重点，加入个人日记"},{width:420,title:"标记原因",height:260},{returnData:a=>{g.addDataService({type:t,data:[e.row],yy:a,headerList:this.tableHeaderList.filter(e=>!e.type&&!e.slots)}).then(e=>{this.$message.success(e.data),x.postMessage({type:"refresh_grrj",data:{}})})}})},getRealParams(e,t,a,s){let r=JSON.parse(JSON.stringify(e));for(let o=0;o<s.length;o++){let e=s[o].column.filterMultiple&&s[o].column.filters.length>1;r[e?s[o].field+"List":s[o].field]=s[o].column.filterRender?e?s[o].datas:s[o].datas[0]:e?s[o].values:s[o].values[0]}return a[0]&&(r.sortOrder=a[0].order,r.sortColumn=a[0].field),this.pagerParam=t,r.pageIndex=t.currentPage-1,r.pageSize=t.pageSize,r},sumMethod(e,t){let a=0;return e.forEach(e=>{a+=Number(e[t])}),a}}};export{g,k as t,b as v};
