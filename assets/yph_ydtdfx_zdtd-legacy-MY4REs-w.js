System.register(["./table_mixin-legacy-DIG8w3YV.js","./UploadHttpComponent-legacy-BNj506lX.js","./dynamic_form-legacy-Boj_rN6B.js","./validateRules-legacy-Co865pER.js","./index-legacy-C9R4tdre.js","./view_file-legacy-Bt94_HJw.js","./zcq-sb-dky-legacy-D5iGgNmW.js","./polyfill-legacy-aWkUxw0k.js"],function(e,t){"use strict";var a,i,l,d,o,s,r,n,h,c,m,p,u,g,f,y,x,b,j,w,D,v;return{setters:[e=>{a=e.t},e=>{i=e.U},e=>{l=e.d},e=>{d=e.v},e=>{o=e.z,s=e.A,r=e._,n=e.r,h=e.o,c=e.c,m=e.b,p=e.h,u=e.d,g=e.F,f=e.q,y=e.e,x=e.w,b=e.t,j=e.v,w=e.x,D=e.y,v=e.D},null,null,null],execute:function(){let t=s.base;const k={loadTableDataService:e=>o({url:`${t}/jxjh/ydjxZdtd`,method:"post",data:e,showLoading:!0}),saveTableDataService:e=>o({url:`${t}/jxjh/saveYdjxZdtd`,method:"post",data:e,showLoading:!0}),doDelTableDataService:e=>o({url:`${t}/jxjh/deleteYdjxZdtd`,method:"post",data:e,showLoading:!0}),importDataService:e=>o({url:`${t}/jxjh/initYdjxZdtd`,method:"post",data:e,showLoading:!0}),createFxyjDataService:e=>o({url:`${t}/jxjh/sgYdFxyj`,method:"post",data:e,showLoading:!0})},C={class:"page_content"},Y={class:"header-item"},R={class:"header-item"},M={class:"header-item"},$={class:"header-item"};e("default",r({name:"yph_ydtdfx_zdtd",mixins:[a],components:{UploadHttpComponent:i},data:()=>({time:["",""],total:0,searchParams:{month:"",sortOrder:"",sortColumn:""},tableData:[],isAutoWrap:!1}),watch:{},computed:{tableHeaderList(){return[{type:"checkbox",width:50},{type:"seq",width:60},{field:"dydj",title:"电压等级",width:100,sortable:!0,colWidth:"50%",editRender:{name:"ElSelect",options:this.$store.state.staticOptionsObj.ydydj,props:{clearable:!0}}},{field:"fqmc",title:"所属分区",width:100,colWidth:"50%",editRender:{}},{field:"tdcs",title:"停电场所",width:100,editRender:{name:"$modal",props:{type:"tdcs"}}},{field:"tdfw",title:"停电设备",minWidth:200,editRender:{name:"$modal",props:{type:"tdsb"}}},{field:"gznr",title:"工作内容",minWidth:200,headerAlign:"center",align:"left",editRender:{name:"ElInput",props:{type:"textarea",clearable:!0,autosize:!this.isAutoWrap||{maxRows:1},resize:"none"}}},{field:"kgsj",title:"开始时间",width:120,colWidth:"50%",editRender:{name:"ElDatePicker",props:{type:"date",labelFormat:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD"}}},{field:"jgsj",title:"结束时间",width:120,colWidth:"50%",editRender:{name:"ElDatePicker",props:{type:"date",labelFormat:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD"}}},{field:"gzdw",title:"工作单位",width:120,colWidth:"50%",editRender:{}},{field:"sfyxtx",title:"是否影响通信",width:120,colWidth:"50%",editRender:{}},{field:"bsjdd",title:"报上级调度",width:100,colWidth:"50%",editRender:{}},{field:"sfnjh",title:"是否年计划",width:100,colWidth:"50%",editRender:{}},{field:"sbgx",title:"设备管辖",width:100,colWidth:"50%",editRender:{}},{field:"jhbh",title:"计划编号",width:120,colWidth:"50%",editRender:{}}]},editRules:()=>({dydj:[{required:!0,message:"电压等级不能为空"}],tdcs:[{required:!0,message:"停电场所不能为空"}],tdfw:[{required:!0,message:"停电设备不能为空"}],gznr:[{required:!0,message:"工作内容不能为空"}],kgsj:[{required:!0,message:"开始时间不能为空"},d.date.rule],jgsj:[{required:!0,message:"结束时间不能为空"},d.date.rule]}),gridOptions(){return{height:"auto",border:!0,round:!0,stripe:!0,headerAlign:"center",align:"center",loading:!1,rowConfig:{isCurrent:!0,isHover:!0},radioConfig:{highlight:!0},checkboxConfig:{highlight:!0},columnConfig:{resizable:!0},sortConfig:{remote:!0},filterConfig:{remote:!0},showOverflow:this.isAutoWrap,headerCellClassName:"row-class",pagerConfig:this.pagerConfig,proxyConfig:{seq:!0,showResponseMsg:!1,showActionMsg:!1,sort:!0,filter:!0,ajax:{query:({page:e,sorts:t,filters:a})=>this.loadTableApi(e,t,a),queryAll:({sorts:e,filters:t})=>this.loadTableApi({pageSize:1e5,currentPage:1},e,t),delete:({body:e})=>this.doDeleteApi(e.removeRecords)}},exportConfig:{filename:"月度重大停电表",sheetName:"sheet1",type:"xlsx",mode:"all",modes:["current","selected","all"],message:!1,columns:this.tableHeaderList.filter(e=>"checkbox"!==e.type),exportMethod:this.exportMethod,afterExportMethod:this.afterExportMethod},menuConfig:{body:{options:[[{code:"collect",name:"标记重点"}]]}},editRules:this.editRules,columns:this.tableHeaderList}},defaultLeftButtons:()=>[{type:"gradientGreen",name:"查询"},{type:"gradientGreen",name:"自动换行"}],defaultRightButtons:()=>[{type:"gradientRed",name:"删除"}]},mounted(){this.searchParams.month=D().format("YYYY-MM")},methods:{reloadTableData(){this.$refs.xTable.commitProxy("query")},loadTableData(){this.$refs.xTable.commitProxy("reload")},loadTableApi(e,t,a){let i=this.getRealParams(this.searchParams,e,t,a);return new Promise(t=>{k.loadTableDataService(i).then(a=>{1e5==e.pageSize?(this.total=a.total,t(a.data)):(this.total=a.total,t({result:a.data,page:{total:a.total}}))})})},toggleWrap(){this.isAutoWrap?this.isAutoWrap=!1:this.isAutoWrap="tooltip"},doDelete(){const e=this.getCheckboxRecords();e&&e.length>0&&this.$confirm(`确认删除勾选的${e.length}条数据吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$refs.xTable.commitProxy("delete")})},doDeleteApi(e){return new Promise((t,a)=>{let i=e.map(e=>e.id).join(",");k.doDelTableDataService({ids:i}).then(e=>{this.$message.success(e.data),t()}).catch(()=>{a()})})},importData(){k.importDataService({}).then(e=>{this.$message.success(e.data),this.loadTableData()})},createData(){const e=this.getCheckboxRecords();e&&e.length>0&&k.createFxyjDataService({data:e}).then(e=>{this.$message.success(e.data)})},doExport(e){v.exportFileService("/jxjh/exportYdjxZdtd",this.searchParams,e,this.pagerParam)},cellDblclick(e){let{row:t}=e;this.openDetail(t)},resetParams(){this.time=["",""],this.$nextTick(function(){this.loadTableData()})},openDetail(e){this.$vxeModal.show(l,{tableHeaderList:this.tableHeaderList,validateRules:this.editRules,row:e},{width:1200,title:"详情",height:window.innerHeight-200},{close:()=>{},doSubmit:e=>{e.kgsj&&e.jgsj&&D(e.kgsj).isAfter(e.jgsj)?this.$message.error("开始时间不能在结束时间之后"):(e.tdcsParamArray=e.tdcsParam,e.tdfwArray=e.tdfwList,this.doRealSave([e]))}})},doSave(){this.$refs.xTable.commitProxy("save")},doRealSave(e){k.saveTableDataService({data:e}).then(e=>{this.$message.success(e.data),this.$vxeModal.closeAll(),this.loadTableData()})}}},[["render",function(e,t,a,i,l,d){const o=n("el-date-picker"),s=n("el-button"),r=n("arrow-down"),D=n("el-icon"),v=n("el-dropdown-item"),k=n("el-dropdown-menu"),T=n("el-dropdown"),A=n("vxe-grid");return h(),c("div",C,[m("header",null,[m("section",null,[m("div",Y,[t[3]||(t[3]=p(" 月份： ",-1)),u(o,{modelValue:l.searchParams.month,"onUpdate:modelValue":t[0]||(t[0]=e=>l.searchParams.month=e),type:"month",format:"YYYY-MM","value-format":"YYYY-MM"},null,8,["modelValue"])]),m("div",R,[(h(!0),c(g,null,f(d.defaultLeftButtons,(t,a)=>(h(),y(s,{type:t.type,plain:t.plain,key:a+"defaultLeftButtons",onClick:a=>e.btnClick(t)},{default:x(()=>[p(b(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128))]),m("div",M,[u(T,null,{dropdown:x(()=>[u(k,null,{default:x(()=>[u(v,{onClick:d.doExport},{default:x(()=>[...t[5]||(t[5]=[p("导出当前页",-1)])]),_:1},8,["onClick"]),u(v,{onClick:t[1]||(t[1]=e=>d.doExport(!0))},{default:x(()=>[...t[6]||(t[6]=[p("导出全部",-1)])]),_:1})]),_:1})]),default:x(()=>[u(s,{type:"gradientGreen"},{default:x(()=>[t[4]||(t[4]=p(" 导出",-1)),u(D,{class:"el-icon--right"},{default:x(()=>[u(r)]),_:1})]),_:1})]),_:1})])]),m("section",null,[m("div",$,[u(s,{type:"gradientBlue",onClick:d.importData},{default:x(()=>[...t[7]||(t[7]=[p("从月计划抽取",-1)])]),_:1},8,["onClick"]),(h(!0),c(g,null,f(d.defaultRightButtons,(t,a)=>(h(),y(s,{type:t.type,plain:t.plain,key:a+"defaultRightButtons",onClick:a=>e.btnClick(t)},{default:x(()=>[p(b(t.name),1)]),_:2},1032,["type","plain","onClick"]))),128)),u(s,{type:"gradientBlue",onClick:d.createData},{default:x(()=>[...t[8]||(t[8]=[p("生成月度风险预警",-1)])]),_:1},8,["onClick"])])])]),m("article",null,[u(A,j(d.gridOptions,{ref:"xTable"},w({cellDblclick:d.cellDblclick}),{onMenuClick:t[2]||(t[2]=t=>e.menuClickEvent(t,"设备检修"))}),null,16)])])}],["__scopeId","data-v-dd0d8f48"]]))}}});
