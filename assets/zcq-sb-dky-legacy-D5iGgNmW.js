!function(){const e=["uid"];function l(e,l){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);l&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),t.push.apply(t,a)}return t}function t(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach(function(l){a(e,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(s,l))})}return e}function a(e,l,t){return(l=function(e){var l=function(e,l){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,l||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===l?String:Number)(e)}(e,"string");return"symbol"==typeof l?l:l+""}(l))in e?Object.defineProperty(e,l,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[l]=t,e}System.register(["./index-legacy-C9R4tdre.js"],function(l,a){"use strict";var s,i,d,n,c,o,r,h,u,p,b,m,v,g,f,S,D,C,x,y,k,z,L,N,I,w,Z,P,_,V,j,O,M,T,$,X,A,E,B,U,R,q,W;return{setters:[e=>{s=e.a1,i=e.a2,d=e.H,n=e.G,c=e.a3,o=e.o,r=e.c,h=e.a4,u=e.p,p=e.a5,b=e.a6,m=e.e,v=e.a7,g=e.a8,f=e.I,S=e.a9,D=e.aa,C=e.ab,x=e.z,y=e.A,k=e._,z=e.a,L=e.r,N=e.d,I=e.ac,w=e.ad,Z=e.w,P=e.b,_=e.F,V=e.q,j=e.n,O=e.t,M=e.h,T=e.ae,$=e.af,X=e.f,A=e.i,E=e.ag,B=e.ah,U=e.ai,R=e.aj,q=e.ak,W=e.al}],execute:function(){const a={__name:"splitpanes",props:{horizontal:{type:Boolean,default:!1},pushOtherPanes:{type:Boolean,default:!0},maximizePanes:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean,default:!1}},emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click","splitter-dblclick"],setup(l,{emit:a}){const s=a,i=l,r=b(),h=f([]),u=g(()=>h.value.reduce((e,l)=>(e[~~l.id]=l)&&e,{})),p=g(()=>h.value.length),x=f(null),y=f(!1),k=f({mouseDown:!1,dragging:!1,activeSplitter:null,cursorOffset:0}),z=f({splitter:null,timeoutId:null}),L=g(()=>({["splitpanes splitpanes--"+(i.horizontal?"horizontal":"vertical")]:!0,"splitpanes--dragging":k.value.dragging})),N=(e,l)=>{const t=e.target.closest(".splitpanes__splitter");if(t){const{left:l,top:a}=t.getBoundingClientRect(),{clientX:s,clientY:d}="ontouchstart"in window&&e.touches?e.touches[0]:e;k.value.cursorOffset=i.horizontal?d-a:s-l}document.addEventListener("mousemove",I,{passive:!1}),document.addEventListener("mouseup",w),"ontouchstart"in window&&(document.addEventListener("touchmove",I,{passive:!1}),document.addEventListener("touchend",w)),k.value.mouseDown=!0,k.value.activeSplitter=l},I=e=>{k.value.mouseDown&&(e.preventDefault(),k.value.dragging=!0,requestAnimationFrame(()=>{_(P(e)),W("resize",{event:e},!0)}))},w=e=>{k.value.dragging&&(window.getSelection().removeAllRanges(),W("resized",{event:e},!0)),k.value.mouseDown=!1,k.value.activeSplitter=null,setTimeout(()=>{k.value.dragging=!1,document.removeEventListener("mousemove",I,{passive:!1}),document.removeEventListener("mouseup",w),"ontouchstart"in window&&(document.removeEventListener("touchmove",I,{passive:!1}),document.removeEventListener("touchend",w))},100)},Z=(e,l)=>{if(W("splitter-dblclick",{event:e,index:l},!0),i.maximizePanes){let t=0;h.value=h.value.map((e,a)=>(e.size=a===l?e.max:e.min,a!==l&&(t+=e.min),e)),h.value[l].size-=t,W("pane-maximize",{event:e,index:l,pane:h.value[l]}),W("resized",{event:e,index:l},!0)}},P=e=>{const l=x.value.getBoundingClientRect(),{clientX:t,clientY:a}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:t-(i.horizontal?0:k.value.cursorOffset)-l.left,y:a-(i.horizontal?k.value.cursorOffset:0)-l.top}},_=e=>{const l=k.value.activeSplitter;let t={prevPanesSize:j(l),nextPanesSize:O(l),prevReachedMinPanes:0,nextReachedMinPanes:0};const a=0+(i.pushOtherPanes?0:t.prevPanesSize),s=100-(i.pushOtherPanes?0:t.nextPanesSize),d=Math.max(Math.min((e=>{e=e[i.horizontal?"y":"x"];const l=x.value[i.horizontal?"clientHeight":"clientWidth"];return i.rtl&&!i.horizontal&&(e=l-e),100*e/l})(e),s),a);let n=[l,l+1],c=h.value[n[0]]||null,o=h.value[n[1]]||null;const r=c.max<100&&d>=c.max+t.prevPanesSize,u=o.max<100&&d<=100-(o.max+O(l+1));if(r||u)r?(c.size=c.max,o.size=Math.max(100-c.max-t.prevPanesSize-t.nextPanesSize,0)):(c.size=Math.max(100-o.max-t.prevPanesSize-O(l+1),0),o.size=o.max);else{if(i.pushOtherPanes){const e=V(t,d);if(!e)return;({sums:t,panesToResize:n}=e),c=h.value[n[0]]||null,o=h.value[n[1]]||null}null!==c&&(c.size=Math.min(Math.max(d-t.prevPanesSize-t.prevReachedMinPanes,c.min),c.max)),null!==o&&(o.size=Math.min(Math.max(100-d-t.nextPanesSize-t.nextReachedMinPanes,o.min),o.max))}},V=(e,l)=>{const t=k.value.activeSplitter,a=[t,t+1];return l<e.prevPanesSize+h.value[a[0]].min&&(a[0]=M(t).index,e.prevReachedMinPanes=0,a[0]<t&&h.value.forEach((l,s)=>{s>a[0]&&s<=t&&(l.size=l.min,e.prevReachedMinPanes+=l.min)}),e.prevPanesSize=j(a[0]),void 0===a[0])?(e.prevReachedMinPanes=0,h.value[0].size=h.value[0].min,h.value.forEach((l,a)=>{a>0&&a<=t&&(l.size=l.min,e.prevReachedMinPanes+=l.min)}),h.value[a[1]].size=100-e.prevReachedMinPanes-h.value[0].min-e.prevPanesSize-e.nextPanesSize,null):l>100-e.nextPanesSize-h.value[a[1]].min&&(a[1]=T(t).index,e.nextReachedMinPanes=0,a[1]>t+1&&h.value.forEach((l,s)=>{s>t&&s<a[1]&&(l.size=l.min,e.nextReachedMinPanes+=l.min)}),e.nextPanesSize=O(a[1]-1),void 0===a[1])?(e.nextReachedMinPanes=0,h.value.forEach((l,a)=>{a<p.value-1&&a>=t+1&&(l.size=l.min,e.nextReachedMinPanes+=l.min)}),h.value[a[0]].size=100-e.prevPanesSize-O(a[0]-1),null):{sums:e,panesToResize:a}},j=e=>h.value.reduce((l,t,a)=>l+(a<e?t.size:0),0),O=e=>h.value.reduce((l,t,a)=>l+(a>e+1?t.size:0),0),M=e=>[...h.value].reverse().find(l=>l.index<e&&l.size>l.min)||{},T=e=>h.value.find(l=>l.index>e+1&&l.size>l.min)||{},$=(e,l,t=!1)=>{const a=e-1,s=document.createElement("div");s.classList.add("splitpanes__splitter"),t||(s.onmousedown=e=>N(e,a),typeof window<"u"&&"ontouchstart"in window&&(s.ontouchstart=e=>N(e,a)),s.onclick=e=>((e,l)=>{"ontouchstart"in window&&(e.preventDefault(),z.value.splitter===l?(clearTimeout(z.value.timeoutId),z.value.timeoutId=null,Z(e,l),z.value.splitter=null):(z.value.splitter=l,z.value.timeoutId=setTimeout(()=>z.value.splitter=null,500))),k.value.dragging||W("splitter-click",{event:e,index:l},!0)})(e,a+1)),s.ondblclick=e=>Z(e,a+1),l.parentNode.insertBefore(s,l)},X=e=>{e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.remove()},A=()=>{var e;const l=Array.from((null==(e=x.value)?void 0:e.children)||[]);for(const a of l)a.className.includes("splitpanes__splitter")&&X(a);let t=0;for(const a of l)a.className.includes("splitpanes__pane")&&(!t&&i.firstSplitter?$(t,a,!0):t&&$(t,a),t++)},E=(e={})=>{e.addedPane||e.removedPane?h.value.some(e=>null!==e.givenSize||e.min||e.max<100)?R(e):B():U(),y.value&&W("resized")},B=()=>{const e=100/p.value;let l=0;const t=[],a=[];for(const s of h.value)s.size=Math.max(Math.min(e,s.max),s.min),l-=s.size,s.size>=s.max&&t.push(s.id),s.size<=s.min&&a.push(s.id);l>.1&&q(l,t,a)},U=()=>{let e=100;const l=[],t=[];let a=0;for(const i of h.value)e-=i.size,null!==i.givenSize&&a++,i.size>=i.max&&l.push(i.id),i.size<=i.min&&t.push(i.id);let s=100;if(e>.1){for(const l of h.value)null===l.givenSize&&(l.size=Math.max(Math.min(e/(p.value-a),l.max),l.min)),s-=l.size;s>.1&&q(s,l,t)}},R=({addedPane:e,removedPane:l}={})=>{var t;let a=100/p.value,s=0;const i=[],d=[];null!==(null!==(t=null==e?void 0:e.givenSize)&&void 0!==t?t:null)&&(a=(100-e.givenSize)/(p.value-1));for(const n of h.value)s-=n.size,n.size>=n.max&&i.push(n.id),n.size<=n.min&&d.push(n.id);if(!(Math.abs(s)<.1)){for(const l of h.value)null!==(null==e?void 0:e.givenSize)&&(null==e?void 0:e.id)===l.id||(l.size=Math.max(Math.min(a,l.max),l.min)),s-=l.size,l.size>=l.max&&i.push(l.id),l.size<=l.min&&d.push(l.id);s>.1&&q(s,i,d)}},q=(e,l,t)=>{let a;a=e>0?e/(p.value-l.length):e/(p.value-t.length),h.value.forEach((s,i)=>{if(e>0&&!l.includes(s.id)){const l=Math.max(Math.min(s.size+a,s.max),s.min),t=l-s.size;e-=t,s.size=l}else if(!t.includes(s.id)){const l=Math.max(Math.min(s.size+a,s.max),s.min),t=l-s.size;e-=t,s.size=l}}),Math.abs(e)>.1&&D(()=>{y.value&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})},W=(e,l=void 0,a=!1)=>{var d,n;const c=null!==(d=null!==(n=null==l?void 0:l.index)&&void 0!==n?n:k.value.activeSplitter)&&void 0!==d?d:null;s(e,t(t(t(t({},l),null!==c&&{index:c}),a&&null!==c&&{prevPane:h.value[c-(i.firstSplitter?1:0)],nextPane:h.value[c+(i.firstSplitter?0:1)]}),{},{panes:h.value.map(e=>({min:e.min,max:e.max,size:e.size}))}))};d(()=>i.firstSplitter,()=>A()),n(()=>{(()=>{var e;const l=Array.from((null==(e=x.value)?void 0:e.children)||[]);for(const t of l){const e=t.classList.contains("splitpanes__pane"),l=t.classList.contains("splitpanes__splitter");!e&&!l&&(t.remove(),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))}})(),A(),E(),W("ready"),y.value=!0}),c(()=>y.value=!1);const F=()=>{var e;return S("div",{ref:x,class:L.value},null==(e=r.default)?void 0:e.call(r))};return C("panes",h),C("indexedPanes",u),C("horizontal",g(()=>i.horizontal)),C("requestUpdate",l=>{let{uid:t}=l,a=function(e,l){if(null==e)return{};var t,a,s=function(e,l){if(null==e)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==l.indexOf(a))continue;t[a]=e[a]}return t}(e,l);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],-1===l.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}(l,e);const s=u.value[t];for(const[e,i]of Object.entries(a))s[e]=i}),C("onPaneAdd",e=>{var l;let a=-1;Array.from((null==(l=x.value)?void 0:l.children)||[]).some(l=>(l.className.includes("splitpanes__pane")&&a++,l.isSameNode(e.el))),h.value.splice(a,0,t(t({},e),{},{index:a})),h.value.forEach((e,l)=>e.index=l),y.value&&D(()=>{A(),E({addedPane:h.value[a]}),W("pane-add",{pane:h.value[a]})})}),C("onPaneRemove",e=>{const l=h.value.findIndex(l=>l.id===e);h.value[l].el=null;const a=h.value.splice(l,1)[0];h.value.forEach((e,l)=>e.index=l),D(()=>{A(),W("pane-remove",{pane:a}),E({removedPane:t({},a)})})}),C("onPaneClick",(e,l)=>{W("pane-click",{event:e,index:u.value[l].index,pane:u.value[l]})}),(e,l)=>(o(),m(v(F)))}},F={__name:"pane",props:{size:{type:[Number,String]},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},setup(e){var l;const t=e,a=s("requestUpdate"),b=s("onPaneAdd"),m=s("horizontal"),v=s("onPaneRemove"),S=s("onPaneClick"),D=null==(l=i())?void 0:l.uid,C=s("indexedPanes"),x=g(()=>C.value[D]),y=f(null),k=g(()=>{const e=isNaN(t.size)||void 0===t.size?0:parseFloat(t.size);return Math.max(Math.min(e,L.value),z.value)}),z=g(()=>{const e=parseFloat(t.minSize);return isNaN(e)?0:e}),L=g(()=>{const e=parseFloat(t.maxSize);return isNaN(e)?100:e}),N=g(()=>{var e;return`${m.value?"height":"width"}: ${null==(e=x.value)?void 0:e.size}%`});return d(()=>k.value,e=>a({uid:D,size:e})),d(()=>z.value,e=>a({uid:D,min:e})),d(()=>L.value,e=>a({uid:D,max:e})),n(()=>{b({id:D,el:y.value,min:z.value,max:L.value,givenSize:void 0===t.size?null:k.value,size:k.value})}),c(()=>v(D)),(e,l)=>(o(),r("div",{ref_key:"paneEl",ref:y,class:"splitpanes__pane",onClick:l[0]||(l[0]=l=>p(S)(l,e._.uid)),style:u(N.value)},[h(e.$slots,"default")],4))}};let K=y.base,J="/fxyj";function Y(e){return x({url:`${K}${J}/custom/add`,method:"post",data:e,showLoading:!0})}function Q(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let l=16*Math.random()|0;return("x"===e?l:3&l|8).toString(16)})}function G(e){return x({url:`${K}${J}/d5000/load-area-lazy-tree`,method:"post",data:e,showLoading:!0})}const H={name:"oms-tree",props:{omsDefaultNode:Object},mounted(){console.log("最终传入Tree的node"),console.log(this.omsDefaultNode),this.$refs.tree.setCurrentKey(this.omsDefaultNode),this.$emit("changeTreeNode",{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,level:0,id:this.omsDefaultNode.id,disabled:!0})},data(){return{newWportIsLink:!1,props:{label:"name",children:"zones",isLeaf:"leaf"},count:1,currentNode:{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,disabled:!0}}},methods:{loadNode(e,l){return this.currentNode=e.data,0==e.level?l([{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,level:0,id:this.omsDefaultNode.id,disabled:!0},{name:"线路",pid:"0",level:0,id:"XL",disabled:!0,leaf:!0}]):1==e.level?l(this.OMSCzList.map(e=>(e.leaf=!1,e))):void this.getLoad(l)},getLoad(e){var l;(l=this.currentNode,x({url:`${K}${J}/oms/load-area-lazy-tree`,method:"post",data:l,showLoading:!0})).then(l=>(this.newWportIsLink=!0,l&&0==l.length&&(this.newWportIsLink=!1),e(l))).catch()},doSelectProvince(){this.$refs.tree.setCurrentKey(this.omsDefaultNode),this.$emit("changeTreeNode",{name:this.omsDefaultNode.area,pid:this.omsDefaultNode.id,level:0,id:this.omsDefaultNode.id,disabled:!0})},doSelectArea(e){this.$refs.tree.setCurrentKey(e),this.$emit("changeTreeNode",e)},clickEvent(e){this.$emit("changeTreeNode",e)}},computed:t({},z(["token","userInfo","staticOMSxl","OMSCzList"]))},ee={id:"oms-tree"};const le={class:"search-div"},te={class:"search-itme"},ae={class:"search-itme"},se={class:"search-itme",style:{"margin-left":"10px"}},ie={class:"content-div"},de={class:"select-input"},ne={class:"select-content"},ce=["onClick","onDblclick"],oe={class:"page-div"},re={class:"center-content"},he={class:"cneter-div"},ue={class:"cneter-div"},pe={class:"select-content"},be=["onClick"],me={class:"write-input"},ve={class:"write-input-textarea"},ge={class:"bottom-button-div"},fe={class:"half-div"},Se={class:"half-div"};const De=k({name:"zcq-cz-oms",props:{omsDefaultNode:Object,updateSource:String,id:String},components:{DArrowLeft:w,DArrowRight:I,Splitpanes:a,Pane:F,omsTree:k(H,[["render",function(e,l,t,a,s,i){const d=L("el-tree");return o(),r("div",ee,[N(d,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":[t.omsDefaultNode.id],load:i.loadNode,onNodeClick:i.clickEvent,lazy:"","highlight-current":""},null,8,["props","default-expanded-keys","load","onNodeClick"])])}],["__scopeId","data-v-caa4156b"]])},mounted(){},computed:{czOptions:()=>[{label:"变电站",value:"MW_APP.MWT_UD_SB_BDZ"},{label:"统调电厂",value:"MW_APP.MWT_UD_SB_TDDC"},{label:"非统调电厂",value:"MW_APP.MWT_UD_SB_FTDDC"}]},data:()=>({param:{substation:"MW_APP.MWT_UD_SB_BDZ",dydj:"",text:"",pageSize:"20",pageIndex:0},dyoptions:[{label:"",value:""},{label:"1000kV",value:"1000000"},{label:"500kV",value:"500000"},{label:"220kV",value:"220000"},{label:"110kV",value:"110000"},{label:"35kV",value:"35000"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",treeNode:{},canSelectData:{},alSelectData:{},allDisabled:!1}),methods:{initPx2Rem(){},changeCZLX(){if("{}"==JSON.stringify(this.treeNode))return this.$message({message:"请先选择厂站所在区域",type:"warning"}),void this.dealCZLX();this.restParam(),this.querySubstation()},changeDYDJ(){this.restParam(),this.querySubstation()},changeTreeNode(e){if(console.log("OMS"),console.log(e),"XL"==e.id)return this.treeNode=e,this.allDisabled=!0,this.inputCZ="线路",void this.restParam();this.inputCZ="",this.allDisabled=!1,this.treeNode=e,this.param.value=e.id,this.restParam(),this.querySubstation()},restParam(){this.param.pageIndex=0},querySubstation(){var e;(e=this.param,x({url:`${K}${J}/oms/list-substation`,method:"post",data:e,showLoading:!0})).then(e=>{this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}}).catch()},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectData=e)},dbClickselctAlselect(e){this.allDisabled||(this.canSelectData=e,this.alSelectList=[e])},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex==this.totalPage||(this.param.pageIndex+=e,this.querySubstation())},ClickAlSelcteCanSelct(e){this.allDisabled||(this.alSelectData=e)},dbClickAlselctAlselect(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},turnRight(){this.allDisabled||null==this.canSelectData.czid||(this.alSelectList=[this.canSelectData])},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},confirm(){if(""==this.inputCZ&&0==this.alSelectList.length&&"XL"!=this.treeNode.id)return void this.$message({message:"请选择一个厂站进行保存",type:"warning"});let e={SSDW:"",DWMC:"",CZID:"",CZMC:"",tdcslx:"OMS",stationType:this.param.substation};if(""!=this.inputCZ&&"线路"!=this.inputCZ){let l=this.inputCZ.split(/[(\r\n)\r\n]+/).join(" ");e.CZMC=l,e.label=l,e.czlx="ST",Y({name:e.CZMC,sblb:this.param.substation,dq:this.treeNode.id}).then(l=>{e.CZID=l.data,e.id=l.data,this.$emit("refreshCZXX",e),this.$emit("close")})}else"XL"==this.treeNode.id?(e.CZMC="线路",e.czlx="XL",e.id="xl",e.label="线路",e.CZID="XL"):(e.SSDW=this.treeNode.id,e.DWMC=this.treeNode.name,e.CZID=this.alSelectList[0].czid,e.CZMC=this.alSelectList[0].czmc,e.id=this.alSelectList[0].czid,e.label=this.alSelectList[0].czmc,e.czlx="CZ"),this.$emit("refreshCZXX",e),this.$emit("close")},cancel(){this.$emit("close")},dealCZLX(){"BDZ"==this.param.substation?this.param.substation="DC":this.param.substation="BDZ"}}},[["render",function(e,l,t,a,s,i){const d=L("omsTree"),n=L("pane"),c=L("el-option"),h=L("el-select"),u=L("el-input"),p=L("el-button"),b=L("d-arrow-right"),v=L("d-arrow-left"),g=L("splitpanes");return o(),r("div",{id:"czOMS",class:"gljh px2rem-ignore",onClose:l[11]||(l[11]=l=>e.$emit("close"))},[N(g,{style:{height:"100%"},class:"default-theme"},{default:Z(()=>[N(n,{size:"25",style:{"overflow-y":"auto"}},{default:Z(()=>[N(d,{onChangeTreeNode:i.changeTreeNode,omsDefaultNode:t.omsDefaultNode},null,8,["onChangeTreeNode","omsDefaultNode"])]),_:1}),N(n,{size:"75"},{default:Z(()=>[P("div",le,[l[12]||(l[12]=P("div",{class:"search-label"},"厂站类型: ",-1)),P("div",te,[N(h,{class:"search-datepicker",modelValue:s.param.substation,"onUpdate:modelValue":l[0]||(l[0]=e=>s.param.substation=e),placeholder:"请选择",onChange:i.changeCZLX,disabled:s.allDisabled},{default:Z(()=>[(o(!0),r(_,null,V(i.czOptions,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),l[13]||(l[13]=P("div",{class:"search-label"},"电压等级: ",-1)),P("div",ae,[N(h,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.dydj=e),placeholder:"请选择",onChange:i.changeDYDJ,disabled:s.allDisabled},{default:Z(()=>[(o(!0),r(_,null,V(s.dyoptions,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),l[14]||(l[14]=P("div",{class:"search-label"},"模糊搜索: ",-1)),P("div",se,[N(u,{class:"search-datepicker",onChange:i.changeDYDJ,modelValue:s.param.text,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.text=e),disabled:s.allDisabled,placeholder:"请输入内容"},null,8,["onChange","modelValue","disabled"])])]),P("div",ie,[P("div",de,[P("div",ne,[l[17]||(l[17]=P("div",{class:"tilte"},"可选厂站(双击选取厂站)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.canSelectList,(e,l)=>(o(),r("div",{class:j(["text-label",[e.czid==s.canSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickSelcteCanSelct(e),onDblclick:l=>i.dbClickselctAlselect(e),key:l+"canSelect"},O(e.czmc),43,ce))),128))],2),P("div",oe,[N(p,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[3]||(l[3]=e=>i.pageChange(-1))},{default:Z(()=>[...l[15]||(l[15]=[M(" 上一页 ",-1)])]),_:1},8,["disabled"]),N(p,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[4]||(l[4]=e=>i.pageChange(1))},{default:Z(()=>[...l[16]||(l[16]=[M(" 下一页 ",-1)])]),_:1},8,["disabled"])])]),P("div",re,[P("div",he,[P("div",{class:j(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[5]||(l[5]=(...e)=>i.turnRight&&i.turnRight(...e))},[N(b,{height:"24"})],2)]),P("div",ue,[P("div",{class:j(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[6]||(l[6]=(...e)=>i.turnLeft&&i.turnLeft(...e))},[N(v,{height:"24"})],2)])]),P("div",pe,[l[18]||(l[18]=P("div",{class:"tilte"},"已选厂站(双击删除已选厂站)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.alSelectList,(e,t)=>(o(),r("div",{class:j(["text-label",[e.czid==s.alSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickAlSelcteCanSelct(e),onDblclick:l[7]||(l[7]=e=>i.dbClickAlselctAlselect()),key:t+"alSelect"},O(e.czmc),43,be))),128))],2)])]),P("div",me,[l[19]||(l[19]=P("div",{class:"tilte"},[P("span",null,"手工录入"),P("span",{style:{color:"red","margin-left":"4px"}},"(注:厂站列表中没有的厂站允许在此填写)")],-1)),P("div",ve,[N(u,{style:{height:"100%"},type:"textarea",resize:"none",disabled:s.allDisabled,placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[8]||(l[8]=e=>s.inputCZ=e)},null,8,["disabled","modelValue"])])])]),P("div",ge,[P("div",fe,[P("div",{class:"gljh-btn qd",onClick:l[9]||(l[9]=e=>i.confirm())},"确认")]),P("div",Se,[P("div",{class:"gljh-btn gb",onClick:l[10]||(l[10]=e=>i.cancel())},"取消")])])]),_:1})]),_:1})],32)}],["__scopeId","data-v-274a1fe8"]]),Ce={name:"d5000-tree",props:{d5000DefaultNode:Object},mounted(){this.OriginalId=this.d5000DefaultNode.id},data(){return{newWportIsLink:!1,OriginalId:"",props:{label:"name",children:"zones",isLeaf:"leaf"},count:1,currentNode:{name:this.d5000DefaultNode.area,pid:this.d5000DefaultNode.id,disabled:!0}}},methods:{loadNode(e,l){return this.currentNode=e.data,0==e.level?l([{name:this.d5000DefaultNode.area,pid:this.d5000DefaultNode.id,level:0,id:this.d5000DefaultNode.id,disabled:!0},{name:"线路",pid:"0",CZID:"XL",level:0,id:"XL",disabled:!0,leaf:!0}]):1==e.level?l(this.D5000CzList.map(e=>(e.leaf=!1,e))):void this.getLoad(l)},getLoad(e){G(this.currentNode).then(l=>(this.newWportIsLink=!(l&&0==l.length),e(l)))},clickEvent(e){e.id!=this.OriginalId?this.$emit("changeTreeNode",e):this.$refs.tree.setCurrentKey()}},computed:t({},z(["token","userInfo","staticOMSxl","D5000CzList"]))},xe={id:"d5000-tree"};const ye={class:"search-div"},ke={class:"search-itme"},ze={class:"search-itme"},Le={class:"search-itme",style:{"margin-left":"10px"}},Ne={class:"content-div"},Ie={class:"select-input"},we={class:"select-content"},Ze=["onClick","onDblclick"],Pe={class:"page-div"},_e={class:"center-content"},Ve={class:"cneter-div"},je={class:"cneter-div"},Oe={class:"select-content"},Me=["onClick"],Te={class:"write-input"},$e={class:"write-input-textarea"},Xe={class:"content-div"},Ae={class:"select-content"},Ee={class:"nullnode-show-div"},Be={class:"nullnode-show-div-select"},Ue={class:"text-label"},Re={class:"nullnode-show-div"},qe={class:"write-input-textarea"},We={class:"bottom-button-div"},Fe={class:"half-div"},Ke={class:"half-div"};const Je=k({name:"zcq-cz-d5000",props:{d5000DefaultNode:Object,updateSource:String,id:String},components:{DArrowRight:I,DArrowLeft:w,Splitpanes:a,Pane:F,d5000Tree:k(Ce,[["render",function(e,l,t,a,s,i){const d=L("el-tree");return o(),r("div",xe,[N(d,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":[t.d5000DefaultNode.id],load:i.loadNode,onNodeClick:i.clickEvent,lazy:"","highlight-current":""},null,8,["props","default-expanded-keys","load","onNodeClick"])])}],["__scopeId","data-v-c8e37669"]])},mounted(){},computed:{czlxOptions:()=>[{label:"变电站",value:"BDZ"},{label:"电厂",value:"DC"}]},data:()=>({guid:Q(),param:{subType:"BDZ",subVol:"",subContent:"",pageSize:"20",pageIndex:0},dyoptions:[{label:"",value:""},{label:"1000kV",value:"112871465677750285"},{label:"800kV",value:"112871465677750310"},{label:"500kV",value:"112871465677750274"},{label:"220kV",value:"112871465677750279"},{label:"110kV",value:"112871465677750280"},{label:"35kV",value:"112871465677750275"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",treeNode:{},canSelectData:{},alSelectData:{},allDisabled:!1,alNullNodeInput:"",NullNodeInput:""}),methods:{changeCZLX(){this.restParam(),this.querySubstation()},changeTreeNode(e){if(console.log(e),"XL"==e.id)return this.treeNode=e,this.allDisabled=!0,this.inputCZ="线路",void this.restParam();this.inputCZ="",this.allDisabled=!1,this.treeNode=e,this.param.areaId=e.id,this.param.dbId=e.pid,this.param.level=e.level,this.restParam(),this.querySubstation()},restParam(){this.param.pageIndex=0},querySubstation(){var e;(e=this.param,x({url:`${K}${J}/d5000/list-substation`,method:"post",data:e,showLoading:!0})).then(e=>{this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}}).catch()},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectData=e)},dbClickselctAlselect(e){this.allDisabled||(this.canSelectData=e,this.alSelectList=[e])},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.querySubstation())},ClickAlSelcteCanSelct(e){this.allDisabled||(this.alSelectData=e)},dbClickAlselctAlselect(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},turnRight(){this.allDisabled||null==this.canSelectData.czid||(this.alSelectList=[this.canSelectData])},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectList=[])},delettextlabel(){this.alNullNodeInput=""},addInpput(){this.alNullNodeInput=this.NullNodeInput},confirm(){if(null==this.treeNode.id){if(""==this.alNullNodeInput)return void this.$message({message:"请输入一个厂站进行保存",type:"warning"})}else if(""==this.inputCZ&&0==this.alSelectList.length&&"XL"!=this.treeNode.id)return void this.$message({message:"请选择一个厂站进行保存",type:"warning"});let e={SSDW:"",DWMC:"",CZID:"",CZMC:"",tdcslx:"D5000",dbId:this.treeNode.pid};if(null==this.treeNode.id)e.CZMC=this.alNullNodeInput,e.czlx="ST",e.label=this.alNullNodeInput,this.dealInputAdd(e);else if(""!=this.inputCZ&&"线路"!=this.inputCZ){let l=this.inputCZ.split(/[(\r\n)\r\n]+/).join(" ");e.CZMC=l,e.label=l,e.czlx="ST",this.dealInputAdd(e)}else"XL"==this.treeNode.id?(e.CZMC="线路",e.czlx="XL",e.CZID="XL",e.id="xl",e.label="线路"):(e.SSDW=this.treeNode.id,e.DWMC=this.treeNode.name,e.CZID=this.alSelectList[0].czid,e.CZMC=this.alSelectList[0].czmc,e.id=this.alSelectList[0].czid,e.label=this.alSelectList[0].czmc,e.czlx="CZ",e.dbId=this.alSelectList[0].dbId,e.fqmc=this.alSelectList[0].fqmc,e.fqmcDispidx=this.alSelectList[0].fqmcDispidx),this.$emit("refreshCZXX",e),this.$emit("close")},dealInputAdd(e){Y({name:e.CZMC,sblb:this.param.subType,dq:this.treeNode.id}).then(l=>{e.CZID=l.data,e.id=l.data,this.$emit("refreshCZXX",e),this.$emit("close")})},cancel(){this.$emit("close")}}},[["render",function(e,l,t,a,s,i){const d=L("d5000Tree"),n=L("pane"),c=L("el-option"),h=L("el-select"),u=L("el-input"),p=L("el-button"),b=L("d-arrow-right"),v=L("d-arrow-left"),g=L("splitpanes");return o(),r("div",{id:"czD5000",class:"gljh px2rem-ignore",onClose:l[14]||(l[14]=l=>e.$emit("close"))},[(o(),m(g,{style:{height:"100%"},class:"default-theme",key:s.guid},{default:Z(()=>[N(n,{size:20},{default:Z(()=>[N(d,{onChangeTreeNode:i.changeTreeNode,d5000DefaultNode:t.d5000DefaultNode},null,8,["onChangeTreeNode","d5000DefaultNode"])]),_:1}),N(n,{size:79},{default:Z(()=>[T(P("div",ye,[l[15]||(l[15]=P("div",{class:"search-label"},"厂站类型: ",-1)),P("div",ke,[N(h,{class:"search-datepicker",modelValue:s.param.subType,"onUpdate:modelValue":l[0]||(l[0]=e=>s.param.subType=e),placeholder:"请选择",onChange:i.changeCZLX,disabled:s.allDisabled},{default:Z(()=>[(o(!0),r(_,null,V(i.czlxOptions,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),l[16]||(l[16]=P("div",{class:"search-label"},"电压等级: ",-1)),P("div",ze,[N(h,{class:"search-datepicker",modelValue:s.param.subVol,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.subVol=e),placeholder:"请选择",onChange:i.changeCZLX,disabled:s.allDisabled},{default:Z(()=>[(o(!0),r(_,null,V(s.dyoptions,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange","disabled"])]),P("div",Le,[N(u,{class:"search-datepicker",onChange:i.changeCZLX,modelValue:s.param.subContent,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.subContent=e),placeholder:"请输入内容",disabled:s.allDisabled},null,8,["onChange","modelValue","disabled"])])],512),[[$,null!=s.treeNode.id]]),T(P("div",Ne,[P("div",Ie,[P("div",we,[l[19]||(l[19]=P("div",{class:"tilte"},"可选厂站(双击选取厂站)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.canSelectList,(e,l)=>(o(),r("div",{class:j(["text-label",[e.czid==s.canSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickSelcteCanSelct(e),onDblclick:l=>i.dbClickselctAlselect(e),key:l+"canSelect"},O(e.czmc),43,Ze))),128))],2),P("div",Pe,[N(p,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[3]||(l[3]=e=>i.pageChange(-1))},{default:Z(()=>[...l[17]||(l[17]=[M(" 上一页 ",-1)])]),_:1},8,["disabled"]),N(p,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[4]||(l[4]=e=>i.pageChange(1))},{default:Z(()=>[...l[18]||(l[18]=[M(" 下一页 ",-1)])]),_:1},8,["disabled"])])]),P("div",_e,[P("div",Ve,[P("div",{class:j(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[5]||(l[5]=(...e)=>i.turnRight&&i.turnRight(...e))},[N(b,{height:"24"})],2)]),P("div",je,[P("div",{class:j(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[6]||(l[6]=(...e)=>i.turnLeft&&i.turnLeft(...e))},[N(v,{height:"24"})],2)])]),P("div",Oe,[l[20]||(l[20]=P("div",{class:"tilte"},"已选厂站(双击删除已选厂站)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.alSelectList,(e,t)=>(o(),r("div",{class:j(["text-label",[e.czid==s.alSelectData.czid?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickAlSelcteCanSelct(e),onDblclick:l[7]||(l[7]=e=>i.dbClickAlselctAlselect()),key:t+"alSelect"},O(e.czmc),43,Me))),128))],2)])]),P("div",Te,[l[21]||(l[21]=P("div",{class:"tilte"},[M("手工录入("),P("span",{style:{color:"red"}},"注:厂站列表中没有的厂站允许在此填写"),M(")")],-1)),P("div",$e,[N(u,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[8]||(l[8]=e=>s.inputCZ=e),disabled:s.allDisabled},null,8,["modelValue","disabled"])])])],512),[[$,null!=s.treeNode.id]]),T(P("div",Xe,[P("div",Ae,[l[22]||(l[22]=P("div",{class:"tilte"},[P("span",null,"已选厂站"),P("span",{style:{color:"red","margin-left":"4px"}},"注：双击可移除已选厂站")],-1)),P("div",Ee,[T(P("div",Be,[P("div",Ue,O(s.alNullNodeInput),1),P("div",{class:"delete-text-label",onClick:l[9]||(l[9]=(...e)=>i.delettextlabel&&i.delettextlabel(...e))})],512),[[$,""!=s.alNullNodeInput]])]),l[23]||(l[23]=P("div",{class:"tilte"},[P("span",null,"手工录入"),P("span",{style:{color:"red","margin-left":"4px"}},"注：左侧设备树中没有的厂站允许在此手工填写")],-1)),P("div",Re,[P("div",qe,[N(u,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.NullNodeInput,"onUpdate:modelValue":l[10]||(l[10]=e=>s.NullNodeInput=e)},null,8,["modelValue"])]),P("div",{class:"add-input",onClick:l[11]||(l[11]=e=>i.addInpput())},"加入手写")])])],512),[[$,null==s.treeNode.id]]),P("div",We,[P("div",Fe,[P("div",{class:"gljh-btn qd",onClick:l[12]||(l[12]=e=>i.confirm())},"确认")]),P("div",Ke,[P("div",{class:"gljh-btn gb",onClick:l[13]||(l[13]=e=>i.cancel())},"取消")])])]),_:1})]),_:1}))],32)}],["__scopeId","data-v-a552a574"]]);let Ye,Qe;const Ge={id:"d5000-tree"};const He={class:"filter-div"},el={class:"tree-outer"},ll={class:"content-div"},tl={class:"select-content"},al={class:"node-show-div"},sl={class:"text-label"},il={class:"node-show-div"},dl={class:"write-input-textarea"},nl={class:"bottom-button-div"},cl={class:"half-div"},ol={class:"half-div"};const rl=k({name:"zcq-cz-dky",props:{d5000DefaultNode:Object,updateSource:String,id:String},components:{DkyCzTree:k({name:"dky-cz-tree",props:{treeFilterKey:{type:String,default:""}},mounted(){this.initData()},data:()=>({props:{label:"label",children:"children",isLeaf:"leaf"},defaultExpandedKeys:[],treeData:[],clickFlag:!1}),methods:{filterNode:(e,l)=>!e||-1!==l.label.indexOf(e),loadTree(){var e;(e={},x({url:`${K}${J}/dky/load-station-lazy-tree`,method:"post",data:e,showLoading:!0})).then(e=>{this.defaultExpandedKeys=[e.data[0].id],this.treeData=e.data})},clickEvent(e){clearTimeout(Ye),e.children||(Ye=setTimeout(()=>{this.clickFlag=!1},650),this.clickFlag&&Qe===e?(this.clickFlag=!1,this.$emit("changeTreeNode",e)):(this.clickFlag=!0,Qe=e))},initData(){this.loadTree()}},watch:{treeFilterKey(e){this.$refs.tree.filter(e)}}},[["render",function(e,l,t,a,s,i){const d=L("el-tree");return o(),r("div",Ge,[N(d,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":s.defaultExpandedKeys,onNodeClick:i.clickEvent,data:s.treeData,"highlight-current":"","filter-node-method":i.filterNode},null,8,["props","default-expanded-keys","onNodeClick","data","filter-node-method"])])}],["__scopeId","data-v-dde4e5eb"]]),Splitpanes:a,Pane:F},data:()=>({selectedNode:{},filterKey:"",treeFilterKey:"",guid:Q(),selfInput:""}),methods:{filterTree(){this.treeFilterKey=this.filterKey},changeTreeNode(e){"{}"===JSON.stringify(this.selectedNode)&&(this.selectedNode=e)},deleteSelectedNode(){this.selectedNode={}},addInpput(){this.selectedNode={id:"input",label:this.selfInput,czid:"",czmc:this.selfInput}},confirm(){if(!this.selectedNode.id)return void this.$message({message:"请选择或输入一个厂站进行保存",type:"warning"});let e={tdcslx:"DKY"};e.CZID=this.selectedNode.czid,e.CZMC=this.selectedNode.czmc,e.id=this.selectedNode.id,e.label=this.selectedNode.label,this.$emit("refreshCZXX",e),this.$emit("close")},cancel(){this.$emit("close")}}},[["render",function(e,l,t,a,s,i){const d=L("el-input"),n=L("DkyCzTree"),c=L("pane"),h=L("splitpanes");return o(),r("div",{id:"czDKY",class:"gljh px2rem-ignore",onClose:l[8]||(l[8]=l=>e.$emit("close"))},[(o(),m(h,{style:{height:"100%"},class:"default-theme",key:s.guid},{default:Z(()=>[N(c,{size:25},{default:Z(()=>[P("div",He,[N(d,{modelValue:s.filterKey,"onUpdate:modelValue":l[1]||(l[1]=e=>s.filterKey=e),size:"mini",onKeyup:X(i.filterTree,["enter","native"])},{default:Z(()=>[P("i",{slot:"suffix",class:"el-input__icon el-icon-search",onClick:l[0]||(l[0]=(...e)=>i.filterTree&&i.filterTree(...e)),style:{cursor:"pointer"}})]),_:1},8,["modelValue","onKeyup"])]),P("div",el,[N(n,{onChangeTreeNode:i.changeTreeNode,"tree-filter-key":s.treeFilterKey},null,8,["onChangeTreeNode","tree-filter-key"])])]),_:1}),N(c,{size:75},{default:Z(()=>[P("div",ll,[P("div",tl,[l[9]||(l[9]=P("div",{class:"tilte"},[P("span",null,"已选厂站"),P("span",{style:{color:"red","margin-left":"4px"}},"注：双击可移除已选厂站")],-1)),P("div",al,[s.selectedNode.id?(o(),r("div",{key:0,class:"node-show-div-select",onDblclick:l[3]||(l[3]=(...e)=>i.deleteSelectedNode&&i.deleteSelectedNode(...e))},[P("div",sl,O(s.selectedNode.label),1),P("div",{class:"delete-text-label",onClick:l[2]||(l[2]=(...e)=>i.deleteSelectedNode&&i.deleteSelectedNode(...e))})],32)):A("",!0)]),l[10]||(l[10]=P("div",{class:"tilte"},[P("span",null,"手工录入"),P("span",{style:{color:"red"}},"(数据库中没有的厂站可在此手动添加)")],-1)),P("div",il,[P("div",dl,[N(d,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.selfInput,"onUpdate:modelValue":l[4]||(l[4]=e=>s.selfInput=e)},null,8,["modelValue"])]),P("div",{class:"add-input",onClick:l[5]||(l[5]=e=>i.addInpput())},"加入手写")])])]),P("div",nl,[P("div",cl,[P("div",{class:"gljh-btn qd",onClick:l[6]||(l[6]=e=>i.confirm())},"确认")]),P("div",ol,[P("div",{class:"gljh-btn gb",onClick:l[7]||(l[7]=e=>i.cancel())},"取消")])])]),_:1})]),_:1}))],32)}],["__scopeId","data-v-91fa9046"]]),hl={name:"czSelect",props:{showD5000:{type:Boolean,default:!0},showDky:{type:Boolean,default:!0},omsDefaultNode:Object,d5000DefaultNode:Object,updateSource:String,unshowDKY:Boolean,showOMS:{type:Boolean,default:!0},id:{type:String,default:""}},components:{},mounted(){},data:()=>({}),methods:{selectCZ(e){"czOMS"==e?this.$vxeModal.show(De,{omsDefaultNode:this.omsDefaultNode,updateSource:this.updateSource,id:this.id},{width:1010,height:650,title:"厂站选择"},{refreshCZXX:e=>{this.$emit("refreshCZXX",e),this.$emit("close")}}):"czD5000"==e?this.$vxeModal.show(Je,{d5000DefaultNode:this.d5000DefaultNode,updateSource:this.updateSource,id:this.id},{width:1010,height:650,title:"厂站选择-D5000"},{refreshCZXX:e=>{console.log(e),this.$emit("refreshCZXX",e),this.$emit("close")}}):"DKY"==e&&this.$vxeModal.show(rl,{d5000DefaultNode:this.d5000DefaultNode,updateSource:this.updateSource,id:this.id},{width:1010,height:650,title:"厂站选择-调控云"},{refreshCZXX:e=>{this.$emit("refreshCZXX",e),this.$emit("close")}})}}},ul={class:"bottom-button"};l("c",k(hl,[["render",function(e,l,t,a,s,i){return o(),r("div",{class:"gljh",onClose:l[3]||(l[3]=l=>e.$emit("close"))},[l[4]||(l[4]=P("div",{class:"top-tip"}," 请选择停电厂站类型 ",-1)),P("div",ul,[t.showOMS?(o(),r("div",{key:0,class:"search-btn",onClick:l[0]||(l[0]=e=>i.selectCZ("czOMS"))},"OMS场所")):A("",!0),T(P("div",{class:"search-btn righ-search",onClick:l[1]||(l[1]=e=>i.selectCZ("czD5000"))}," D5000场所 ",512),[[$,t.showD5000]]),t.showDky?T((o(),r("div",{key:1,class:"search-btn righ-search",onClick:l[2]||(l[2]=e=>i.selectCZ("DKY"))}," 调控云场所 ",512)),[[$,!t.unshowDKY]]):A("",!0)])],32)}],["__scopeId","data-v-8ca3028a"]]));const pl={name:"zcq-sb-d5000",props:{paramdata:{type:Object},updateSource:String,sblist:{type:Array},id:{type:String,default:""},isCommon:{type:Boolean,default:!1}},components:{DArrowLeft:w,DArrowRight:I,Bottom:B,Top:E,Splitpanes:a,Pane:F},mounted(){this.sfts=!!this.paramdata.sfts&&this.paramdata.sfts,this.testData=this.paramdata,this.testData.showzsb&&(this.showzsb=!0),this.testData.tdcsParam||(this.testData.tdcsParam={czlx:"",CZID:"",dbId:"",stationType:""}),this.CZLX=this.testData.tdcsParam.czlx,this.param.subType=this.CZLX,this.getAlSelectDevice(),this.param.deviceType=this.options[0].value,"XL"==this.CZLX?(this.options=[{label:"线路",value:"XL"}],this.param.deviceType=this.options[0].value,this.getLeftTree()):("徐州"==this.$store.state.userInfo.cropJc&&(this.options=[{label:"线路",value:"XL"},{label:"母线",value:"MX"},{label:"开关",value:"KG"},{label:"主变",value:"ZB"},{label:"发电机",value:"FDJ"},{label:"电容器",value:"DRQ"},{label:"电抗器",value:"DKQ"},{label:"二次设备",value:"ECSB"}]),setTimeout(()=>{this.sbLoadingFlag=!0,this.selectCZ(this.testData.tdcsParam)},100))},data:()=>({innerSblist:[],sfts:!1,showzsb:!1,curNode:{},defaultExpandId:"",treeData:[],props:{children:"children",label:"name",isLeaf:"leaf"},CZLX:"",testData:{tdcsParam:{CZID:""}},param:{subId:"",dydj:"",dbId:"",deviceType:"",subType:"",deviceContent:"",keyword:"",pageSize:"20",pageIndex:0},options:[{label:"线路",value:"XL"},{label:"母线",value:"MX"},{label:"开关",value:"KG"},{label:"主变",value:"ZB"},{label:"发电机",value:"FDJ"},{label:"电容器",value:"DRQ"},{label:"电抗器",value:"DKQ"}],dydjoptions:[{label:"",value:""},{label:"1000kV",value:"112871465677750285"},{label:"800kV",value:"112871465677750310"},{label:"500kV",value:"112871465677750274"},{label:"220kV",value:"112871465677750279"},{label:"110kV",value:"112871465677750280"},{label:"35kV",value:"112871465677750275"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",canSelectData:{},treeNode:{},alSelectData:{},alSelectDataIndex:-1,allDisabled:!1,NullNodeInputList:[],NullNodeInput:"",selectNode:{CZID:""},unCZSelectFlag:!1,sbLoadingFlag:!1}),methods:{getAlSelectDevice(){this.sblist&&(this.innerSblist=JSON.parse(JSON.stringify(this.sblist)),this.innerSblist.length>0&&(this.innerSblist.forEach(e=>{this.testData.showzsb||(e.zsb=!1),e.checked=!1}),"ST"==this.CZLX?this.NullNodeInputList=JSON.parse(JSON.stringify(this.innerSblist)):this.alSelectList=JSON.parse(JSON.stringify(this.innerSblist))),console.log(this.innerSblist))},loadNode(e,l){let t=e.data;"[object Object]"===Object.prototype.toString.call(t)&&(t.children&&t.children.length>0?l(t.children):G(t).then(e=>{l(e)}).catch())},getLeftTree(){var e;x({url:`${K}${J}/d5000/load-line-lazy-tree`,method:"post",data:e,showLoading:!0}).then(e=>{this.treeData=[e.data],this.defaultExpandId=e.data.id}).catch()},selectCZ(e){this.resetParam(),this.curNode=e,this.selectNode=e,this.param.subId=this.testData.tdcsParam.CZID,this.param.dbId=this.testData.tdcsParam.dbId,this.param.subType=this.testData.tdcsParam.czlx,this.queryD5000Device()},clickEvent(e){console.log(e),0!=e.level?(this.curNode=e,this.param.subId=e.id,this.param.level=e.level,this.param.dbId=e.pid,this.resetParam(),this.queryD5000Device()):this.$refs.tree.setCurrentKey()},changeCZLX(e){this.resetParam(),console.log(e,"flag"),this.queryD5000Device(e)},resetParam(){this.param.pageIndex=0},queryD5000Device(e){var l;this.param.dbId||!e?(this.param.stationType=this.testData.tdcsParam.stationType,this.sbLoadingFlag=!0,"ECSB"==this.param.deviceType?(l=this.param,x({url:`${K}${J}/select/get-second`,method:"post",data:l,showLoading:!0})).then(e=>{e.data&&(e.data.forEach(e=>{e.checked=!1,e.zsb=!1}),this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}),this.sbLoadingFlag=!1}).catch():function(e){return x({url:`${K}${J}/d5000/list-device`,method:"post",data:e,showLoading:!0})}(this.param).then(e=>{e.data&&(e.data.forEach(e=>{e.checked=!1,e.zsb=!1}),this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}),this.sbLoadingFlag=!1}).catch()):this.$message({message:"请先选择厂站",type:"warning"})},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectList.forEach(e=>{e.checked=!1}),e.checked=!0,this.canSelectData=e)},dbClickCanSelect(e){this.allDisabled||(this.canSelectData=e,this.canSelectList.forEach(e=>{e.checked=!1}),this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):(e.isSecond&&(e.label="保护停用"),e.checked=!1,this.alSelectList.push(JSON.parse(JSON.stringify(e))),e.checked=!0))},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.queryD5000Device())},ClickAlSelcteCanSelct(e,l){this.allDisabled||(this.alSelectData=e,this.alSelectDataIndex=l,this.alSelectList.forEach(e=>{e.checked=!1}),e.checked=!0)},dbClickAlselctAlselect(e){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList.splice(e,1),this.alSelectList.forEach(e=>{e.checked=!1}))},selectDevice(e){let l=[];this.alSelectList[e].zsb&&(l.push(this.alSelectList[e]),this.alSelectList.splice(e,1));let t=[],a=[];this.alSelectList.length>0&&this.alSelectList.forEach(e=>{e.zsb?t.push(e):a.push(e)}),this.alSelectList=JSON.parse(JSON.stringify(l.concat(t).concat(a)))},moveUp(){-1!=this.alSelectDataIndex?0!=this.alSelectDataIndex?(this.alSelectList.splice(this.alSelectDataIndex-1,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex+1,1),this.alSelectDataIndex=this.alSelectDataIndex-1):this.$message({message:"已经在第一个，无法上移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},moveDown(){-1!=this.alSelectDataIndex?this.alSelectDataIndex!=this.alSelectList.length-1?(this.alSelectList.splice(this.alSelectDataIndex+2,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex,1),this.alSelectDataIndex=this.alSelectDataIndex+1):this.$message({message:"已经在最后一个，无法下移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},judgeExist(){return-1!=this.alSelectList.findIndex(e=>e.sbid==this.canSelectData.sbid)},turnRight(){this.allDisabled||null==this.canSelectData.sbid||(this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):(this.canSelectData.isSecond&&(this.canSelectData.label="保护停用"),this.alSelectList.push(this.canSelectData)))},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList=[])},delettextlabel(e){this.NullNodeInputList.splice(e,1)},addInpput(){""!=this.NullNodeInput.trim()?this.NullNodeInputList.findIndex(e=>e.sbmc==this.NullNodeInput)>-1?this.$message({message:"无法加入同名设备",type:"warning"}):this.NullNodeInputList.push({sbid:"",sbmc:this.NullNodeInput,sbzt:"",sbddmm:this.NullNodeInput,label:"",realdydj:"",checked:!1,sblx:"手写输入"}):this.$message({message:"无法加入空白设备",type:"warning"})},addInpputCZ(){""!=this.inputCZ.trim()?this.alSelectList.findIndex(e=>e.sbmc==this.inputCZ)>-1?this.$message({message:"无法加入同名设备",type:"warning"}):this.alSelectList.push({sbid:"",sbmc:this.inputCZ,sbzt:"",sbddmm:this.inputCZ,label:"",dydj:"",checked:!1,sblx:"手写输入"}):this.$message({message:"无法加入空白设备",type:"warning"})},confirm(){let e={CZSBList:[]};if(-1!=this.testData.bdlx.indexOf("rjh")&&this.alSelectList.length<1&&this.NullNodeInputList.length<1)return this.$emit("refreshSBXX",e.CZSBList),void this.$emit("close");if(this.alSelectList.length<1&&this.NullNodeInputList.length<1)this.$message({message:"请选择一条数据",type:"warning"});else{if(!this.isCommon&&(-1!=this.testData.bdlx.indexOf("rjh")&&!this.sfts||this.testData.bdlx.indexOf("zcq")>-1)){let e=!1;if(this.alSelectList.forEach(l=>{l.label||(e=!0)}),this.NullNodeInputList.forEach(l=>{l.label||(e=!0)}),e)return void this.$message({message:"请给所有设备选择类型",type:"warning"})}"ST"==this.CZLX?e={CZSBList:this.NullNodeInputList,STSBList:[]}:this.alSelectList.forEach(l=>{""!=l.sbid?e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm:l.sbmc,sbid:l.sbid,label:l.label?l.label:"",realdydj:l.realdydj?l.realdydj:l.dydj?l.dydj:"",zsb:!!l.zsb,sblx:l.sblx?l.sblx:"",sbbm:l.sbbm?l.sbbm:"",isSecond:!!l.isSecond,czid:l.czid?l.czid:l.czid_md?l.czid_md:"",czmc:l.czmc?l.czmc:l.czmc_md?l.czmc_md:""}):(l.realdydj="",e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm.replace(/[\r\n]/g," "):l.sbmc.replace(/[\r\n]/g," "),sbid:l.sbid,label:l.label?l.label:"",realdydj:"",sbbm:"",zsb:!!l.zsb,sblx:"手写输入"}))}),e.CZSBList&&e.CZSBList.length>0&&(e.CZSBList.forEach((e,l)=>{e.sort=l+1}),this.testData.showzsb&&e.CZSBList.sort((e,l)=>e.zsb&&l.zsb?0:e.zsb?-1:1)),this.$emit("refreshSBXX",e.CZSBList),this.$emit("close")}},cancel(){this.$emit("close")}},computed:t(t({},R(["areaEng"])),{},{fromRjh:()=>!0,options2(){return e=>e.isSecond?[{label:"保护停用",value:"保护停用"},{label:"保护信号",value:"保护信号"}]:(this.testData.bdlx.indexOf("rjh")>-1||this.testData.bdlx.indexOf("zcq")>-1)&&"NT"===this.areaEng?[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"},{label:"停机",value:"停机"}]:[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"}]}})},bl={class:"sb-left-tree"},ml={class:"search-div"},vl={class:"search-itme"},gl={class:"search-itme"},fl={class:"search-itme",style:{"margin-left":"10px"}},Sl={class:"search-itme",style:{"margin-left":"10px"}},Dl={class:"content-div"},Cl={class:"select-input"},xl={class:"select-content"},yl=["onClick","onDblclick"],kl={class:"page-div"},zl={class:"center-content"},Ll={class:"cneter-div"},Nl={class:"cneter-div"},Il={class:"select-content"},wl=["onClick","onDblclick"],Zl={class:"zsb-check"},Pl={class:"selection",style:{display:"flex"}},_l={style:{color:"red","margin-right":"5px"}},Vl={class:"write-input"},jl={class:"top-hand-div"},Ol={class:"write-input-textarea"},Ml={class:"content-div"},Tl={class:"select-content"},$l={class:"nullnode-show-div"},Xl=["onDblclick"],Al={class:"text-label"},El={class:"text-label2",style:{display:"flex"}},Bl={style:{color:"red","margin-right":"5px"}},Ul=["onClick"],Rl={class:"nullnode-show-div"},ql={class:"write-input-textarea"},Wl={class:"bottom-button-div"},Fl={class:"half-div"},Kl={class:"half-div"};const Jl=l("Z",k(pl,[["render",function(e,l,t,a,s,i){const d=L("el-tree"),n=L("pane"),c=L("el-option"),h=L("el-select"),u=L("el-input"),p=L("el-button"),b=L("Top"),v=L("Bottom"),g=L("d-arrow-right"),f=L("d-arrow-left"),S=L("el-checkbox"),D=L("Splitpanes"),C=U("loading");return o(),r("div",{id:"sbD5000",class:"gljh px2rem-ignore",onClose:l[17]||(l[17]=l=>e.$emit("close"))},[N(D,{style:{height:"100%"},class:"default-theme"},{default:Z(()=>[N(n,{size:"20"},{default:Z(()=>[T(P("div",{class:j(["select-cz",s.selectNode.CZID==s.testData.tdcsParam.CZID?"alselect-cz":""]),onClick:l[0]||(l[0]=e=>i.selectCZ(s.testData.tdcsParam))},O(s.testData.tdcsParam.CZMC),3),[[$,"CZ"==s.CZLX]]),T(P("div",bl,[N(d,{ref:"tree","node-key":"id","expand-on-click-node":!1,data:s.treeData,props:s.props,onNodeClick:i.clickEvent,lazy:"",load:i.loadNode,"default-expanded-keys":[s.defaultExpandId],"highlight-current":""},null,8,["data","props","onNodeClick","load","default-expanded-keys"])],512),[[$,"CZ"!=s.CZLX]])]),_:1}),N(n,null,{default:Z(()=>[T(P("a",null,[P("div",ml,[l[19]||(l[19]=P("div",{class:"search-label"},"设备类型: ",-1)),P("div",vl,[N(h,{class:"search-datepicker",modelValue:s.param.deviceType,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.deviceType=e),placeholder:"请选择",onChange:i.changeCZLX},{default:Z(()=>[(o(!0),r(_,null,V(s.options,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),l[20]||(l[20]=P("div",{class:"search-label"},"电压等级: ",-1)),P("div",gl,[N(h,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.dydj=e),placeholder:"请选择",onChange:i.changeCZLX},{default:Z(()=>[(o(!0),r(_,null,V(s.dydjoptions,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),P("div",fl,[N(u,{class:"search-datepicker",onChange:i.changeCZLX,modelValue:s.param.deviceContent,"onUpdate:modelValue":l[3]||(l[3]=e=>s.param.deviceContent=e),placeholder:"请输入内容"},null,8,["onChange","modelValue"])]),P("div",Sl,[N(p,{style:{width:"50px","line-height":"0px","text-align":"center","text-indent":"-8px"},class:"",onClick:l[4]||(l[4]=e=>i.changeCZLX(!0))},{default:Z(()=>[...l[18]||(l[18]=[M("查询 ",-1)])]),_:1})])]),P("div",Dl,[P("div",Cl,[T((o(),r("div",xl,[l[23]||(l[23]=P("div",{class:"tilte"},"可选设备(双击选取设备)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.canSelectList,(e,l)=>(o(),r("div",{class:j(["text-label",[1==e.checked?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickSelcteCanSelct(e),onDblclick:l=>i.dbClickCanSelect(e),key:l+"canSelect"},O(e.sbddmm),43,yl))),128))],2),P("div",kl,[N(p,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[5]||(l[5]=e=>i.pageChange(-1))},{default:Z(()=>[...l[21]||(l[21]=[M(" 上一页 ",-1)])]),_:1},8,["disabled"]),N(p,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[6]||(l[6]=e=>i.pageChange(1))},{default:Z(()=>[...l[22]||(l[22]=[M(" 下一页 ",-1)])]),_:1},8,["disabled"])])])),[[C,s.sbLoadingFlag]]),P("div",zl,[P("div",{class:"sortbutton upbutton",onClick:l[7]||(l[7]=(...e)=>i.moveUp&&i.moveUp(...e))},[N(b)]),P("div",{class:"sortbutton downbutton",onClick:l[8]||(l[8]=(...e)=>i.moveDown&&i.moveDown(...e))},[N(v)]),P("div",Ll,[P("div",{class:j(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[9]||(l[9]=(...e)=>i.turnRight&&i.turnRight(...e))},[N(g,{height:"24"})],2)]),P("div",Nl,[P("div",{class:j(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[10]||(l[10]=(...e)=>i.turnLeft&&i.turnLeft(...e))},[N(f,{height:"24"})],2)])]),P("div",Il,[l[25]||(l[25]=P("div",{class:"tilte"},"已选设备(双击删除已选设备)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.alSelectList,(e,a)=>(o(),r("a",{key:a+"alSelect"},[P("div",{class:j(["text-label",[a==s.alSelectDataIndex?"selctet":"",s.showzsb?"candele show-candele":"candele",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickAlSelcteCanSelct(e,a),onDblclick:e=>i.dbClickAlselctAlselect(a)},O(e.sbddmm?e.sbddmm:e.sbmc),43,wl),T(P("div",Zl,[N(S,{onChange:e=>i.selectDevice(a),modelValue:e.zsb,"onUpdate:modelValue":l=>e.zsb=l},{default:Z(()=>[...l[24]||(l[24]=[M("主 ",-1)])]),_:1},8,["onChange","modelValue","onUpdate:modelValue"])],512),[[$,s.showzsb]]),T(P("div",Pl,[T(P("span",_l,"*",512),[[$,!s.sfts]]),N(h,{class:"search-datepicker",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,placeholder:"请选择",clearable:"","allow-create":i.fromRjh,filterable:i.fromRjh},{default:Z(()=>[(o(!0),r(_,null,V(i.options2(e),e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","allow-create","filterable"])],512),[[$,!t.isCommon]])]))),128))],2)])]),T(P("div",Vl,[l[26]||(l[26]=P("div",{class:"tilte"},[M("手工录入("),P("span",{style:{color:"red"}},"注:厂站列表中没有的厂站允许在此填写"),M(")")],-1)),P("div",jl,[P("div",Ol,[N(u,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[11]||(l[11]=e=>s.inputCZ=e)},null,8,["modelValue"])]),P("div",{class:"right-button",onClick:l[12]||(l[12]=e=>i.addInpputCZ())},"加入手写")])],512),[[$,s.testData.bdlx&&-1==s.testData.bdlx.indexOf("jl")]])])],512),[[$,"ST"!=s.CZLX]]),T(P("div",Ml,[P("div",Tl,[l[27]||(l[27]=P("div",{class:"tilte"},[M("已选设备"),P("span",{style:{color:"red"}},"注：双击可移除已选设备")],-1)),P("div",$l,[(o(!0),r(_,null,V(s.NullNodeInputList,(e,l)=>(o(),r("div",{class:"nullnode-show-div-select",key:l+"slect",onDblclick:e=>i.delettextlabel(l)},[P("div",Al,O(e.sbddmm),1),T(P("div",El,[T(P("span",Bl,"*",512),[[$,!s.sfts]]),N(h,{class:"search-datepicker",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,placeholder:"请选择",clearable:"","allow-create":i.fromRjh,filterable:i.fromRjh},{default:Z(()=>[(o(!0),r(_,null,V(i.options2(e),e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","allow-create","filterable"])],512),[[$,!t.isCommon]]),P("div",{class:"delete-text-label",onClick:e=>i.delettextlabel(l)},null,8,Ul)],40,Xl))),128))]),l[28]||(l[28]=P("div",{class:"tilte"},[M("手工录入"),P("span",{style:{color:"red"}},"注：左侧设备树中没有的设备允许在此手工填写")],-1)),P("div",Rl,[P("div",ql,[N(u,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.NullNodeInput,"onUpdate:modelValue":l[13]||(l[13]=e=>s.NullNodeInput=e)},null,8,["modelValue"])]),P("div",{class:"add-input",onClick:l[14]||(l[14]=e=>i.addInpput())},"加入手写")])])],512),[[$,"ST"==s.CZLX]]),P("div",Wl,[P("div",Fl,[P("div",{class:"gljh-btn qd",onClick:l[15]||(l[15]=e=>i.confirm())},"确认")]),P("div",Kl,[P("div",{class:"gljh-btn gb",onClick:l[16]||(l[16]=e=>i.cancel())},"取消")])])]),_:1})]),_:1})],32)}],["__scopeId","data-v-d1b7a154"]]));Jl.install=e=>{e.component(Jl.name,Jl)};const Yl={name:"zcq-sb-oms",props:{paramdata:{type:Object},updateSource:String,sblist:{type:Array},id:{type:String,default:""},isCommon:{type:Boolean,default:!1}},components:{DArrowLeft:w,DArrowRight:I,Bottom:B,Top:E,Splitpanes:a,Pane:F},data:()=>({innerSblist:[],sfts:!1,showzsb:!1,STSBList:[],defaultExpandId:"",CZLX:"",testData:{tdcsParam:{CZID:""}},param:{stationId:"",sbType:"",sbTypeName:"线路",dydj:"",keyword:"",pageSize:"20",pageIndex:0},options:[{label:"线路",value:"MW_APP.MWT_UD_SB_XL"},{label:"母线",value:"MW_APP.MWT_UD_SB_MX"},{label:"断路器",value:"MW_APP.MWT_UD_SB_DLQ"},{label:"间隔单元",value:"MW_APP.MWT_UD_SB_JGDY"},{label:"发电机",value:"MW_APP.MWT_UD_SB_FDJ"},{label:"变压器",value:"MW_APP.MWT_UD_SB_BYQ"},{label:"电抗器",value:"MW_APP.MWT_UD_SB_DKQ"},{label:"电容器",value:"MW_APP.MWT_UD_SB_DLDRQ"},{label:"电流互感器",value:"MW_APP.MWT_UD_SB_DLHGQ"},{label:"电压互感器",value:"MW_APP.MWT_UD_SB_DYHGQ"}],dydjoptions:[{label:"",value:""},{label:"1000kV",value:"1000000"},{label:"500kV",value:"500000"},{label:"220kV",value:"220000"},{label:"110kV",value:"110000"},{label:"35kV",value:"35000"}],canSelectList:[],totalPage:1,alSelectList:[],inputCZ:"",canSelectData:{},treeNode:{},alSelectData:{},alSelectDataIndex:-1,allDisabled:!1,alNullNodeInput:"",NullNodeInput:"",selectNode:{CZID:""},unCZSelectFlag:!1,sbLoadingFlag:!1,props:{label:"name",children:"child",isLeaf:"leaf"}}),created(){this.sfts=!!this.paramdata.sfts&&this.paramdata.sfts,this.testData=this.paramdata,this.testData.showzsb&&(this.showzsb=!0),this.CZLX=this.testData.tdcsParam.czlx},mounted(){console.log(this.testData),this.getAlSelectDevice(),this.testData.tdcsParam||(this.testData.tdcsParam={czlx:"",CZID:"",dbId:"",stationType:""}),console.log("this.testData.tdcsParam"),console.log(this.testData.tdcsParam),this.JudgeCZMC(),this.param.sbType=this.options[0].value,this.param.sbTypeName=this.options[0].label,setTimeout(()=>{this.sbLoadingFlag=!0,this.selectCZ(this.testData.tdcsParam)},100)},methods:{getAlSelectDevice(){this.sblist&&(this.innerSblist=JSON.parse(JSON.stringify(this.sblist)),this.innerSblist.forEach(e=>{this.testData.showzsb||(e.zsb=!1),e.checked=!1}),this.alSelectList=JSON.parse(JSON.stringify(this.innerSblist)))},loadNode(e,l){this.currentNode=e.data,0==e.level?(this.currentNode={isFirst:!0,pageFlag:"sd-zcq"},this.getLoad(l)):this.getLoad(l)},getLoad(e){var l;console.log(this.CZLX),"CZ"!=this.CZLX&&(l=this.currentNode,x({url:`${K}${J}/oms/load-line-lazy-tree`,method:"post",data:l,showLoading:!0})).then(l=>(l[0]&&"0"==l[0].level&&(this.defaultExpandId=l[0].id),e(l))).catch()},clickEvent(e){e.leaf?(this.resetParam(),this.param.stationId=e.id,this.queryOMSDevice()):this.$refs.tree.setCurrentKey()},JudgeCZMC(){"CZ"!=this.CZLX&&(this.options=[{label:"线路",value:"MW_APP.MWT_UD_SB_XL"}],this.param.sbType="MW_APP.MWT_UD_SB_XL")},selectCZ(e){this.resetParam(),this.selectNode=e,this.param.stationId=this.testData.tdcsParam.CZID,this.queryOMSDevice()},selectUnCZ(){this.unCZSelectFlag=!0,this.queryOMSDevice()},changeCZLX(){this.param.sbType&&""!=this.param.sbType&&(this.param.sbTypeName=this.options.find(e=>e.value==this.param.sbType).label),this.resetParam(),this.queryOMSDevice()},resetParam(){this.param.pageIndex=0},queryOMSDevice(){var e;this.param.stationType=this.testData.tdcsParam.stationType,this.sbLoadingFlag=!0,(e=this.param,x({url:`${K}${J}/oms/list-device`,method:"post",data:e,showLoading:!0})).then(e=>{e.data&&(e.data.forEach(e=>{e.checked=!1}),this.canSelectList=e.data,this.totalPage=Math.ceil(e.total/20),this.canSelectData={}),this.sbLoadingFlag=!1}).catch()},ClickSelcteCanSelct(e){this.allDisabled||(this.canSelectList.forEach(e=>{e.checked=!1}),this.canSelectData=e,e.checked=!0)},dbClickselctAlselect(e){this.allDisabled||(this.canSelectData=e,this.canSelectList.forEach(e=>{e.checked=!1}),this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):(e.checked=!1,this.alSelectList.push(JSON.parse(JSON.stringify(e))),e.checked=!0))},pageChange(e){this.allDisabled||-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.queryOMSDevice())},ClickAlSelcteCanSelct(e,l){this.allDisabled||(this.alSelectData=e,this.alSelectDataIndex=l,this.alSelectList.forEach(e=>{e.checked=!1}),e.checked=!0)},dbClickAlselctAlselect(e){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList.splice(e,1),this.alSelectList.forEach(e=>{e.checked=!1}))},selectDevice(e){let l=[];this.alSelectList[e].zsb&&(l.push(this.alSelectList[e]),this.alSelectList.splice(e,1));let t=[],a=[];this.alSelectList.length>0&&this.alSelectList.forEach(e=>{e.zsb?t.push(e):a.push(e)}),this.alSelectList=JSON.parse(JSON.stringify(l.concat(t).concat(a)))},judgeExist(){return-1!=this.alSelectList.findIndex(e=>e.sbid==this.canSelectData.sbid)},turnRight(){this.allDisabled||null==this.canSelectData.sbid||(this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):this.alSelectList.push(this.canSelectData))},turnLeft(){this.allDisabled||(this.alSelectData={},this.alSelectDataIndex=-1,this.alSelectList=[])},moveUp(){-1!=this.alSelectDataIndex?0!=this.alSelectDataIndex?(this.alSelectList.splice(this.alSelectDataIndex-1,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex+1,1),this.alSelectDataIndex=this.alSelectDataIndex-1):this.$message({message:"已经在第一个，无法上移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},moveDown(){-1!=this.alSelectDataIndex?this.alSelectDataIndex!=this.alSelectList.length-1?(this.alSelectList.splice(this.alSelectDataIndex+2,0,this.alSelectList[this.alSelectDataIndex]),this.alSelectList.splice(this.alSelectDataIndex,1),this.alSelectDataIndex=this.alSelectDataIndex+1):this.$message({message:"已经在最后一个，无法下移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},addInpputCZ(){""!=this.inputCZ.trim()?this.alSelectList.findIndex(e=>e.sbmc==this.inputCZ)>-1?this.$message({message:"无法加入同名设备",type:"warning"}):this.alSelectList.push({sbid:"",sbmc:this.inputCZ,sbzt:"",sbddmm:this.inputCZ,label:"",dydj:"",checked:!1,sblx:"手写输入"}):this.$message({message:"无法加入空白设备",type:"warning"})},confirm(){let e={CZSBList:[],STSBList:[]};if(-1!=this.testData.bdlx.indexOf("rjh")&&this.alSelectList.length<1)return this.$emit("refreshSBXX",e.CZSBList),void this.$emit("close");if(this.alSelectList.length<1)this.$message({message:"请选择一条数据",type:"warning"});else{if(console.log("当前是否调试"),console.log(this.sfts),console.log("如果是日计划，并且sfts  为 false  此时必填设备类型"),console.log(-1!=this.testData.bdlx.indexOf("rjh")&&!this.sfts),!this.isCommon&&(-1!=this.testData.bdlx.indexOf("rjh")&&!this.sfts||this.testData.bdlx.indexOf("zcq")>-1)){let e=!1;if(this.alSelectList.forEach(l=>{l.label||(e=!0)}),e)return void this.$message({message:"请给所有设备选择类型",type:"warning"})}this.alSelectList.forEach(l=>{let t="";l.realdydj&&l.realdydj.split("kV")>1?t=l.realdydj:l.dydj&&l.dydj.split("kV")>1?t=l.dydj:l.sbdydjmc&&l.sbdydjmc.split("kV")>1?t=l.sbdydjmc:l.realdydj?t=l.realdydj:l.dyd?t=l.dydj:l.sbdydjmc&&(t=l.sbdydjmc),""!=l.sbid?(l.realdydj=t,e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm:l.sbmc,sbid:l.sbid,label:l.label?l.label:"",realdydj:l.realdydj?l.realdydj:"",zsb:!!l.zsb,sblx:l.sblx?l.sblx:"",sbbm:l.sbbm?l.sbbm:"",rl:l.sbedrl?l.sbedrl:"",czid:l.czid?l.czid:l.czid_md?l.czid_md:"",czmc:l.czmc?l.czmc:l.czmc_md?l.czmc_md:""})):(l.realdydj="",e.CZSBList.push({sbddmm:l.sbddmm?l.sbddmm.replace(/[\r\n]/g," "):l.sbmc.replace(/[\r\n]/g," "),sbid:l.sbid,label:l.label?l.label:"",realdydj:"",zsb:!!l.zsb,sblx:"手写输入",sbbm:""}))}),e.CZSBList.forEach((e,l)=>{e.sort=l+1}),this.testData.showzsb&&e.CZSBList.sort((e,l)=>e.zsb&&l.zsb?0:e.zsb?-1:1),this.closeAndReturnData(e)}},closeAndReturnData(e){console.log("设备选择组件开始回传数据"),console.log(e),this.$emit("refreshSBXX",e.CZSBList),this.$emit("close")},cancel(){this.$emit("close")}},computed:t(t({},R(["areaEng"])),{},{fromRjh:()=>!0,options2(){return(this.testData.bdlx.indexOf("rjh")>-1||this.testData.bdlx.indexOf("zcq")>-1)&&"NT"===this.areaEng?[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"},{label:"停机",value:"停机"}]:[{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"运行",value:"运行"},{label:"停用",value:"停用"}]}})},Ql={class:"sb-left-tree"},Gl={class:"search-div"},Hl={class:"search-itme"},et={class:"search-itme"},lt={class:"search-itme",style:{"margin-left":"10px"}},tt={class:"content-div"},at={class:"select-input"},st={class:"select-content"},it=["onClick","onDblclick"],dt={class:"page-div"},nt={class:"center-content"},ct={class:"cneter-div"},ot={class:"cneter-div"},rt={class:"select-content"},ht=["onClick","onDblclick"],ut={class:"zsb-check"},pt={class:"selection",style:{display:"flex"}},bt={style:{color:"red","margin-right":"5px"}},mt={class:"write-input"},vt={class:"top-hand-div"},gt={class:"write-input-textarea"},ft={class:"bottom-button-div"},St={class:"half-div"},Dt={class:"half-div"};const Ct=l("a",k(Yl,[["render",function(e,l,t,a,s,i){const d=L("el-tree"),n=L("pane"),c=L("el-option"),h=L("el-select"),u=L("el-input"),p=L("el-button"),b=L("Top"),v=L("Bottom"),g=L("d-arrow-right"),f=L("d-arrow-left"),S=L("el-checkbox"),D=L("Splitpanes"),C=U("loading");return o(),r("div",{id:"sbOMS",class:"gljh px2rem-ignore",onClose:l[14]||(l[14]=l=>e.$emit("close"))},[N(D,{style:{height:"100%"},class:"default-theme"},{default:Z(()=>[N(n,{size:"20"},{default:Z(()=>[T(P("div",{class:j(["select-cz",s.selectNode.CZID==s.testData.tdcsParam.CZID?"alselect-cz":""]),onClick:l[0]||(l[0]=e=>i.selectCZ(s.testData.tdcsParam))},O(s.testData.tdcsParam.CZMC),3),[[$,"CZ"==s.CZLX]]),P("div",Ql,[T(N(d,{"node-key":"id",ref:"tree","expand-on-click-node":!1,props:s.props,"default-expanded-keys":[s.defaultExpandId],load:i.loadNode,onNodeClick:i.clickEvent,lazy:"","highlight-current":""},null,8,["props","default-expanded-keys","load","onNodeClick"]),[[$,"CZ"!=s.CZLX]])])]),_:1}),N(n,null,{default:Z(()=>[P("div",Gl,[l[15]||(l[15]=P("div",{class:"search-label"},"设备类型: ",-1)),P("div",Hl,[N(h,{class:"search-datepicker",modelValue:s.param.sbType,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.sbType=e),placeholder:"请选择",onChange:i.changeCZLX},{default:Z(()=>[(o(!0),r(_,null,V(s.options,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),l[16]||(l[16]=P("div",{class:"search-label"},"电压等级: ",-1)),P("div",et,[N(h,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.dydj=e),placeholder:"请选择",onChange:i.changeCZLX},{default:Z(()=>[(o(!0),r(_,null,V(s.dydjoptions,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),P("div",lt,[N(u,{class:"search-datepicker",onChange:i.changeCZLX,modelValue:s.param.keyword,"onUpdate:modelValue":l[3]||(l[3]=e=>s.param.keyword=e),placeholder:"请输入内容"},null,8,["onChange","modelValue"])])]),P("div",tt,[P("div",at,[T((o(),r("div",st,[l[19]||(l[19]=P("div",{class:"tilte"},"可选设备(双击选取设备)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.canSelectList,(e,l)=>(o(),r("div",{class:j(["text-label",[e.checked?"selctet":"",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickSelcteCanSelct(e),onDblclick:l=>i.dbClickselctAlselect(e),key:l+"canSelect"},O(e.sbddmm),43,it))),128))],2),P("div",dt,[N(p,{class:"el-icon-d-arrow-left page-icon pagebutton",disabled:0==s.param.pageIndex||s.allDisabled,onClick:l[4]||(l[4]=e=>i.pageChange(-1))},{default:Z(()=>[...l[17]||(l[17]=[M(" 上一页 ",-1)])]),_:1},8,["disabled"]),N(p,{class:"el-icon-d-arrow-right page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||s.allDisabled||0==s.totalPage,onClick:l[5]||(l[5]=e=>i.pageChange(1))},{default:Z(()=>[...l[18]||(l[18]=[M(" 下一页 ",-1)])]),_:1},8,["disabled"])])])),[[C,s.sbLoadingFlag]]),P("div",nt,[P("div",{class:"sortbutton upbutton el-icon-top",onClick:l[6]||(l[6]=(...e)=>i.moveUp&&i.moveUp(...e))},[N(b)]),P("div",{class:"sortbutton downbutton",onClick:l[7]||(l[7]=(...e)=>i.moveDown&&i.moveDown(...e))},[N(v)]),P("div",ct,[P("div",{class:j(["turn-right",s.allDisabled?"disable-turn":""]),onClick:l[8]||(l[8]=(...e)=>i.turnRight&&i.turnRight(...e))},[N(g,{height:"24"})],2)]),P("div",ot,[P("div",{class:j(["turn-left",s.allDisabled?"disable-turn":""]),onClick:l[9]||(l[9]=(...e)=>i.turnLeft&&i.turnLeft(...e))},[N(f,{height:"24"})],2)])]),P("div",rt,[l[21]||(l[21]=P("div",{class:"tilte"},"已选设备(双击删除已选设备)",-1)),P("div",{class:j(["show-div",s.allDisabled?"disable-show-div":""])},[(o(!0),r(_,null,V(s.alSelectList,(e,a)=>(o(),r("a",{key:a+"alSelect"},[P("div",{class:j(["text-label candele",[a==s.alSelectDataIndex?"selctet":"",s.showzsb?"candele show-candele":"candele",s.allDisabled?"disable-text-label":""]]),onClick:l=>i.ClickAlSelcteCanSelct(e,a),onDblclick:e=>i.dbClickAlselctAlselect(a)},O(e.sbddmm?e.sbddmm:e.sbmc),43,ht),T(P("div",ut,[N(S,{onChange:e=>i.selectDevice(a),modelValue:e.zsb,"onUpdate:modelValue":l=>e.zsb=l},{default:Z(()=>[...l[20]||(l[20]=[M("主",-1)])]),_:1},8,["onChange","modelValue","onUpdate:modelValue"])],512),[[$,s.showzsb]]),T(P("div",pt,[T(P("span",bt,"*",512),[[$,!s.sfts]]),N(h,{class:"search-datepicker",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,placeholder:"请选择",clearable:"","allow-create":i.fromRjh,filterable:i.fromRjh},{default:Z(()=>[(o(!0),r(_,null,V(i.options2,e=>(o(),m(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","allow-create","filterable"])],512),[[$,!t.isCommon]])]))),128))],2)])]),T(P("div",mt,[l[22]||(l[22]=P("div",{class:"tilte"},[M("手工录入("),P("span",{style:{color:"red"}},"注:厂站列表中没有的厂站允许在此填写"),M(")")],-1)),P("div",vt,[P("div",gt,[N(u,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.inputCZ,"onUpdate:modelValue":l[10]||(l[10]=e=>s.inputCZ=e)},null,8,["modelValue"])]),P("div",{class:"right-button",onClick:l[11]||(l[11]=e=>i.addInpputCZ())},"加入手写")])],512),[[$,s.testData.bdlx&&-1==s.testData.bdlx.indexOf("jl")]])]),P("div",ft,[P("div",St,[P("div",{class:"gljh-btn qd",onClick:l[12]||(l[12]=e=>i.confirm())},"确认")]),P("div",Dt,[P("div",{class:"gljh-btn gb",onClick:l[13]||(l[13]=e=>i.cancel())},"取消")])])]),_:1})]),_:1})],32)}],["__scopeId","data-v-5e787759"]]));Ct.install=e=>{e.component(Ct.name,Ct)};const xt={name:"zcq-sb-dky",props:{isZytdsb:{type:Boolean,default:!1},isTysb:{type:Boolean,default:!1},isBYQ:{type:Boolean,default:!1},isFdj:{type:Boolean,default:!1},isMx:{type:Boolean,default:!1},isXsbty:{type:Boolean,default:!1},paramdata:{type:Object},sblist:{type:Array,default:[]},id:{type:String,default:""}},components:{DArrowLeft:w,DArrowRight:I,ArrowRight:W,ArrowLeft:q,Bottom:B,Top:E,Splitpanes:a,Pane:F},data:()=>({nowArea:"",czParam:{},selectedNodes:[],filterKey:"",treeData:[],treeFilterKey:"",guid:Q(),selfInput:"",showzsb:!1,sbLoadingFlag:!1,canSelectList:[],defaultExpandId:"",totalPage:1,props:{children:"children",label:"name",isLeaf:"leaf"},testData:{tdcsParam:{CZID:""}},param:{sblx:"",dydj:"",subId:"",keyword:"",pageSize:"20",pageIndex:0},sblxOptions:[{label:"交流线路",value:"交流线路"},{label:"T接线路",value:"T接线路"},{label:"发电机",value:"发电机"},{label:"变压器",value:"变压器"},{label:"母线",value:"母线"},{label:"断路器",value:"断路器"},{label:"隔离开关",value:"隔离开关"},{label:"并联电容器",value:"并联电容器"},{label:"电流互感器",value:"电流互感器"},{label:"电压互感器",value:"电压互感器"}],dydjoptions:[{label:"全部",value:""},{label:"1000kV",value:"1000kV"},{label:"800kV",value:"800kV"},{label:"500kV",value:"500kV"},{label:"220kV",value:"220kV"},{label:"110kV",value:"110kV"},{label:"35kV",value:"35kV"},{label:"20kV",value:"20kV"},{label:"10kV",value:"10kV"}],CZLX:"",treeNode:{},alSelectDataIndex:-1,alSelectData:{},selectNode:{}}),mounted(){this.nowArea=this.$store.state.userInfo.cropJc,this.testData=this.paramdata,this.czParam=this.paramdata.tdcsParam,this.testData.showzsb&&(this.showzsb=!0),this.testData.tdcsParam||(this.testData.tdcsParam={czlx:"",CZID:"",dbId:"",stationType:""}),this.CZLX=this.testData.tdcsParam.id,"南京"==this.nowArea&&(this.param.dydj="110kV"),"xl"==this.CZLX?(this.sblxOptions=[{label:"交流线路",value:"交流线路"},{label:"T接线路",value:"T接线路"}],"南京"==this.nowArea&&(this.dydjoptions=[{label:"全部",value:""},{label:"1000kV",value:"1000kV"},{label:"800kV",value:"800kV"},{label:"500kV",value:"500kV"},{label:"220kV",value:"220kV"},{label:"110kV",value:"110kV"}],this.param.dydj="110kV"),"常州"==this.nowArea&&(this.dydjoptions=[{label:"110kV",value:"110kV"}],this.param.dydj=this.dydjoptions[0].value),this.param.sblx=this.sblxOptions[0].value,this.param.subId="xl",this.queryDkyDevice()):"input"==this.CZLX?(this.param.sblx=this.sblxOptions[0].value,this.param.subId="input",setTimeout(()=>{this.selectCZ(this.testData.tdcsParam,!0)},100)):(this.isBYQ&&(this.sblxOptions=[{label:"变压器",value:"变压器"}]),this.isMx&&(this.sblxOptions=[{label:"母线",value:"母线"}]),this.isFdj&&(this.sblxOptions=[{label:"发电机",value:"发电机"}]),this.CZLX="CZ",this.param.sblx=this.sblxOptions[0].value,setTimeout(()=>{this.selectCZ(this.testData.tdcsParam)},100)),this.sblist.forEach(e=>{let l="";!l&&e.specialDkyName&&(l=e.specialDkyName),!l&&e.sbddmm&&(l=e.sbddmm);let t="";t="xl"==this.czParam.CZID&&"常州"!=this.nowArea?e.sbddmm:e.simpleDkyName?e.simpleDkyName:e.sbddmm;let a={zsb:e.zsb,sbzt:e.label,id:e.id,label:l,sbmc:t,d5000id:e.d5000id,dydj:e.realdydj,sbid:e.sbid,sblx:e.sblx};this.selectedNodes.push(a)})},methods:{loadNode(e,l){let t=e.data;"[object Object]"===Object.prototype.toString.call(t)&&(t.children&&t.children.length>0?l(t.children):G(t).then(e=>{l(e)}).catch())},resetParam(){this.param.pageIndex=0},filterTree(){this.treeFilterKey=this.filterKey},selectCZ(e,l){this.resetParam(),this.curNode=e,this.selectNode=e,l||(this.param.subId=this.testData.tdcsParam.id),this.queryDkyDevice()},clickEvent(e){this.param.areaId=e.id,this.param.dbId=e.pid,this.param.level=e.level,this.treeNode=e,this.restParam(),this.querySubstation()},changeCZLX(e){this.resetParam(),console.log(e,"flag"),this.queryDkyDevice()},queryDkyDevice(){var e;this.sbLoadingFlag=!0,(e=t(t({},this.param),{},{isXsbty:this.isXsbty}),x({url:`${K}${J}/dky/load-device-lazy-tree`,method:"post",data:e,showLoading:!0})).then(e=>{e.data.forEach(e=>{e.checked=!1,e.zsb=!1}),this.canSelectList=e.data,this.sbLoadingFlag=!1,this.totalPage=Math.ceil(e.total/20)}).catch(()=>{this.sbLoadingFlag=!1})},pageChange(e){-1==e&&0==this.param.pageIndex||1==e&&this.param.pageIndex+1==this.totalPage||(this.param.pageIndex+=e,this.queryDkyDevice())},ClickSelcteCanSelct(e){this.canSelectList.forEach(e=>{e.checked=!1}),e.checked=!0,this.canSelectData=e},dbClickCanSelect(e){this.canSelectData=e,this.canSelectList.forEach(e=>{e.checked=!1}),this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):("常州"===this.nowArea&&(e.sbzt="检修"),e.checked=!1,this.selectedNodes.push(JSON.parse(JSON.stringify(e))),e.checked=!0)},ClickAlSelcteCanSelct(e,l){console.log(e,l),this.canSelectData=e,this.alSelectDataIndex=l,this.selectedNodes.forEach(e=>{e.checked=!1}),e.checked=!0},deleteSelectedNode(e){this.canSelectData={},this.alSelectDataIndex=-1,this.selectedNodes.splice(this.selectedNodes.indexOf(e),1),this.selectedNodes.forEach(e=>{e.checked=!1})},judgeExist(){return-1!=this.selectedNodes.findIndex(e=>e.sbid==this.canSelectData.sbid)},moveUp(){-1!=this.alSelectDataIndex?0!=this.alSelectDataIndex?(this.selectedNodes.splice(this.alSelectDataIndex-1,0,this.selectedNodes[this.alSelectDataIndex]),this.selectedNodes.splice(this.alSelectDataIndex+1,1),this.alSelectDataIndex=this.alSelectDataIndex-1):this.$message({message:"已经在第一个，无法上移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},moveDown(){-1!=this.alSelectDataIndex?this.alSelectDataIndex!=this.selectedNodes.length-1?(this.selectedNodes.splice(this.alSelectDataIndex+2,0,this.selectedNodes[this.alSelectDataIndex]),this.selectedNodes.splice(this.alSelectDataIndex,1),this.alSelectDataIndex=this.alSelectDataIndex+1):this.$message({message:"已经在最后一个，无法下移",type:"warning"}):this.$message({message:"请选择一条数据",type:"warning"})},turnRight(){null!=this.canSelectData.sbid&&(this.judgeExist()?this.$message({message:"当前设备已添加",type:"warning"}):this.selectedNodes.push(this.canSelectData))},turnLeft(){this.alSelectData={},this.alSelectDataIndex=-1,this.selectedNodes=[]},addInpput(){let e=Math.random();this.dbClickCanSelect({id:"input"+e,label:this.selfInput,simpleDkyName:this.selfInput,sbmc:this.selfInput,sblx:"手写输入",sbid:"sbinput"+e})},confirm(){if(0===this.selectedNodes.length)return void this.$message({message:"请选择或输入一个设备进行保存",type:"warning"});if(this.showRequireLabel){if(!this.selectedNodes.every(e=>e.sbzt))return void this.$message({message:"请给所有设备选择类型",type:"warning"})}let e=[];for(let l=0;l<this.selectedNodes.length;l++){let t,a=this.selectedNodes[l];if(this.czParam&&"xl"==this.czParam.CZID&&"常州"!=this.nowArea){let e="";e=a.czmc?(a.czmc?a.czmc:"")+":"+(a.sbmc?a.sbmc:""):a.sbmc,t={sbddmm:e,specialDkyName:a.label?a.label:"",simpleDkyName:a.sbmc?a.sbmc:"",sbid:a.sbid,label:a.sbzt?a.sbzt:"",realdydj:a.realdydj?a.realdydj:a.dydj?a.dydj:"",zsb:!!a.zsb,sblx:a.sblx?a.sblx:"",czid:this.czParam.CZID,czmc:this.czParam.CZMC,id:a.id,d5000id:a.d5000id,sort:l+1}}else t={sbddmm:a.label?a.label:"",specialDkyName:a.label?a.label:"",simpleDkyName:a.sbmc?a.sbmc:"",sbid:a.sbid,label:a.sbzt?a.sbzt:"",realdydj:a.realdydj?a.realdydj:a.dydj?a.dydj:"",zsb:!!a.zsb,sblx:a.sblx?a.sblx:"",czid:this.czParam.CZID,czmc:this.czParam.CZMC,id:a.id,d5000id:a.d5000id,sort:l+1,sbedrl:a.sbedrl?a.sbedrl:"",fdlx:a.fdlx?a.fdlx:""};e.push(t)}this.$emit("refreshSBXX",e),this.$emit("close")},cancel(){this.$emit("close")}},computed:{showRequireLabel:()=>!1,showSelectSbzt:()=>!1,sbztOptions1:()=>[{label:"运行",value:"运行"},{label:"检修",value:"检修"},{label:"冷备用",value:"冷备用"},{label:"热备用",value:"热备用"},{label:"停用保护",value:"停用保护"},{label:"停用",value:"停用"},{label:"启用",value:"启用"},{label:"充电",value:"充电"}],sbztOptions2(){return this.isTysb?[{label:"主变更换",value:"主变更换"},{label:"保护更换",value:"保护更换"},{label:"流变更换",value:"流变更换"},{label:"线路改造",value:"线路改造"},{label:"压变更换",value:"压变更换"},{label:"新增主变",value:"新增主变"},{label:"新增保护",value:"新增保护"},{label:"新增流变",value:"新增流变"},{label:"新增线路",value:"新增线路"},{label:"新增压变",value:"新增压变"},{label:"母线新增",value:"母线新增"},{label:"母线改造",value:"母线改造"}]:[{label:"主变更换",value:"主变更换"},{label:"保护更换",value:"保护更换"},{label:"流变更换",value:"流变更换"},{label:"线路改造",value:"线路改造"},{label:"压变更换",value:"压变更换"},{label:"新增主变",value:"新增主变"},{label:"新增保护",value:"新增保护"},{label:"新增流变",value:"新增流变"},{label:"新增线路",value:"新增线路"},{label:"新增压变",value:"新增压变"}]},sbztOptions3:()=>[{label:"主变更换",value:"主变更换"},{label:"保护更换",value:"保护更换"},{label:"流变更换",value:"流变更换"},{label:"线路改造",value:"线路改造"},{label:"压变更换",value:"压变更换"},{label:"主变改造",value:"主变改造"},{label:"新增主变",value:"新增主变"},{label:"新增保护",value:"新增保护"},{label:"新增流变",value:"新增流变"},{label:"新增线路",value:"新增线路"},{label:"新增压变",value:"新增压变"}]}},yt={class:"sb-left-tree alselect-cz"},kt={class:"content-div"},zt={class:"search-div"},Lt={class:"search-itme"},Nt={class:"search-itme"},It={class:"search-itme",style:{"margin-left":"10px"}},wt={class:"search-itme",style:{"margin-left":"10px",width:"80px"}},Zt={class:"select-input"},Pt={class:"select-content"},_t={class:"show-div"},Vt=["onClick","onDblclick"],jt={class:"page-div"},Ot={class:"center-content"},Mt={class:"cneter-div"},Tt={class:"cneter-div"},$t={class:"select-content"},Xt={class:"node-show-div"},At=["onClick","onDblclick"],Et={class:"text-label"},Bt={class:"show-div-right"},Ut={style:{color:"red","margin-right":"5px"}},Rt=["onClick"],qt={class:"write-input"},Wt={class:"top-hand-div"},Ft={class:"write-input-textarea"},Kt={class:"bottom-button-div"},Jt={class:"half-div"},Yt={class:"half-div"};l("z",k(xt,[["render",function(e,l,t,a,s,i){const d=L("pane"),n=L("el-option"),c=L("el-select"),h=L("el-input"),u=L("el-button"),p=L("Top"),b=L("Bottom"),v=L("d-arrow-right"),g=L("d-arrow-left"),f=L("el-checkbox"),S=L("splitpanes"),D=U("loading");return o(),r("div",{id:"sbDky",class:"gljh px2rem-ignore",onClose:l[15]||(l[15]=l=>e.$emit("close"))},[(o(),m(S,{style:{height:"100%"},class:"default-theme",key:s.guid},{default:Z(()=>[N(d,{size:25},{default:Z(()=>[T(P("div",{class:j(["select-cz",s.selectNode.CZID==s.testData.tdcsParam.CZID?"alselect-cz":""]),onClick:l[0]||(l[0]=e=>i.selectCZ(s.testData.tdcsParam))},O(s.testData.tdcsParam.CZMC),3),[[$,"CZ"==s.CZLX||"input"==s.CZLX]]),T(P("div",yt," 线路 ",512),[[$,"xl"==s.CZLX]])]),_:1}),N(d,{size:75},{default:Z(()=>[P("div",kt,[P("div",zt,[l[17]||(l[17]=P("div",{class:"search-label"},"设备类型: ",-1)),P("div",Lt,[N(c,{class:"search-datepicker",modelValue:s.param.sblx,"onUpdate:modelValue":l[1]||(l[1]=e=>s.param.sblx=e),placeholder:"请选择",onChange:i.changeCZLX},{default:Z(()=>[(o(!0),r(_,null,V(s.sblxOptions,e=>(o(),m(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),l[18]||(l[18]=P("div",{class:"search-label"},"电压等级: ",-1)),P("div",Nt,[N(c,{class:"search-datepicker",modelValue:s.param.dydj,"onUpdate:modelValue":l[2]||(l[2]=e=>s.param.dydj=e),placeholder:"请选择",onChange:i.changeCZLX},{default:Z(()=>[(o(!0),r(_,null,V(s.dydjoptions,e=>(o(),m(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),P("div",It,[N(h,{class:"search-datepicker",onChange:i.changeCZLX,modelValue:s.param.keyword,"onUpdate:modelValue":l[3]||(l[3]=e=>s.param.keyword=e),placeholder:"请输入内容"},null,8,["onChange","modelValue"])]),P("div",wt,[N(u,{style:{width:"50px","line-height":"0px","text-align":"center","text-indent":"-8px"},class:"",onClick:l[4]||(l[4]=e=>i.changeCZLX(!0))},{default:Z(()=>[...l[16]||(l[16]=[M("查询 ",-1)])]),_:1})])]),P("div",Zt,[T((o(),r("div",Pt,[l[21]||(l[21]=P("div",{class:"tilte"},"可选设备(双击选取设备)",-1)),P("div",_t,[(o(!0),r(_,null,V(s.canSelectList,(e,l)=>(o(),r("div",{class:j(["text-label",[1==e.checked?"selctet":""]]),onClick:l=>i.ClickSelcteCanSelct(e),onDblclick:l=>i.dbClickCanSelect(e),key:l+"canSelect"},O(e.label),43,Vt))),128))]),P("div",jt,[N(u,{class:"page-icon pagebutton",disabled:0==s.param.pageIndex,onClick:l[5]||(l[5]=e=>i.pageChange(-1))},{default:Z(()=>[...l[19]||(l[19]=[M(" 上一页 ",-1)])]),_:1},8,["disabled"]),N(u,{class:"page-icon pagebutton",disabled:s.param.pageIndex+1==s.totalPage||0==s.totalPage,onClick:l[6]||(l[6]=e=>i.pageChange(1))},{default:Z(()=>[...l[20]||(l[20]=[M(" 下一页 ",-1)])]),_:1},8,["disabled"])])])),[[D,s.sbLoadingFlag]]),P("div",Ot,[P("div",{class:"sortbutton upbutton",onClick:l[7]||(l[7]=(...e)=>i.moveUp&&i.moveUp(...e))},[N(p)]),P("div",{class:"sortbutton downbutton",onClick:l[8]||(l[8]=(...e)=>i.moveDown&&i.moveDown(...e))},[N(b)]),P("div",Mt,[P("div",{class:"turn-right",onClick:l[9]||(l[9]=(...e)=>i.turnRight&&i.turnRight(...e))},[N(v,{height:"24"})])]),P("div",Tt,[P("div",{class:"turn-left",onClick:l[10]||(l[10]=(...e)=>i.turnLeft&&i.turnLeft(...e))},[N(g,{height:"24"})])])]),P("div",$t,[l[23]||(l[23]=P("div",{class:"tilte"},[M(" 已选数据"),P("span",{style:{color:"red"}},"注:双击可移除已选数据")],-1)),P("div",Xt,[(o(!0),r(_,null,V(s.selectedNodes,(a,d)=>(o(),r("div",{class:"node-show-div-select",key:"zcqSbDky_SelectedNodes_"+d,onClick:e=>i.ClickAlSelcteCanSelct(a,d),onDblclick:e=>i.deleteSelectedNode(a)},[P("div",Et,O(a.label),1),P("div",Bt,[T(N(f,{onChange:l=>e.selectDevice(a),modelValue:a.zsb,"onUpdate:modelValue":e=>a.zsb=e},{default:Z(()=>[...l[22]||(l[22]=[M("主 ",-1)])]),_:1},8,["onChange","modelValue","onUpdate:modelValue"]),[[$,s.showzsb]]),T(P("span",Ut,"*",512),[[$,i.showRequireLabel]]),T(N(c,{class:"search-datepicker",style:{width:"100px"},modelValue:a.sbzt,"onUpdate:modelValue":e=>a.sbzt=e,placeholder:"请选择",clearable:"","allow-create":!0,filterable:!0},{default:Z(()=>[(o(!0),r(_,null,V(i.sbztOptions1,e=>(o(),m(n,{key:e.value+d,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),[[$,i.showSelectSbzt&&!t.isTysb]]),P("div",{class:"delete-text-label",onClick:e=>i.deleteSelectedNode(a)},null,8,Rt)])],40,At))),128))])]),P("div",qt,[l[24]||(l[24]=P("div",{class:"tilte"},[P("span",{style:{display:"inline-block"}},"手动录入"),P("span",{style:{color:"red"}},"(数据库中没有的设备可在此手动添加)")],-1)),P("div",Wt,[P("div",Ft,[N(h,{style:{height:"100%"},type:"textarea",resize:"none",placeholder:"请输入内容",modelValue:s.selfInput,"onUpdate:modelValue":l[11]||(l[11]=e=>s.selfInput=e)},null,8,["modelValue"])]),P("div",{class:"add-input",onClick:l[12]||(l[12]=e=>i.addInpput())}," 加入手写 ")])])])]),P("div",Kt,[P("div",Jt,[P("div",{class:"gljh-btn qd",onClick:l[13]||(l[13]=e=>i.confirm())},"确认")]),P("div",Yt,[P("div",{class:"gljh-btn gb",onClick:l[14]||(l[14]=e=>i.cancel())},"取消")])])]),_:1})]),_:1}))],32)}],["__scopeId","data-v-eea98f1a"]]))}}})}();
