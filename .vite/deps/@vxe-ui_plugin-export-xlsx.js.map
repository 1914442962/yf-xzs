{
  "version": 3,
  "sources": ["../../node_modules/@vxe-ui/plugin-export-xlsx/es/index.esm.js"],
  "sourcesContent": ["import XEUtils from 'xe-utils';\nlet VxeUI;\nlet globalExcelJS;\nconst defaultHeaderBackgroundColor = 'f2f2f2';\nconst defaultCellFontColor = '000000';\nconst defaultCellBorderStyle = 'thin';\nconst defaultCellBorderColor = 'e0e0e0';\nconst defaultFontSizeMaps = {\n    default: 14,\n    medium: 14,\n    small: 13,\n    mini: 12\n};\nconst httpPromiseMaps = {};\nconst httpBufferMaps = {};\nfunction getExcelJS() {\n    const ExcelJS = globalExcelJS || window.ExcelJS;\n    if (!ExcelJS) {\n        console.error('[@vxe-ui/plugin-export-xlsx 4.5.1] Install error. ExcelJS not exist.');\n    }\n    return ExcelJS;\n}\nfunction getCellLabel($xeTable, column, cellValue) {\n    const { cellType, cellRender, editRender } = column;\n    const renderOpts = editRender || cellRender;\n    if (cellValue) {\n        if (renderOpts) {\n            if (['VxeImage', 'VxeImageGroup', 'VxeUpload'].includes(renderOpts.name || '')) {\n                return '';\n            }\n        }\n        if (column.type === 'seq') {\n            const tableProps = $xeTable.props;\n            const { treeConfig } = tableProps;\n            if (!treeConfig) {\n                if (!isNaN(cellValue)) {\n                    return Number(cellValue);\n                }\n            }\n            return XEUtils.toValueString(cellValue);\n        }\n        switch (cellType) {\n            case 'string':\n                return XEUtils.toValueString(cellValue);\n            case 'number':\n                if (!isNaN(cellValue)) {\n                    return Number(cellValue);\n                }\n                break;\n        }\n        if (cellValue.length < 12 && !isNaN(cellValue)) {\n            return Number(cellValue);\n        }\n    }\n    return XEUtils.toValueString(cellValue);\n}\nfunction getFooterData($xeTable, opts, footerData) {\n    const $xeGrid = $xeTable.xeGrid;\n    const $xeGantt = $xeTable.xeGantt;\n    const { footerFilterMethod } = opts;\n    return footerFilterMethod ? footerData.filter((items, index) => footerFilterMethod({ $table: $xeTable, $grid: $xeGrid, $gantt: $xeGantt, items, $rowIndex: index })) : footerData;\n}\nfunction getFooterCellValue($xeTable, opts, row, column) {\n    const { renderer } = VxeUI;\n    const { computeColumnOpts } = $xeTable.getComputeMaps();\n    const columnOpts = computeColumnOpts.value;\n    const renderOpts = column.editRender || column.cellRender;\n    let footLabelMethod = column.footerExportMethod;\n    if (!footLabelMethod && renderOpts && renderOpts.name) {\n        const compConf = renderer.get(renderOpts.name);\n        if (compConf) {\n            footLabelMethod = compConf.tableFooterExportMethod || compConf.footerExportMethod;\n        }\n    }\n    if (!footLabelMethod) {\n        footLabelMethod = columnOpts.footerExportMethod;\n    }\n    if (footLabelMethod) {\n        const _columnIndex = $xeTable.getVTColumnIndex(column);\n        return footLabelMethod({ $table: $xeTable, items: row, itemIndex: _columnIndex, row, _columnIndex, column, options: opts });\n    }\n    if ($xeTable.getFooterCellLabel) {\n        return getCellLabel($xeTable, column, $xeTable.getFooterCellLabel(row, column));\n    }\n    // 兼容老模式\n    if (XEUtils.isArray(row)) {\n        const _columnIndex = $xeTable.getVTColumnIndex(column);\n        return getCellLabel($xeTable, column, row[_columnIndex]);\n    }\n    return getCellLabel($xeTable, column, XEUtils.get(row, column.field));\n}\nfunction getValidColumn(column) {\n    const { childNodes } = column;\n    const isColGroup = childNodes && childNodes.length;\n    if (isColGroup) {\n        return getValidColumn(childNodes[0]);\n    }\n    return column;\n}\nfunction setExcelRowHeight(excelRow, height) {\n    if (height) {\n        excelRow.height = XEUtils.floor(height * 1.13, 2);\n    }\n}\nfunction setExcelCellStyle(excelCell, align) {\n    excelCell.protection = {\n        locked: false\n    };\n    excelCell.alignment = {\n        vertical: 'middle',\n        horizontal: align || 'left'\n    };\n}\nfunction getImgType(name) {\n    const index = name.lastIndexOf('.');\n    let ext = '';\n    if (index > 0) {\n        ext = name.substring(index + 1).toLowerCase();\n    }\n    return ext || 'png';\n}\nfunction getExcelCellCurrencySymbol(currencySymbol) {\n    if (currencySymbol === '$') {\n        return '$';\n    }\n    if (currencySymbol === '¥' || currencySymbol === '￥') {\n        return '¥';\n    }\n    return currencySymbol;\n}\nfunction getExcelCellNumberValSymbol(digits) {\n    return `0.${XEUtils.padEnd('0', digits, '0')}`;\n}\nfunction getExcelCellNumberColorSymbol(showNegativeStatus) {\n    if (showNegativeStatus) {\n        return '[Red]';\n    }\n    return '';\n}\nfunction settExcelCellFormat(workbook, worksheet, excelCell, column, excelRow, row) {\n    const { getConfig, getI18n } = VxeUI;\n    const { cellType, cellRender, editRender } = column;\n    if (cellType !== 'string') {\n        const renderOpts = editRender || cellRender;\n        if (renderOpts) {\n            const { name, props = {}, showNegativeStatus } = renderOpts;\n            if (name === 'VxeNumberInput' || name === 'FormatNumberInput') {\n                const { type, digits } = props;\n                const numberInputConfig = getConfig().numberInput || {};\n                if (type === 'amount') {\n                    const numDigits = digits || numberInputConfig.digits || 2;\n                    const numSymbol = getExcelCellNumberValSymbol(numDigits);\n                    excelCell.numFmt = `##${numSymbol};${getExcelCellNumberColorSymbol(showNegativeStatus)}\\\\-##${numSymbol}`;\n                    const showCurrency = props.showCurrency;\n                    if (XEUtils.isBoolean(showCurrency) ? showCurrency : numberInputConfig.showCurrency) {\n                        const currencySymbol = getExcelCellCurrencySymbol(props.currencySymbol || numberInputConfig.currencySymbol || getI18n('vxe.numberInput.currencySymbol') || '');\n                        excelCell.numFmt = `\"${currencySymbol}\"#,##${numSymbol};${getExcelCellNumberColorSymbol(showNegativeStatus)}-\"${currencySymbol}\"#,##${numSymbol}`;\n                    }\n                }\n                else {\n                    const numDigits = digits || (type === 'float' ? numberInputConfig.digits : 2) || 1;\n                    const numSymbol = getExcelCellNumberValSymbol(numDigits);\n                    excelCell.numFmt = `##${numSymbol};${getExcelCellNumberColorSymbol(showNegativeStatus)}\\\\-##${numSymbol}`;\n                }\n            }\n            else if (renderOpts.name === 'VxeImage' || renderOpts.name === 'VxeImageGroup') {\n                const { width, height } = (renderOpts.name === 'VxeImage' ? props : props.imageStyle) || {};\n                const cellValue = XEUtils.get(row, column.field);\n                if (cellValue) {\n                    // 支持一张图片\n                    (XEUtils.isArray(cellValue) ? cellValue.slice(0, 1) : [cellValue]).forEach(item => {\n                        if (item) {\n                            const imgUrl = XEUtils.isString(item) ? item : item.url;\n                            if (imgUrl) {\n                                const imgBuffer = httpBufferMaps[imgUrl];\n                                if (imgBuffer) {\n                                    const cellImage = workbook.addImage({\n                                        buffer: imgBuffer,\n                                        extension: getImgType(imgUrl)\n                                    });\n                                    worksheet.addImage(cellImage, {\n                                        tl: {\n                                            col: Math.max(0, XEUtils.toNumber(excelCell.col) - 1),\n                                            row: Math.max(0, XEUtils.toNumber(excelCell.row) - 1)\n                                        },\n                                        ext: {\n                                            width: XEUtils.toNumber(width || height) || 24,\n                                            height: XEUtils.toNumber(height || width) || 24\n                                        }\n                                    });\n                                }\n                            }\n                        }\n                    });\n                }\n            }\n            else if (renderOpts.name === 'VxeUpload' && props.mode === 'image') {\n                const { urlField, typeField, imageConfig } = props;\n                const { width, height } = imageConfig || {};\n                const cellValue = XEUtils.get(row, column.field);\n                if (cellValue) {\n                    // 支持一张图片\n                    (XEUtils.isArray(cellValue) ? cellValue.slice(0, 1) : [cellValue]).forEach(item => {\n                        if (item) {\n                            const imgUrl = XEUtils.isString(item) ? item : item[urlField || 'url'];\n                            if (imgUrl) {\n                                const imgBuffer = httpBufferMaps[imgUrl];\n                                if (imgBuffer) {\n                                    const cellImage = workbook.addImage({\n                                        buffer: imgBuffer,\n                                        extension: (XEUtils.isString(item) ? '' : item[typeField]) || getImgType(imgUrl)\n                                    });\n                                    worksheet.addImage(cellImage, {\n                                        tl: {\n                                            col: Math.max(0, XEUtils.toNumber(excelCell.col) - 1),\n                                            row: Math.max(0, XEUtils.toNumber(excelCell.row) - 1)\n                                        },\n                                        ext: {\n                                            width: XEUtils.toNumber(width || height) || 24,\n                                            height: XEUtils.toNumber(height || width) || 24\n                                        }\n                                    });\n                                }\n                            }\n                        }\n                    });\n                }\n            }\n        }\n    }\n}\nfunction getDefaultBorderStyle() {\n    return {\n        top: {\n            style: defaultCellBorderStyle,\n            color: {\n                argb: defaultCellBorderColor\n            }\n        },\n        left: {\n            style: defaultCellBorderStyle,\n            color: {\n                argb: defaultCellBorderColor\n            }\n        },\n        bottom: {\n            style: defaultCellBorderStyle,\n            color: {\n                argb: defaultCellBorderColor\n            }\n        },\n        right: {\n            style: defaultCellBorderStyle,\n            color: {\n                argb: defaultCellBorderColor\n            }\n        }\n    };\n}\nfunction handleParseColumnImageUrl(params) {\n    const { columns, datas } = params;\n    const urlList = [];\n    columns.forEach(column => {\n        const { cellRender, editRender } = column;\n        const renderOpts = editRender || cellRender || {};\n        const { name, props = {} } = renderOpts;\n        if (name === 'VxeImage' || name === 'VxeImageGroup') {\n            datas.forEach(rowRest => {\n                const row = rowRest._row;\n                const cellValue = XEUtils.get(row, column.field);\n                if (cellValue) {\n                    (XEUtils.isArray(cellValue) ? cellValue : [cellValue]).forEach(item => {\n                        if (item) {\n                            const imgUrl = item.url ? item.url : `${item || ''}`;\n                            if (imgUrl) {\n                                urlList.push(imgUrl);\n                            }\n                        }\n                    });\n                }\n            });\n        }\n        else if (name === 'VxeUpload' && props.mode === 'image') {\n            const { urlField } = props;\n            datas.forEach(rowRest => {\n                const row = rowRest._row;\n                const cellValue = XEUtils.get(row, column.field);\n                if (cellValue) {\n                    (XEUtils.isArray(cellValue) ? cellValue : [cellValue]).forEach(item => {\n                        if (item) {\n                            const imgUrl = XEUtils.isString(item) ? item : item[urlField || 'url'];\n                            if (imgUrl) {\n                                urlList.push(imgUrl);\n                            }\n                        }\n                    });\n                }\n            });\n        }\n    });\n    if (urlList.length) {\n        return handleFetchImage(urlList);\n    }\n}\nfunction handleFetchImage(urlList) {\n    let fIndex = 0;\n    const handleStartFetch = () => {\n        if (fIndex < urlList.length) {\n            const restList = [];\n            let count = 1;\n            for (; fIndex < urlList.length; fIndex++) {\n                const url = urlList[fIndex];\n                if (!httpBufferMaps[url]) {\n                    if (!httpPromiseMaps[url]) {\n                        count++;\n                        httpPromiseMaps[url] = fetch(url).then(res => res.arrayBuffer()).then(arrayBuffer => {\n                            httpBufferMaps[url] = arrayBuffer;\n                            delete httpPromiseMaps[url];\n                        }).catch(() => {\n                            delete httpPromiseMaps[url];\n                        });\n                    }\n                    restList.push(httpPromiseMaps[url]);\n                }\n                if (count >= 4) {\n                    break;\n                }\n            }\n            return Promise.all(restList).then(() => {\n                if (fIndex < urlList.length) {\n                    return handleStartFetch();\n                }\n            });\n        }\n        return Promise.resolve();\n    };\n    return handleStartFetch();\n}\nfunction exportXLSX(params) {\n    const msgKey = XEUtils.uniqueId('xlsx');\n    const { modal, getI18n } = VxeUI;\n    const { $table, $grid, options, columns, colgroups, datas } = params;\n    const tableProps = $table.props;\n    const tableReactData = $table.reactData;\n    const { computeSize, computeColumnOpts } = $table.getComputeMaps();\n    const { headerAlign: allHeaderAlign, align: allAlign, footerAlign: allFooterAlign } = tableProps;\n    const { rowHeight } = tableReactData;\n    const { message, download, sheetName, isHeader, isFooter, isMerge, isColgroup, isTitle, useStyle, sheetMethod } = options;\n    const vSize = computeSize.value;\n    const columnOpts = computeColumnOpts.value;\n    const showMsg = message !== false;\n    const mergeCells = $table.getMergeCells();\n    const fontSize = defaultFontSizeMaps[vSize || ''] || 14;\n    const colList = [];\n    let footList = [];\n    const footArr = [];\n    const sheetCols = [];\n    const sheetMerges = [];\n    let beforeRowCount = 0;\n    columns.forEach((column) => {\n        const { id, renderWidth } = column;\n        sheetCols.push({\n            key: id,\n            width: XEUtils.ceil(renderWidth / 7.2, 1)\n        });\n    });\n    // 处理表头\n    if (isHeader) {\n        // 处理分组\n        if (isColgroup && colgroups) {\n            colgroups.forEach((cols, rIndex) => {\n                const groupHead = {};\n                columns.forEach((column) => {\n                    groupHead[column.id] = null;\n                });\n                cols.forEach((column) => {\n                    const { _colSpan, _rowSpan } = column;\n                    const validColumn = getValidColumn(column);\n                    const columnIndex = columns.indexOf(validColumn);\n                    const headExportMethod = column.headerExportMethod || columnOpts.headerExportMethod;\n                    groupHead[validColumn.id] = headExportMethod ? headExportMethod({ column, options, $table }) : (isTitle ? column.getTitle() : validColumn.field);\n                    if (_colSpan > 1 || _rowSpan > 1) {\n                        sheetMerges.push({\n                            s: { r: rIndex, c: columnIndex },\n                            e: { r: rIndex + _rowSpan - 1, c: columnIndex + _colSpan - 1 }\n                        });\n                    }\n                });\n                colList.push(groupHead);\n            });\n        }\n        else {\n            const colHead = {};\n            columns.forEach((column) => {\n                const { id, field } = column;\n                const headExportMethod = column.headerExportMethod || columnOpts.headerExportMethod;\n                colHead[id] = headExportMethod ? headExportMethod({ column, options, $table }) : (isTitle ? column.getTitle() : field);\n            });\n            colList.push(colHead);\n        }\n        beforeRowCount += colList.length;\n    }\n    // 处理合并\n    if (isMerge) {\n        mergeCells.forEach(mergeItem => {\n            const { row: mergeRowIndex, rowspan: mergeRowspan, col: mergeColIndex, colspan: mergeColspan } = mergeItem;\n            sheetMerges.push({\n                s: { r: mergeRowIndex + beforeRowCount, c: mergeColIndex },\n                e: { r: mergeRowIndex + beforeRowCount + mergeRowspan - 1, c: mergeColIndex + mergeColspan - 1 }\n            });\n        });\n    }\n    const rowList = datas;\n    const rowArr = rowList.map(item => {\n        const rest = {};\n        columns.forEach((column) => {\n            rest[column.id] = getCellLabel($table, column, item[column.id]);\n        });\n        return rest;\n    });\n    beforeRowCount += rowList.length;\n    // 处理表尾\n    if (isFooter) {\n        const { footerData } = $table.getTableData();\n        footList = getFooterData($table, options, footerData);\n        const mergeFooterItems = $table.getMergeFooterItems();\n        // 处理合并\n        if (isMerge) {\n            mergeFooterItems.forEach(mergeItem => {\n                const { row: mergeRowIndex, rowspan: mergeRowspan, col: mergeColIndex, colspan: mergeColspan } = mergeItem;\n                sheetMerges.push({\n                    s: { r: mergeRowIndex + beforeRowCount, c: mergeColIndex },\n                    e: { r: mergeRowIndex + beforeRowCount + mergeRowspan - 1, c: mergeColIndex + mergeColspan - 1 }\n                });\n            });\n        }\n        footList.forEach((row) => {\n            const item = {};\n            columns.forEach((column) => {\n                item[column.id] = getFooterCellValue($table, options, row, column);\n            });\n            footArr.push(item);\n        });\n    }\n    const exportMethod = () => {\n        const ExcelObj = getExcelJS();\n        if (!ExcelObj) {\n            if (modal) {\n                modal.close(msgKey);\n            }\n            return Promise.resolve({\n                status: false\n            });\n        }\n        const workbook = new ExcelObj.Workbook();\n        const sheet = workbook.addWorksheet(sheetName || 'Sheet1');\n        workbook.creator = 'vxe-table';\n        sheet.columns = sheetCols;\n        if (isHeader) {\n            sheet.addRows(colList).forEach(excelRow => {\n                if (useStyle) {\n                    setExcelRowHeight(excelRow, rowHeight);\n                }\n                excelRow.eachCell(excelCell => {\n                    const excelCol = sheet.getColumn(excelCell.col);\n                    const column = $table.getColumnById(excelCol.key);\n                    const { headerAlign, align } = column;\n                    setExcelCellStyle(excelCell, headerAlign || align || allHeaderAlign || allAlign);\n                    if (useStyle) {\n                        Object.assign(excelCell, {\n                            font: {\n                                bold: true,\n                                size: fontSize,\n                                color: {\n                                    argb: defaultCellFontColor\n                                }\n                            },\n                            fill: {\n                                type: 'pattern',\n                                pattern: 'solid',\n                                fgColor: {\n                                    argb: defaultHeaderBackgroundColor\n                                }\n                            },\n                            border: getDefaultBorderStyle()\n                        });\n                    }\n                });\n            });\n        }\n        sheet.addRows(rowArr).forEach((excelRow, rIndex) => {\n            const row = rowList[rIndex]._row;\n            if (useStyle) {\n                setExcelRowHeight(excelRow, rowHeight);\n            }\n            excelRow.eachCell(excelCell => {\n                const excelCol = sheet.getColumn(excelCell.col);\n                const column = $table.getColumnById(excelCol.key);\n                if (column) {\n                    const { align } = column;\n                    setExcelCellStyle(excelCell, align || allAlign);\n                    settExcelCellFormat(workbook, sheet, excelCell, column, excelRow, row);\n                    if (useStyle) {\n                        Object.assign(excelCell, {\n                            font: {\n                                size: fontSize,\n                                color: {\n                                    argb: defaultCellFontColor\n                                }\n                            },\n                            border: getDefaultBorderStyle()\n                        });\n                    }\n                }\n            });\n        });\n        if (isFooter) {\n            sheet.addRows(footArr).forEach((excelRow, rIndex) => {\n                const row = footList[rIndex];\n                if (useStyle) {\n                    setExcelRowHeight(excelRow, rowHeight);\n                }\n                excelRow.eachCell(excelCell => {\n                    const excelCol = sheet.getColumn(excelCell.col);\n                    const column = $table.getColumnById(excelCol.key);\n                    if (column) {\n                        const { footerAlign, align } = column;\n                        setExcelCellStyle(excelCell, footerAlign || align || allFooterAlign || allAlign);\n                        settExcelCellFormat(workbook, sheet, excelCell, column, excelRow, row);\n                        if (useStyle) {\n                            Object.assign(excelCell, {\n                                font: {\n                                    size: fontSize,\n                                    color: {\n                                        argb: defaultCellFontColor\n                                    }\n                                },\n                                border: getDefaultBorderStyle()\n                            });\n                        }\n                    }\n                });\n            });\n        }\n        return Promise.resolve(\n        // 自定义处理\n        sheetMethod\n            ? sheetMethod({\n                options: options,\n                workbook,\n                worksheet: sheet,\n                columns,\n                colgroups,\n                datas,\n                $grid,\n                $table\n            })\n            : null).then(() => {\n            sheetMerges.forEach(({ s, e }) => {\n                sheet.mergeCells(s.r + 1, s.c + 1, e.r + 1, e.c + 1);\n            });\n            return workbook.xlsx.writeBuffer().then(buffer => {\n                const type = 'application/octet-stream';\n                const blob = new Blob([buffer], { type });\n                if (modal) {\n                    modal.close(msgKey);\n                }\n                if (showMsg && modal) {\n                    modal.message({\n                        content: getI18n('vxe.table.expSuccess'),\n                        status: 'success'\n                    });\n                }\n                if (download) {\n                    // 导出 xlsx\n                    downloadFile(params, blob, options);\n                    return {\n                        status: true\n                    };\n                }\n                return { type, content: '', blob };\n            });\n        }).catch(() => {\n            if (modal) {\n                modal.close(msgKey);\n            }\n            if (showMsg && modal) {\n                modal.message({\n                    content: getI18n('vxe.table.expError'),\n                    status: 'error'\n                });\n            }\n            return {\n                status: false\n            };\n        });\n    };\n    return Promise.all([\n        handleParseColumnImageUrl(params)\n    ]).then(() => {\n        if (showMsg && modal) {\n            modal.message({\n                id: msgKey,\n                content: getI18n('vxe.table.expLoading'),\n                status: 'loading',\n                duration: -1\n            });\n            return new Promise(resolve => {\n                setTimeout(() => {\n                    resolve(exportMethod());\n                }, 1500);\n            });\n        }\n        return exportMethod();\n    });\n}\nfunction downloadFile(params, blob, options) {\n    const { modal, t } = VxeUI;\n    const { message, filename, type } = options;\n    const showMsg = message !== false;\n    if (window.Blob) {\n        if (navigator.msSaveBlob) {\n            navigator.msSaveBlob(blob, `${filename}.${type}`);\n        }\n        else {\n            const linkElem = document.createElement('a');\n            linkElem.target = '_blank';\n            linkElem.download = `${filename}.${type}`;\n            linkElem.href = URL.createObjectURL(blob);\n            document.body.appendChild(linkElem);\n            linkElem.click();\n            document.body.removeChild(linkElem);\n        }\n    }\n    else {\n        if (showMsg && modal) {\n            modal.alert({ content: t('vxe.error.notExp'), status: 'error' });\n        }\n    }\n}\nfunction importError(params) {\n    const { modal, t } = VxeUI;\n    const { $table, options } = params;\n    const tableInternalData = $table.internalData;\n    const { _importReject } = tableInternalData;\n    const showMsg = options.message !== false;\n    if (showMsg && modal) {\n        modal.message({ content: t('vxe.error.impFields'), status: 'error' });\n    }\n    if (_importReject) {\n        _importReject({ status: false });\n    }\n}\nfunction importXLSX(params) {\n    const { modal, getI18n } = VxeUI;\n    const { $table, columns, options, file } = params;\n    const tableInternalData = $table.internalData;\n    const { _importResolve } = tableInternalData;\n    const ExcelObj = getExcelJS();\n    if (!ExcelObj) {\n        if (_importResolve) {\n            _importResolve({\n                status: false\n            });\n        }\n        return;\n    }\n    const showMsg = options.message !== false;\n    const fileReader = new FileReader();\n    fileReader.onerror = () => {\n        importError(params);\n    };\n    fileReader.onload = (evnt) => {\n        const tableFieldMaps = {};\n        const tableTitleMaps = {};\n        columns.forEach((column) => {\n            const field = column.field;\n            const title = column.getTitle();\n            if (field) {\n                tableFieldMaps[field] = column;\n            }\n            if (title) {\n                tableTitleMaps[column.getTitle()] = column;\n            }\n        });\n        const workbook = new ExcelObj.Workbook();\n        const readerTarget = evnt.target;\n        if (readerTarget) {\n            workbook.xlsx.load(readerTarget.result).then(wb => {\n                const firstSheet = wb.worksheets[0];\n                if (firstSheet) {\n                    const sheetValues = Array.from(firstSheet.getSheetValues());\n                    const fieldIndex = XEUtils.findIndexOf(sheetValues, (list) => list && list.length > 0);\n                    const heads = sheetValues[fieldIndex];\n                    let status = false;\n                    const fields = heads.map(key => {\n                        if (tableFieldMaps[key]) {\n                            if (!status) {\n                                status = true;\n                            }\n                            return key;\n                        }\n                        if (tableTitleMaps[key]) {\n                            if (!status) {\n                                status = true;\n                            }\n                            return tableTitleMaps[key].field;\n                        }\n                        return null;\n                    });\n                    if (status) {\n                        const records = sheetValues.slice(fieldIndex + 1).map(list => {\n                            const record = {};\n                            fields.forEach((field, cIndex) => {\n                                if (field) {\n                                    record[field] = XEUtils.isUndefined(list[cIndex]) ? null : list[cIndex];\n                                }\n                            });\n                            return record;\n                        });\n                        $table.createData(records)\n                            .then((data) => {\n                            let loadRest;\n                            if (options.mode === 'insertTop') {\n                                loadRest = $table.insertAt(data, 0);\n                            }\n                            else if (options.mode === 'insertBottom' || options.mode === 'insert') {\n                                loadRest = $table.insertAt(data, -1);\n                            }\n                            else {\n                                const { visibleData } = $table.getTableData();\n                                loadRest = $table.remove(visibleData).then(() => $table.insertAt(data, -1));\n                            }\n                            return loadRest.then(() => {\n                                if (_importResolve) {\n                                    _importResolve({ status: true });\n                                }\n                            });\n                        });\n                        if (showMsg && modal) {\n                            modal.message({ content: getI18n('vxe.table.impSuccess', [records.length]), status: 'success' });\n                        }\n                    }\n                    else {\n                        importError(params);\n                    }\n                }\n                else {\n                    importError(params);\n                }\n            });\n        }\n        else {\n            importError(params);\n        }\n    };\n    fileReader.readAsArrayBuffer(file);\n}\nfunction hasAdvancedVersion(tableVersion) {\n    const vRest = tableVersion ? `${tableVersion}`.match(/(\\d+)\\.(\\d+)\\./) : null;\n    return vRest && XEUtils.toNumber(vRest[1]) >= 4 && XEUtils.toNumber(vRest[2]) >= 12;\n}\nfunction handleImportEvent(params) {\n    if (params.options.type === 'xlsx') {\n        if (VxeUI && hasAdvancedVersion(VxeUI.tableVersion || '')) {\n            return {\n                result: importXLSX(params),\n                status: false\n            };\n        }\n        return false;\n    }\n}\nfunction handleExportEvent(params) {\n    if (params.options.type === 'xlsx') {\n        if (VxeUI && hasAdvancedVersion(VxeUI.tableVersion || '')) {\n            return {\n                result: exportXLSX(params),\n                status: false\n            };\n        }\n        return false;\n    }\n}\nfunction pluginSetup(options) {\n    globalExcelJS = options ? options.ExcelJS : null;\n}\nexport const VxeUIPluginExportXLSX = {\n    setConfig: pluginSetup,\n    install(core, options) {\n        VxeUI = core;\n        // 检查版本\n        if (VxeUI.checkVersion) {\n            const pVersion = 4;\n            const sVersion = 11;\n            if (!VxeUI.checkVersion(VxeUI.tableVersion, pVersion, sVersion)) {\n                console.error(`[@vxe-ui/plugin-export-xlsx 4.5.1] ${VxeUI.getI18n('vxe.error.errorVersion', [`vxe-table@${VxeUI.tableVersion || '?'}`, `vxe-table v${pVersion}.${sVersion}+`])} https://vxeui.com/other4/#/plugin-export-xlsx/install`);\n            }\n        }\n        else {\n            if (!/^(4)\\./.test(VxeUI.uiVersion || VxeUI.tableVersion)) {\n                console.error('[@vxe-ui/plugin-export-xlsx 4.5.1] Requires vxe-table 4.7.0+ version. https://vxeui.com/other4/#/plugin-export-xlsx/install');\n            }\n        }\n        if (options) {\n            pluginSetup(options);\n        }\n        VxeUI.setConfig({\n            table: {\n                importConfig: {\n                    _typeMaps: {\n                        xlsx: 1\n                    }\n                },\n                exportConfig: {\n                    _typeMaps: {\n                        xlsx: 1\n                    }\n                }\n            }\n        });\n        VxeUI.interceptor.mixin({\n            'event.import': handleImportEvent,\n            'event.export': handleExportEvent\n        });\n    }\n};\nif (typeof window !== 'undefined' && window.VxeUI && window.VxeUI.use) {\n    window.VxeUI.use(VxeUIPluginExportXLSX);\n}\nexport default VxeUIPluginExportXLSX;\n"],
  "mappings": "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",
  "names": ["XEUtils"]
}
